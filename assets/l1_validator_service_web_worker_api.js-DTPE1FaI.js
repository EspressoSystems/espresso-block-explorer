(function(){"use strict";class tc{assert(){}}function rc(){return new tc}const oc=rc();function B(t,e){oc.assert(t,e)}function $e(t,e){B(typeof t===e,`type assertion failed: expected "${e}", received "${typeof t}"`)}function nc(t){B(t!==null,"expected a non-null value, received null")}function C(t,e){B(t instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof t=="object"&&t!==null?t.constructor.name:typeof t}"`)}class Ke extends Error{key;haveType;constructor(e,r,o=`expected object with key: "${r}", instead found ${e}`){super(o),this.haveType=e,this.key=r,Object.freeze(this)}toJSON(){return{code:Ke.name,message:this.message,have:this.haveType,key:this.key}}}class Ge{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class s extends Ge{}function to(t){return typeof t=="number"}function me(t){return typeof t=="string"}function sc(t){return typeof t=="bigint"}function cc(t){return typeof t=="object"&&t!==null}function ac(t){return t!==void 0}function dc(t,e){return Array.isArray(t)&&t.every(e)}function ic(t){return e=>dc(e,t)}function M(t,...e){return cc(t)&&e.every(r=>r in t)}function c(t,...e){if(typeof t!="object")throw new Error("expected object");if(t===null)throw new Error("received null");for(const r of e)if(!(r in t))throw new Ke("object",r)}function S(t,e){if(!me(t.code))throw new Error("code must be a string");if(t.code!==e)throw new Error(`expected code to be ${e}, got ${t.code}`)}class y extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return T.convert(this)}}class R{convert(e){return C(e,y),{code:e.code,message:e.message}}}const T=new R,lc="NoCodecFoundError";class pe extends Error{codec;constructor(e,r=`no codec found for: "${e}"`){super(r),this.codec=e,Object.freeze(this);debugger}toJSON(){return{code:a.encode(pe.name),message:a.encode(this.message),codec:a.encode(this.codec)}}get code(){return lc}}const Qe=new Map;class hc{convert(e){c(e,"code");const r=a.decode(e.code),o=Qe.get(r);if(!o)throw new pe(r);return o.decode(e)}}class uc{convert(e){const r=Qe.get(e.code);if(!r)throw new pe(e.code);return r.encode(e)}}class wc extends Ge{encoder=new uc;decoder=new hc}const ve=new wc;function b(t,e){Qe.set(t,e)}const Xe="InvalidTypeError";class E extends y{have;want;constructor(e,r,o=`invalid type: have "${e}", want "${r}"`){super(o),this.have=e,this.want=r,Object.freeze(this)}toJSON(){return ro.encode(this)}get code(){return Xe}}class fc{convert(e){return c(e,"code","have","want","message"),S(e,Xe),new E(a.decode(e.have),a.decode(e.want),a.decode(e.message))}}class gc{convert(e){return C(e,E),{...T.convert(e),have:a.encode(e.have),want:a.encode(e.want)}}}class mc extends s{encoder=new gc;decoder=new fc}const ro=new mc;b(Xe,ro);const pc=ic(ac);class vc{convert(e){return e}}const oo=new vc;class yc extends Ge{encoder=oo;decoder=oo}const ye=new yc;class x{itemCodec;constructor(e){this.itemCodec=e}convert(e){if(!pc(e)){const r=typeof e=="object"&&e!==null?e.constructor.name:typeof e,o="array";throw new Error(`invalid array value: have "${r}", want "${o}"`)}return e.map(r=>this.itemCodec.decode(r))}}class N{itemCodec;constructor(e){this.itemCodec=e}convert(e){return C(e,Array),e.map(r=>this.itemCodec.encode(r))}}class k extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}}class U{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class J{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:(nc(e),this.itemCodec.encode(e))}}class L extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}}class Sc{convert(e){if(!me(e))throw new E(typeof e,"string");return e}}class bc{convert(e){return $e(e,"string"),e}}class Ec extends s{encoder=new bc;decoder=new Sc}const a=new Ec;new k(new x(a),new N(a)),new L(new U(a),new J(a));class Ze extends y{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return no}}const no="CompleterAlreadyCompletedError";class Cc{convert(e){return c(e,"code","message"),S(e,no),new Ze(a.decode(e.message))}}class xc extends R{}class Nc extends s{encoder=new xc;decoder=new Cc}const kc=new Nc;b(Ze.name,kc);function Se(){B(!1,"completer is not ready, this should never be reached")}function be(){throw new Ze}class Oc{resolve=Se;reject=Se;completed=!1;promise;get isCompleted(){return this.completed}constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r}),B(this.resolve!==Se,"resolve should be set"),B(this.reject!==Se,"resolve should be set")}complete(e){const r=this.resolve,o=this.reject;if(this.completed=!0,this.resolve=be,this.reject=be,e instanceof Promise){e.then(r,o);return}r(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=be,this.reject=be}}function Ye(){return new Oc}class te extends y{response;status;constructor(e,r,o){super(o),this.status=e,this.response=r}toJSON(){return so.convert(this)}}class Ee{convert(e){return C(e,te),{...T.convert(e),status:e.status}}}const so=new Ee,et="BadResponseClientError";class co extends te{constructor(e,r,o="bad server response: client error"){super(e,r,o),Object.freeze(this)}get code(){return et}toJSON(){return ao.encode(this)}}class Bc{convert(e){return c(e,"code","message","status"),S(e,et),new co(Number(e.status),null,a.decode(e.message))}}class Dc extends Ee{}class Ic extends s{encoder=new Dc;decoder=new Bc}const ao=new Ic;b(et,ao);const tt="BadResponseError";class io extends te{constructor(e,r,o="bad server response"){super(e,r,o),Object.freeze(this)}get code(){return tt}toJSON(){return lo.encode(this)}}class Rc{convert(e){return c(e,"code","message","status"),S(e,tt),new io(Number(e.status),null,a.decode(e.message))}}class Ac extends Ee{}class Uc extends s{encoder=new Ac;decoder=new Rc}const lo=new Uc;b(tt,lo);class ho extends te{constructor(e,r,o="bad server response: server error"){super(e,r,o),Object.freeze(this)}get code(){return rt}}const rt="BadResponseServerError";class Jc{convert(e){return c(e,"code","message","status"),S(e,rt),new ho(Number(e.status),null,a.decode(e.message))}}class Lc extends Ee{}class Wc extends s{encoder=new Lc;decoder=new Jc}const Mc=new Wc;b(rt,Mc);const ot="ChannelClosedError";class re extends y{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return ot}}class Tc{convert(e){return c(e,"code","message"),S(e,ot),new re(a.decode(e.message))}}class Pc extends R{}class zc extends s{encoder=new Pc;decoder=new Tc}const Fc=new zc;b(ot,Fc);const nt="FetchError";class uo extends y{cause;constructor(e,r=`fetch failed: ${String(e)}`){super(r),this.cause=e,Object.freeze(this)}get code(){return nt}}class _c{convert(e){return c(e,"code","message"),S(e,nt),new uo({},a.decode(e.message))}}class jc extends R{}class Vc extends s{encoder=new jc;decoder=new _c}const Hc=new Vc;b(nt,Hc);const st="IncorrectBase64PaddingError";class wo extends y{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return st}}class qc{convert(e){return c(e,"code","message"),S(e,st),new wo(a.decode(e.message))}}class $c extends R{}class Kc extends s{encoder=new $c;decoder=new qc}const Gc=new Kc;b(st,Gc);class Qc{convert(e){if(!to(e))throw new E(typeof e,"number");return e}}class Xc{convert(e){return $e(e,"number"),e}}class Zc extends s{encoder=new Xc;decoder=new Qc}const p=new Zc,fo=new L(new U(p),new J(p)),go=new k(new x(p),new N(p));new k(new x(fo),new N(fo));const ct="InvalidBase64AlphabetLengthError";class at extends y{length;constructor(e,r=`alphabet needs to be 64 characters, received ${e}`){super(r),this.length=e,Object.freeze(this)}toJSON(){return mo.encode(this)}get code(){return ct}}class Yc{convert(e){return c(e,"code","length","message"),S(e,ct),new at(p.decode(e.length),a.decode(e.message))}}class ea{convert(e){return C(e,at),{...T.convert(e),length:p.encode(e.length)}}}class ta extends s{encoder=new ea;decoder=new Yc}const mo=new ta;b(ct,mo);const dt="InvalidHexStringError";class po extends y{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return dt}}class ra{convert(e){return c(e,"code","message"),S(e,dt),new po(a.decode(e.message))}}class oa extends R{}class na extends s{encoder=new oa;decoder=new ra}const sa=new na;b(dt,sa);const it="InvalidHexValueError";class vo extends y{value;constructor(e,r=`invalid hex value "${e}"`){super(r),this.value=e,Object.freeze(this)}toJSON(){return yo.encode(this)}get code(){return it}}class ca{convert(e){return c(e,"code","value","message"),S(e,it),new vo(p.decode(e.value),a.decode(e.message))}}class aa{convert(e){return{...T.convert(e),value:p.encode(e.value)}}}class da extends s{encoder=new aa;decoder=new ca}const yo=new da;b(it,yo);const lt="InvalidInputError";class oe extends y{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return lt}}class ia{convert(e){return c(e,"code","message"),S(e,lt),new oe(a.decode(e.message))}}class la extends R{}class ha extends s{encoder=new la;decoder=new ia}const ua=new ha;b(lt,ua);const ht="InvalidStringValueError";class So extends y{have;want;constructor(e,r,o=`invalid string value: have "${e}", want "${r}"`){super(o),this.have=e,this.want=r,Object.freeze(this)}toJSON(){return bo.encode(this)}get code(){return ht}}class wa{convert(e){return c(e,"code","have","want","message"),S(e,ht),new So(a.decode(e.have),a.decode(e.want),a.decode(e.message))}}class fa{convert(e){return C(e,So),{...T.convert(e),have:a.encode(e.have),want:a.encode(e.want)}}}class ga extends s{encoder=new fa;decoder=new wa}const bo=new ga;b(ht,bo);const ut="InvalidTaggedBase64EncodingError";class Eo extends y{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return Co.encode(this)}get code(){return ut}}class ma{convert(e){return c(e,"code","message"),S(e,ut),new Eo(a.decode(e.message))}}class pa extends R{}class va extends s{encoder=new pa;decoder=new ma}const Co=new va;b(ut,Co);const wt="MissingElementError";class Ce extends y{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return wt}}class ya{convert(e){return c(e,"code","message"),S(e,wt),new Ce(a.decode(e.message))}}class Sa extends R{}class ba extends s{encoder=new Sa;decoder=new ya}const Ea=new ba;b(wt,Ea);const ft="NoCompleterFoundForRequestID";class xo extends y{requestID;constructor(e,r=`no completer found for request id "${e}"`){super(r),this.requestID=e,Object.freeze(this)}toJSON(){return No.encode(this)}get code(){return ft}}class Ca{convert(e){return c(e,"code","requestID","message"),S(e,ft),new xo(ye.decode(e.requestID),a.decode(e.message))}}class xa{convert(e){return C(e,xo),{...T.convert(e),requestID:ye.encode(e.requestID)}}}class Na extends s{encoder=new xa;decoder=new Ca}const No=new Na;b(ft,No);const gt="NotFoundError";class ka extends y{key;constructor(e,r=`Not Found: ${e}`){super(r),this.key=e,Object.freeze(this)}get code(){return gt}}class ko{codec;constructor(e){this.codec=e}convert(e){return c(e,"code","key"),S(e,gt),new ka(this.codec.decode(e.key))}}class Oo{codec;constructor(e){this.codec=e}convert(e){return{...T.convert(e),key:this.codec.encode(e.key)}}}class Bo extends s{encoder;decoder;constructor(e,r){super(),this.encoder=e,this.decoder=r}}new Bo(new Oo(a),new ko(a));const Oa=new Bo(new Oo(ye),new ko(ye));b(gt,Oa);const mt="NoURLProvidedError";class Ba extends y{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return mt}}class Da{convert(e){return c(e,"code","message"),S(e,mt),new Ba(a.decode(e.message))}}class Ia extends R{}class Ra extends s{encoder=new Ia;decoder=new Da}const Aa=new Ra;b(mt,Aa);const pt="UnimplementedError";class A extends y{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return pt}}class Ua{convert(e){return c(e,"code","message"),S(e,pt),new A(a.decode(e.message))}}class Ja extends R{}class La extends s{encoder=new Ja;decoder=new Ua}const Wa=new La;b(pt,Wa);const vt="QUERY_ERROR";class Ma extends y{error;constructor(e,r="missing element"){super(r),this.error=e,Object.freeze(this)}get code(){return vt}}class Ta{convert(e){return c(e,"code","error","message"),S(e,vt),new Ma(Ao.decode(e.error),a.decode(e.message))}}class Pa{convert(e){return{code:e.code,error:Ao.encode(e.error),message:a.encode(e.message)}}}class za extends s{encoder=new Pa;decoder=new Ta}const Fa=new za;class yt{}const St="NotFound";class Do extends yt{constructor(){super(),Object.freeze(this)}valueOf(){return St}toJSON(){return this.valueOf()}}const _a=new Do,bt="Missing";class Io extends yt{constructor(){super(),Object.freeze(this)}valueOf(){return bt}toJSON(){return this.valueOf()}}const ja=new Io;class Ro extends yt{error;constructor(e){super(),this.error=e,Object.freeze(this)}toJSON(){return Ct.encode(this)}}class Va{message;constructor(e){this.message=e,Object.freeze(this)}toJSON(){return Et.encode(this)}}class Ha{convert(e){return c(e,"message"),new Va(a.decode(e.message))}}class qa{convert(e){return{message:a.encode(e.message)}}}class $a extends s{encoder=new qa;decoder=new Ha}const Et=new $a;class Ka{convert(e){return c(e,"Error"),new Ro(Et.decode(e.Error))}}class Ga{convert(e){return{Error:Et.encode(e.error)}}}class Qa extends s{encoder=new Ga;decoder=new Ka}const Ct=new Qa;class Xa{convert(e){return e===St?_a:e===bt?ja:Ct.decode(e)}}class Za{convert(e){if(e instanceof Do)return St;if(e instanceof Io)return bt;if(e instanceof Ro)return Ct.encode(e);throw new A}}class Ya extends s{encoder=new Za;decoder=new Xa}const Ao=new Ya;b(vt,Fa);const Uo="ResponseContentTypeIsNotApplicationJSONError";class ne extends te{haveHeaderType;constructor(e,r,o,n="response content type is not application/json"){super(r,o,n),this.haveHeaderType=e,Object.freeze(this)}static fromResponse(e,r){return new ne(e.headers.get("content-type")??"undefined",e.status,e,r)}toJSON(){return Jo.encode(this)}get code(){return Uo}}class ed{convert(e){return c(e,"code","status","have","want","message"),S(e,Uo),new ne(a.decode(e.code),p.decode(e.status),null,a.decode(e.message))}}class td{convert(e){return{...so.convert(e),have:a.encode(e.haveHeaderType),want:a.encode("application/json")}}}class rd extends s{encoder=new td;decoder=new ed}const Jo=new rd;b(ne.name,Jo);const xt="WebWorkerErrorResponse";class od extends y{error;constructor(e,r="error in web worker"){super(r),this.error=e,Object.freeze(this)}toJSON(){return Lo.encode(this)}get code(){return xt}}class nd{convert(e){return c(e,"code","error","message"),S(e,xt),new od(ve.decode(e.error),a.decode(e.message))}}class sd{convert(e){return{...T.convert(e),error:ve.encode(e.error)}}}class cd extends s{encoder=new sd;decoder=new nd}const Lo=new cd;b(xt,Lo);var Wo=(t=>(t[t.success=0]="success",t[t.full=1]="full",t[t.failed=2]="failed",t))(Wo||{});class ad{getFromEmpty(){}}class dd{getFromEmpty(){throw new Ce}}const Mo={returnUndefined:new ad,throwMissingElement:new dd};class id{maxSize;constructor(e){B(!Number.isNaN(e),"maxSize must not be NaN"),B(Number.isInteger(e),"maxSize must be an integer"),B(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return B(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class ld{preComputedSizeMinus1;constructor(e){B(!Number.isNaN(e),"maxSize must not be NaN"),B(Number.isInteger(e),"maxSize must be an integer"),B(e>0,"maxSize must be greater than 0"),B(To(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return B(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function To(t){return(t&t-1)===0}const Nt="BufferFullError";class Po extends y{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return Nt}}class hd{convert(e){return c(e,"code","message"),S(e,Nt),new Po(a.decode(e.message))}}class ud extends R{}class wd extends s{encoder=new ud;decoder=new hd}const fd=new wd;b(Nt,fd);class gd{putToFull(e,r){return e.get(),e.put(r)}}class md{putToFull(){throw new Po}}const zo={overwriteOldest:new gd,throw:new md};function pd(t){return To(t)?new ld(t):new id(t)}class vd{readIndex=0;writeIndex=0;buffer;nextIndex;getOnEmpty;putOnFull;constructor(e,r,o){B(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=pd(e),this.getOnEmpty=r,this.putOnFull=o}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const r=this.nextIndex.nextIndex(this.writeIndex);return r===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=r,Wo.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new yd(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new Sd(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class yd{buffer;constructor(e){this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class Sd{readIndex;writeIndex;buffer;nextIndex;constructor(e,r,o,n){this.readIndex=e,this.writeIndex=r,this.buffer=o,this.nextIndex=n}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function bd(t=32,e=Mo.returnUndefined,r=zo.overwriteOldest){return new vd(t,e,r)}class Ed{publishQueue;pollBlocked;publishBlocked;capacity;closed=!1;constructor(e){this.publishQueue=bd(Math.max(2,e),Mo.throwMissingElement,zo.throw);const r=Ye();this.pollBlocked=r,this.publishBlocked=r,r.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new re;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new re;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const r=Ye();this.publishBlocked=r,await r.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new re;if(this.pollBlocked.isCompleted){const r=Ye();this.pollBlocked=r}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new Cd(this)}}class Cd{channel;constructor(e){this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof re)return{done:!0,value:void 0};throw e}}}function xd(t){return new Ed(t)}class F{constructor(e,r,o){this.alpha3Code=e,this.code=r,this.significantDigits=o,this.alpha3Code=e,this.code=r,this.significantDigits=o,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}significantDigitsMultiplier;toJSON(){return xe.encode(this)}}const Fo=new F("JPY",392,0),Nd=new F("GBP",826,2),_o=new F("USD",840,2),kd=new F("EUR",978,2),Od=new F("XXX",999,2),jo=new F("ETH",1001,18),kt=new F("XBT",1002,8),Vo=new F("ESP",10001,18),Bd=[Fo,Nd,_o,kd,Od,jo,kt,Vo],Dd=new Map(Bd.map(t=>[t.alpha3Code,t]));class Id{convert(e){if(typeof e!="string")throw new oe("CurrencyCodeDecoder: expected string");if(e==="BTC")return kt;const r=Dd.get(e);if(r===void 0)throw new oe(`CurrencyCodeDecoder: unknown currency: "${e}"`);return r}}class Rd{convert(e){return C(e,F),e.alpha3Code}}class Ad extends s{decoder=new Id;encoder=new Rd}const xe=new Ad;class P{constructor(e,r){this.currency=e,this.value=r,this.currency=e,this.value=r}static USD(e){return new P(_o,BigInt(e))}static ETH(e){return new P(jo,BigInt(e))}static ESP(e){return new P(Vo,BigInt(e))}static JPY(e){return new P(Fo,BigInt(e))}static BTC(e){return new P(kt,BigInt(e))}toString(){return Ne.encode(this)}toJSON(){return Ne.encode(this)}}function Ud(t){return t==="."||t===","||t===" "}function Jd(t,e){let r=-1;const o=t.length;for(let n=0;n<o;n++)e(t[n])&&(r=n);return r}class Ld{parseCurrencyCode(e){return xe.decode(e)}parseValue(e,r){let o=1n;r[0]==="-"&&(o=-1n,r=r.substring(1));const n=Jd(r,Ud);if(n===-1){const l=BigInt(r.replace(/\D/g,""))*e.significantDigitsMultiplier;return o*l}const d=r.substring(0,n).replace(/\D/g,""),h=r.substring(n+1).replace(/\D/g,""),u=BigInt(d)*e.significantDigitsMultiplier,m=BigInt(h)*10n**BigInt(e.significantDigits-h.length);return o*(u+m)}convert(e){if(typeof e!="string")throw new oe("MonetaryValueDecoder: expected string");const r=e.indexOf(" ");if(r<=-1)throw new oe("MonetaryValueDecoder: missing non-breaking space");const o=e.substring(0,r),n=e.substring(r+1);if(/^-?[\d .,]+$/.test(o)){const h=this.parseCurrencyCode(n);return new P(h,this.parseValue(h,o))}const d=this.parseCurrencyCode(o);return new P(d,this.parseValue(d,n))}}class Wd{convert(e){C(e,P);const r=e.value<0n?"-":"",o=e.value<0n?-e.value:e.value,n=o%e.currency.significantDigitsMultiplier,d=o/e.currency.significantDigitsMultiplier,h=String(d),u=String(n);return/^0+$/.test(u)?`${xe.encode(e.currency)} ${r}${h}`:`${xe.encode(e.currency)} ${r}${d}.${String(n).padStart(e.currency.significantDigits,"0")}`}}class Md extends s{decoder=new Ld;encoder=new Wd}const Ne=new Md;new k(new x(Ne),new N(Ne));class v{namespace;name;site;blockExplorer;constructor(e,r,o,n){this.namespace=e,this.name=r,this.site=o,this.blockExplorer=n}}const Td=new v(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),Pd=new v(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),zd=new v(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),Fd=new v(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),_d=new v(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),jd=new v(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),Vd=new v(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),Hd=new v(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),qd=new v(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),$d=new v(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),Kd=new v(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),Gd=1918988905,Qd=new v(Gd,"RARI",new URL("https://rarichain.org/"),new URL("https://explorer.rarichain.org/")),Xd=1380012617,Zd=new v(Xd,"RARI",new URL("https://rarichain.org/"),new URL("https://mainnet.explorer.rarichain.org/")),Yd=9369,ei=new v(Yd,"LogX",new URL("https://logx.network/"),new URL("https://kartel-testnet-explorer.alt.technology/")),ti=936369,ri=new v(ti,"LogX",new URL("https://logx.network/"),new URL("https://vzjuxmhfn70kgnlds27h-explorer.alt.technology")),oi=466,ni=new v(oi,"AppChain",new URL("https://appchain.xyz/"),new URL("https://explorer.appchain.xyz/")),si=4661,ci=new v(si,"AppChain",new URL("https://appchain.xyz/"),new URL("https://appchaintestnet.explorer.caldera.xyz/")),ai=360,di=new v(ai,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),ii=3609,li=new v(ii,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),hi=33139,ui=new v(hi,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apescan.io/")),wi=3313939,fi=new v(wi,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apechain-testnet.explorer.caldera.xyz/")),gi=13107,mi=new v(gi,"t3rn",new URL("https://t3rn.io/"),new URL("https://brn-testnet.explorer.caldera.xyz/")),pi=819,vi=new v(pi,"t3rn",new URL("https://t3rn.io/"),new URL("https://exporer.t3rn.io/")),Ho=21341,yi=new v(Ho,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus-sepolia-testnet.explorer.caldera.xyz/")),Si=new v(Ho,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus.calderaexplorer.xyz/")),bi=2524852,Ei=new v(bi,"Huddle01",new URL("https://huddle01.com/"),new URL("https://hudlscan.com/txs")),Ci=1397311310,qo=new v(Ci,"Infinite Garden",new URL("https://infinitegarden.espressosys.com/"),new URL("https://explorer.main.net.espressosys.com/")),xi=10101,Ni=new v(xi,"Timeboost Decaf",new URL("https://espressosys.com/"),new URL("https://explorer.decaf.testnet.espresso.network/")),ki=[qo,Zd,ri,di,ni,ui,vi,Si],Oi=[qo,Qd,ei,ci,li,fi,mi,yi,Ei,Ni],Bi=new Map([Td,Pd,zd,qd,Fd,_d,jd,Vd,Hd,$d,Kd,...ki,...Oi].map(t=>[t.namespace,t])),Ot="CorruptBase64InputError";class V extends y{offset;constructor(e,r=`corrupt input error at ${e}`){super(r),this.offset=e,Object.freeze(this)}get code(){return Ot}toJSON(){return $o.encode(this)}}class Di{convert(e){return c(e,"code","offset","message"),S(e,Ot),new V(p.decode(e.offset),a.decode(e.message))}}class Ii{convert(e){return C(e,V),{...T.convert(e),offset:p.encode(e.offset),message:a.encode(e.message)}}}class Ri extends s{encoder=new Ii;decoder=new Di}const $o=new Ri;b(Ot,$o);class Ai{convert(e){const r=new ArrayBuffer(e.byteLength);return new Uint8Array(r).set(e),r}}class Ui{convert(e){return new Uint8Array(e)}}class Ji extends s{encoder=new Ai;decoder=new Ui}const Bt=new Ji,Li=new TextEncoder;function Ko(t){return Li.encode(t)}const Wi=new TextDecoder;function Mi(t){return Wi.decode(t)}function*Go(t){yield*Ko(t)}function*Ti(){for(let t=0;t<256;t++)yield 255}const se=-1,Pi=61;class ce{encodeMap;decodeMap;padChar;strict;constructor(e,r,o=Pi,n=!1){this.encodeMap=e,this.decodeMap=r,this.padChar=o,this.strict=n}static withAlphabet(e){const r=e.length;if(r!==64)throw new at(r);const o=Array.from(Go(e)),n=Array.from(Ti());for(let d=0;d<r;d++)n[o[d]]=d;return new ce(o,n)}withPadding(e){return new ce(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let r=0,o=0;const n=Math.floor(e.byteLength/3)*3,d=Math.ceil(e.byteLength/3)*4,h=new ArrayBuffer(d),u=new DataView(e),m=new DataView(h);for(;o<n;){const D=u.getUint8(o+0)<<16|u.getUint8(o+1)<<8|u.getUint8(o+2);m.setUint8(r+0,this.encodeMap[D>>18&63]),m.setUint8(r+1,this.encodeMap[D>>12&63]),m.setUint8(r+2,this.encodeMap[D>>6&63]),m.setUint8(r+3,this.encodeMap[D&63]),o+=3,r+=4}const l=e.byteLength-o;if(l===0)return h;let O=u.getUint8(o+0)<<16;switch(l===2&&(O|=u.getUint8(o+1)<<8),m.setUint8(r+0,this.encodeMap[O>>18&63]),m.setUint8(r+1,this.encodeMap[O>>12&63]),l){case 2:return m.setUint8(r+2,this.encodeMap[O>>6&63]),this.padChar!==se?(m.setUint8(r+3,this.padChar),h.slice(0,r+4)):h.slice(0,r+3);case 1:if(this.padChar!==se)return m.setUint8(r+2,this.padChar),m.setUint8(r+3,this.padChar),h.slice(0,r+4);break}return h.slice(0,r+2)}decode(e){const r=e.byteLength;if(r===0)return new ArrayBuffer(0);const o=new DataView(e),n=new ArrayBuffer(Math.floor(r/4*3)),d=new DataView(n),h=new ArrayBuffer(4),u=new DataView(h);let m=0,l=0,O=0,D=!1;for(;l<r&&!D;){let f=3,w=4;for(let I=0;I<4;I++){if(l===r){if(I===0)return n;if(I===1||this.padChar!==se)throw new V(l-I);f=I-1,w=I,D=!0;break}const K=o.getUint8(l);l++;const ge=this.decodeMap[K];if(ge!==255){u.setUint8(I,ge);continue}if(K===10||K===13){I--;continue}if(K===this.padChar){switch(I){case 0:case 1:throw new wo;case 2:for(;l<r&&(o.getUint8(l)===10||o.getUint8(l)===13);)l++;if(l===r)throw new V(r);l++}for(;l<r&&(o.getUint8(l)===10||o.getUint8(l)===13);)l++;if(l<r)throw new V(l);f=3,w=I,D=!0;break}throw new V(l-1)}const ee=u.getUint8(0)<<18|u.getUint8(1)<<12|u.getUint8(2)<<6|u.getUint8(3);switch(u.setUint8(2,ee>>0&255),u.setUint8(1,ee>>8&255),u.setUint8(0,ee>>16&255),w){case 4:d.setUint8(O+2,u.getUint8(2)),u.setUint8(2,0);case 3:if(d.setUint8(O+1,u.getUint8(1)),this.strict&&u.getUint8(2)!==0)throw new V(l-1);case 2:if(d.setUint8(O+0,u.getUint8(0)),this.strict&&(u.getUint8(1)!==0||u.getUint8(2)!==0))throw new V(l-2)}O+=f,m+=w-1}return n.slice(0,m)}decodeString(e){return this.decode(Bt.encode(Ko(e)))}encodeToString(e){return Mi(this.encode(e))}}const Qo=ce.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),zi=Qo.withPadding(se),Xo=ce.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Dt=Xo.withPadding(se);class z{tag;data;constructor(e,r){this.tag=e,this.data=r}static fromString(e){const r=e.indexOf("~");if(r<0)throw new Eo;const o=e.substring(0,r),n=Dt.decodeString(e.substring(r+1));return new z(o,n)}static inflate(e){return W.decode(e)}toString(){return`${this.tag}~${Dt.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class Fi{convert(e){if(typeof e!="string")throw new E(typeof e,"string");return z.fromString(e)}}class _i{convert(e){return C(e,z),e.toString()}}class ji extends s{encoder=new _i;decoder=new Fi}const W=new ji,ae=2147483648,Vi=1103515245,Hi=12345;class G{state;constructor(e){this.state=e!==void 0?e:Math.floor(Math.random()*(ae-1))}nextInt(){return this.state=(Vi*this.state+Hi)%ae,this.state}nextFloat(){return this.nextInt()/(ae-1)}nextRange(e,r){const o=r-e,n=this.nextInt()/ae;return e+Math.floor(n*o)}nextRangeBigInt(e,r){const o=r-e,n=BigInt(this.nextInt())*1000000n/BigInt(ae);return e+n*o/1000000n}fillBytes(e){const r=new ArrayBuffer(e),o=new DataView(r);let n=0;for(;n<e-4;n+=4)o.setUint32(n,this.nextRange(0,4294967295));for(let d=n;d<e;d++)o.setUint8(d,this.nextRange(0,256));return r}}const ke=new Date,Zo=new Date(ke.getFullYear(),ke.getMonth(),ke.getDate()).valueOf(),qi=Zo;function $i(){return ke.valueOf()}function Ki(){return Zo}function It(){return qi}function*Gi(t,e){for(let r=t.next();!r.done;r=t.next())e(r.value)&&(yield r.value)}function Qi(t,e){return Gi(t[Symbol.iterator](),e)}function*Yo(t,e){for(let r=t.next();!r.done;r=t.next())yield e(r.value)}function Oe(t,e){return Yo(t[Symbol.iterator](),e)}function*Xi(t,e){for(let r=0;r<e;r++){const o=t.next();if(o.done)return;yield o.value}}function Zi(t,e){return Xi(t[Symbol.iterator](),e)}function Yi(t){let e;for(let r=t.next();!r.done;r=t.next())e=r.value;if(e===void 0)throw new Ce;return e}function el(t){return Yi(t[Symbol.iterator]())}function*tl(t,e){for(let r=t.next();!r.done;r=t.next())yield*e(r.value)}function rl(t,e){return tl(t[Symbol.iterator](),e)}function*ol(){let t=0;for(;;)yield t++}function nl(t){return Zi(ol(),Math.ceil(t))}function*sl(t,e,r){for(let o=t.next(),n=e.next();!o.done&&!n.done;o=t.next(),n=e.next())yield r(o.value,n.value)}function en(t,e,r){return sl(t[Symbol.iterator](),e[Symbol.iterator](),r)}const tn=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],rn=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],on=["Linux","Unix","Windows","MacOS"],nn=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],cl=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],sn=[0,0,5,26,28,26,9,6],al=sn.reduce((t,e)=>t+e,0),dl=sn.reduce((t,e)=>{const r=t[t.length-1]??0;return t.push(r+e),t},[]),il=Array.from(en(dl,cl,(t,e)=>[t,e]));function ll(t){const e=t.nextRange(0,al),r=Qi(il,([h])=>h<=e),[,o]=el(r),n=t.nextRange(0,o.length);return o[n]}function hl(t){const e=t.nextRange(0,nn.length);return nn[e]}function ul(t){const e=t.nextRange(0,on.length);return on[e]}function wl(t){const e=t.nextRange(0,rn.length);return rn[e]}function fl(t){const e=t.nextRange(0,tn.length);return tn[e]}function gl(t){const[e,r]=hl(t),[,o,n,d]=ll(t),h=ul(t),u=wl(t),m=fl(t);return{pubkey:new z("PUBKEY",t.fillBytes(32)),stateVerKey:new z("STATE_VER_KEY",t.fillBytes(32)),stake:t.nextRangeBigInt(0n,1000n)*1000000000000000000n,commission:t.nextRange(0,5e3),name:`${e} Node ${d} ${t.nextRange(0,100)}`,address:t.fillBytes(32),company:{name:e,website:r},location:{coords:[o,n],country:d},operatingSystem:h,networkType:m,nodeType:u}}function*ml(t=new G(It())){const e=t.nextRange(100,350);for(let r=0;r<e;r++)yield gl(new G(r))}const Be=Array.from(ml());async function*pl(){}function vl(){const t=new Uint8Array(new Array(20).map(()=>0)).buffer;return{hash:new z("BLOCK",t),height:0,time:new Date(0),genTime:0,transactions:pl(),numTransactions:0,proposer:[],size:0,fees:[]}}async function*yl(t){let e=1,r=It();const o=$i();for(;r<o;){const n=Math.floor(t.nextFloat()*14*1e3);yield bl(new G(e+n),e,r,r+n),r+=n,e++}}async function*Sl(t=new G(It())){yield vl(),yield*yl(t)}function bl(t,e,r,o){const n=Math.floor(t.nextRange(0,5)),d=t.nextRange(0,Be.length),h=Be[d];return{hash:new z("BLOCK",t.fillBytes(32)),height:e,genTime:o-r,time:new Date(o),numTransactions:n,transactions:Cl(new G(e+r),e,r,o,n),proposer:[h.address],size:Math.floor(t.nextFloat()*1024*n)+8,fees:[P.ESP(BigInt(t.nextRange(0,1e9)*1e3))]}}const cn=Array.from(Bi.keys());function El(t){return t.nextFloat()>.98?1:cn[t.nextRange(0,cn.length)]}async function*Cl(t,e,r,o,n){const d=(o-r)/n;for(let h=0,u=r;u<o;u+=d,h++){const m=El(t),l=Math.floor(1024*t.nextFloat());yield{block:e,index:h,size:l,hash:new z("COMMIT",t.fillBytes(32)),time:new Date(u),sender:new z("PUBKEY",t.fillBytes(32)),tree:{namespace:m,data:t.fillBytes(l)}}}}function Rt(t){if(t.startsWith("0x"))return Rt(t.substring(2));if((t.length&1)!==0)return Rt("0"+t);const e=new ArrayBuffer(t.length/2);return xl(Go(t),e),e}function xl(t,e){const r=new DataView(e);let o=0;for(;o<e.byteLength;){const n=t.next(),d=t.next();if(n.done||d.done)throw new po;const h=an(n.value),u=an(d.value),m=h<<4|u;r.setUint8(o,m),o++}}function an(t){if(t>=48&&t<=57)return t-48;if(t>=97&&t<=102)return t-97+10;if(t>=65&&t<=70)return t-65+10;throw new vo(t)}function Nl(t){return t.toString(16).padStart(2,"0")}function*kl(t){yield*Yo(t,Nl)}function dn(t){return kl(t[Symbol.iterator]())}class Ol{convert(e){if(typeof e!="string")throw new E(typeof e,"string");return Rt(e)}}class Bl{convert(e){return`0x${Array.from(dn(new Uint8Array(e))).join("")}`}}class Dl extends s{encoder=new Bl;decoder=new Ol}const i=new Dl;new L(new U(i),new J(i)),new k(new x(i),new N(i));class Il{encoding;constructor(e){this.encoding=e}convert(e){if(typeof e!="string")throw new E(typeof e,"string");return this.encoding.decodeString(e)}}class Rl{encoding;constructor(e){this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class De extends s{encoder;decoder;constructor(e){super(),this.encoder=new Rl(e),this.decoder=new Il(e)}}new De(Dt),new De(zi),new De(Xo);const At=new De(Qo);new L(new U(At),new J(At));class Al{convert(e){if(sc(e))return e;if(to(e))return BigInt(e);if(!me(e))throw new E(typeof e,"string | bigint | number");return BigInt(e)}}class Ul{convert(e){return $e(e,"bigint"),`0x${e.toString(16)}`}}class Jl extends s{encoder=new Ul;decoder=new Al}const g=new Jl,ln=new L(new U(g),new J(g));new k(new x(g),new N(g)),new k(new x(ln),new N(ln)),BigInt.prototype.toJSON=function(){return g.encode(this)};class hn{constructor(e,r,o){this.number=e,this.hash=r,this.parent=o,Object.freeze(this)}toJSON(){return de.encode(this)}}class Ll{convert(e){return c(e,"number","hash","parent"),new hn(g.decode(e.number),i.decode(e.hash),i.decode(e.parent))}}class Wl{convert(e){return{number:g.encode(e.number),hash:i.encode(e.hash),parent:i.encode(e.parent)}}}class Ml extends s{encoder=new Wl;decoder=new Ll}const de=new Ml,Tl=1000000000n,Pl=12n;class zl{async getBlockForHeight(e){const r=new ArrayBuffer(32);new DataView(r).setBigUint64(24,BigInt(e),!1);const n=new ArrayBuffer(32);return new DataView(n).setBigUint64(24,e-1n,!1),new hn(BigInt(e),r,n)}async getLatestBlock(){const e=BigInt(Math.floor(Ki()/1e3)),o=(BigInt(Math.floor(Date.now()/1e3))-e)/Pl,n=Tl+o;return this.getBlockForHeight(n)}}async function Fl(t){let e;for(let r=await t.next();!r.done;r=await t.next())e=r.value;if(e===void 0)throw new Ce;return e}async function _l(t){return Fl(t[Symbol.asyncIterator]())}new Promise(()=>{});class Ie{constructor(e){this.ratio=e,Object.freeze(this)}valueOf(){return this.ratio}toString(){return this.ratio.toString()}toJSON(){return q.encode(this)}}class jl{convert(e){return p.encode(e.ratio)}}class Vl{convert(e){return new Ie(p.decode(e))}}class Hl extends s{encoder=new jl;decoder=new Vl}const q=new Hl,Re=new L(new U(q),new J(q));class un{constructor(e,r,o){this.address=e,this.voterParticipation=r,this.leaderParticipation=o,this.addressText=i.encode(e),Object.freeze(this)}addressText;toJSON(){return Ut.encode(this)}}class ql{convert(e){return c(e,"address","voter_participation","leader_participation"),new un(i.decode(e.address),Re.decode(e.voter_participation),Re.decode(e.leader_participation))}}class $l{convert(e){return{address:i.encode(e.address),voter_participation:Re.encode(e.voterParticipation),leader_participation:Re.encode(e.leaderParticipation)}}}class Kl extends s{encoder=new $l;decoder=new ql}const Ut=new Kl,Ae=new k(new x(Ut),new N(Ut)),wn=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];function Ue(t){for(let e=0;e<24;++e){const r=t[0]^t[10]^t[20]^t[30]^t[40],o=t[1]^t[11]^t[21]^t[31]^t[41],n=t[2]^t[12]^t[22]^t[32]^t[42],d=t[3]^t[13]^t[23]^t[33]^t[43],h=t[4]^t[14]^t[24]^t[34]^t[44],u=t[5]^t[15]^t[25]^t[35]^t[45],m=t[6]^t[16]^t[26]^t[36]^t[46],l=t[7]^t[17]^t[27]^t[37]^t[47],O=t[8]^t[18]^t[28]^t[38]^t[48],D=t[9]^t[19]^t[29]^t[39]^t[49];let f=O^(n<<1|d>>>31),w=D^(d<<1|n>>>31);const ee=t[0]^f,I=t[1]^w,K=t[10]^f,ge=t[11]^w,is=t[20]^f,ls=t[21]^w,hs=t[30]^f,us=t[31]^w,ws=t[40]^f,fs=t[41]^w;f=r^(h<<1|u>>>31),w=o^(u<<1|h>>>31);const gs=t[2]^f,ms=t[3]^w,ps=t[12]^f,vs=t[13]^w,ys=t[22]^f,Ss=t[23]^w,bs=t[32]^f,Es=t[33]^w,Cs=t[42]^f,xs=t[43]^w;f=n^(m<<1|l>>>31),w=d^(l<<1|m>>>31);const Ns=t[4]^f,ks=t[5]^w,Os=t[14]^f,Bs=t[15]^w,Ds=t[24]^f,Is=t[25]^w,Rs=t[34]^f,As=t[35]^w,Us=t[44]^f,Js=t[45]^w;f=h^(O<<1|D>>>31),w=u^(D<<1|O>>>31);const Ls=t[6]^f,Ws=t[7]^w,Ms=t[16]^f,Ts=t[17]^w,Ps=t[26]^f,zs=t[27]^w,Fs=t[36]^f,_s=t[37]^w,js=t[46]^f,Vs=t[47]^w;f=m^(r<<1|o>>>31),w=l^(o<<1|r>>>31);const Hs=t[8]^f,qs=t[9]^w,$s=t[18]^f,Ks=t[19]^w,Gs=t[28]^f,Qs=t[29]^w,Xs=t[38]^f,Zs=t[39]^w,Ys=t[48]^f,ec=t[49]^w,sr=ee,cr=I,ar=ge<<4|K>>>28,dr=K<<4|ge>>>28,ir=is<<3|ls>>>29,lr=ls<<3|is>>>29,hr=us<<9|hs>>>23,ur=hs<<9|us>>>23,wr=ws<<18|fs>>>14,fr=fs<<18|ws>>>14,gr=gs<<1|ms>>>31,mr=ms<<1|gs>>>31,pr=vs<<12|ps>>>20,vr=ps<<12|vs>>>20,yr=ys<<10|Ss>>>22,Sr=Ss<<10|ys>>>22,br=Es<<13|bs>>>19,Er=bs<<13|Es>>>19,Cr=Cs<<2|xs>>>30,xr=xs<<2|Cs>>>30,Nr=ks<<30|Ns>>>2,kr=Ns<<30|ks>>>2,Or=Os<<6|Bs>>>26,Br=Bs<<6|Os>>>26,Dr=Is<<11|Ds>>>21,Ir=Ds<<11|Is>>>21,Rr=Rs<<15|As>>>17,Ar=As<<15|Rs>>>17,Ur=Js<<29|Us>>>3,Jr=Us<<29|Js>>>3,Lr=Ls<<28|Ws>>>4,Wr=Ws<<28|Ls>>>4,Mr=Ts<<23|Ms>>>9,Tr=Ms<<23|Ts>>>9,Pr=Ps<<25|zs>>>7,zr=zs<<25|Ps>>>7,Fr=Fs<<21|_s>>>11,_r=_s<<21|Fs>>>11,jr=Vs<<24|js>>>8,Vr=js<<24|Vs>>>8,Hr=Hs<<27|qs>>>5,qr=qs<<27|Hs>>>5,$r=$s<<20|Ks>>>12,Kr=Ks<<20|$s>>>12,Gr=Qs<<7|Gs>>>25,Qr=Gs<<7|Qs>>>25,Xr=Xs<<8|Zs>>>24,Zr=Zs<<8|Xs>>>24,Yr=Ys<<14|ec>>>18,eo=ec<<14|Ys>>>18;t[0]=sr^~pr&Dr,t[1]=cr^~vr&Ir,t[10]=Lr^~$r&ir,t[11]=Wr^~Kr&lr,t[20]=gr^~Or&Pr,t[21]=mr^~Br&zr,t[30]=Hr^~ar&yr,t[31]=qr^~dr&Sr,t[40]=Nr^~Mr&Gr,t[41]=kr^~Tr&Qr,t[2]=pr^~Dr&Fr,t[3]=vr^~Ir&_r,t[12]=$r^~ir&br,t[13]=Kr^~lr&Er,t[22]=Or^~Pr&Xr,t[23]=Br^~zr&Zr,t[32]=ar^~yr&Rr,t[33]=dr^~Sr&Ar,t[42]=Mr^~Gr&hr,t[43]=Tr^~Qr&ur,t[4]=Dr^~Fr&Yr,t[5]=Ir^~_r&eo,t[14]=ir^~br&Ur,t[15]=lr^~Er&Jr,t[24]=Pr^~Xr&wr,t[25]=zr^~Zr&fr,t[34]=yr^~Rr&jr,t[35]=Sr^~Ar&Vr,t[44]=Gr^~hr&Cr,t[45]=Qr^~ur&xr,t[6]=Fr^~Yr&sr,t[7]=_r^~eo&cr,t[16]=br^~Ur&Lr,t[17]=Er^~Jr&Wr,t[26]=Xr^~wr&gr,t[27]=Zr^~fr&mr,t[36]=Rr^~jr&Hr,t[37]=Ar^~Vr&qr,t[46]=hr^~Cr&Nr,t[47]=ur^~xr&kr,t[8]=Yr^~sr&pr,t[9]=eo^~cr&vr,t[18]=Ur^~Lr&$r,t[19]=Jr^~Wr&Kr,t[28]=wr^~gr&Or,t[29]=fr^~mr&Br,t[38]=jr^~Hr&ar,t[39]=Vr^~qr&dr,t[48]=Cr^~Nr&Mr,t[49]=xr^~kr&Tr,t[0]^=wn[e*2],t[1]^=wn[e*2+1]}}class Gl{state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];blockSize=0;count=0;squeezing=!1;initialize(e,r){for(let o=0;o<50;++o)this.state[o]=0;this.blockSize=e/8,this.count=0,this.squeezing=!1}absorb(e){for(let r=0;r<e.length;++r)this.state[~~(this.count/4)]^=e[r]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(Ue(this.state),this.count=0)}absorbLastFewBits(e){this.state[~~(this.count/4)]^=e<<8*(this.count%4),(e&128)!==0&&this.count===this.blockSize-1&&Ue(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),Ue(this.state),this.count=0,this.squeezing=!0}squeeze(e){this.squeezing||this.absorbLastFewBits(1);const r=new Uint8Array(e);for(let o=0;o<e;++o)r[o]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(Ue(this.state),this.count=0);return r}copy(e){for(let r=0;r<50;++r)e.state[r]=this.state[r];e.blockSize=this.blockSize,e.count=this.count,e.squeezing=this.squeezing}}class H{_rate;_capacity;_delimitedSuffix;_hashBitLength;_state;_finalized;constructor(e,r,o,n){this._rate=e,this._capacity=r,this._delimitedSuffix=o,this._hashBitLength=n,this._state=new Gl,this._state.initialize(e,r),this._finalized=!1}update(e){if(this._finalized)throw new Error("Digest already called");return this._state.absorb(new Uint8Array(e)),this}digest(){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);const e=this._state.squeeze(this._hashBitLength/8);return this._resetState(),Bt.encode(e)}_resetState(){return this._state.initialize(this._rate,this._capacity),this}}function Ql(t){switch(t.toLowerCase()){case"keccak224":return new H(1152,448,null,224);case"keccak256":return new H(1088,512,null,256);case"keccak384":return new H(832,768,null,384);case"keccak512":return new H(576,1024,null,512);case"sha3-224":return new H(1152,448,6,224);case"sha3-256":return new H(1088,512,6,256);case"sha3-384":return new H(832,768,6,384);case"sha3-512":return new H(576,1024,6,512);default:throw new Error("invalid algorithm: "+t)}}const Xl=48,Zl=57,Yl=97,eh=102;class th{convert(e){if(C(e,ArrayBuffer),e.byteLength!==20)throw new E(typeof e,"20-byte ArrayBuffer");const o=[...rl(dn(new Uint8Array(e)),m=>m.split(""))],n=Ql("keccak256"),d=new TextEncoder;n.update(Bt.encode(d.encode(o.join(""))));const h=new Uint8Array(n.digest());return["0x",...Oe(en(nl(e.byteLength*2),o,(m,l)=>[m,l]),([m,l])=>{const O=l.charCodeAt(0);if(O>=Xl&&O<=Zl)return l;if(O>=Yl&&O<=eh){const D=Math.floor(m/2),f=m&1,w=h[D];return(f===0?w>>4:w&15)>7?l.toUpperCase():l}throw new A})].join("")}}const rh=new th;class oh{keyCodec;valueCodec;constructor(e,r){this.keyCodec=e,this.valueCodec=r}convert(e){if(typeof e!="object"||e===null)throw new Error(`invalid map value: expected an object, got ${typeof e}`);const r=new Map;for(const[o,n]of Object.entries(e)){const d=this.keyCodec.decode(o),h=this.valueCodec.decode(n);r.set(d,h)}return r}}class nh{keyCodec;valueCodec;constructor(e,r){this.keyCodec=e,this.valueCodec=r}convert(e){C(e,Map);const r={};for(const[o,n]of e.entries()){const d=this.keyCodec.encode(o),h=this.valueCodec.encode(n);r[d]=h}return r}}class Jt extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}static keyStringCodec(e){return new Jt(new oh(a,e),new nh(a,e))}}class sh{convert(e){if(!me(e))throw new E(typeof e,"string");return new URL(e)}}class ch{convert(e){return e.toString()}}class ah extends s{encoder=new ch;decoder=new sh}const fn=new ah;new L(new U(fn),new J(fn));class gn{constructor(e,r,o){this.epoch=e,this.block=r,this.timestamp=o,Object.freeze(this)}toJSON(){return ie.encode(this)}}class dh{convert(e){return c(e,"epoch","block","timestamp"),new gn(g.decode(e.epoch),g.decode(e.block),new Date(p.decode(e.timestamp)))}}class ih{convert(e){return{epoch:g.encode(e.epoch),block:g.encode(e.block),timestamp:p.encode(e.timestamp.getTime())}}}class lh extends s{encoder=new ih;decoder=new dh}const ie=new lh;class mn{constructor(e,r){this.espressoBlock=e,this.nodes=r,Object.freeze(this)}toJSON(){return Je.encode(this)}}class hh{convert(e){return c(e,"espresso_block","nodes"),new mn(ie.decode(e.espresso_block),Ae.decode(e.nodes))}}class uh{convert(e){return{espresso_block:ie.encode(e.espressoBlock),nodes:Ae.encode(e.nodes)}}}class wh extends s{encoder=new uh;decoder=new hh}const Je=new wh;class fh{async active(){const e=await _l(Sl()),r=Be.slice().sort((n,d)=>Number(d.stake-n.stake)).slice(0,100),o=new G(e.genTime);return new mn(new gn(BigInt(Math.floor(e.height/100)),BigInt(e.height),new Date(e.time)),Array.from(Oe(r,n=>new un(n.address,new Ie(o.nextFloat()),new Ie(o.nextFloat())))))}async activeFor(){return this.active()}async updatesSince(){throw new A}}class Le{constructor(e,r,o){this.number=e,this.hash=r,this.timestamp=o,Object.freeze(this)}toJSON(){return _.encode(this)}}class gh{convert(e){return c(e,"number","hash","timestamp"),new Le(g.decode(e.number),i.decode(e.hash),new Date(p.decode(e.timestamp)))}}class mh{convert(e){return{number:g.encode(e.number),hash:i.encode(e.hash),timestamp:p.encode(e.timestamp.valueOf())}}}class ph extends s{encoder=new mh;decoder=new gh}const _=new ph,Lt=1e4,pn=0,vh="PercentageOutOfRange";class yh extends y{value;constructor(e,r=`the commission percentage is outside of the range [${pn}, ${Lt}], have ${e}`){super(r),this.value=e,Object.freeze(this)}get code(){return vh}}class vn{value;constructor(e){if(e<pn||e>Lt)throw new yh(e);this.value=e}toString(){return`${this.value/100}%`}toJSON(){return this.value}valueOf(){return this.value/Lt}}class Sh{convert(e){if(typeof e!="number")throw new E(typeof e,"number");return new vn(e)}}class bh{convert(e){if(!(e instanceof vn))throw new E(e,"CommissionPercent");return Math.floor(e.value)}}class Eh extends s{encoder=new bh;decoder=new Sh}const yn=new Eh;class Sn{stakeKey;stakeAmount;constructor(e,r){this.stakeKey=e,this.stakeAmount=r}}class Ch{convert(e){return c(e,"stake_key","stake_amount"),new Sn(W.decode(e.stake_key),g.decode(e.stake_amount))}}class xh{convert(e){return C(e,Sn),{stake_key:W.encode(e.stakeKey),stake_amount:g.encode(e.stakeAmount)}}}class Nh extends s{encoder=new xh;decoder=new Ch}const Q=new Nh;new L(new U(Q),new J(Q)),new k(new x(Q),new N(Q));class bn{stakeTableEntry;stateVerKey;constructor(e,r){this.stakeTableEntry=e,this.stateVerKey=r}}class kh{convert(e){return c(e,"stake_table_entry","state_ver_key"),new bn(Q.decode(e.stake_table_entry),W.decode(e.state_ver_key))}}class Oh{convert(e){return C(e,bn),{stake_table_entry:Q.encode(e.stakeTableEntry),state_ver_key:W.encode(e.stateVerKey)}}}class Bh extends s{encoder=new Oh;decoder=new kh}const We=new Bh;new L(new U(We),new J(We)),new k(new x(We),new N(We));class Dh{address;constructor(e){this.address=e,Object.freeze(this)}toJSON(){return X.encode(this)}toString(){return X.encode(this)}}class Ih{convert(e){return e.address.byteLength!==20?i.encode(e.address):rh.convert(e.address)}}class Rh{convert(e){return new Dh(i.decode(e))}}class Ah extends s{encoder=new Ih;decoder=new Rh}const X=new Ah;new L(new U(X),new J(X));const En=Jt.keyStringCodec(g);class Cn{account;stakeTableKey;stateVerKey;stake;commission;delegators;constructor(e,r,o,n,d,h){this.account=e,this.stakeTableKey=r,this.stateVerKey=o,this.stake=n,this.commission=d,this.delegators=h}}class Uh{convert(e){return c(e,"account","stake_table_key","state_ver_key","stake","commission","delegators"),new Cn(X.decode(e.account),W.decode(e.stake_table_key),W.decode(e.state_ver_key),g.decode(e.stake),yn.decode(e.commission),En.decode(e.delegators))}}class Jh{convert(e){return C(e,Cn),{account:X.encode(e.account),stake_table_key:W.encode(e.stakeTableKey),state_ver_key:W.encode(e.stateVerKey),stake:g.encode(e.stake),commission:yn.encode(e.commission),delegators:En.encode(e.delegators)}}}class Lh extends s{encoder=new Jh;decoder=new Uh}const Me=new Lh;new L(new U(Me),new J(Me)),new k(new x(Me),new N(Me));class xn{constructor(e,r,o,n){this.address=e,this.stakingKey=r,this.stake=o,this.commission=n,this.addressText=i.encode(e),Object.freeze(this)}addressText;toJSON(){return le.encode(this)}}class Wh{convert(e){return c(e,"address","staking_key","stake","commission"),new xn(i.decode(e.address),W.decode(e.staking_key),g.decode(e.stake),q.decode(e.commission))}}class Mh{convert(e){return{address:i.encode(e.address),staking_key:W.encode(e.stakingKey),stake:g.encode(e.stake),commission:q.encode(e.commission)}}}class Th extends s{encoder=new Mh;decoder=new Wh}const le=new Th,Nn=new k(new x(le),new N(le));class kn{constructor(e,r=[]){this.l1Block=e,this.nodes=r,Object.freeze(this)}toJSON(){return Wt.encode(this)}}class Ph{convert(e){return c(e,"l1_block","nodes"),new kn(_.decode(e.l1_block),Nn.decode(e.nodes))}}class zh{convert(e){return{l1_block:_.encode(e.l1Block),nodes:Nn.encode(e.nodes)}}}class Fh extends s{encoder=new zh;decoder=new Ph}const Wt=new Fh;class _h{async snapshot(){return new kn(new Le(BigInt(1),new ArrayBuffer(32),new Date),Array.from(Oe(Be,e=>new xn(e.address,e.stateVerKey,e.stake,new Ie(e.commission/1e4)))))}async updatesSince(){throw new A}}class jh{constructor(e,r,o){this.delegator=e,this.node=r,this.amount=o,this.delegatorText=i.encode(e),this.nodeText=i.encode(r),Object.freeze(this)}delegatorText;nodeText;toJSON(){return he.encode(this)}}class Vh{convert(e){return{delegator:i.encode(e.delegator),node:i.encode(e.node),amount:g.encode(e.amount)}}}class Hh{convert(e){return c(e,"delegator","node","amount"),new jh(i.decode(e.delegator),i.decode(e.node),g.decode(e.amount))}}class qh extends s{encoder=new Vh;decoder=new Hh}const he=new qh,On=new k(new x(he),new N(he));class $h{constructor(e,r,o,n){this.delegator=e,this.node=r,this.amount=o,this.availableTime=n,this.nodeText=i.encode(r),Object.freeze(this)}nodeText;toJSON(){return $.encode(this)}}class Kh{convert(e){return{delegator:i.encode(e.delegator),node:i.encode(e.node),amount:g.encode(e.amount),available_time:p.encode(e.availableTime.valueOf())}}}class Gh{convert(e){return c(e,"delegator","node","amount","available_time"),new $h(i.decode(e.delegator),i.decode(e.node),g.decode(e.amount),new Date(p.decode(e.available_time)))}}class Qh extends s{encoder=new Kh;decoder=new Gh}const $=new Qh,Te=new k(new x($),new N($));class Bn{constructor(e,r,o,n,d){this.nodes=e,this.pendingUndelegations=r,this.pendingExits=o,this.claimedRewards=n,this.l1Block=d,Object.freeze(this)}toJSON(){return Mt.encode(this)}}class Xh{convert(e){return c(e,"nodes","pending_undelegations","pending_exits","claimed_rewards","l1_block"),new Bn(On.decode(e.nodes),Te.decode(e.pending_undelegations),Te.decode(e.pending_exits),g.decode(e.claimed_rewards),_.decode(e.l1_block))}}class Zh{convert(e){return{nodes:On.encode(e.nodes),pending_undelegations:Te.encode(e.pendingUndelegations),pending_exits:Te.encode(e.pendingExits),claimed_rewards:g.encode(e.claimedRewards),l1_block:_.encode(e.l1Block)}}}class Yh extends s{encoder=new Zh;decoder=new Xh}const Mt=new Yh;class Z{}class Dn extends Z{constructor(e){super(),this.claimedRewards=e,Object.freeze(this)}toJSON(){return Tt.encode(this)}}class eu{convert(e){return new Dn(g.decode(e))}}class tu{convert(e){return g.encode(e.claimedRewards)}}class ru extends s{encoder=new tu;decoder=new eu}const Pe="ClaimedRewards",Tt=new ru;class In extends Z{constructor(e){super(),this.delegation=e,Object.freeze(this)}toJSON(){return Pt.encode(this)}}class ou{convert(e){return new In(he.decode(e))}}class nu{convert(e){return he.encode(e.delegation)}}class su extends s{encoder=new nu;decoder=new ou}const ze="DelegatedToNode",Pt=new su;class cu{constructor(e,r,o){this.delegator=e,this.node=r,this.amount=o,Object.freeze(this)}toJSON(){return ue.encode(this)}}class au{convert(e){return{delegator:i.encode(e.delegator),node:i.encode(e.node),amount:g.encode(e.amount)}}}class du{convert(e){return c(e,"delegator","node","amount"),new cu(i.decode(e.delegator),i.decode(e.node),g.decode(e.amount))}}class iu extends s{encoder=new au;decoder=new du}const ue=new iu;class Rn extends Z{constructor(e){super(),this.withdrawal=e,Object.freeze(this)}toJSON(){return zt.encode(this)}}class lu{convert(e){return new Rn(ue.decode(e))}}class hu{convert(e){return ue.encode(e.withdrawal)}}class uu extends s{encoder=new hu;decoder=new lu}const Fe="NodeExitWithdrawal",zt=new uu;class An extends Z{constructor(e){super(),this.pendingWithdrawal=e,Object.freeze(this)}toJSON(){return Ft.encode(this)}}class wu{convert(e){return new An($.decode(e))}}class fu{convert(e){return $.encode(e.pendingWithdrawal)}}class gu extends s{encoder=new fu;decoder=new wu}const _e="NodeExited",Ft=new gu;class Un extends Z{constructor(e){super(),this.pendingWithdrawal=e,Object.freeze(this)}toJSON(){return _t.encode(this)}}class mu{convert(e){return new Un($.decode(e))}}class pu{convert(e){return $.encode(e.pendingWithdrawal)}}class vu extends s{encoder=new pu;decoder=new mu}const je="UndelegatedFromNode",_t=new vu;class Jn extends Z{constructor(e){super(),this.withdrawal=e,Object.freeze(this)}toJSON(){return jt.encode(this)}}class yu{convert(e){return new Jn(ue.decode(e))}}class Su{convert(e){return ue.encode(e.withdrawal)}}class bu extends s{encoder=new Su;decoder=new yu}const Ve="UndelegationWithdrawal",jt=new bu;class Eu{convert(e){if(c(e),M(e,Pe))return Tt.decode(e[Pe]);if(M(e,ze))return Pt.decode(e[ze]);if(M(e,Fe))return zt.decode(e[Fe]);if(M(e,_e))return Ft.decode(e[_e]);if(M(e,je))return _t.decode(e[je]);if(M(e,Ve))return jt.decode(e[Ve]);const r=Object.keys(e);if(r.length<=0)throw new E("Empty WalletDiff object","object");const[o]=r;throw new E(o,`${Pe} | ${ze} | ${Fe} | ${_e} | ${je} | ${Ve}`)}}class Cu{convert(e){if(e instanceof Dn)return{[Pe]:Tt.encode(e)};if(e instanceof In)return{[ze]:Pt.encode(e)};if(e instanceof Rn)return{[Fe]:zt.encode(e)};if(e instanceof An)return{[_e]:Ft.encode(e)};if(e instanceof Un)return{[je]:_t.encode(e)};if(e instanceof Jn)return{[Ve]:jt.encode(e)};throw new E("Unrecognized EspressoMessage type","Valid EspressoMessage Type")}}class xu extends s{encoder=new Cu;decoder=new Eu}const Ln=new xu,Wn=new k(new x(Ln),new N(Ln));class Mn{constructor(e,r){this.l1Block=e,this.diff=r,Object.freeze(this)}toJSON(){return Vt.encode(this)}}class Nu{convert(e){return c(e,"l1_block","diff"),new Mn(_.decode(e.l1_block),Wn.decode(e.diff))}}class ku{convert(e){return{l1_block:_.encode(e.l1Block),diff:Wn.encode(e.diff)}}}class Ou extends s{encoder=new ku;decoder=new Nu}const Vt=new Ou;class Bu{async snapshot(){return new Bn([],[],[],0n,new Le(0n,new ArrayBuffer(0),new Date(0)))}async updates(){return new Mn(new Le(0n,new ArrayBuffer(0),new Date(0)),[])}}class Du{l1Block=new zl;validatorsAll=new _h;validatorsActive=new fh;wallet=new Bu;async setURL(){throw new A}}function j(t,e){return async r=>(await Iu(r,e),Ht(r),t.convert(await r.json()))}async function Iu(t,e){if(!t.ok){if(t.status>=500&&t.status<600){try{Ht(t)}catch(r){if(r instanceof y)throw r;console.error("encountered an error attempting to decode a server error from the server",r)}throw new ho(t.status,t)}if(t.status>=400&&t.status<500){try{Ht(t)}catch(r){if(r instanceof y)throw r;console.error("encountered an error attempting to decode a client error from the server",r)}throw new co(t.status,t)}throw new io(t.status,t)}}function Ht(t){const e=t.headers.get("content-type");if(!e||!e.startsWith("application/json"))throw ne.fromResponse(t,e||"undefined")}class Ru{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async getBlockForHeight(e){const r=new URL(`./${e}`,this.baseURL);return this.fetcher(r).then(j(de.decoder))}async getLatestBlock(){const e=new URL("latest",this.baseURL);return this.fetcher(e).then(j(de.decoder))}}class Tn{width;index;constructor(e,r){this.width=e,this.index=r}toJSON(){return qt.encode(this)}}class Au{convert(e){return c(e,"width","index"),new Tn(p.decode(e.width),p.decode(e.index))}}class Uu{convert(e){return C(e,Tn),{width:p.encode(e.width),index:p.encode(e.index)}}}class Ju extends s{encoder=new Uu;decoder=new Au}const qt=new Ju;class we{static get lsb0(){return Wu}static get msb0(){return Tu}valueOf(){return this.toString()}toJSON(){return this.toString()}}const Pn="bitvec::order::Lsb0",zn="bitvec::order::Msb0";class Lu extends we{toString(){return Pn}}const Wu=new Lu;class Mu extends we{toString(){return zn}}const Tu=new Mu;class Pu{convert(e){if(typeof e!="string")throw new E(typeof e,"string");switch(e){case Pn:return we.lsb0;case zn:return we.msb0;default:throw new E(e,"CappuccinoAPIBitVecOrder")}}}class zu{convert(e){return e.toString()}}class Fu extends s{encoder=new zu;decoder=new Pu}const Fn=new Fu;class _n{order;head;bits;data;constructor(e,r,o,n){this.order=e,this.head=r,this.bits=o,this.data=n}getBitVecIndexIterable(){return this.order===we.lsb0?new $u(this.head.width,this.bits):new Gu(this.head.width,this.bits)}[Symbol.iterator](){const e=this.getBitVecIndexIterable();return Oe(e,r=>Hu(this.data,r))[Symbol.iterator]()}toJSON(){return fe.encode(this)}}class _u{convert(e){return c(e,"order","head","bits","data"),new _n(Fn.decode(e.order),qt.decode(e.head),p.decode(e.bits),go.decode(e.data))}}class ju{convert(e){return C(e,_n),{order:Fn.encode(e.order),head:qt.encode(e.head),bits:p.encode(e.bits),data:go.encode(e.data)}}}class Vu extends s{encoder=new ju;decoder=new _u}const fe=new Vu;new k(new x(fe),new N(fe));function Hu(t,e){return(t[e.bucket]>>e.bitOffset&1)===1}class jn{bucket;bitOffset;constructor(e,r){this.bucket=e,this.bitOffset=r}}function Vn(t){switch(B(t===8||t===16||t===32,"bit width should be a power of two that is supported"),t){case 8:return 3;case 16:return 4;case 32:return 5;default:throw new A}}class qu{totalBits;bitWidthMask;bitWidthShift;offset=0;constructor(e,r){this.totalBits=r;const o=Vn(e);this.bitWidthMask=e-1,this.bitWidthShift=o}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,r=this.offset&this.bitWidthMask;return this.offset+=1,{done:!1,value:new jn(e,r)}}}class $u{bitWidth;totalBits;constructor(e,r){this.bitWidth=e,this.totalBits=r}[Symbol.iterator](){return new qu(this.bitWidth,this.totalBits)}}class Ku{bitWidth;totalBits;bitWidthMask;bitWidthShift;offset=0;constructor(e,r){this.bitWidth=e,this.totalBits=r;const o=Vn(e);this.bitWidthMask=e-1,this.bitWidthShift=o}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,r=this.bitWidth-1-(this.offset&this.bitWidthMask);return this.offset+=1,{done:!1,value:new jn(e,r)}}}class Gu{bitWidth;totalBits;constructor(e,r){this.bitWidth=e,this.totalBits=r}[Symbol.iterator](){return new Ku(this.bitWidth,this.totalBits)}}class Qu{constructor(e,r){this.node=e,this.ratio=r,Object.freeze(this)}toJSON(){return $t.encode(this)}}class Xu{convert(e){return c(e,"node","percentage"),new Qu(p.decode(e.node),q.decode(e.percentage))}}class Zu{convert(e){return{node:p.encode(e.node),percentage:q.encode(e.ratio)}}}class Yu extends s{encoder=new Zu;decoder=new Xu}const $t=new Yu,Hn=new k(new x($t),new N($t));class qn{}class $n extends qn{constructor(e,r){super(),this.leaders=e,this.voters=r,Object.freeze(this)}toJSON(){return Kt.encode(this)}}class ew{convert(e){return c(e,"leaders","voters"),new $n(Hn.decode(e.leaders),fe.decode(e.voters))}}class tw{convert(e){return{leaders:Hn.encode(e.leaders),voters:fe.encode(e.voters)}}}class rw extends s{encoder=new tw;decoder=new ew}const He="NewBlock",Kt=new rw;class Kn extends qn{constructor(e){super(),this.entries=e,Object.freeze(this)}toJSON(){return Gt.encode(this)}}class ow{convert(e){return new Kn(Ae.decode(e))}}class nw{convert(e){return Ae.encode(e.entries)}}class sw extends s{encoder=new nw;decoder=new ow}const qe="NewEpoch",Gt=new sw;class cw{convert(e){if(c(e),M(e,qe))return Gt.decode(e[qe]);if(M(e,He))return Kt.decode(e[He]);const r=Object.keys(e);if(r.length<=0)throw new E("Empty EspressoMessage object","object");const[o]=r;throw new E(o,`${qe} | ${He}`)}}class aw{convert(e){if(e instanceof Kn)return{[qe]:Gt.encode(e)};if(e instanceof $n)return{[He]:Kt.encode(e)};throw new E("Unrecognized EspressoMessage type","Valid EspressoMessage Type")}}class dw extends s{encoder=new aw;decoder=new cw}const Gn=new dw,Qn=new k(new x(Gn),new N(Gn));class iw{constructor(e,r){this.espressoBlock=e,this.diff=r,Object.freeze(this)}toJSON(){return Qt.encode(this)}}class lw{convert(e){return c(e,"espresso_block","diff"),new iw(ie.decode(e.espresso_block),Qn.decode(e.diff))}}class hw{convert(e){return{espresso_block:ie.encode(e.espressoBlock),diff:Qn.encode(e.diff)}}}class uw extends s{encoder=new hw;decoder=new lw}const Qt=new uw;class ww{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async active(){return this.fetcher(this.baseURL).then(j(Je.decoder))}async activeFor(e){const r=new URL(`active/${e}`,this.baseURL);return this.fetcher(r).then(j(Je.decoder))}async updatesSince(e){const r=new URL(`active/updates/${e}`,this.baseURL);return this.fetcher(r).then(j(Qt.decoder))}}class fw{constructor(e,r){this.address=e,this.exitTime=r,Object.freeze(this)}toJSON(){return Xt.encode(this)}}class gw{convert(e){return c(e,"address","exit_time"),new fw(i.decode(e.address),new Date(e.exit_time))}}class mw{convert(e){return{address:i.encode(e.address),exit_time:e.exitTime.toISOString()}}}class pw extends s{encoder=new mw;decoder=new gw}const Xt=new pw;class Xn{}class Zn extends Xn{constructor(e){super(),this.validatorExit=e,Object.freeze(this)}toJSON(){return Yt.encode(this)}}class vw{convert(e){return c(e,"validator_exit"),new Zn(Xt.decode(e.validator_exit))}}class yw{convert(e){return{validator_exit:Xt.encode(e.validatorExit)}}}class Sw extends s{encoder=new yw;decoder=new vw}const Zt="NodeExit",Yt=new Sw;class Yn extends Xn{constructor(e){super(),this.validatorInformation=e,Object.freeze(this)}toJSON(){return tr.encode(this)}}class bw{convert(e){return new Yn(le.decode(e))}}class Ew{convert(e){return le.encode(e.validatorInformation)}}class Cw extends s{encoder=new Ew;decoder=new bw}const er="NodeUpdate",tr=new Cw;class xw{convert(e){if(c(e),M(e,er))return tr.decode(e[er]);if(M(e,Zt))return Yt.decode(e[Zt]);throw Object.keys(e).length<=0?new E("Empty L1Message object","object"):new E("Unrecognized L1Message type","Valid L1 Type")}}class Nw{convert(e){if(e instanceof Yn)return{[er]:tr.encode(e)};if(e instanceof Zn)return{[Zt]:Yt.encode(e)};throw new E("Unrecognized L1Message type","Valid L1 Type")}}class kw extends s{encoder=new Nw;decoder=new xw}const es=new kw,ts=new k(new x(es),new N(es));class Ow{constructor(e,r=[]){this.l1Block=e,this.diff=r,Object.freeze(this)}toJSON(){return rr.encode(this)}}class Bw{convert(e){return c(e,"l1_block","diff"),new Ow(_.decode(e.l1_block),ts.decode(e.diff))}}class Dw{convert(e){return{l1_block:_.encode(e.l1Block),diff:ts.encode(e.diff)}}}class Iw extends s{encoder=new Dw;decoder=new Bw}const rr=new Iw;class Rw{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async snapshot(e){const r=i.encode(e),o=new URL(`./${r}`,this.baseURL);return this.fetcher(o).then(j(Wt.decoder))}async updatesSince(e){const r=new URL(`updates/${i.encode(e)}`,this.baseURL);return this.fetcher(r).then(j(rr.decoder))}}class Aw{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async snapshot(e,r){const o=new URL(`./${i.encode(e)}/${i.encode(r)}`,this.baseURL);return this.fetcher(o).then(j(Mt.decoder))}async updates(e,r){const o=new URL(`./${i.encode(e)}/updates/${i.encode(r)}`,this.baseURL);return this.fetcher(o).then(j(Vt.decoder))}}class rs{l1Block;validatorsAll;validatorsActive;wallet;constructor(e,r){this.l1Block=new Ru(e,new URL("l1/block/",r)),this.validatorsAll=new Rw(e,new URL("nodes/all/",r)),this.validatorsActive=new ww(e,new URL("nodes/active",r)),this.wallet=new Aw(e,new URL("wallet/",r))}async setURL(){throw new A}}class Uw{service;constructor(e){this.service=e}async getBlockForHeight(e){return this.service.getBlockForHeight(e)}async getLatestBlock(){return this.service.getLatestBlock()}async handleRequest(e){switch(e.method){case"getBlockForHeight":return de.encode(await this.getBlockForHeight(g.decode(e.param[0])));case"getLatestBlock":return de.encode(await this.getLatestBlock());default:throw new A}}}class Jw{service;constructor(e){this.service=e}async active(){return this.service.active()}async activeFor(e){return this.service.activeFor(e)}async updatesSince(e){return this.service.updatesSince(e)}async handleRequest(e){switch(e.method){case"active":return Je.encode(await this.active());case"updatesSince":return Qt.encode(await this.updatesSince(g.decode(e.param[0])))}}}class Lw{service;constructor(e){this.service=e}async snapshot(e){return this.service.snapshot(e)}async updatesSince(e){return this.service.updatesSince(e)}async handleRequest(e){switch(e.method){case"snapshot":{const r=i.decode(e.param[0]);return Wt.encode(await this.snapshot(r))}case"updatesSince":return rr.encode(await this.updatesSince(At.decode(e.param[0])))}}}class Ww{constructor(e){this.service=e}async snapshot(e,r){return this.service.snapshot(e,r)}async updates(e,r){return this.service.updates(e,r)}async handleRequest(e){switch(e.method){case"snapshot":return Mt.encode(await this.snapshot(i.decode(e.param[0]),i.decode(e.param[1])));case"updates":return Vt.encode(await this.updates(i.decode(e.param[0]),i.decode(e.param[1])))}}}class os{l1Block;validatorsActive;validatorsAll;wallet;constructor(e){this.l1Block=new Uw(e.l1Block),this.validatorsActive=new Jw(e.validatorsActive),this.validatorsAll=new Lw(e.validatorsAll),this.wallet=new Ww(e.wallet)}async handleRequest(e){switch(e.api){case"l1Block":return this.l1Block.handleRequest(e);case"validatorsActive":return this.validatorsActive.handleRequest(e);case"validatorsAll":return this.validatorsAll.handleRequest(e);case"wallet":return this.wallet.handleRequest(e);default:throw new A}}}const Y=p;class ns{requestID;api;method;param;constructor(e,r,o,n){this.requestID=e,this.api=r,this.method=o,this.param=n}toJSON(){return{requestID:this.requestID,api:this.api,method:this.method,param:this.param}}}class Mw{convert(e){return c(e,"requestID","api","method","param"),new ns(Y.decode(e.requestID),a.decode(e.api),a.decode(e.method),e.param)}}class Tw{convert(e){return C(e,ns),{requestID:Y.encode(e.requestID),api:a.encode(e.api),method:a.encode(e.method),param:e.param}}}class Pw extends s{encoder=new Tw;decoder=new Mw}const zw=new Pw;class ss{requestID;constructor(e){this.requestID=e}}class or extends ss{response;constructor(e,r){super(e),this.response=r}toJSON(){return cs.encode(this)}}class Fw{convert(e){return c(e,"requestID","response"),new or(Y.decode(e.requestID),e.response)}}class _w{convert(e){return C(e,or),{requestID:Y.encode(e.requestID),response:e.response}}}class jw extends s{encoder=new _w;decoder=new Fw}const cs=new jw;class nr extends ss{error;constructor(e,r){super(e),this.error=r}toJSON(){return as.encode(this)}}class Vw{convert(e){return c(e,"requestID","error"),new nr(Y.decode(e.requestID),ve.decode(e.error))}}class Hw{convert(e){return C(e,nr),{requestID:Y.encode(e.requestID),error:ve.encode(e.error)}}}class qw extends s{encoder=new Hw;decoder=new Vw}const as=new qw,ds=async(t,e)=>{try{return await fetch(t,e)}catch(r){throw new uo(r)}};async function $w(){try{const e=await(await fetch("/config.json")).json();if(e.l1_validators_service_url){const r=new URL(e.l1_validators_service_url);return new rs(ds,r)}}catch{}return new Du}async function Kw(){return new os(await $w())}class Gw{service;postMessage;requestChannel;constructor(e){this.postMessage=e,this.service=Kw(),this.requestChannel=xd(10),this.processRequests()}async handleProxyRequest(e){if(e.method==="set-url"){const r=e.param[0];if(!r||typeof r!="string")throw new A("Invalid URL provided");return this.service=Promise.resolve(new os(new rs(ds,new URL(r)))),!0}else throw new A(`Unknown proxy method: ${e.method}`)}async processRequests(){for await(const e of this.requestChannel)try{const r=await this.service;let o;e.api==="proxy"?o=await this.handleProxyRequest(e):o=await r.handleRequest(e),this.postMessage(cs.encode(new or(e.requestID,o)))}catch(r){this.postMessage(as.encode(new nr(e.requestID,r)))}}async handleEvent(e){const r=zw.decode(e.data);await this.requestChannel.publish(r)}}self.addEventListener("message",new Gw(self.postMessage.bind(self)))})();
