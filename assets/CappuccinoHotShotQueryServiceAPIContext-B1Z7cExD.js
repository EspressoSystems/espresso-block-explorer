var Fr=Object.defineProperty;var Hr=(r,e,t)=>e in r?Fr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var s=(r,e,t)=>Hr(r,typeof e!="symbol"?e+"":e,t);import{j as Nr}from"./jsx-runtime-BlAj40OV.js";import{n as a,b as lr}from"./base64-B9OJSIzr.js";import{c as G,b as P,d as ur,e as Y,n as pr,l as hr,f as mr,g as V,h as fr,r as wr,i as Cr,W as Jr,j as Mr,N as sr,k as Qr,m as or,o as he,p as zr,q as jr,s as $r,t as Kr,u as Yr,v as Vr,w as yr,x as gr,y as x,z as Xr,A as Zr,C as et,a as Rr,B as rt,D as tt,E as st,F as ot,R as ct}from"./CircularBuffer-Dxw-FMcc.js";import{C as g,g as l,s as _,a as u,T as f,p as kr,t as v,v as E,w as nt,I as Sr,m as at,l as it}from"./string-BRHtp8nH.js";import{I as W}from"./monetary_value-BoyvFl18.js";import{t as m,T as y}from"./TaggedBase64-kwVVsu1o.js";import{h as vr}from"./array_buffer-R2gdYDdl.js";import{f as z,d as A,g as C,a as dt,b as Q,t as D,c as I,e as T,h as Er,r as me,i as B,j as xr,m as b,k as O,l as lt,o as ae,p as ut,U as pe,q as cr,s as ie,v as de,w as pt,x as ht,y as le,z as mt}from"./functional_async-y9fAbhVo.js";import{N as ft}from"./NotFoundError-CI-iUI-y.js";import{R as wt}from"./index-Cs7sjTYM.js";class br{constructor(e){s(this,"query");this.query=e}toJSON(){return Tr.encode(this)}}class Ct{convert(e){return l(e,br),_.encode(e.query)}}class yt{convert(e){return new br(_.decode(e))}}class gt extends g{constructor(){super(...arguments);s(this,"encoder",new Ct);s(this,"decoder",new yt)}}const Tr=new gt;class fe{constructor(e,t){s(this,"blocks");s(this,"transactions");this.blocks=e,this.transactions=t}toJSON(){return we.encode(this)}}class Rt{convert(e){return u(e,"blocks","transactions"),new fe(G.decode(e.blocks),P.decode(e.transactions))}}class kt{convert(e){return l(e,fe),{blocks:G.encode(e.blocks),transactions:P.encode(e.transactions)}}}class St extends g{constructor(){super(...arguments);s(this,"encoder",new kt);s(this,"decoder",new Rt)}}const we=new St;class Ce{constructor(e){s(this,"searchResults");this.searchResults=e}toJSON(){return ye.encode(this)}}class vt{convert(e){return u(e,"search_results"),new Ce(we.decode(e.search_results))}}class Et{convert(e){return l(e,Ce),{search_results:we.encode(e.searchResults)}}}class xt extends g{constructor(){super(...arguments);s(this,"encoder",new Et);s(this,"decoder",new vt)}}const ye=new xt,L=a;class ge{constructor(e,t,o,n){s(this,"requestID");s(this,"api");s(this,"method");s(this,"param");this.requestID=e,this.api=t,this.method=o,this.param=n}toJSON(){return{requestID:this.requestID,api:this.api,method:this.method,param:this.param}}}class bt{convert(e){return u(e,"requestID","api","method","param"),new ge(L.decode(e.requestID),_.decode(e.api),_.decode(e.method),e.param)}}class Tt{convert(e){return l(e,ge),{requestID:L.encode(e.requestID),api:_.encode(e.api),method:_.encode(e.method),param:e.param}}}class _t extends f{constructor(){super(...arguments);s(this,"encoder",new Tt);s(this,"decoder",new bt)}}const At=new _t;class Re{constructor(e){s(this,"requestID");this.requestID=e}}class ke extends Re{constructor(t,o){super(t);s(this,"response");this.response=o}toJSON(){return _r.encode(this)}}class Dt{convert(e){return u(e,"requestID","response"),new ke(L.decode(e.requestID),e.response)}}class Bt{convert(e){return l(e,ke),{requestID:L.encode(e.requestID),response:e.response}}}class It extends f{constructor(){super(...arguments);s(this,"encoder",new Bt);s(this,"decoder",new Dt)}}const _r=new It;class Se extends Re{constructor(t,o){super(t);s(this,"error");this.error=o}toJSON(){return Ar.encode(this)}}class qt{convert(e){return u(e,"requestID","error"),new Se(L.decode(e.requestID),kr.decode(e.error))}}class Gt{convert(e){return l(e,Se),{requestID:L.encode(e.requestID),error:kr.encode(e.error)}}}class Pt extends f{constructor(){super(...arguments);s(this,"encoder",new Gt);s(this,"decoder",new qt)}}const Ar=new Pt;class Lt{convert(e){if(v(e,"response",E))return _r.decode(e);if(v(e,"error",E))return Ar.decode(e);throw new W}}class Ot{convert(e){return l(e,Re),e.toJSON()}}class Ut extends f{constructor(){super(...arguments);s(this,"encoder",new Ot);s(this,"decoder",new Lt)}}const nr=new Ut;class ve{constructor(e){s(this,"transaction_nmt");this.transaction_nmt=e}toJSON(){return F.encode(this)}}class Wt{convert(e){return u(e,"transaction_nmt"),new ve(ur.decode(e.transaction_nmt))}}class Ft{convert(e){return l(e,ve),{transaction_nmt:ur.encode(e.transaction_nmt)}}}class Ht extends f{constructor(){super(...arguments);s(this,"encoder",new Ft);s(this,"decoder",new Wt)}}const F=new Ht;class Ee{constructor(e,t,o,n,c){s(this,"header");s(this,"payload");s(this,"hash");s(this,"size");s(this,"numTransactions");this.header=e,this.payload=t,this.hash=o,this.size=n,this.numTransactions=c}toJSON(){return xe.encode(this)}}class Nt{convert(e){return u(e,"header","payload","hash","size","num_transactions"),new Ee(Y.decode(e.header),F.decode(e.payload),m.decode(e.hash),a.decode(e.size),a.decode(e.num_transactions))}}class Jt{convert(e){return l(e,Ee),{header:Y.encode(e.header),payload:F.encode(e.payload),hash:m.encode(e.hash),size:a.encode(e.size),num_transactions:a.encode(e.numTransactions)}}}class Mt extends g{constructor(){super(...arguments);s(this,"encoder",new Jt);s(this,"decoder",new Nt)}}const xe=new Mt;class Qt{convert(e){if(!nt(e))throw new Sr(typeof e,"boolean");return e}}class zt{convert(e){return at(e,"boolean"),e}}class jt extends f{constructor(){super(...arguments);s(this,"encoder",new zt);s(this,"decoder",new Qt)}}const X=new jt;class j{constructor(e){s(this,"leaf_commit");this.leaf_commit=e}toJSON(){return be.encode(this)}}class $t{convert(e){return u(e,"leaf_commit"),new j(m.decode(e.leaf_commit))}}class Kt{convert(e){return l(e,j),{leaf_commit:m.encode(e.leaf_commit)}}}class Yt extends f{constructor(){super(...arguments);s(this,"encoder",new Kt);s(this,"decoder",new $t)}}const be=new Yt;class ${constructor(e,t,o,n,c,i){s(this,"data");s(this,"vote_commitment");s(this,"view_number");s(this,"signatures");s(this,"is_genesis");s(this,"_pd");this.data=e,this.vote_commitment=t,this.view_number=o,this.signatures=n,this.is_genesis=c,this._pd=i}toJSON(){return H.encode(this)}}class Vt{convert(e){return u(e,"data","vote_commitment","view_number","signatures","is_genesis","_pd"),new $(be.decode(e.data),m.decode(e.vote_commitment),a.decode(e.view_number),pr.decode(e.signatures),X.decode(e.is_genesis),null)}}class Xt{convert(e){return l(e,$),{data:be.encode(e.data),vote_commitment:m.encode(e.vote_commitment),view_number:a.encode(e.view_number),signatures:pr.encode(e.signatures),is_genesis:X.encode(e.is_genesis),_pd:null}}}class Zt extends f{constructor(){super(...arguments);s(this,"encoder",new Xt);s(this,"decoder",new Vt)}}const H=new Zt;class Te{constructor(e,t,o,n,c,i,d,h){s(this,"view_number");s(this,"justify_qc");s(this,"parent_commitment");s(this,"block_header");s(this,"block_payload");s(this,"rejected");s(this,"timestamp");s(this,"proposer_id");this.view_number=e,this.justify_qc=t,this.parent_commitment=o,this.block_header=n,this.block_payload=c,this.rejected=i,this.timestamp=d,this.proposer_id=h}toJSON(){return _e.encode(this)}}class es{convert(e){return u(e,"view_number","justify_qc","parent_commitment","block_header","block_payload","rejected","timestamp","proposer_id"),new Te(a.decode(e.view_number),H.decode(e.justify_qc),m.decode(e.parent_commitment),Y.decode(e.block_header),F.decode(e.block_payload),lr.decode(e.rejected),a.decode(e.timestamp),vr.decode(e.proposer_id))}}class rs{convert(e){return l(e,Te),{view_number:a.encode(e.view_number),justify_qc:H.encode(e.justify_qc),parent_commitment:m.encode(e.parent_commitment),block_header:Y.encode(e.block_header),block_payload:F.encode(e.block_payload),rejected:lr.encode(e.rejected),timestamp:a.encode(e.timestamp),proposer_id:vr.encode(e.proposer_id)}}}class ts extends f{constructor(){super(...arguments);s(this,"encoder",new rs);s(this,"decoder",new es)}}const _e=new ts;class Ae{constructor(e,t){s(this,"leaf");s(this,"qc");this.leaf=e,this.qc=t}toJSON(){return De.encode(this)}}class ss{convert(e){return u(e,"leaf","qc"),new Ae(_e.decode(e.leaf),H.decode(e.qc))}}class os{convert(e){return l(e,Ae),{leaf:_e.encode(e.leaf),qc:H.encode(e.qc)}}}class cs extends f{constructor(){super(...arguments);s(this,"encoder",new os);s(this,"decoder",new ss)}}const De=new cs;class Be{constructor(e,t){s(this,"pos");s(this,"proof");this.pos=e,this.proof=t}toJSON(){return Ie.encode(this)}}class ns{convert(e){return u(e,"pos","proof"),new Be(m.decode(e.pos),hr.decode(e.proof))}}class as{convert(e){return l(e,Be),{pos:m.encode(e.pos),proof:hr.encode(e.proof)}}}class is extends f{constructor(){super(...arguments);s(this,"encoder",new as);s(this,"decoder",new ns)}}const Ie=new is;class qe{constructor(e,t,o,n,c){s(this,"transaction");s(this,"block_hash");s(this,"proof");s(this,"height");s(this,"hash");this.transaction=e,this.block_hash=t,this.proof=o,this.height=n,this.hash=c}toJSON(){return Ge.encode(this)}}class ds{convert(e){return u(e,"transaction","block_hash","proof","height","hash"),new qe(mr.decoder.convert(e.transaction),m.decode(e.block_hash),Ie.decoder.convert(e.proof),a.decode(e.height),m.decode(e.hash))}}class ls{convert(e){return l(e,qe),{transaction:mr.encode(e.transaction),block_hash:m.encode(e.block_hash),proof:Ie.encode(e.proof),height:a.encode(e.height),hash:m.encode(e.hash)}}}class us extends f{constructor(){super(...arguments);s(this,"encoder",new ls);s(this,"decoder",new ds)}}const Ge=new us,q="latest";class Pe{constructor(e){s(this,"target");this.target=e}static latest(){return new Br}static height(e){return new Ir(e)}toJSON(){return Dr.encode(this)}}class ps{convert(e){return l(e,Pe),typeof e.target=="number"?a.encode(e.target):_.encode(e.target)}}class hs{convert(e){return e===q?new Br:new Ir(a.decode(e))}}class ms extends g{constructor(){super(...arguments);s(this,"encoder",new ps);s(this,"decoder",new hs)}}const Dr=new ms;class Br extends Pe{constructor(){super(q)}}class Ir extends Pe{constructor(e){super(e)}}class Le{constructor(e){s(this,"blockDetail");this.blockDetail=e}toJSON(){return Oe.encode(this)}}class fs{convert(e){return u(e,"block_detail"),new Le(V.decode(e.block_detail))}}class ws{convert(e){return l(e,Le),{block_detail:V.encode(e.blockDetail)}}}class Cs extends g{constructor(){super(...arguments);s(this,"encoder",new ws);s(this,"decoder",new fs)}}const Oe=new Cs;class Ue{constructor(e){s(this,"limit");this.limit=e}static latest(e){return new Gr(e)}static from(e,t){return new Pr(e,t)}toJSON(){return qr.encode(this)}}class ys{convert(e){return l(e,Ue),it(e.from)?{from:a.encode(e.from),limit:a.encode(e.limit)}:{from:_.encode(e.from),limit:a.encode(e.limit)}}}class gs{convert(e){return u(e,"from","limit"),e.from===q?new Gr(a.decode(e.limit)):new Pr(a.decode(e.from),a.decode(e.limit))}}class Rs extends g{constructor(){super(...arguments);s(this,"encoder",new ys);s(this,"decoder",new gs)}}const qr=new Rs;class Gr extends Ue{constructor(e){super(e)}get from(){return q}}class Pr extends Ue{constructor(t,o){super(o);s(this,"from");this.from=t}}class We{constructor(e){s(this,"blockSummaries");this.blockSummaries=e}toJSON(){return Fe.encode(this)}}class ks{convert(e){return u(e,"block_summaries"),new We(G.decode(e.block_summaries))}}class Ss{convert(e){return l(e,We),{block_summaries:G.encode(e.blockSummaries)}}}class vs extends g{constructor(){super(...arguments);s(this,"encoder",new Ss);s(this,"decoder",new ks)}}const Fe=new vs;class He{constructor(e,t,o){s(this,"rollups");s(this,"transactions");s(this,"blocks");this.rollups=e,this.transactions=t,this.blocks=o}toJSON(){return Ne.encode(this)}}class Es{convert(e){return u(e,"rollups","transactions","blocks"),new He(a.decode(e.rollups),a.decode(e.transactions),a.decode(e.blocks))}}class xs{convert(e){return l(e,He),{rollups:a.encode(e.rollups),transactions:a.encode(e.transactions),blocks:a.encode(e.blocks)}}}class bs extends f{constructor(){super(...arguments);s(this,"encoder",new xs);s(this,"decoder",new Es)}}const Ne=new bs;class Je{constructor(e,t,o,n,c){s(this,"latestBlock");s(this,"genesisOverview");s(this,"latestBlocks");s(this,"latestTransactions");s(this,"histograms");this.latestBlock=e,this.genesisOverview=t,this.latestBlocks=o,this.latestTransactions=n,this.histograms=c}toJSON(){return Me.encode(this)}}class Ts{convert(e){return u(e,"latest_block","genesis_overview","latest_blocks","latest_transactions","histograms"),new Je(V.decode(e.latest_block),Ne.decode(e.genesis_overview),G.decode(e.latest_blocks),P.decode(e.latest_transactions),fr.decode(e.histograms))}}class _s{convert(e){return l(e,Je),{latest_block:V.encode(e.latestBlock),genesis_overview:Ne.encode(e.genesisOverview),latest_blocks:G.encode(e.latestBlocks),latest_transactions:P.encode(e.latestTransactions),histograms:fr.encode(e.histograms)}}}class As extends f{constructor(){super(...arguments);s(this,"encoder",new _s);s(this,"decoder",new Ts)}}const Me=new As;class Qe{constructor(e){s(this,"explorerSummary");this.explorerSummary=e}toJSON(){return ze.encode(this)}}class Ds{convert(e){return u(e,"explorer_summary"),new Qe(Me.decode(e.explorer_summary))}}class Bs{convert(e){return l(e,Qe),{explorer_summary:Me.encode(e.explorerSummary)}}}class Is extends f{constructor(){super(...arguments);s(this,"encoder",new Bs);s(this,"decoder",new Ds)}}const ze=new Is;class je{static heightAndOffset(e,t){return new N(e,t)}static hash(e){return new J(e)}toJSON(){return Lr.encode(this)}}class qs{convert(e){if(l(e,je),e instanceof N)return{height:a.encode(e.height),offset:a.encode(e.offset)};if(e instanceof J)return{hash:m.encode(e.hash)};throw new W}}class Gs{convert(e){if(v(e,"height",E)&&v(e,"offset",E))return new N(a.decode(e.height),a.decode(e.offset));if(v(e,"hash",E))return new J(m.decode(e.hash));throw new W}}class Ps extends f{constructor(){super(...arguments);s(this,"encoder",new qs);s(this,"decoder",new Gs)}}const Lr=new Ps;class N extends je{constructor(t,o){super();s(this,"height");s(this,"offset");this.height=t,this.offset=o}}class J extends je{constructor(t){super();s(this,"hash");this.hash=t}}class $e{constructor(e,t,o,n,c,i,d,h,w){s(this,"hash");s(this,"height");s(this,"blockConfirmed");s(this,"offset");s(this,"numTransactions");s(this,"size");s(this,"time");s(this,"sequencingFees");s(this,"feeDetails");this.hash=e,this.height=t,this.blockConfirmed=o,this.offset=n,this.numTransactions=c,this.size=i,this.time=d,this.sequencingFees=h,this.feeDetails=w}toJSON(){return Ke.encode(this)}}class Ls{convert(e){return u(e,"hash","height","block_confirmed","offset","num_transactions","size","time","sequencing_fees","fee_details"),new $e(m.decode(e.hash),a.decode(e.height),X.decode(e.block_confirmed),a.decode(e.offset),a.decode(e.num_transactions),a.decode(e.size),wr.decode(e.time),[],[])}}class Os{convert(e){return l(e,$e),{hash:m.encode(e.hash),height:a.encode(e.height),block_confirmed:X.encode(e.blockConfirmed),offset:a.encode(e.offset),num_transactions:a.encode(e.numTransactions),size:a.encode(e.size),time:wr.encode(e.time),sequencing_fees:[],fee_details:[]}}}class Us extends f{constructor(){super(...arguments);s(this,"encoder",new Os);s(this,"decoder",new Ls)}}const Ke=new Us;class Ye{constructor(e,t){s(this,"details");s(this,"data");this.details=e,this.data=t}toJSON(){return Ve.encode(this)}}class Ws{convert(e){return u(e,"details","data"),new Ye(Ke.decode(e.details),Cr.decode(e.data))}}class Fs{convert(e){return l(e,Ye),{details:Ke.encode(e.details),data:Cr.encode(e.data)}}}class Hs extends f{constructor(){super(...arguments);s(this,"encoder",new Fs);s(this,"decoder",new Ws)}}const Ve=new Hs;class K{constructor(e){s(this,"transactionDetail");this.transactionDetail=e}toJSON(){return Xe.encode(this)}}class Ns{convert(e){return u(e,"transaction_detail"),new K(Ve.decode(e.transaction_detail))}}class Js{convert(e){return l(e,K),{transaction_detail:Ve.encode(e.transactionDetail)}}}class Ms extends g{constructor(){super(...arguments);s(this,"encoder",new Js);s(this,"decoder",new Ns)}}const Xe=new Ms;class Z{constructor(){}static block(e){return new ee(e)}static namespace(e){return new re(e)}static none(){return new er}toJSON(){return Ze.encode(this)}}class Qs{convert(e){return v(e,"block",E)?new ee(a.decode(e.block)):v(e,"namespace",E)?new re(a.decode(e.namespace)):new er}}class zs{convert(e){if(l(e,Z),e instanceof er)return{};if(e instanceof ee)return{block:a.encode(e.block)};if(e instanceof re)return{namespace:a.encode(e.namespace)};throw new W}}class js extends g{constructor(){super(...arguments);s(this,"encoder",new zs);s(this,"decoder",new Qs)}}const Ze=new js;class er extends Z{constructor(){super()}convertURL(e){return e}}class ee extends Z{constructor(t){super();s(this,"block");this.block=t}convertURL(t){return new URL(`${t.pathname}/block/${this.block}`,t)}}class re extends Z{constructor(t){super();s(this,"namespace");this.namespace=t}convertURL(t){return new URL(`${t.pathname}/namespace/${this.namespace}`,t)}}class te{constructor(e){s(this,"limit");this.limit=e}static latest(e){return new se(e)}static heightAndOffset(e,t,o){return new oe(e,t,o)}static hash(e,t){return new ce(e,t)}toJSON(){return rr.encode(this)}}class $s{convert(e){return u(e,"limit"),v(e,"height",E)&&v(e,"offset",E)?new oe(a.decode(e.height),a.decode(e.offset),a.decode(e.limit)):v(e,"hash",E)?new ce(m.decode(e.hash),a.decode(e.limit)):new se(a.decode(e.limit))}}class Ks{convert(e){if(l(e,te),e instanceof se)return{limit:a.encode(e.limit)};if(e instanceof oe)return{height:a.encode(e.height),offset:a.encode(e.offset),limit:a.encode(e.limit)};if(e instanceof ce)return{hash:m.encode(e.hash),limit:a.encode(e.limit)};throw new W}}class Ys extends g{constructor(){super(...arguments);s(this,"encoder",new Ks);s(this,"decoder",new $s)}}const rr=new Ys;class se extends te{constructor(e){super(e)}convertURL(e){return new URL(`transactions/latest/${this.limit}`,e)}}class oe extends te{constructor(t,o,n){super(n);s(this,"height");s(this,"offset");this.height=t,this.offset=o}convertURL(t){return new URL(`transactions/from/${this.height}/${this.offset}/${this.limit}`,t)}}class ce extends te{constructor(t,o){super(o);s(this,"hash");this.hash=t}convertURL(t){return new URL(`transactions/hash/${this.hash}/${this.limit}`,t)}}class Or{constructor(e,t){s(this,"target");s(this,"filter");this.target=e,this.filter=t}toJSON(){return Ur.encode(this)}}class Vs{convert(e){return u(e,"filter","target"),new Or(rr.decode(e.target),Ze.decode(e.filter))}}class Xs{convert(e){return l(e,Or),{filter:Ze.encode(e.filter),target:rr.encode(e.target)}}}class Zs extends g{constructor(){super(...arguments);s(this,"encoder",new Xs);s(this,"decoder",new Vs)}}const Ur=new Zs;class U{constructor(e){s(this,"transactionSummaries");this.transactionSummaries=e}toJSON(){return tr.encode(this)}}class eo{convert(e){return u(e,"transaction_summaries"),new U(P.decode(e.transaction_summaries))}}class ro{convert(e){return l(e,U),{transaction_summaries:P.encode(e.transactionSummaries)}}}class to extends g{constructor(){super(...arguments);s(this,"encoder",new ro);s(this,"decoder",new eo)}}const tr=new to;function so(r){return new Worker(""+new URL("hotshot_query_service_web_worker_api.js-CkcLGQXi.js",import.meta.url).href,{name:r==null?void 0:r.name})}class oo{constructor(e){s(this,"worker");s(this,"nextRequestID",0);s(this,"requestCompleters",new Map);this.worker=e,e.onmessageerror,e.addEventListener("message",this.handleMessage.bind(this)),e.addEventListener("messageerror",this.handleMessageError.bind(this)),e.addEventListener("error",this.handleError.bind(this))}async submitRequest(e,t,o,n){const[c,i]=this.nextRequest();try{return this.worker.postMessage(At.encode(new ge(c,t,o,n))),await i.promise.then(d=>{if(d instanceof Se)throw new Jr(d.error);if(d instanceof ke){const{response:h}=d;return e.decode(h)}throw new Sr(typeof d,"WebWorkerResponse")})}finally{this.requestCompleters.delete(c)}}nextRequest(){const e=this.nextRequestID++,t=Mr();return this.requestCompleters.set(e,t),[e,t]}handleMessage(e){const t=nr.decode(e.data),o=this.requestCompleters.get(t.requestID);if(o===void 0)throw new sr(t.requestID);o.complete(t)}handleMessageError(e){const t=nr.decode(e.data),o=this.requestCompleters.get(t.requestID);if(o===void 0)throw new sr(t.requestID);o.completeError(t)}handleError(e){debugger;console.error("encountered error setting up Web worker",e)}}class co{constructor(e){s(this,"helper");this.helper=e}async sendRequest(e,t,...o){return this.helper.submitRequest(e,"availability",t,o)}async getLeafFromHeight(e){return await this.sendRequest(De,"getLeafFromHeight",e)}async getTransactionFromHeightAndOffset(e,t){return await this.sendRequest(Ge,"getTransactionFromHeightAndOffset",e,t)}async getBlockSummaries(e,t){return await this.sendRequest(Qr,"getBlockSummaries",e,t)}async getBlockFromHeight(e){return await this.sendRequest(xe,"getBlockFromHeight",e)}async getTransactionSummaryRange(e,t,o){return await this.sendRequest(or,"getTransactionSummaryRange",e,t,o)}async getTransactionSummaryRangeForRollup(e,t,o,n){return await this.sendRequest(or,"getTransactionSummaryRangeForRollup",e,t,o,n)}}class no{constructor(e){s(this,"helper");this.helper=e}async sendRequest(e,t,...o){return this.helper.submitRequest(e,"status",t,o)}async blockHeight(){return await this.sendRequest(a,"blockHeight")}}class ao{constructor(e){s(this,"helper");this.helper=e}async sendRequest(e,t,...o){return this.helper.submitRequest(e,"explorer",t,o)}async getBlockDetail(e){return await this.sendRequest(Oe,"getBlockDetail",Dr.encode(e))}async getBlockSummaries(e){return await this.sendRequest(Fe,"getBlockSummaries",qr.encode(e))}async getTransactionDetail(e){return await this.sendRequest(Xe,"getTransactionDetail",Lr.encode(e))}async getTransactionSummaries(e){return await this.sendRequest(tr,"getTransactionSummaries",Ur.encode(e))}async getExplorerOverview(){return await this.sendRequest(ze,"getExplorerOverview",null)}async getSearchResult(e){return await this.sendRequest(ye,"getSearchResult",Tr.encode(e))}}class io{constructor(){s(this,"availability");s(this,"status");s(this,"explorer");const e=new so,t=new oo(e);this.availability=new co(t),this.status=new no(t),this.explorer=new ao(t)}}function ne(r){return new jr(r.height,r.time.valueOf()/1e3,0,new $r(0,"00","00"),[],new Kr(new ArrayBuffer(0)),new y("MERKLE_COMM",new Uint8Array([0,0,0,0]).buffer),new y("MERKLE_COMM",new Uint8Array([0,0,0,0]).buffer),new Yr(new ArrayBuffer(0),new ArrayBuffer(0),0),new Vr(new ArrayBuffer(0),new ArrayBuffer(0)))}async function lo(r){return new Ee(ne(r),new ve(await T(b(r.transactions,async e=>new he(e.tree.namespace,Array.from(new Uint8Array(e.tree.data)))))),new y("BLOCK",new Uint8Array([0,0,0,0]).buffer),r.size,r.numTransactions)}function uo(r){return new yr(ne(r),new y("BLOCK",new Uint8Array([0,0,0,0]).buffer),r.size,r.numTransactions,r.proposer)}function po(r){const e=r.transactions,t=ne(r);return b(e,async o=>new gr(o.hash,t,o.index,new he(o.tree.namespace,Array.from(new Uint8Array(o.tree.data)))))}async function*ho(r){const e=ne(r),t=r.transactions;yield*b(t,async o=>new qe(new he(o.tree.namespace,Array.from(new Uint8Array(o.tree.data))),new y("BLOCK",new Uint8Array([0,0,0,0]).buffer),new Be(new y("POS",new Uint8Array([0,0,0,0]).buffer),[new zr(new y("EMPTY",new Uint8Array([0,0,0,0]).buffer),[])]),e.height,new y("COMMIT",o.tree.data.slice(0,32))))}class mo{async getLeafFromHeight(e){const t=await this.getBlockFromHeight(e);return new Ae(new Te(e,new $(new j(new y("EMPTY",new Uint8Array([0,0,0,0]).buffer)),new y("EMPTY",new Uint8Array([0,0,0,0]).buffer),e,null,!1,null),new y("LEAF",new Uint8Array([0,0,0,0]).buffer),t.header,t.payload,[],t.header.timestamp,t.header.fee_info.account),new $(new j(new y("EMPTY",new Uint8Array([0,0,0,0]).buffer)),new y("EMPTY",new Uint8Array([0,0,0,0]).buffer),e,null,!1,null))}async getTransactionFromHeightAndOffset(e,t){const o=await z(A(C(),e)),n=ho(o);return await dt(Q(n,t))}async getBlockSummaries(e,t){const o=A(C(),e),n=D(o,t-e),c=I(n,async i=>uo(i));return await T(c)}async getBlockFromHeight(e){const t=A(C(),e),o=await z(t);return lo(o)}async*streamTransactionSummaries(e){const t=Er(C(),c=>c.height<=e),o=me(t);yield*B(o,c=>O(po(c)))}async getTransactionSummaryRange(e,t,o){const n=this.streamTransactionSummaries(e),c=A(n,t),i=D(c,o);return await T(i)}async getTransactionSummaryRangeForRollup(e,t,o,n){const c=this.streamTransactionSummaries(t),i=xr(c,w=>w.transaction.vm===e),d=A(i,o),h=D(d,n);return await T(h)}}function ar(r){return new Zr(r.hash,r.height,r.time,r.numTransactions,r.proposer,r.proposer,r.size,r.fees)}function ue(r){return new et(r.hash,r.height,r.proposer,r.numTransactions,r.size,r.time)}function ir(r,e){return new Ye(new $e(e.hash,e.block,!0,e.index,r.numTransactions,e.size,e.time,[],[]),[new rt(e.tree.namespace,e.tree.data)])}function M(r,e){return new Rr(e.hash,[e.tree.namespace],e.block,e.time,e.index,r.numTransactions)}class fo{async getBlockDetail(e){const t=e.target,o=await(t===q?lt(C()):z(Q(C(),t)));return new Le(ar(o))}async getBlockSummaries(e){const t=Er(C(),d=>e.from===q||d.height<=e.from),o=me(t),n=D(o,e.limit),c=I(n,async d=>ue(d)),i=await T(c);return new We(i)}async getTransactionDetail(e){const t=C();if(e instanceof N){const o=ae(t,d=>d.height<=e.height),n=B(o,d=>b(d.transactions,async h=>ir(d,h))),c=Q(O(n),e.offset),i=await z(c);return new K(i)}if(e instanceof J){const o=B(t,c=>b(c.transactions,async i=>ir(c,i))),n=await ut(o,c=>c.details.hash===e.hash);if(!n)throw new ft(e.hash);return new K(n)}throw new pe}applyFilter(e,t){return t instanceof ee?cr(e,o=>o.height==t.block):t instanceof re?cr(e,o=>o.rollups.indexOf(t.namespace)>=0):e}async getTransactionSummaries(e){const t=C(),{target:o,filter:n}=e;if(o instanceof se){const i=B(t,k=>b(k.transactions,async p=>M(k,p))),d=O(i),h=this.applyFilter(d,n),w=await ie(de(h,o.limit));return new U(w)}if(o instanceof oe){const c=ae(t,p=>p.height<=o.height),i=B(c,p=>b(p.transactions,async R=>M(p,R))),d=O(i),h=Q(d,o.offset),w=this.applyFilter(h,n),k=await ie(de(w,o.limit));return new U(k)}if(o instanceof ce){const c=C(),i=B(c,p=>b(p.transactions,async R=>new Rr(R.hash,[R.tree.namespace],R.block,R.time,R.index,p.numTransactions))),d=ae(i,p=>p.hash!==o.hash),h=O(d),w=this.applyFilter(h,n),k=await ie(de(w,o.limit));return new U(k)}throw new pe}async getExplorerOverview(){let e;const t=x(11),o=x(51),n=x(51),c=x(51),i=x(51),d=x(11);let h=0,w=0;const k=new Map;for await(const p of C()){e=ar(p),t.put(ue(p)),o.put(p.size),n.put(Math.round(p.genTime/1e3)),c.put(p.numTransactions),i.put(p.height),h++,w+=p.numTransactions;for await(const R of p.transactions){d.put(M(p,R));const Wr=k.get(R.tree.namespace)||0;k.set(R.tree.namespace,Wr+1)}}return new Qe(new Je(e,new He(Array.from(k.keys()).length,w,h),Array.from(t),Array.from(d),new Xr(Array.from(n),Array.from(o),Array.from(c),Array.from(i))))}async getSearchResult(e){const t=x(101),o=x(10),n=x(10);for await(const c of C())t.put(c);for(const c of t){c.hash.toString().startsWith(e.query)&&o.put(ue(c));for await(const i of c.transactions)i.hash.toString().startsWith(e.query)&&n.put(M(c,i))}return new Ce(new fe(Array.from(o),Array.from(n)))}}class wo{async blockHeight(){return(await pt(C())).height}}class Co{constructor(){s(this,"availability",new mo);s(this,"status",new wo);s(this,"explorer",new fo)}}function S(r){return async e=>(yo(e),go(e),r.convert(await e.json()))}function yo(r){if(!r.ok)throw r.status>=500&&r.status<600?new tt(r.status,r):r.status>=400&&r.status<500?new st(r.status,r):new ot(r.status,r)}function go(r){const e=r.headers.get("content-type");if(!e||!e.startsWith("application/json"))throw ct.fromResponse(r,e||"undefined")}async function Ro(r,e){return new yr(r.header,r.hash,r.size,r.payload.transaction_nmt.length,[e.leaf.proposer_id])}async function*ko(r,e){const t=e[Symbol.asyncIterator]();yield*b(ht(r.leaf.block_payload.transaction_nmt),async o=>{const n=r.leaf.block_payload.transaction_nmt.indexOf(o),c=await t.next();if(c.done)throw new Error("Not enough transactions");return new gr(c.value.hash,r.leaf.block_header,n,o)})}class So{constructor(e,t){s(this,"fetcher");s(this,"baseURL");this.fetcher=e,this.baseURL=t}getLeafFromHeight(e){const t=new URL(`leaf/${e}`,this.baseURL);return this.fetcher(t.toString()).then(S(De.decoder))}getTransactionFromHeightAndOffset(e,t){const o=new URL(`transaction/${e}/${t}`,this.baseURL);return this.fetcher(o.toString()).then(S(Ge.decoder))}async getBlockSummaries(e,t){const o=le(t-e),n=I(o,i=>Promise.all([this.getBlockFromHeight(e+i),this.getLeafFromHeight(e+i)])),c=I(n,([i,d])=>Ro(i,d));return await T(c)}getBlockFromHeight(e){const t=new URL(`block/${e}`,this.baseURL);return this.fetcher(t.toString()).then(S(xe.decoder))}async*streamBlocksFromHeightRange(e,t){const o=le(e),n=I(o,i=>this.getLeafFromHeight(e-i)),c=mt(n,i=>me(ko(i,I(le(i.leaf.block_payload.transaction_nmt.length),d=>this.getTransactionFromHeightAndOffset(i.leaf.block_header.height,d)))));if(t===void 0){yield*c;return}yield*D(c,t)}async getTransactionSummaryRange(e,t,o){const n=this.streamBlocksFromHeightRange(e,50),c=A(n,t),i=D(c,o);return await T(i)}async getTransactionSummaryRangeForRollup(e,t,o,n){const c=this.streamBlocksFromHeightRange(t,50),i=xr(c,w=>w.transaction.vm===e),d=A(i,o),h=D(d,n);return await T(h)}}class vo{constructor(e,t){s(this,"fetcher");s(this,"baseURL");this.fetcher=e,this.baseURL=t}async getBlockDetail(e){const t=new URL(`block/${e.target}`,this.baseURL);return this.fetcher(t.toString()).then(S(Oe.decoder))}async getBlockSummaries(e){const t=new URL(`blocks/${e.from}/${e.limit}`,this.baseURL);return this.fetcher(t.toString()).then(S(Fe.decoder))}async getTransactionDetail(e){let t=null;if(e instanceof J?t=new URL(`transaction/hash/${e.hash}`,this.baseURL):e instanceof N&&(t=new URL(`transaction/${e.height}/${e.offset}`,this.baseURL)),!t)throw new pe;return this.fetcher(t.toString()).then(S(Xe.decoder))}async getTransactionSummaries(e){const{target:t,filter:o}=e;let n=t.convertURL(this.baseURL);return n=o.convertURL(n),this.fetcher(n.toString()).then(S(tr.decoder))}async getExplorerOverview(){const e=new URL("explorer-summary",this.baseURL);return this.fetcher(e.toString()).then(S(ze.decoder))}async getSearchResult(e){const t=new URL(`search/${encodeURIComponent(e.query)}`,this.baseURL);return this.fetcher(t.toString()).then(S(ye.decoder))}}class Eo{constructor(e,t){s(this,"fetcher");s(this,"baseURL");s(this,"blockHeightURL");s(this,"blockHeightResponseValidator",S(a.decoder));this.fetcher=e,this.baseURL=t,this.blockHeightURL=new URL("block-height",this.baseURL)}blockHeight(){return this.fetcher(this.blockHeightURL).then(this.blockHeightResponseValidator)}}class xo{constructor(e,t){s(this,"availability");s(this,"status");s(this,"explorer");this.availability=new So(e,new URL("availability/",t)),this.status=new Eo(e,new URL("status/",t)),this.explorer=new vo(e,new URL("explorer/",t))}}const bo=wt.createContext(To());function To(){return typeof window<"u"&&"Worker"in window||typeof self<"u"&&"Worker"in self?new io:new Co}function _o(){return typeof window>"u"?fetch:fetch.bind(window)}const dr=({url:r,children:e})=>Nr.jsx(bo.Provider,{value:new xo(_o(),r),children:e});try{dr.displayName="ProvideCappuccinoLiveService",dr.__docgenInfo={description:`ProvideCappuccinoLiveService is a component that provides a Cappuccino
HotShot Query Service API targeting the given URL.`,displayName:"ProvideCappuccinoLiveService",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"URL"}}}}}catch{}export{Ce as C,fe as a,bo as b,Pe as c,Ue as d,Or as e,te as f,Z as g,je as h,br as i};
