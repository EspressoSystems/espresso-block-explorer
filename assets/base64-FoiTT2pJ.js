import{c as F,b as S}from"./assert-BI051aL8.js";import{A as T,T as U,k,l as O,h as K,I as W,N as q,f as G,g as H,B as y,s as C,d as V,b as A,c as v,r as I,a as Q}from"./string-DurhFPzJ.js";class X{convert(e){if(!K(e))throw new W(typeof e,"number");return e}}class Y{convert(e){return F(e,"number"),e}}class Z extends U{encoder=new Y;decoder=new X}const f=new Z,P=new q(new G(f),new H(f)),Ee=new T(new k(f),new O(f)),Ue=new T(new k(P),new O(P)),M="CorruptBase64InputError";class g extends y{offset;constructor(e,t=`corrupt input error at ${e}`){super(t),this.offset=e,Object.freeze(this)}get code(){return M}toJSON(){return j.encode(this)}}class ${convert(e){return A(e,"code","offset","message"),v(e,M),new g(f.decode(e.offset),C.decode(e.message))}}class _{convert(e){return S(e,g),{...V.convert(e),offset:f.encode(e.offset),message:C.encode(e.message)}}}class ee extends U{encoder=new _;decoder=new $}const j=new ee;I(M,j);const x="IncorrectBase64PaddingError";class z extends y{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return x}}class te{convert(e){return A(e,"code","message"),v(e,x),new z(C.decode(e.message))}}class re extends Q{}class ne extends U{encoder=new re;decoder=new te}const se=new ne;I(x,se);const D="InvalidBase64AlphabetLengthError";class L extends y{length;constructor(e,t=`alphabet needs to be 64 characters, received ${e}`){super(t),this.length=e,Object.freeze(this)}toJSON(){return J.encode(this)}get code(){return D}}class oe{convert(e){return A(e,"code","length","message"),v(e,D),new L(f.decode(e.length),C.decode(e.message))}}class ce{convert(e){return S(e,L),{...V.convert(e),length:f.encode(e.length)}}}class ae extends U{encoder=new ce;decoder=new oe}const J=new ae;I(D,J);const de=new TextEncoder;function R(n){return de.encode(n)}const ie=new TextDecoder;function he(n){return ie.decode(n)}function*le(n){yield*R(n)}function*we(){for(let n=0;n<256;n++)yield 255}const u=-1,ge=61;class p{encodeMap;decodeMap;padChar;strict;constructor(e,t,o=ge,d=!1){this.encodeMap=e,this.decodeMap=t,this.padChar=o,this.strict=d}static withAlphabet(e){const t=e.length;if(t!==64)throw new L(t);const o=Array.from(le(e)),d=Array.from(we());for(let i=0;i<t;i++)d[o[i]]=i;return new p(o,d)}withPadding(e){return new p(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let t=0,o=0;const d=Math.floor(e.byteLength/3)*3,i=Math.ceil(e.byteLength/3)*4,l=new ArrayBuffer(i),s=new DataView(e),c=new DataView(l);for(;o<d;){const w=s.getUint8(o+0)<<16|s.getUint8(o+1)<<8|s.getUint8(o+2);c.setUint8(t+0,this.encodeMap[w>>18&63]),c.setUint8(t+1,this.encodeMap[w>>12&63]),c.setUint8(t+2,this.encodeMap[w>>6&63]),c.setUint8(t+3,this.encodeMap[w&63]),o+=3,t+=4}const r=e.byteLength-o;if(r===0)return l;let h=s.getUint8(o+0)<<16;switch(r===2&&(h|=s.getUint8(o+1)<<8),c.setUint8(t+0,this.encodeMap[h>>18&63]),c.setUint8(t+1,this.encodeMap[h>>12&63]),r){case 2:return c.setUint8(t+2,this.encodeMap[h>>6&63]),this.padChar!==u?(c.setUint8(t+3,this.padChar),l.slice(0,t+4)):l.slice(0,t+3);case 1:if(this.padChar!==u)return c.setUint8(t+2,this.padChar),c.setUint8(t+3,this.padChar),l.slice(0,t+4);break}return l.slice(0,t+2)}decode(e){const t=e.byteLength;if(t===0)return new ArrayBuffer(0);const o=new DataView(e),d=new ArrayBuffer(Math.floor(t/4*3)),i=new DataView(d),l=new ArrayBuffer(4),s=new DataView(l);let c=0,r=0,h=0,w=!1;for(;r<t&&!w;){let B=3,b=4;for(let a=0;a<4;a++){if(r===t){if(a===0)return d;if(a===1||this.padChar!==u)throw new g(r-a);B=a-1,b=a,w=!0;break}const E=o.getUint8(r);r++;const N=this.decodeMap[E];if(N!==255){s.setUint8(a,N);continue}if(E===10||E===13){a--;continue}if(E===this.padChar){switch(a){case 0:case 1:throw new z;case 2:for(;r<t&&(o.getUint8(r)===10||o.getUint8(r)===13);)r++;if(r===t)throw new g(t);r++}for(;r<t&&(o.getUint8(r)===10||o.getUint8(r)===13);)r++;if(r<t)throw new g(r);B=3,b=a,w=!0;break}throw new g(r-1)}const m=s.getUint8(0)<<18|s.getUint8(1)<<12|s.getUint8(2)<<6|s.getUint8(3);switch(s.setUint8(2,m>>0&255),s.setUint8(1,m>>8&255),s.setUint8(0,m>>16&255),b){case 4:i.setUint8(h+2,s.getUint8(2)),s.setUint8(2,0);case 3:if(i.setUint8(h+1,s.getUint8(1)),this.strict&&s.getUint8(2)!==0)throw new g(r-1);case 2:if(i.setUint8(h+0,s.getUint8(0)),this.strict&&(s.getUint8(1)!==0||s.getUint8(2)!==0))throw new g(r-2)}h+=B,c+=b-1}return d.slice(0,c)}decodeString(e){return this.decode(R(e).buffer)}encodeToString(e){return he(this.encode(e))}}const fe=p.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Ce=fe.withPadding(u),ue=p.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Be=ue.withPadding(u);export{Ce as a,Ee as b,le as c,Ue as d,f as n,Be as r,fe as s,ue as u};
