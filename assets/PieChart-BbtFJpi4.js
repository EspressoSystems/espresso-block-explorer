import{R as x,j as e}from"./iframe-6qRHL8kK.js";import{D as G}from"./LoadingProvider-CiRo7IyT.js";import{N as I}from"./NumberText-CX4omtIU.js";import{i as $}from"./typography-CU0Q2b4v.js";import{T as Y}from"./Text-BU7JBOLk.js";import{S as w}from"./SVGPathBuilder-4dyJLere.js";import{u as B,S as f,a as y,b as R,c as z,d as E,e as L,f as k}from"./SVGToolTip-B8imTCh9.js";const U=$("text"),W=14,V=x.createContext(()=>e.jsx(e.Fragment,{})),_=x.createContext(null),S=r=>{const a=r.values,[l,s]=B();if(!a)return e.jsx(e.Fragment,{});if(a.length<=0)return e.jsx(e.Fragment,{});const m=s??{x:0,y:0,width:100,height:100},{x:g,y:P,width:c,height:h}=m,t=Math.min(c,h)/2;if(a.length===1)return e.jsx("svg",{ref:l,viewBox:`${g} ${P} ${c} ${h}`,role:"graphics-datachart","aria-roledescription":"pie chart",children:e.jsx(f.Provider,{value:Number(c),children:e.jsxs(y.Provider,{value:Number(h),children:[e.jsx("g",{className:"pie-chart-sections",role:"graphics-datagroup",children:e.jsx("circle",{cx:t,cy:t,r:t,"data-label":a[0].label,role:"graphics-datascale","aria-valuemax":1})}),e.jsx("g",{className:"pie-chart-tooltip-hitboxes",children:e.jsx(_.Provider,{value:{startX:t,startY:t,endX:t,endY:t,label:a[0].label,value:a[0].value,startAngle:0,endAngle:2*Math.PI,endPercentage:1},children:e.jsxs("g",{className:"pie-chart-tooltip-hitbox",children:[e.jsx("circle",{className:"pie-chart-section-hitbox",cx:t,cy:t,r:t,"data-label":a[0].label}),e.jsx(F,{})]})})})]})})});const A=a.reduce((n,o)=>n+o.value,0),M=a.reduce((n,o)=>{const i=(n[n.length-1]??0)+o.value/A;return n.push(i),n},[]),X=a.map((n,o)=>{const d=M[o]??0,i=(M[o-1]??0)*2*Math.PI,p=d*2*Math.PI,v=t+Math.cos(i)*t,j=t+Math.sin(i)*t,C=t+Math.cos(p)*t,b=t+Math.sin(p)*t;return{startX:v,startY:j,endX:C,endY:b,startAngle:i,endAngle:p,endPercentage:d,label:n.label,value:n.value}});return e.jsx("svg",{ref:l,viewBox:`${g} ${P} ${c} ${h}`,role:"graphics-datachart","aria-roledescription":"pie chart",children:e.jsx(f.Provider,{value:Number(c),children:e.jsxs(y.Provider,{value:Number(h),children:[e.jsx("g",{className:"pie-chart-sections",role:"graphics-datagroup",children:X.map((n,o)=>{const{startX:d,startY:i,endX:p,endY:v,label:j,value:C,startAngle:b,endAngle:N}=n,u=N-b>Math.PI?1:0,T=new w;return T.moveTo(t,t),T.lineTo(d,i),T.arcTo(t,t,0,u,1,p,v),T.close(),e.jsx("path",{d:T.instructionToString(),"data-label":j,role:"graphics-datascale","aria-valuemax":C/A},o)})}),e.jsx("g",{className:"pie-chart-tooltip-hitboxes",children:X.map((n,o)=>{const{startX:d,startY:i,endX:p,endY:v,label:j,endAngle:C,startAngle:b}=n,N=C-b>Math.PI?1:0,u=new w;return u.moveTo(t,t),u.lineTo(d,i),u.arcTo(t,t,0,N,1,p,v),u.close(),e.jsx(_.Provider,{value:n,children:e.jsxs("g",{className:"pie-chart-tooltip-hitbox",children:[e.jsx("path",{className:"pie-chart-section-hitbox",d:u.instructionToString(),"data-label":j},o),e.jsx(F,{})]})},o)})})]})})})};function q(r,a,l,s){const m=r*.5,g=a*.5;if(s.endAngle>=2*Math.PI&&s.startAngle<=0)return[m,g];const P=(s.endAngle+s.startAngle)/2,c=m+Math.cos(P)*l,h=g+Math.sin(P)*l;return[c,h]}const H=2/3,F=()=>{const r=x.useContext(y),a=x.useContext(f),l=x.useContext(_);if(!l)return e.jsx(e.Fragment,{});const[s,m]=q(a,r,Math.min(a,r)*.5*H,l);return e.jsx(R.Provider,{value:O,children:e.jsx(z.Provider,{value:Number(s),children:e.jsx(E.Provider,{value:Number(m),children:e.jsx(L.Provider,{value:s/a,children:e.jsx(k,{})})})})})},O=()=>{const r=x.useContext(_);return r?e.jsxs(U,{x:0,y:W,textAnchor:"start",children:[e.jsx(Y,{text:r.label}),e.jsx(Y,{text:" "}),e.jsx(I,{number:r.value})]}):e.jsx(e.Fragment,{})},D=()=>{const r=x.useContext(G);return e.jsx(S,{values:r})};try{V.displayName="PieChartLabelContext",V.__docgenInfo={description:"",displayName:"PieChartLabelContext",props:{}}}catch{}try{S.displayName="PieChart",S.__docgenInfo={description:"PieChart is a component that takes the given data and creates a pie chart",displayName:"PieChart",props:{values:{defaultValue:null,description:"",name:"values",required:!0,type:{name:"PieChartEntry[]"}}}}}catch{}try{D.displayName="PieChartFromData",D.__docgenInfo={description:"PieChartFromData is a convenience component that uses the DataContext,\ninterpreted as a list of entries of type `PieChartEntry`, to render a\nPieChart.",displayName:"PieChartFromData",props:{}}}catch{}export{D as P,S as a,V as b};
