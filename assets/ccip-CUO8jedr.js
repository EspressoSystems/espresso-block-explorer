import{z as f,A as y,C as w,D as k,F as O,G as b,H as L,I as R,J as E,K as x,M as h,O as M}from"./en_US-RFN65H63-BQpMWGaM.js";import"./iframe-DhalQE6g.js";import"./preload-helper-PPVm8Dsz.js";import"./higher_order-rjCqB3wU.js";import"./typography-BVAXx6mN.js";import"./Text-BU7JBOLk.js";import"./CappuccinoHotShotQueryServiceAPIContext-CrpNrgzo.js";import"./UnimplementedError-BEJrC_RV.js";import"./string-B8Rshh3e.js";import"./array_buffer-Dp0JAU74.js";import"./base64-BLHA4cZM.js";import"./functional-CqKsH-G6.js";import"./MissingElementError-C0Z4QoIY.js";import"./url-C1KMHJ_r.js";import"./monetary_value-EEH_Vydd.js";import"./TaggedBase64-BTy5Cvep.js";import"./generateFakeData-BI0Gp2aL.js";import"./sleep-CW-vxfof.js";import"./data-GneXnXE7.js";import"./LoadingProvider-plSsL9kW.js";import"./FetchError-CEWPZz5z.js";import"./NotFoundError-BUbztAVW.js";import"./index-DF41TwKL.js";import"./index-C2NqSSlr.js";import"./TransactionDetailLoader-Dp_V6I8H.js";import"./PromiseResolver-BKLn-jPG.js";import"./ProvideAsyncStates-Ak1Lk5Aw.js";import"./PathResolverProvider-OkjeJArZ.js";import"./DataTable-BKF5euvk.js";import"./ChevronUp-DNPN_4Gv.js";import"./SVGIconBase-DFPJZAw4.js";import"./LabeledAnchorButton-kJ5kitAk.js";import"./AnchorButton-L-GS_Agi.js";import"./DateTimeFormattersProvider-Byy5ZfRy.js";import"./LocaleProvider-vur0MvWU.js";import"./NavDrawerStateProvider-BOM6Rgvv.js";import"./NowProvider-Cxgig7md.js";import"./NumberFormattersProvider-BmlPtdZ5.js";import"./AsyncIterableResolver-CDHpntym.js";class S extends f{constructor({callbackSelector:a,cause:e,data:s,extraData:n,sender:i,urls:r}){super(e.shortMessage||"An error occurred while fetching for an offchain result.",{cause:e,metaMessages:[...e.metaMessages||[],e.metaMessages?.length?"":[],"Offchain Gateway Call:",r&&["  Gateway URL(s):",...r.map(c=>`    ${y(c)}`)],`  Sender: ${i}`,`  Data: ${s}`,`  Callback selector: ${a}`,`  Extra data: ${n}`].flat(),name:"OffchainLookupError"})}}class $ extends f{constructor({result:a,url:e}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${y(e)}`,`Response: ${w(a)}`],name:"OffchainLookupResponseMalformedError"})}}class q extends f{constructor({sender:a,to:e}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${e}`,`OffchainLookup sender address: ${a}`],name:"OffchainLookupSenderMismatchError"})}}const we="0x556f1830",C={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function ge(p,{blockNumber:a,blockTag:e,data:s,to:n}){const{args:i}=k({data:s,abi:[C]}),[r,c,m,t,o]=i,{ccipRead:d}=p,u=d&&typeof d?.request=="function"?d.request:G;try{if(!O(n,r))throw new q({sender:r,to:n});const l=c.includes(b)?await L({data:m,ccipRequest:u}):await u({data:m,sender:r,urls:c}),{data:g}=await R(p,{blockNumber:a,blockTag:e,data:E([t,x([{type:"bytes"},{type:"bytes"}],[l,o])]),to:n});return g}catch(l){throw new S({callbackSelector:t,cause:l,data:s,extraData:o,sender:r,urls:c})}}async function G({data:p,sender:a,urls:e}){let s=new Error("An unknown error occurred.");for(let n=0;n<e.length;n++){const i=e[n],r=i.includes("{data}")?"GET":"POST",c=r==="POST"?{data:p,sender:a}:void 0,m=r==="POST"?{"Content-Type":"application/json"}:{};try{const t=await fetch(i.replace("{sender}",a.toLowerCase()).replace("{data}",p),{body:JSON.stringify(c),headers:m,method:r});let o;if(t.headers.get("Content-Type")?.startsWith("application/json")?o=(await t.json()).data:o=await t.text(),!t.ok){s=new h({body:c,details:o?.error?w(o.error):t.statusText,headers:t.headers,status:t.status,url:i});continue}if(!M(o)){s=new $({result:o,url:i});continue}return o}catch(t){s=new h({body:c,details:t.message,url:i})}}throw s}export{G as ccipRequest,ge as offchainLookup,C as offchainLookupAbiItem,we as offchainLookupSignature};
