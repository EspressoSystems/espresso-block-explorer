var V=Object.defineProperty;var j=(r,e,t)=>e in r?V(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var c=(r,e,t)=>(j(r,typeof e!="symbol"?e+"":e,t),t);import{A as k,f as z,g as J,T as y,i as R,I as F,h as K,r as M,B as I,a as x,b as D,s as B,e as P,c as S,d as W}from"./string-BgQ3tcOU.js";class q{convert(e){if(!R(e))throw new F(typeof e,"number");return e}}class G{convert(e){return K(e,"number"),e}}class H extends y{constructor(){super(...arguments);c(this,"encoder",new G);c(this,"decoder",new q)}}const u=new H,fe=new k(new z(u),new J(u));class l extends I{constructor(t,s=`corrupt input error at ${t}`){super(s);c(this,"offset");this.offset=t,Object.freeze(this)}toJSON(){return T.encode(this)}}class Q{convert(e){return x(e,"code","offset","message"),D(e,l.name),new l(u.decode(e.offset),B.decode(e.message))}}class X{convert(e){return P(e,l),{...S.convert(e),offset:u.encode(e.offset),message:B.encode(e.message)}}}class Y extends y{constructor(){super(...arguments);c(this,"encoder",new X);c(this,"decoder",new Q)}}const T=new Y;M(l.name,T);class m extends I{constructor(e="incorrect padding"){super(e),Object.freeze(this)}}class Z{convert(e){return x(e,"code","message"),D(e,m.name),new m(B.decode(e.message))}}class $ extends W{}class _ extends y{constructor(){super(...arguments);c(this,"encoder",new $);c(this,"decoder",new Z)}}const ee=new _;M(m.name,ee);class p extends I{constructor(t,s=`alphabet needs to be 64 characters, received ${t}`){super(s);c(this,"length");this.length=t,Object.freeze(this)}toJSON(){return N.encode(this)}}class te{convert(e){return x(e,"code","length","message"),D(e,p.name),new p(u.decode(e.length),B.decode(e.message))}}class re{convert(e){return P(e,p),{...S.convert(e),length:u.encode(e.length)}}}class ne extends y{constructor(){super(...arguments);c(this,"encoder",new re);c(this,"decoder",new te)}}const N=new ne;M(p.name,N);const se=new TextEncoder;function O(r){return se.encode(r)}const oe=new TextDecoder;function ce(r){return oe.decode(r)}function*ae(r){yield*O(r)}function*de(){for(let r=0;r<256;r++)yield 255}const U=-1,ie=61;class b{constructor(e,t,s=ie,i=!1){c(this,"encodeMap");c(this,"decodeMap");c(this,"padChar");c(this,"strict");this.encodeMap=e,this.decodeMap=t,this.padChar=s,this.strict=i}static withAlphabet(e){const t=e.length;if(t!==64)throw new p(t);const s=Array.from(ae(e)),i=Array.from(de());for(let h=0;h<t;h++)i[s[h]]=h;return new b(s,i)}withPadding(e){return new b(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let t=0,s=0;const i=Math.floor(e.byteLength/3)*3,h=Math.ceil(e.byteLength/3)*4,g=new ArrayBuffer(h),o=new DataView(e),a=new DataView(g);for(;s<i;){const f=o.getUint8(s+0)<<16|o.getUint8(s+1)<<8|o.getUint8(s+2);a.setUint8(t+0,this.encodeMap[f>>18&63]),a.setUint8(t+1,this.encodeMap[f>>12&63]),a.setUint8(t+2,this.encodeMap[f>>6&63]),a.setUint8(t+3,this.encodeMap[f&63]),s+=3,t+=4}const n=e.byteLength-s;if(n===0)return g;let w=o.getUint8(s+0)<<16;switch(n===2&&(w|=o.getUint8(s+1)<<8),a.setUint8(t+0,this.encodeMap[w>>18&63]),a.setUint8(t+1,this.encodeMap[w>>12&63]),n){case 2:return a.setUint8(t+2,this.encodeMap[w>>6&63]),this.padChar!==U?(a.setUint8(t+3,this.padChar),g.slice(0,t+4)):g.slice(0,t+3);case 1:if(this.padChar!==U)return a.setUint8(t+2,this.padChar),a.setUint8(t+3,this.padChar),g.slice(0,t+4);break}return g.slice(0,t+2)}decode(e){const t=e.byteLength;if(t===0)return new ArrayBuffer(0);const s=new DataView(e),i=new ArrayBuffer(Math.floor(t/4*3)),h=new DataView(i),g=new ArrayBuffer(4),o=new DataView(g);let a=0,n=0,w=0,f=!1;for(;n<t&&!f;){let A=3,E=4;for(let d=0;d<4;d++){if(n===t){if(d===0)return i;if(d===1||this.padChar!==U)throw new l(n-d);A=d-1,E=d,f=!0;break}const C=s.getUint8(n);n++;const L=this.decodeMap[C];if(L!==255){o.setUint8(d,L);continue}if(C===10||C===13){d--;continue}if(C===this.padChar){switch(d){case 0:case 1:throw new m;case 2:for(;n<t&&(s.getUint8(n)===10||s.getUint8(n)===13);)n++;if(n===t)throw new l(t);n++}for(;n<t&&(s.getUint8(n)===10||s.getUint8(n)===13);)n++;if(n<t)throw new l(n);A=3,E=d,f=!0;break}throw new l(n-1)}const v=o.getUint8(0)<<18|o.getUint8(1)<<12|o.getUint8(2)<<6|o.getUint8(3);switch(o.setUint8(2,v>>0&255),o.setUint8(1,v>>8&255),o.setUint8(0,v>>16&255),E){case 4:h.setUint8(w+2,o.getUint8(2)),o.setUint8(2,0);case 3:if(h.setUint8(w+1,o.getUint8(1)),this.strict&&o.getUint8(2)!==0)throw new l(n-1);case 2:if(h.setUint8(w+0,o.getUint8(0)),this.strict&&(o.getUint8(1)!==0||o.getUint8(2)!==0))throw new l(n-2)}w+=A,a+=E-1}return i.slice(0,a)}decodeString(e){return this.decode(O(e).buffer)}encodeToString(e){return ce(this.encode(e))}}const he=b.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ue=he.withPadding(U),le=b.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Ue=le.withPadding(U);export{ue as a,fe as b,ae as c,u as n,Ue as r,he as s,le as u};
