import{F as l,G as y,H as w,I as k,J as O,K as b,M as L,O as E,Q as x,U as R,V as h,X as M}from"./en_US-RFN65H63-OTC6LdPs.js";import"./iframe-zEcEksBb.js";import"./higher_order-BfTEeOwN.js";import"./typography-B3yGvuWM.js";import"./Text-BU7JBOLk.js";import"./CappuccinoHotShotQueryServiceAPIContext-DC1WOFXZ.js";import"./UnimplementedError-17tXTyU9.js";import"./string-D0u4-xyR.js";import"./array_buffer-BKVV0l5M.js";import"./base64-Dx-bhXjM.js";import"./functional-BS7OJ5eK.js";import"./MissingElementError-YFeWEE8W.js";import"./url-BL_yoWaS.js";import"./monetary_value-CZcT9WbV.js";import"./TaggedBase64-KfoUSl3M.js";import"./generateFakeData-UQf8nJ8g.js";import"./sleep-CW-vxfof.js";import"./data-Cr5z5ONv.js";import"./LoadingProvider-BMrX2k61.js";import"./FetchError-DsbqzoSu.js";import"./NotFoundError-Dda3nNUu.js";import"./index-CgQfVK4-.js";import"./PromiseResolver-BiyWZgkv.js";import"./ProvideAsyncStates-xIzp1Eue.js";import"./PathResolverProvider-BY6HTwpT.js";import"./DataTable-DTduNdJP.js";import"./ChevronUp-NICuEiX9.js";import"./SVGIconBase-BNeTmGDn.js";import"./LabeledAnchorButton-DdIZ5ze5.js";import"./AnchorButton-DSnULDw6.js";import"./DateTimeFormattersProvider-D90xWuNL.js";import"./LocaleProvider-ysY4q8_d.js";import"./NavDrawerStateProvider-3p1xyIAP.js";import"./NowProvider-BzxzTsO6.js";import"./NumberFormattersProvider-DB0fdcoi.js";import"./AsyncIterableResolver-DG60zIvE.js";class S extends l{constructor({callbackSelector:o,cause:t,data:n,extraData:c,sender:m,urls:r}){var s;super(t.shortMessage||"An error occurred while fetching for an offchain result.",{cause:t,metaMessages:[...t.metaMessages||[],(s=t.metaMessages)!=null&&s.length?"":[],"Offchain Gateway Call:",r&&["  Gateway URL(s):",...r.map(p=>`    ${y(p)}`)],`  Sender: ${m}`,`  Data: ${n}`,`  Callback selector: ${o}`,`  Extra data: ${c}`].flat(),name:"OffchainLookupError"})}}class $ extends l{constructor({result:o,url:t}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${y(t)}`,`Response: ${w(o)}`],name:"OffchainLookupResponseMalformedError"})}}class q extends l{constructor({sender:o,to:t}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${t}`,`OffchainLookup sender address: ${o}`],name:"OffchainLookupSenderMismatchError"})}}const ue="0x556f1830",G={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function he(i,{blockNumber:o,blockTag:t,data:n,to:c}){const{args:m}=k({data:n,abi:[G]}),[r,s,p,d,a]=m,{ccipRead:e}=i,u=e&&typeof(e==null?void 0:e.request)=="function"?e.request:T;try{if(!O(c,r))throw new q({sender:r,to:c});const f=s.includes(b)?await L({data:p,ccipRequest:u}):await u({data:p,sender:r,urls:s}),{data:g}=await E(i,{blockNumber:o,blockTag:t,data:x([d,R([{type:"bytes"},{type:"bytes"}],[f,a])]),to:c});return g}catch(f){throw new S({callbackSelector:d,cause:f,data:n,extraData:a,sender:r,urls:s})}}async function T({data:i,sender:o,urls:t}){var c;let n=new Error("An unknown error occurred.");for(let m=0;m<t.length;m++){const r=t[m],s=r.includes("{data}")?"GET":"POST",p=s==="POST"?{data:i,sender:o}:void 0,d=s==="POST"?{"Content-Type":"application/json"}:{};try{const a=await fetch(r.replace("{sender}",o.toLowerCase()).replace("{data}",i),{body:JSON.stringify(p),headers:d,method:s});let e;if((c=a.headers.get("Content-Type"))!=null&&c.startsWith("application/json")?e=(await a.json()).data:e=await a.text(),!a.ok){n=new h({body:p,details:e!=null&&e.error?w(e.error):a.statusText,headers:a.headers,status:a.status,url:r});continue}if(!M(e)){n=new $({result:e,url:r});continue}return e}catch(a){n=new h({body:p,details:a.message,url:r})}}throw n}export{T as ccipRequest,he as offchainLookup,G as offchainLookupAbiItem,ue as offchainLookupSignature};
