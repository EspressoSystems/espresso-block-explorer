(function(){"use strict";class As{assert(){}}function Ds(){return new As}const Ts=Ds();function k(r,e){Ts.assert(r,e)}function Me(r,e){k(typeof r===e,`type assertion failed: expected "${e}", received "${typeof r}"`)}function Us(r){k(r!==null,"expected a non-null value, received null")}function u(r,e){k(r instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof r=="object"&&r!==null?r.constructor.name:typeof r}"`)}class Cr extends Error{key;haveType;constructor(e,t,o=`expected object with key: "${t}", instead found ${e}`){super(o),this.haveType=e,this.key=t,Object.freeze(this)}toJSON(){return{code:Cr.name,message:this.message,have:this.haveType,key:this.key}}}class E{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class i extends E{}function Ns(r){return typeof r=="boolean"}function yr(r){return typeof r=="number"}function ce(r){return typeof r=="string"}function Ps(r){return typeof r=="bigint"}function _s(r){return typeof r=="object"&&r!==null}function _(r){return r!==void 0}function Ls(r,e){return Array.isArray(r)&&r.every(e)}function Os(r){return e=>Ls(e,r)}function F(r,e,t){return _s(r)&&e in r&&t(r[e])}function d(r,...e){if(typeof r!="object")throw new Error("expected object");if(r===null)throw new Error("received null");for(const t of e)if(!(t in r))throw new Cr("object",t)}function y(r,e){if(!ce(r.code))throw new Error("code must be a string");if(r.code!==e)throw new Error(`expected code to be ${e}, got ${r.code}`)}class v extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return z.convert(this)}}class L{convert(e){return u(e,v),{code:e.code,message:e.message}}}const z=new L,Ms="NoCodecFoundError";class Fe extends Error{codec;constructor(e,t=`no codec found for: "${e}"`){super(t),this.codec=e,Object.freeze(this);debugger}toJSON(){return{code:h.encode(Fe.name),message:h.encode(this.message),codec:h.encode(this.codec)}}get code(){return Ms}}const vr=new Map;class Fs{convert(e){d(e,"code");const t=h.decode(e.code),o=vr.get(t);if(!o)throw new Fe(t);return o.decode(e)}}class Hs{convert(e){const t=vr.get(e.code);if(!t)throw new Fe(e.code);return t.encode(e)}}class zs extends E{encoder=new Hs;decoder=new Fs}const Z=new zs;function b(r,e){vr.set(r,e)}const br="InvalidTypeError";class T extends v{have;want;constructor(e,t,o=`invalid type: have "${e}", want "${t}"`){super(o),this.have=e,this.want=t,Object.freeze(this)}toJSON(){return ko.encode(this)}get code(){return br}}class Gs{convert(e){return d(e,"code","have","want","message"),y(e,br),new T(h.decode(e.have),h.decode(e.want),h.decode(e.message))}}class Ws{convert(e){return u(e,T),{...z.convert(e),have:h.encode(e.have),want:h.encode(e.want)}}}class Js extends i{encoder=new Ws;decoder=new Gs}const ko=new Js;b(br,ko);const Ro=Os(_);class qs{convert(e){return e}}const Io=new qs;class js extends E{encoder=Io;decoder=Io}const He=new js;class B{itemCodec;constructor(e){this.itemCodec=e}convert(e){if(!Ro(e)){const t=typeof e=="object"&&e!==null?e.constructor.name:typeof e,o="array";throw new Error(`invalid array value: have "${t}", want "${o}"`)}return e.map(t=>this.itemCodec.decode(t))}}class A{itemCodec;constructor(e){this.itemCodec=e}convert(e){return u(e,Array),e.map(t=>this.itemCodec.encode(t))}}class D extends i{encoder;decoder;constructor(e,t){super(),this.encoder=t,this.decoder=e}}class G{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class W{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:(Us(e),this.itemCodec.encode(e))}}class J extends i{encoder;decoder;constructor(e,t){super(),this.encoder=t,this.decoder=e}}class Vs{convert(e){if(!ce(e))throw new T(typeof e,"string");return e}}class $s{convert(e){return Me(e,"string"),e}}class Qs extends i{encoder=new $s;decoder=new Vs}const h=new Qs;new D(new B(h),new A(h)),new J(new G(h),new W(h));class xr extends v{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return Bo}}const Bo="CompleterAlreadyCompletedError";class Xs{convert(e){return d(e,"code","message"),y(e,Bo),new xr(h.decode(e.message))}}class Ks extends L{}class Ys extends i{encoder=new Ks;decoder=new Xs}const Zs=new Ys;b(xr.name,Zs);function ze(){k(!1,"completer is not ready, this should never be reached")}function Ge(){throw new xr}class ec{resolve=ze;reject=ze;completed=!1;promise;get isCompleted(){return this.completed}constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),k(this.resolve!==ze,"resolve should be set"),k(this.reject!==ze,"resolve should be set")}complete(e){const t=this.resolve,o=this.reject;if(this.completed=!0,this.resolve=Ge,this.reject=Ge,e instanceof Promise){e.then(t,o);return}t(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=Ge,this.reject=Ge}}function Er(){return new ec}class Ce extends v{response;status;constructor(e,t,o){super(o),this.status=e,this.response=t}toJSON(){return Ao.convert(this)}}class We{convert(e){return u(e,Ce),{...z.convert(e),status:e.status}}}const Ao=new We,Sr="BadResponseClientError";class Do extends Ce{constructor(e,t,o="bad server response: client error"){super(e,t,o),Object.freeze(this)}get code(){return Sr}toJSON(){return To.encode(this)}}class rc{convert(e){return d(e,"code","message","status"),y(e,Sr),new Do(Number(e.status),null,h.decode(e.message))}}class tc extends We{}class oc extends i{encoder=new tc;decoder=new rc}const To=new oc;b(Sr,To);const kr="BadResponseError";class Uo extends Ce{constructor(e,t,o="bad server response"){super(e,t,o),Object.freeze(this)}get code(){return kr}toJSON(){return No.encode(this)}}class nc{convert(e){return d(e,"code","message","status"),y(e,kr),new Uo(Number(e.status),null,h.decode(e.message))}}class sc extends We{}class cc extends i{encoder=new sc;decoder=new nc}const No=new cc;b(kr,No);class Po extends Ce{constructor(e,t,o="bad server response: server error"){super(e,t,o),Object.freeze(this)}get code(){return Rr}}const Rr="BadResponseServerError";class ac{convert(e){return d(e,"code","message","status"),y(e,Rr),new Po(Number(e.status),null,h.decode(e.message))}}class ic extends We{}class dc extends i{encoder=new ic;decoder=new ac}const lc=new dc;b(Rr,lc);const Ir="ChannelClosedError";class ye extends v{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return Ir}}class uc{convert(e){return d(e,"code","message"),y(e,Ir),new ye(h.decode(e.message))}}class hc extends L{}class pc extends i{encoder=new hc;decoder=new uc}const wc=new pc;b(Ir,wc);const Br="FetchError";class _o extends v{cause;constructor(e,t=`fetch failed: ${String(e)}`){super(t),this.cause=e,Object.freeze(this)}get code(){return Br}}class mc{convert(e){return d(e,"code","message"),y(e,Br),new _o({},h.decode(e.message))}}class fc extends L{}class gc extends i{encoder=new fc;decoder=new mc}const Cc=new gc;b(Br,Cc);const Ar="IncorrectBase64PaddingError";class Lo extends v{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return Ar}}class yc{convert(e){return d(e,"code","message"),y(e,Ar),new Lo(h.decode(e.message))}}class vc extends L{}class bc extends i{encoder=new vc;decoder=new yc}const xc=new bc;b(Ar,xc);class Ec{convert(e){if(!yr(e))throw new T(typeof e,"number");return e}}class Sc{convert(e){return Me(e,"number"),e}}class kc extends i{encoder=new Sc;decoder=new Ec}const s=new kc,Oo=new J(new G(s),new W(s)),$=new D(new B(s),new A(s)),ee=new D(new B(Oo),new A(Oo)),Dr="InvalidBase64AlphabetLengthError";class Tr extends v{length;constructor(e,t=`alphabet needs to be 64 characters, received ${e}`){super(t),this.length=e,Object.freeze(this)}toJSON(){return Mo.encode(this)}get code(){return Dr}}class Rc{convert(e){return d(e,"code","length","message"),y(e,Dr),new Tr(s.decode(e.length),h.decode(e.message))}}class Ic{convert(e){return u(e,Tr),{...z.convert(e),length:s.encode(e.length)}}}class Bc extends i{encoder=new Ic;decoder=new Rc}const Mo=new Bc;b(Dr,Mo);const Ur="InvalidHexStringError";class Fo extends v{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return Ur}}class Ac{convert(e){return d(e,"code","message"),y(e,Ur),new Fo(h.decode(e.message))}}class Dc extends L{}class Tc extends i{encoder=new Dc;decoder=new Ac}const Uc=new Tc;b(Ur,Uc);const Nr="InvalidHexValueError";class Ho extends v{value;constructor(e,t=`invalid hex value "${e}"`){super(t),this.value=e,Object.freeze(this)}toJSON(){return zo.encode(this)}get code(){return Nr}}class Nc{convert(e){return d(e,"code","value","message"),y(e,Nr),new Ho(s.decode(e.value),h.decode(e.message))}}class Pc{convert(e){return{...z.convert(e),value:s.encode(e.value)}}}class _c extends i{encoder=new Pc;decoder=new Nc}const zo=new _c;b(Nr,zo);const Pr="InvalidInputError";class O extends v{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return Pr}}class Lc{convert(e){return d(e,"code","message"),y(e,Pr),new O(h.decode(e.message))}}class Oc extends L{}class Mc extends i{encoder=new Oc;decoder=new Lc}const Fc=new Mc;b(Pr,Fc);const _r="InvalidStringValueError";class Go extends v{have;want;constructor(e,t,o=`invalid string value: have "${e}", want "${t}"`){super(o),this.have=e,this.want=t,Object.freeze(this)}toJSON(){return Wo.encode(this)}get code(){return _r}}class Hc{convert(e){return d(e,"code","have","want","message"),y(e,_r),new Go(h.decode(e.have),h.decode(e.want),h.decode(e.message))}}class zc{convert(e){return u(e,Go),{...z.convert(e),have:h.encode(e.have),want:h.encode(e.want)}}}class Gc extends i{encoder=new zc;decoder=new Hc}const Wo=new Gc;b(_r,Wo);const Lr="InvalidTaggedBase64EncodingError";class Jo extends v{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return qo.encode(this)}get code(){return Lr}}class Wc{convert(e){return d(e,"code","message"),y(e,Lr),new Jo(h.decode(e.message))}}class Jc extends L{}class qc extends i{encoder=new Jc;decoder=new Wc}const qo=new qc;b(Lr,qo);const Or="MissingElementError";class ve extends v{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return Or}}class jc{convert(e){return d(e,"code","message"),y(e,Or),new ve(h.decode(e.message))}}class Vc extends L{}class $c extends i{encoder=new Vc;decoder=new jc}const Qc=new $c;b(Or,Qc);const Mr="NoCompleterFoundForRequestID";class jo extends v{requestID;constructor(e,t=`no completer found for request id "${e}"`){super(t),this.requestID=e,Object.freeze(this)}toJSON(){return Vo.encode(this)}get code(){return Mr}}class Xc{convert(e){return d(e,"code","requestID","message"),y(e,Mr),new jo(He.decode(e.requestID),h.decode(e.message))}}class Kc{convert(e){return u(e,jo),{...z.convert(e),requestID:He.encode(e.requestID)}}}class Yc extends i{encoder=new Kc;decoder=new Xc}const Vo=new Yc;b(Mr,Vo);const Fr="NotFoundError";class $o extends v{key;constructor(e,t=`Not Found: ${e}`){super(t),this.key=e,Object.freeze(this)}get code(){return Fr}}class Qo{codec;constructor(e){this.codec=e}convert(e){return d(e,"code","key"),y(e,Fr),new $o(this.codec.decode(e.key))}}class Xo{codec;constructor(e){this.codec=e}convert(e){return{...z.convert(e),key:this.codec.encode(e.key)}}}class Ko extends i{encoder;decoder;constructor(e,t){super(),this.encoder=e,this.decoder=t}}new Ko(new Xo(h),new Qo(h));const Zc=new Ko(new Xo(He),new Qo(He));b(Fr,Zc);const Hr="NoURLProvidedError";class ea extends v{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return Hr}}class ra{convert(e){return d(e,"code","message"),y(e,Hr),new ea(h.decode(e.message))}}class ta extends L{}class oa extends i{encoder=new ta;decoder=new ra}const na=new oa;b(Hr,na);const zr="UnimplementedError";class U extends v{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return zr}}class sa{convert(e){return d(e,"code","message"),y(e,zr),new U(h.decode(e.message))}}class ca extends L{}class aa extends i{encoder=new ca;decoder=new sa}const ia=new aa;b(zr,ia);const Gr="QUERY_ERROR";class da extends v{error;constructor(e,t="missing element"){super(t),this.error=e,Object.freeze(this)}get code(){return Gr}}class la{convert(e){return d(e,"code","error","message"),y(e,Gr),new da(rn.decode(e.error),h.decode(e.message))}}class ua{convert(e){return{code:e.code,error:rn.encode(e.error),message:h.encode(e.message)}}}class ha extends i{encoder=new ua;decoder=new la}const pa=new ha;class Wr{}const Jr="NotFound";class Yo extends Wr{constructor(){super(),Object.freeze(this)}valueOf(){return Jr}toJSON(){return this.valueOf()}}const wa=new Yo,qr="Missing";class Zo extends Wr{constructor(){super(),Object.freeze(this)}valueOf(){return qr}toJSON(){return this.valueOf()}}const ma=new Zo;class en extends Wr{error;constructor(e){super(),this.error=e,Object.freeze(this)}toJSON(){return Vr.encode(this)}}class fa{message;constructor(e){this.message=e,Object.freeze(this)}toJSON(){return jr.encode(this)}}class ga{convert(e){return d(e,"message"),new fa(h.decode(e.message))}}class Ca{convert(e){return{message:h.encode(e.message)}}}class ya extends i{encoder=new Ca;decoder=new ga}const jr=new ya;class va{convert(e){return d(e,"Error"),new en(jr.decode(e.Error))}}class ba{convert(e){return{Error:jr.encode(e.error)}}}class xa extends i{encoder=new ba;decoder=new va}const Vr=new xa;class Ea{convert(e){return e===Jr?wa:e===qr?ma:Vr.decode(e)}}class Sa{convert(e){if(e instanceof Yo)return Jr;if(e instanceof Zo)return qr;if(e instanceof en)return Vr.encode(e);throw new U}}class ka extends i{encoder=new Sa;decoder=new Ea}const rn=new ka;b(Gr,pa);const tn="ResponseContentTypeIsNotApplicationJSONError";class be extends Ce{haveHeaderType;constructor(e,t,o,n="response content type is not application/json"){super(t,o,n),this.haveHeaderType=e,Object.freeze(this)}static fromResponse(e,t){return new be(e.headers.get("content-type")??"undefined",e.status,e,t)}toJSON(){return on.encode(this)}get code(){return tn}}class Ra{convert(e){return d(e,"code","status","have","want","message"),y(e,tn),new be(h.decode(e.code),s.decode(e.status),null,h.decode(e.message))}}class Ia{convert(e){return{...Ao.convert(e),have:h.encode(e.haveHeaderType),want:h.encode("application/json")}}}class Ba extends i{encoder=new Ia;decoder=new Ra}const on=new Ba;b(be.name,on);const $r="WebWorkerErrorResponse";class Aa extends v{error;constructor(e,t="error in web worker"){super(t),this.error=e,Object.freeze(this)}toJSON(){return nn.encode(this)}get code(){return $r}}class Da{convert(e){return d(e,"code","error","message"),y(e,$r),new Aa(Z.decode(e.error),h.decode(e.message))}}class Ta{convert(e){return{...z.convert(e),error:Z.encode(e.error)}}}class Ua extends i{encoder=new Ta;decoder=new Da}const nn=new Ua;b($r,nn);var sn=(r=>(r[r.success=0]="success",r[r.full=1]="full",r[r.failed=2]="failed",r))(sn||{});class Na{getFromEmpty(){}}class Pa{getFromEmpty(){throw new ve}}const cn={returnUndefined:new Na,throwMissingElement:new Pa};class _a{maxSize;constructor(e){k(!Number.isNaN(e),"maxSize must not be NaN"),k(Number.isInteger(e),"maxSize must be an integer"),k(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return k(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class La{preComputedSizeMinus1;constructor(e){k(!Number.isNaN(e),"maxSize must not be NaN"),k(Number.isInteger(e),"maxSize must be an integer"),k(e>0,"maxSize must be greater than 0"),k(an(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return k(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function an(r){return(r&r-1)===0}const Qr="BufferFullError";class dn extends v{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return Qr}}class Oa{convert(e){return d(e,"code","message"),y(e,Qr),new dn(h.decode(e.message))}}class Ma extends L{}class Fa extends i{encoder=new Ma;decoder=new Oa}const Ha=new Fa;b(Qr,Ha);class za{putToFull(e,t){return e.get(),e.put(t)}}class Ga{putToFull(){throw new dn}}const ln={overwriteOldest:new za,throw:new Ga};function Wa(r){return an(r)?new La(r):new _a(r)}class Ja{readIndex=0;writeIndex=0;buffer;nextIndex;getOnEmpty;putOnFull;constructor(e,t,o){k(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=Wa(e),this.getOnEmpty=t,this.putOnFull=o}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const t=this.nextIndex.nextIndex(this.writeIndex);return t===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=t,sn.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new qa(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new ja(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class qa{buffer;constructor(e){this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class ja{readIndex;writeIndex;buffer;nextIndex;constructor(e,t,o,n){this.readIndex=e,this.writeIndex=t,this.buffer=o,this.nextIndex=n}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function q(r=32,e=cn.returnUndefined,t=ln.overwriteOldest){return new Ja(r,e,t)}class Va{publishQueue;pollBlocked;publishBlocked;capacity;closed=!1;constructor(e){this.publishQueue=q(Math.max(2,e),cn.throwMissingElement,ln.throw);const t=Er();this.pollBlocked=t,this.publishBlocked=t,t.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new ye;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new ye;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const t=Er();this.publishBlocked=t,await t.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new ye;if(this.pollBlocked.isCompleted){const t=Er();this.pollBlocked=t}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new $a(this)}}class $a{channel;constructor(e){this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof ye)return{done:!0,value:void 0};throw e}}}function Qa(r){return new Va(r)}const Xr="CorruptBase64InputError";class re extends v{offset;constructor(e,t=`corrupt input error at ${e}`){super(t),this.offset=e,Object.freeze(this)}get code(){return Xr}toJSON(){return un.encode(this)}}class Xa{convert(e){return d(e,"code","offset","message"),y(e,Xr),new re(s.decode(e.offset),h.decode(e.message))}}class Ka{convert(e){return u(e,re),{...z.convert(e),offset:s.encode(e.offset),message:h.encode(e.message)}}}class Ya extends i{encoder=new Ka;decoder=new Xa}const un=new Ya;b(Xr,un);class Za{convert(e){const t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(e),t}}class ei{convert(e){return new Uint8Array(e)}}class ri extends i{encoder=new Za;decoder=new ei}const ti=new ri,oi=new TextEncoder;function hn(r){return oi.encode(r)}const ni=new TextDecoder;function si(r){return ni.decode(r)}function*pn(r){yield*hn(r)}function*ci(){for(let r=0;r<256;r++)yield 255}const xe=-1,ai=61;class Ee{encodeMap;decodeMap;padChar;strict;constructor(e,t,o=ai,n=!1){this.encodeMap=e,this.decodeMap=t,this.padChar=o,this.strict=n}static withAlphabet(e){const t=e.length;if(t!==64)throw new Tr(t);const o=Array.from(pn(e)),n=Array.from(ci());for(let c=0;c<t;c++)n[o[c]]=c;return new Ee(o,n)}withPadding(e){return new Ee(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let t=0,o=0;const n=Math.floor(e.byteLength/3)*3,c=Math.ceil(e.byteLength/3)*4,a=new ArrayBuffer(c),l=new DataView(e),m=new DataView(a);for(;o<n;){const f=l.getUint8(o+0)<<16|l.getUint8(o+1)<<8|l.getUint8(o+2);m.setUint8(t+0,this.encodeMap[f>>18&63]),m.setUint8(t+1,this.encodeMap[f>>12&63]),m.setUint8(t+2,this.encodeMap[f>>6&63]),m.setUint8(t+3,this.encodeMap[f&63]),o+=3,t+=4}const p=e.byteLength-o;if(p===0)return a;let C=l.getUint8(o+0)<<16;switch(p===2&&(C|=l.getUint8(o+1)<<8),m.setUint8(t+0,this.encodeMap[C>>18&63]),m.setUint8(t+1,this.encodeMap[C>>12&63]),p){case 2:return m.setUint8(t+2,this.encodeMap[C>>6&63]),this.padChar!==xe?(m.setUint8(t+3,this.padChar),a.slice(0,t+4)):a.slice(0,t+3);case 1:if(this.padChar!==xe)return m.setUint8(t+2,this.padChar),m.setUint8(t+3,this.padChar),a.slice(0,t+4);break}return a.slice(0,t+2)}decode(e){const t=e.byteLength;if(t===0)return new ArrayBuffer(0);const o=new DataView(e),n=new ArrayBuffer(Math.floor(t/4*3)),c=new DataView(n),a=new ArrayBuffer(4),l=new DataView(a);let m=0,p=0,C=0,f=!1;for(;p<t&&!f;){let S=3,H=4;for(let I=0;I<4;I++){if(p===t){if(I===0)return n;if(I===1||this.padChar!==xe)throw new re(p-I);S=I-1,H=I,f=!0;break}const V=o.getUint8(p);p++;const Bs=this.decodeMap[V];if(Bs!==255){l.setUint8(I,Bs);continue}if(V===10||V===13){I--;continue}if(V===this.padChar){switch(I){case 0:case 1:throw new Lo;case 2:for(;p<t&&(o.getUint8(p)===10||o.getUint8(p)===13);)p++;if(p===t)throw new re(t);p++}for(;p<t&&(o.getUint8(p)===10||o.getUint8(p)===13);)p++;if(p<t)throw new re(p);S=3,H=I,f=!0;break}throw new re(p-1)}const N=l.getUint8(0)<<18|l.getUint8(1)<<12|l.getUint8(2)<<6|l.getUint8(3);switch(l.setUint8(2,N>>0&255),l.setUint8(1,N>>8&255),l.setUint8(0,N>>16&255),H){case 4:c.setUint8(C+2,l.getUint8(2)),l.setUint8(2,0);case 3:if(c.setUint8(C+1,l.getUint8(1)),this.strict&&l.getUint8(2)!==0)throw new re(p-1);case 2:if(c.setUint8(C+0,l.getUint8(0)),this.strict&&(l.getUint8(1)!==0||l.getUint8(2)!==0))throw new re(p-2)}C+=S,m+=H-1}return n.slice(0,m)}decodeString(e){return this.decode(ti.encode(hn(e)))}encodeToString(e){return si(this.encode(e))}}const wn=Ee.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ii=wn.withPadding(xe),mn=Ee.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Kr=mn.withPadding(xe);class di{value;next;constructor(e,t){this.value=e,this.next=t}[Symbol.iterator](){return fn(this)}}function li(r,e){return new di(e,r)}function*fn(r){if(r!==null)for(let e=r;e!==null;e=e.next)yield e.value}function*ui(r,e){for(let t=r.next();!t.done;t=r.next())e(t.value)&&(yield t.value)}function hi(r,e){return ui(r[Symbol.iterator](),e)}function*gn(r,e){for(let t=r.next();!t.done;t=r.next())yield e(t.value)}function pi(r,e){return gn(r[Symbol.iterator](),e)}function*wi(r,e){for(let t=0;t<e;t++){const o=r.next();if(o.done)return;yield o.value}}function mi(r,e){return wi(r[Symbol.iterator](),e)}function fi(r){let e;for(let t=r.next();!t.done;t=r.next())e=t.value;if(e===void 0)throw new ve;return e}function gi(r){return fi(r[Symbol.iterator]())}function*Ci(){let r=0;for(;;)yield r++}function yi(r){return mi(Ci(),Math.ceil(r))}function*vi(r,e,t){for(let o=r.next(),n=e.next();!o.done&&!n.done;o=r.next(),n=e.next())yield t(o.value,n.value)}function bi(r,e,t){return vi(r[Symbol.iterator](),e[Symbol.iterator](),t)}function Yr(r){if(r.startsWith("0x"))return Yr(r.substring(2));if((r.length&1)!==0)return Yr("0"+r);const e=new ArrayBuffer(r.length/2);return xi(pn(r),e),e}function xi(r,e){const t=new DataView(e);let o=0;for(;o<e.byteLength;){const n=r.next(),c=r.next();if(n.done||c.done)throw new Fo;const a=Cn(n.value),l=Cn(c.value),m=a<<4|l;t.setUint8(o,m),o++}}function Cn(r){if(r>=48&&r<=57)return r-48;if(r>=97&&r<=102)return r-97+10;if(r>=65&&r<=70)return r-65+10;throw new Ho(r)}function Ei(r){return r.toString(16).padStart(2,"0")}function*Si(r){yield*gn(r,Ei)}function ki(r){return Si(r[Symbol.iterator]())}class Ri{convert(e){if(typeof e!="string")throw new T(typeof e,"string");return Yr(e)}}class Ii{convert(e){return`0x${Array.from(ki(new Uint8Array(e))).join("")}`}}class Bi extends i{encoder=new Ii;decoder=new Ri}const R=new Bi;new J(new G(R),new W(R));const yn=new D(new B(R),new A(R));class Ai{convert(e){return e instanceof Array?yn.decode(e):[R.decode(e)]}}class Di{convert(e){return yn.encode(e)}}class Ti extends i{encoder=new Di;decoder=new Ai}const te=new Ti;class Ui{encoding;constructor(e){this.encoding=e}convert(e){if(typeof e!="string")throw new T(typeof e,"string");return this.encoding.decodeString(e)}}class Ni{encoding;constructor(e){this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class Je extends i{encoder;decoder;constructor(e){super(),this.encoder=new Ni(e),this.decoder=new Ui(e)}}new Je(Kr),new Je(ii);const vn=new Je(mn),qe=new Je(wn);new J(new G(qe),new W(qe));class Pi{convert(e){if(Ps(e))return e;if(yr(e))return BigInt(e);if(!ce(e))throw new T(typeof e,"string | bigint | number");return BigInt(e)}}class _i{convert(e){return Me(e,"bigint"),`0x${e.toString(16)}`}}class Li extends i{encoder=new _i;decoder=new Pi}const ae=new Li,Se=new J(new G(ae),new W(ae));new D(new B(ae),new A(ae)),new D(new B(Se),new A(Se)),BigInt.prototype.toJSON=function(){return ae.encode(this)};class Oi{convert(e){if(!Ns(e))throw new T(typeof e,"boolean");return e}}class Mi{convert(e){return Me(e,"boolean"),e}}class Fi extends i{encoder=new Mi;decoder=new Oi}const je=new Fi;class Hi{convert(e){if(!ce(e))throw new T(typeof e,"string");const t=new Date(e);if(Number.isNaN(t.valueOf()))throw new T("NaN","number");return t}}class zi{convert(e){return u(e,Date),e.toISOString()}}class Gi extends i{encoder=new zi;decoder=new Hi}const oe=new Gi;class Wi{convert(e){if(!ce(e))throw new T(typeof e,"string");return new URL(e)}}class Ji{convert(e){return e.toString()}}class qi extends i{encoder=new Ji;decoder=new Wi}const bn=new qi;new J(new G(bn),new W(bn));const he=s;class xn{requestID;api;method;param;constructor(e,t,o,n){this.requestID=e,this.api=t,this.method=o,this.param=n}toJSON(){return{requestID:this.requestID,api:this.api,method:this.method,param:this.param}}}class ji{convert(e){return d(e,"requestID","api","method","param"),new xn(he.decode(e.requestID),h.decode(e.api),h.decode(e.method),e.param)}}class Vi{convert(e){return u(e,xn),{requestID:he.encode(e.requestID),api:h.encode(e.api),method:h.encode(e.method),param:e.param}}}class $i extends i{encoder=new Vi;decoder=new ji}const Qi=new $i;class En{requestID;constructor(e){this.requestID=e}}class Zr extends En{response;constructor(e,t){super(e),this.response=t}toJSON(){return Sn.encode(this)}}class Xi{convert(e){return d(e,"requestID","response"),new Zr(he.decode(e.requestID),e.response)}}class Ki{convert(e){return u(e,Zr),{requestID:he.encode(e.requestID),response:e.response}}}class Yi extends i{encoder=new Ki;decoder=new Xi}const Sn=new Yi;class et extends En{error;constructor(e,t){super(e),this.error=t}toJSON(){return kn.encode(this)}}class Zi{convert(e){return d(e,"requestID","error"),new et(he.decode(e.requestID),Z.decode(e.error))}}class ed{convert(e){return u(e,et),{requestID:he.encode(e.requestID),error:Z.encode(e.error)}}}class rd extends i{encoder=new ed;decoder=new Zi}const kn=new rd;class x{tag;data;constructor(e,t){this.tag=e,this.data=t}static fromString(e){const t=e.indexOf("~");if(t<0)throw new Jo;const o=e.substring(0,t),n=Kr.decodeString(e.substring(t+1));return new x(o,n)}static inflate(e){return w.decode(e)}toString(){return`${this.tag}~${Kr.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class td{convert(e){if(typeof e!="string")throw new T(typeof e,"string");return x.fromString(e)}}class od{convert(e){return u(e,x),e.toString()}}class nd extends i{encoder=new od;decoder=new td}const w=new nd;class rt{r;s;v;constructor(e,t,o){this.r=e,this.s=t,this.v=o}toJSON(){return tt.encode(this)}}class sd{convert(e){return d(e,"r","s","v"),new rt(R.decode(e.r),R.decode(e.s),s.decode(e.v))}}class cd{convert(e){return u(e,rt),{r:R.encode(e.r),s:R.encode(e.s),v:s.encode(e.v)}}}class ad extends i{encoder=new cd;decoder=new sd}const tt=new ad;class ot{account;amount;constructor(e,t){this.account=e,this.amount=t}toJSON(){return nt.encode(this)}}class id{convert(e){return d(e,"account","amount"),new ot(R.decode(e.account),R.decode(e.amount))}}class dd{convert(e){return u(e,ot),{account:R.encode(e.account),amount:R.encode(e.amount)}}}class ld extends i{encoder=new dd;decoder=new id}const nt=new ld;class st{number;timestamp;hash;constructor(e,t,o){this.number=e,this.timestamp=t,this.hash=o}toJSON(){return ct.encode(this)}}class ud{convert(e){return d(e,"number","timestamp","hash"),new st(s.decode(e.number),h.decode(e.timestamp),h.decode(e.hash))}}class hd{convert(e){return u(e,st),{number:s.encode(e.number),timestamp:h.encode(e.timestamp),hash:h.encode(e.hash)}}}class pd extends i{encoder=new hd;decoder=new ud}const ct=new pd,Rn=new J(new G(ct),new W(ct));class at{bytes;constructor(e){this.bytes=e}toJSON(){return it.encode(this)}}class wd{convert(e){return d(e,"bytes"),new at(vn.decode(e.bytes))}}class md{convert(e){return u(e,at),{bytes:vn.encode(e.bytes)}}}class fd extends i{encoder=new md;decoder=new wd}const it=new fd;class dt{height;timestamp;l1_head;l1_finalized;payload_commitment;ns_table;block_merkle_root;fee_merkle_root;builder_signature;fee_info;constructor(e,t,o,n,c,a,l,m,p,C){this.height=e,this.timestamp=t,this.l1_head=o,this.l1_finalized=n,this.payload_commitment=c,this.ns_table=a,this.block_merkle_root=l,this.fee_merkle_root=m,this.builder_signature=p,this.fee_info=C}toJSON(){return Q.encode(this)}}class gd{convert(e){return d(e,"height","timestamp","l1_head","l1_finalized","payload_commitment","ns_table","block_merkle_root","fee_merkle_root","builder_signature","fee_info"),new dt(s.decode(e.height),s.decode(e.timestamp),s.decode(e.l1_head),Rn.decode(e.l1_finalized),$.decode(e.payload_commitment),it.decode(e.ns_table),w.decode(e.block_merkle_root),w.decode(e.fee_merkle_root),tt.decode(e.builder_signature),nt.decode(e.fee_info))}}class Cd{convert(e){return u(e,dt),{height:s.encode(e.height),timestamp:s.encode(e.timestamp),l1_head:s.encode(e.l1_head),l1_finalized:Rn.encode(e.l1_finalized),payload_commitment:$.encode(e.payload_commitment),ns_table:it.encode(e.ns_table),block_merkle_root:w.encode(e.block_merkle_root),fee_merkle_root:w.encode(e.fee_merkle_root),builder_signature:tt.encode(e.builder_signature),fee_info:nt.encode(e.fee_info)}}}class yd extends i{encoder=new Cd;decoder=new gd}const Q=new yd;class ke{vm;payload;constructor(e,t){this.vm=e,this.payload=t}toJSON(){return ie.encode(this)}}class vd{convert(e){return d(e,"vm","payload"),new ke(s.decode(e.vm),$.decode(e.payload))}}class bd{convert(e){return u(e,ke),{vm:s.encode(e.vm),payload:$.encode(e.payload)}}}class xd extends i{encoder=new bd;decoder=new vd}const ie=new xd,In=new D(new B(ie),new A(ie));class lt{transaction_nmt;constructor(e){this.transaction_nmt=e}toJSON(){return Re.encode(this)}}class Ed{convert(e){return d(e,"transaction_nmt"),new lt(In.decode(e.transaction_nmt))}}class Sd{convert(e){return u(e,lt),{transaction_nmt:In.encode(e.transaction_nmt)}}}class kd extends i{encoder=new Sd;decoder=new Ed}const Re=new kd;class ut{header;payload;hash;size;numTransactions;constructor(e,t,o,n,c){this.header=e,this.payload=t,this.hash=o,this.size=n,this.numTransactions=c}toJSON(){return ht.encode(this)}}class Rd{convert(e){return d(e,"header","payload","hash","size","num_transactions"),new ut(Q.decode(e.header),Re.decode(e.payload),w.decode(e.hash),s.decode(e.size),s.decode(e.num_transactions))}}class Id{convert(e){return u(e,ut),{header:Q.encode(e.header),payload:Re.encode(e.payload),hash:w.encode(e.hash),size:s.encode(e.size),num_transactions:s.encode(e.numTransactions)}}}class Bd extends E{encoder=new Id;decoder=new Rd}const ht=new Bd;class Ve{header;hash;size;num_transactions;proposer_id;constructor(e,t,o,n,c){this.header=e,this.hash=t,this.size=o,this.num_transactions=n,this.proposer_id=c}toJSON(){return pt.encode(this)}}class Ad{convert(e){return d(e,"header","hash","size","num_transactions","proposer_id"),new Ve(Q.decode(e.header),w.decode(e.hash),s.decode(e.size),s.decode(e.num_transactions),te.decode(e.proposer_id))}}class Dd{convert(e){return u(e,Ve),{header:Q.encode(e.header),hash:w.encode(e.hash),size:s.encode(e.size),num_transactions:s.encode(e.num_transactions),proposer_id:te.encode(e.proposer_id)}}}class Td extends i{encoder=new Dd;decoder=new Ad}const pt=new Td,Ud=new D(new B(pt),new A(pt));class $e{hash;header;offset;transaction;constructor(e,t,o,n){this.hash=e,this.header=t,this.offset=o,this.transaction=n}toJSON(){return wt.encode(this)}}class Nd{convert(e){return d(e,"hash","header","offset","transaction"),new $e(w.decode(e.hash),Q.decode(e.header),s.decode(e.offset),ie.decode(e.transaction))}}class Pd{convert(e){return u(e,$e),{hash:w.encode(e.hash),header:Q.encode(e.header),offset:s.encode(e.offset),transaction:ie.encode(e.transaction)}}}class _d extends i{encoder=new Pd;decoder=new Nd}const wt=new _d,Bn=new D(new B(wt),new A(wt));class Qe{leaf_commit;constructor(e){this.leaf_commit=e}toJSON(){return mt.encode(this)}}class Ld{convert(e){return d(e,"leaf_commit"),new Qe(w.decode(e.leaf_commit))}}class Od{convert(e){return u(e,Qe),{leaf_commit:w.encode(e.leaf_commit)}}}class Md extends i{encoder=new Od;decoder=new Ld}const mt=new Md;class An{width;index;constructor(e,t){this.width=e,this.index=t}toJSON(){return ft.encode(this)}}class Fd{convert(e){return d(e,"width","index"),new An(s.decode(e.width),s.decode(e.index))}}class Hd{convert(e){return u(e,An),{width:s.encode(e.width),index:s.encode(e.index)}}}class zd extends i{encoder=new Hd;decoder=new Fd}const ft=new zd;class Ie{static get lsb0(){return Wd}static get msb0(){return qd}valueOf(){return this.toString()}toJSON(){return this.toString()}}const Dn="bitvec::order::Lsb0",Tn="bitvec::order::Msb0";class Gd extends Ie{toString(){return Dn}}const Wd=new Gd;class Jd extends Ie{toString(){return Tn}}const qd=new Jd;class jd{convert(e){if(typeof e!="string")throw new T(typeof e,"string");switch(e){case Dn:return Ie.lsb0;case Tn:return Ie.msb0;default:throw new T(e,"CappuccinoAPIBitVecOrder")}}}class Vd{convert(e){return e.toString()}}class $d extends i{encoder=new Vd;decoder=new jd}const Un=new $d;class Nn{order;head;bits;data;constructor(e,t,o,n){this.order=e,this.head=t,this.bits=o,this.data=n}getBitVecIndexIterable(){return this.order===Ie.lsb0?new el(this.head.width,this.bits):new tl(this.head.width,this.bits)}[Symbol.iterator](){const e=this.getBitVecIndexIterable();return pi(e,t=>Yd(this.data,t))[Symbol.iterator]()}toJSON(){return Be.encode(this)}}class Qd{convert(e){return d(e,"order","head","bits","data"),new Nn(Un.decode(e.order),ft.decode(e.head),s.decode(e.bits),$.decode(e.data))}}class Xd{convert(e){return u(e,Nn),{order:Un.encode(e.order),head:ft.encode(e.head),bits:s.encode(e.bits),data:$.encode(e.data)}}}class Kd extends i{encoder=new Xd;decoder=new Qd}const Be=new Kd;new D(new B(Be),new A(Be));function Yd(r,e){return(r[e.bucket]>>e.bitOffset&1)===1}class Pn{bucket;bitOffset;constructor(e,t){this.bucket=e,this.bitOffset=t}}function _n(r){switch(k(r===8||r===16||r===32,"bit width should be a power of two that is supported"),r){case 8:return 3;case 16:return 4;case 32:return 5;default:throw new U}}class Zd{totalBits;bitWidthMask;bitWidthShift;offset=0;constructor(e,t){this.totalBits=t;const o=_n(e);this.bitWidthMask=e-1,this.bitWidthShift=o}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,t=this.offset&this.bitWidthMask;return this.offset+=1,{done:!1,value:new Pn(e,t)}}}class el{bitWidth;totalBits;constructor(e,t){this.bitWidth=e,this.totalBits=t}[Symbol.iterator](){return new Zd(this.bitWidth,this.totalBits)}}class rl{bitWidth;totalBits;bitWidthMask;bitWidthShift;offset=0;constructor(e,t){this.bitWidth=e,this.totalBits=t;const o=_n(e);this.bitWidthMask=e-1,this.bitWidthShift=o}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,t=this.bitWidth-1-(this.offset&this.bitWidthMask);return this.offset+=1,{done:!1,value:new Pn(e,t)}}}class tl{bitWidth;totalBits;constructor(e,t){this.bitWidth=e,this.totalBits=t}[Symbol.iterator](){return new rl(this.bitWidth,this.totalBits)}}class Ln{signature;bitvec;constructor(e,t){this.signature=e,this.bitvec=t}toJSON(){return gt.encode(this)}}class ol{convert(e){if(!Ro(e)||e.length!==2)throw new T(typeof e,"Array");return new Ln(w.decode(e[0]),Be.decode(e[1]))}}class nl{convert(e){return u(e,Ln),[w.encode(e.signature),Be.encode(e.bitvec)]}}class sl extends i{encoder=new nl;decoder=new ol}const gt=new sl,On=new J(new G(gt),new W(gt));class Xe{data;vote_commitment;view_number;signatures;is_genesis;_pd;constructor(e,t,o,n,c,a){this.data=e,this.vote_commitment=t,this.view_number=o,this.signatures=n,this.is_genesis=c,this._pd=a}toJSON(){return Ae.encode(this)}}class cl{convert(e){return d(e,"data","vote_commitment","view_number","signatures","is_genesis","_pd"),new Xe(mt.decode(e.data),w.decode(e.vote_commitment),s.decode(e.view_number),On.decode(e.signatures),je.decode(e.is_genesis),null)}}class al{convert(e){return u(e,Xe),{data:mt.encode(e.data),vote_commitment:w.encode(e.vote_commitment),view_number:s.encode(e.view_number),signatures:On.encode(e.signatures),is_genesis:je.encode(e.is_genesis),_pd:null}}}class il extends i{encoder=new al;decoder=new cl}const Ae=new il;class Ct{view_number;justify_qc;parent_commitment;block_header;block_payload;rejected;timestamp;proposer_id;constructor(e,t,o,n,c,a,l,m){this.view_number=e,this.justify_qc=t,this.parent_commitment=o,this.block_header=n,this.block_payload=c,this.rejected=a,this.timestamp=l,this.proposer_id=m}toJSON(){return yt.encode(this)}}class dl{convert(e){return d(e,"view_number","justify_qc","parent_commitment","block_header","block_payload","rejected","timestamp","proposer_id"),new Ct(s.decode(e.view_number),Ae.decode(e.justify_qc),w.decode(e.parent_commitment),Q.decode(e.block_header),Re.decode(e.block_payload),$.decode(e.rejected),s.decode(e.timestamp),R.decode(e.proposer_id))}}class ll{convert(e){return u(e,Ct),{view_number:s.encode(e.view_number),justify_qc:Ae.encode(e.justify_qc),parent_commitment:w.encode(e.parent_commitment),block_header:Q.encode(e.block_header),block_payload:Re.encode(e.block_payload),rejected:$.encode(e.rejected),timestamp:s.encode(e.timestamp),proposer_id:R.encode(e.proposer_id)}}}class ul extends i{encoder=new ll;decoder=new dl}const yt=new ul;class vt{leaf;qc;constructor(e,t){this.leaf=e,this.qc=t}toJSON(){return bt.encode(this)}}class hl{convert(e){return d(e,"leaf","qc"),new vt(yt.decode(e.leaf),Ae.decode(e.qc))}}class pl{convert(e){return u(e,vt),{leaf:yt.encode(e.leaf),qc:Ae.encode(e.qc)}}}class wl extends i{encoder=new pl;decoder=new hl}const bt=new wl;class De{}class xt extends De{toJSON(){return Et.encode(this)}}class ml{convert(e){if(!ce(e)||e!=="Empty")throw new O;return new xt}}class fl{convert(e){return u(e,xt),"Empty"}}class gl extends i{encoder=new fl;decoder=new ml}const Et=new gl;class St extends De{value;pos;elem;constructor(e,t,o){super(),this.value=e,this.pos=t,this.elem=o}toJSON(){return kt.encode(this)}}class Cl{convert(e){d(e,"Leaf");const t=e.Leaf;return d(t,"value","pos","elem"),new St(w.decode(t.value),w.decode(t.pos),w.decode(t.elem))}}class yl{convert(e){return u(e,St),{Leaf:{value:w.encode(e.value),pos:w.encode(e.pos),elem:w.encode(e.elem)}}}}class vl extends E{encoder=new yl;decoder=new Cl}const kt=new vl;class Rt extends De{value;constructor(e){super(),this.value=e}toJSON(){return It.encode(this)}}class bl{convert(e){d(e,"ForgettenSubtree");const t=e.ForgettenSubtree;return d(t,"value"),new Rt(w.decode(t.value))}}class xl{convert(e){return u(e,Rt),{ForgettenSubtree:{value:w.encode(e.value)}}}}class El extends E{encoder=new xl;decoder=new bl}const It=new El;class Ke extends De{value;children;constructor(e,t){super(),this.value=e,this.children=t}toJSON(){return Bt.encode(this)}}class Sl{convert(e){d(e,"Branch");const t=e.Branch;return d(t,"value","children"),new Ke(w.decode(t.value),Ye.decode(t.children))}}class kl{convert(e){return u(e,Ke),{Branch:{value:w.encode(e.value),children:Ye.encode(e.children)}}}}class Rl extends i{encoder=new kl;decoder=new Sl}const Bt=new Rl;class Il{convert(e){if(F(e,"Leaf",_))return kt.decoder.convert(e);if(F(e,"Branch",_))return Bt.decoder.convert(e);if(F(e,"ForgettenSubtree",_))return It.decoder.convert(e);if(ce(e))return Et.decoder.convert(e);throw new O}}class Bl{convert(e){if(u(e,De),e instanceof St)return kt.encode(e);if(e instanceof Ke)return Bt.encode(e);if(e instanceof Rt)return It.encode(e);if(e instanceof xt)return Et.encode(e);throw new O}}class Al extends i{encoder=new Bl;decoder=new Il}const Mn=new Al,Ye=new D(new B(Mn),new A(Mn));class At{pos;proof;constructor(e,t){this.pos=e,this.proof=t}toJSON(){return Dt.encode(this)}}class Dl{convert(e){return d(e,"pos","proof"),new At(w.decode(e.pos),Ye.decode(e.proof))}}class Tl{convert(e){return u(e,At),{pos:w.encode(e.pos),proof:Ye.encode(e.proof)}}}class Ul extends i{encoder=new Tl;decoder=new Dl}const Dt=new Ul;class Tt{transaction;block_hash;proof;height;hash;constructor(e,t,o,n,c){this.transaction=e,this.block_hash=t,this.proof=o,this.height=n,this.hash=c}toJSON(){return Ut.encode(this)}}class Nl{convert(e){return d(e,"transaction","block_hash","proof","height","hash"),new Tt(ie.decoder.convert(e.transaction),w.decode(e.block_hash),Dt.decoder.convert(e.proof),s.decode(e.height),w.decode(e.hash))}}class Pl{convert(e){return u(e,Tt),{transaction:ie.encode(e.transaction),block_hash:w.encode(e.block_hash),proof:Dt.encode(e.proof),height:s.encode(e.height),hash:w.encode(e.hash)}}}class _l extends i{encoder=new Pl;decoder=new Nl}const Ut=new _l,pe="latest";class Nt{target;constructor(e){this.target=e}static latest(){return new Hn}static height(e){return new zn(e)}toJSON(){return Fn.encode(this)}}class Ll{convert(e){return u(e,Nt),typeof e.target=="number"?s.encode(e.target):h.encode(e.target)}}class Ol{convert(e){return e===pe?new Hn:new zn(s.decode(e))}}class Ml extends E{encoder=new Ll;decoder=new Ol}const Fn=new Ml;class Hn extends Nt{constructor(){super(pe)}}class zn extends Nt{constructor(e){super(e)}}class X{constructor(e,t,o){this.alpha3Code=e,this.code=t,this.significantDigits=o,this.alpha3Code=e,this.code=t,this.significantDigits=o,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}significantDigitsMultiplier;toJSON(){return Ze.encode(this)}}const Gn=new X("JPY",392,0),Fl=new X("GBP",826,2),Wn=new X("USD",840,2),Hl=new X("EUR",978,2),zl=new X("XXX",999,2),Jn=new X("ETH",1001,18),Pt=new X("XBT",1002,8),qn=new X("ESP",10001,18),Gl=[Gn,Fl,Wn,Hl,zl,Jn,Pt,qn],Wl=new Map(Gl.map(r=>[r.alpha3Code,r]));class Jl{convert(e){if(typeof e!="string")throw new O("CurrencyCodeDecoder: expected string");if(e==="BTC")return Pt;const t=Wl.get(e);if(t===void 0)throw new O(`CurrencyCodeDecoder: unknown currency: "${e}"`);return t}}class ql{convert(e){return u(e,X),e.alpha3Code}}class jl extends i{decoder=new Jl;encoder=new ql}const Ze=new jl;class j{constructor(e,t){this.currency=e,this.value=t,this.currency=e,this.value=t}static USD(e){return new j(Wn,BigInt(e))}static ETH(e){return new j(Jn,BigInt(e))}static ESP(e){return new j(qn,BigInt(e))}static JPY(e){return new j(Gn,BigInt(e))}static BTC(e){return new j(Pt,BigInt(e))}toString(){return er.encode(this)}toJSON(){return er.encode(this)}}function Vl(r){return r==="."||r===","||r===" "}function $l(r,e){let t=-1;const o=r.length;for(let n=0;n<o;n++)e(r[n])&&(t=n);return t}class Ql{parseCurrencyCode(e){return Ze.decode(e)}parseValue(e,t){let o=1n;t[0]==="-"&&(o=-1n,t=t.substring(1));const n=$l(t,Vl);if(n===-1){const p=BigInt(t.replace(/\D/g,""))*e.significantDigitsMultiplier;return o*p}const c=t.substring(0,n).replace(/\D/g,""),a=t.substring(n+1).replace(/\D/g,""),l=BigInt(c)*e.significantDigitsMultiplier,m=BigInt(a)*10n**BigInt(e.significantDigits-a.length);return o*(l+m)}convert(e){if(typeof e!="string")throw new O("MonetaryValueDecoder: expected string");const t=e.indexOf(" ");if(t<=-1)throw new O("MonetaryValueDecoder: missing non-breaking space");const o=e.substring(0,t),n=e.substring(t+1);if(/^-?[\d .,]+$/.test(o)){const a=this.parseCurrencyCode(n);return new j(a,this.parseValue(a,o))}const c=this.parseCurrencyCode(o);return new j(c,this.parseValue(c,n))}}class Xl{convert(e){u(e,j);const t=e.value<0n?"-":"",o=e.value<0n?-e.value:e.value,n=o%e.currency.significantDigitsMultiplier,c=o/e.currency.significantDigitsMultiplier,a=String(c),l=String(n);return/^0+$/.test(l)?`${Ze.encode(e.currency)} ${t}${a}`:`${Ze.encode(e.currency)} ${t}${c}.${String(n).padStart(e.currency.significantDigits,"0")}`}}class Kl extends i{decoder=new Ql;encoder=new Xl}const er=new Kl,jn=new D(new B(er),new A(er));class _t{hash;height;time;numTransactions;proposerID;feeRecipient;size;blockReward;constructor(e,t,o,n,c,a,l,m){this.hash=e,this.height=t,this.time=o,this.numTransactions=n,this.proposerID=c,this.feeRecipient=a,this.size=l,this.blockReward=m}toJSON(){return de.encode(this)}}class Yl{convert(e){return d(e,"hash","height","time","num_transactions","proposer_id","fee_recipient","size","block_reward"),new _t(w.decode(e.hash),s.decode(e.height),oe.decode(e.time),s.decode(e.num_transactions),te.decode(e.proposer_id),te.decode(e.fee_recipient),s.decode(e.size),jn.decode(e.block_reward))}}class Zl{convert(e){return u(e,_t),{hash:w.encode(e.hash),height:s.encode(e.height),time:oe.encode(e.time),num_transactions:s.encode(e.numTransactions),proposer_id:te.encode(e.proposerID),fee_recipient:te.encode(e.feeRecipient),size:s.encode(e.size),block_reward:jn.encode(e.blockReward)}}}class eu extends E{encoder=new Zl;decoder=new Yl}const de=new eu;new D(new B(de),new A(de));class Lt{blockDetail;constructor(e){this.blockDetail=e}toJSON(){return Ot.encode(this)}}class ru{convert(e){return d(e,"block_detail"),new Lt(de.decode(e.block_detail))}}class tu{convert(e){return u(e,Lt),{block_detail:de.encode(e.blockDetail)}}}class ou extends E{encoder=new tu;decoder=new ru}const Ot=new ou;class Mt{limit;constructor(e){this.limit=e}static latest(e){return new $n(e)}static from(e,t){return new Qn(e,t)}toJSON(){return Vn.encode(this)}}class nu{convert(e){return u(e,Mt),yr(e.from)?{from:s.encode(e.from),limit:s.encode(e.limit)}:{from:h.encode(e.from),limit:s.encode(e.limit)}}}class su{convert(e){return d(e,"from","limit"),e.from===pe?new $n(s.decode(e.limit)):new Qn(s.decode(e.from),s.decode(e.limit))}}class cu extends E{encoder=new nu;decoder=new su}const Vn=new cu;class $n extends Mt{constructor(e){super(e)}get from(){return pe}}class Qn extends Mt{from;constructor(e,t){super(t),this.from=e}}class Ft{hash;height;proposerID;numTransactions;size;time;constructor(e,t,o,n,c,a){this.hash=e,this.height=t,this.proposerID=o,this.numTransactions=n,this.size=c,this.time=a}toJSON(){return Ht.encode(this)}}class au{convert(e){return d(e,"hash","height","proposer_id","num_transactions","size","time"),new Ft(w.decode(e.hash),s.decode(e.height),te.decode(e.proposer_id),s.decode(e.num_transactions),s.decode(e.size),oe.decode(e.time))}}class iu{convert(e){return u(e,Ft),{hash:w.encode(e.hash),height:s.encode(e.height),proposer_id:te.encode(e.proposerID),num_transactions:s.encode(e.numTransactions),size:s.encode(e.size),time:oe.encode(e.time)}}}class du extends E{encoder=new iu;decoder=new au}const Ht=new du,we=new D(new B(Ht),new A(Ht));class zt{blockSummaries;constructor(e){this.blockSummaries=e}toJSON(){return Gt.encode(this)}}class lu{convert(e){return d(e,"block_summaries"),new zt(we.decode(e.block_summaries))}}class uu{convert(e){return u(e,zt),{block_summaries:we.encode(e.blockSummaries)}}}class hu extends E{encoder=new uu;decoder=new lu}const Gt=new hu;class Wt{rollups;transactions;blocks;constructor(e,t,o){this.rollups=e,this.transactions=t,this.blocks=o}toJSON(){return Jt.encode(this)}}class pu{convert(e){return d(e,"rollups","transactions","blocks"),new Wt(s.decode(e.rollups),s.decode(e.transactions),s.decode(e.blocks))}}class wu{convert(e){return u(e,Wt),{rollups:s.encode(e.rollups),transactions:s.encode(e.transactions),blocks:s.encode(e.blocks)}}}class mu extends i{encoder=new wu;decoder=new pu}const Jt=new mu;function fu(r,e){return r.blockHeights-e.blockHeights}class qt{blockTime;blockSize;blockTransactions;blockHeights;constructor(e,t,o,n){const c=[],a=Math.min(e.length,t.length,o.length,n.length);for(let N=0;N<a;N++){const I=n[N];I!==null&&c.push({blockTime:e[N],blockSize:t[N],blockTransactions:o[N],blockHeights:I})}c.sort(fu);const l=c[0].blockHeights,m=c[c.length-1].blockHeights,p=[],C=[],f=[],S=[];for(let N=l,I=0;N<=m;N++){const V=c[I];if(V.blockHeights!==N){p.push(null),C.push(null),f.push(null),S.push(null);continue}p.push(V.blockTime),C.push(V.blockSize),f.push(V.blockTransactions),S.push(V.blockHeights),I++}const H=Math.max(0,S.length-50);this.blockTime=p.slice(H),this.blockSize=C.slice(H),this.blockTransactions=f.slice(H),this.blockHeights=S.slice(H)}toJSON(){return jt.encode(this)}}class gu{convert(e){return d(e,"block_time","block_size","block_transactions","block_heights"),new qt(ee.decode(e.block_time),ee.decode(e.block_size),ee.decode(e.block_transactions),ee.decode(e.block_heights))}}class Cu{convert(e){return u(e,qt),{block_time:ee.encode(e.blockTime),block_size:ee.encode(e.blockSize),block_transactions:ee.encode(e.blockTransactions),block_heights:ee.encode(e.blockHeights)}}}class yu extends i{encoder=new Cu;decoder=new gu}const jt=new yu,Xn=$;class rr{hash;rollups;height;time;offset;numTransactions;constructor(e,t,o,n,c,a){this.hash=e,this.rollups=t,this.height=o,this.time=n,this.offset=c,this.numTransactions=a}toJSON(){return Vt.encode(this)}}class vu{convert(e){return d(e,"hash","rollups","height","time","offset","num_transactions"),new rr(w.decode(e.hash),Xn.decode(e.rollups),s.decode(e.height),oe.decode(e.time),s.decode(e.offset),s.decode(e.num_transactions))}}class bu{convert(e){return u(e,rr),{hash:w.encode(e.hash),rollups:Xn.encode(e.rollups),height:s.encode(e.height),time:oe.encode(e.time),offset:s.encode(e.offset),num_transactions:s.encode(e.numTransactions)}}}class xu extends i{encoder=new bu;decoder=new vu}const Vt=new xu,me=new D(new B(Vt),new A(Vt));class $t{latestBlock;genesisOverview;latestBlocks;latestTransactions;histograms;constructor(e,t,o,n,c){this.latestBlock=e,this.genesisOverview=t,this.latestBlocks=o,this.latestTransactions=n,this.histograms=c}toJSON(){return Qt.encode(this)}}class Eu{convert(e){return d(e,"latest_block","genesis_overview","latest_blocks","latest_transactions","histograms"),new $t(de.decode(e.latest_block),Jt.decode(e.genesis_overview),we.decode(e.latest_blocks),me.decode(e.latest_transactions),jt.decode(e.histograms))}}class Su{convert(e){return u(e,$t),{latest_block:de.encode(e.latestBlock),genesis_overview:Jt.encode(e.genesisOverview),latest_blocks:we.encode(e.latestBlocks),latest_transactions:me.encode(e.latestTransactions),histograms:jt.encode(e.histograms)}}}class ku extends i{encoder=new Su;decoder=new Eu}const Qt=new ku;class Xt{explorerSummary;constructor(e){this.explorerSummary=e}toJSON(){return Kt.encode(this)}}class Ru{convert(e){return d(e,"explorer_summary"),new Xt(Qt.decode(e.explorer_summary))}}class Iu{convert(e){return u(e,Xt),{explorer_summary:Qt.encode(e.explorerSummary)}}}class Bu extends i{encoder=new Iu;decoder=new Ru}const Kt=new Bu;class Kn{query;constructor(e){this.query=e}toJSON(){return Yn.encode(this)}}class Au{convert(e){return u(e,Kn),h.encode(e.query)}}class Du{convert(e){return new Kn(h.decode(e))}}class Tu extends E{encoder=new Au;decoder=new Du}const Yn=new Tu;class Yt{blocks;transactions;constructor(e,t){this.blocks=e,this.transactions=t}toJSON(){return Zt.encode(this)}}class Uu{convert(e){return d(e,"blocks","transactions"),new Yt(we.decode(e.blocks),me.decode(e.transactions))}}class Nu{convert(e){return u(e,Yt),{blocks:we.encode(e.blocks),transactions:me.encode(e.transactions)}}}class Pu extends E{encoder=new Nu;decoder=new Uu}const Zt=new Pu;class eo{searchResults;constructor(e){this.searchResults=e}toJSON(){return ro.encode(this)}}class _u{convert(e){return d(e,"search_results"),new eo(Zt.decode(e.search_results))}}class Lu{convert(e){return u(e,eo),{search_results:Zt.encode(e.searchResults)}}}class Ou extends E{encoder=new Lu;decoder=new _u}const ro=new Ou;class to{static heightAndOffset(e,t){return new Te(e,t)}static hash(e){return new Ue(e)}toJSON(){return Zn.encode(this)}}class Mu{convert(e){if(u(e,to),e instanceof Te)return{height:s.encode(e.height),offset:s.encode(e.offset)};if(e instanceof Ue)return{hash:w.encode(e.hash)};throw new O}}class Fu{convert(e){if(F(e,"height",_)&&F(e,"offset",_))return new Te(s.decode(e.height),s.decode(e.offset));if(F(e,"hash",_))return new Ue(w.decode(e.hash));throw new O}}class Hu extends i{encoder=new Mu;decoder=new Fu}const Zn=new Hu;class Te extends to{height;offset;constructor(e,t){super(),this.height=e,this.offset=t}}class Ue extends to{hash;constructor(e){super(),this.hash=e}}const es=s;class oo{namespace;payload;constructor(e,t){this.namespace=e,this.payload=t}toJSON(){return no.encode(this)}}class zu{convert(e){return d(e,"namespace","payload"),new oo(es.decode(e.namespace),qe.decode(e.payload))}}class Gu{convert(e){return u(e,oo),{namespace:es.encode(e.namespace),payload:qe.encode(e.payload)}}}class Wu extends i{encoder=new Gu;decoder=new zu}const no=new Wu,rs=new D(new B(no),new A(no));class so{hash;height;blockConfirmed;offset;numTransactions;size;time;sequencingFees;feeDetails;constructor(e,t,o,n,c,a,l,m,p){this.hash=e,this.height=t,this.blockConfirmed=o,this.offset=n,this.numTransactions=c,this.size=a,this.time=l,this.sequencingFees=m,this.feeDetails=p}toJSON(){return co.encode(this)}}class Ju{convert(e){return d(e,"hash","height","block_confirmed","offset","num_transactions","size","time","sequencing_fees","fee_details"),new so(w.decode(e.hash),s.decode(e.height),je.decode(e.block_confirmed),s.decode(e.offset),s.decode(e.num_transactions),s.decode(e.size),oe.decode(e.time),[],[])}}class qu{convert(e){return u(e,so),{hash:w.encode(e.hash),height:s.encode(e.height),block_confirmed:je.encode(e.blockConfirmed),offset:s.encode(e.offset),num_transactions:s.encode(e.numTransactions),size:s.encode(e.size),time:oe.encode(e.time),sequencing_fees:[],fee_details:[]}}}class ju extends i{encoder=new qu;decoder=new Ju}const co=new ju;class ao{details;data;constructor(e,t){this.details=e,this.data=t}toJSON(){return io.encode(this)}}class Vu{convert(e){return d(e,"details","data"),new ao(co.decode(e.details),rs.decode(e.data))}}class $u{convert(e){return u(e,ao),{details:co.encode(e.details),data:rs.encode(e.data)}}}class Qu extends i{encoder=new $u;decoder=new Vu}const io=new Qu;class tr{transactionDetail;constructor(e){this.transactionDetail=e}toJSON(){return lo.encode(this)}}class Xu{convert(e){return d(e,"transaction_detail"),new tr(io.decode(e.transaction_detail))}}class Ku{convert(e){return u(e,tr),{transaction_detail:io.encode(e.transactionDetail)}}}class Yu extends E{encoder=new Ku;decoder=new Xu}const lo=new Yu;class or{constructor(){}static block(e){return new nr(e)}static namespace(e){return new sr(e)}static none(){return new ho}toJSON(){return uo.encode(this)}}class Zu{convert(e){return F(e,"block",_)?new nr(s.decode(e.block)):F(e,"namespace",_)?new sr(s.decode(e.namespace)):new ho}}class eh{convert(e){if(u(e,or),e instanceof ho)return{};if(e instanceof nr)return{block:s.encode(e.block)};if(e instanceof sr)return{namespace:s.encode(e.namespace)};throw new O}}class rh extends E{encoder=new eh;decoder=new Zu}const uo=new rh;class ho extends or{constructor(){super()}convertURL(e){return e}}class nr extends or{block;constructor(e){super(),this.block=e}convertURL(e){return new URL(`${e.pathname}/block/${this.block}`,e)}}class sr extends or{namespace;constructor(e){super(),this.namespace=e}convertURL(e){return new URL(`${e.pathname}/namespace/${this.namespace}`,e)}}class cr{limit;constructor(e){this.limit=e}static latest(e){return new ar(e)}static heightAndOffset(e,t,o){return new ir(e,t,o)}static hash(e,t){return new dr(e,t)}toJSON(){return po.encode(this)}}class th{convert(e){return d(e,"limit"),F(e,"height",_)&&F(e,"offset",_)?new ir(s.decode(e.height),s.decode(e.offset),s.decode(e.limit)):F(e,"hash",_)?new dr(w.decode(e.hash),s.decode(e.limit)):new ar(s.decode(e.limit))}}class oh{convert(e){if(u(e,cr),e instanceof ar)return{limit:s.encode(e.limit)};if(e instanceof ir)return{height:s.encode(e.height),offset:s.encode(e.offset),limit:s.encode(e.limit)};if(e instanceof dr)return{hash:w.encode(e.hash),limit:s.encode(e.limit)};throw new O}}class nh extends E{encoder=new oh;decoder=new th}const po=new nh;class ar extends cr{constructor(e){super(e)}convertURL(e){return new URL(`transactions/latest/${this.limit}`,e)}}class ir extends cr{height;offset;constructor(e,t,o){super(o),this.height=e,this.offset=t}convertURL(e){return new URL(`transactions/from/${this.height}/${this.offset}/${this.limit}`,e)}}class dr extends cr{hash;constructor(e,t){super(t),this.hash=e}convertURL(e){return new URL(`transactions/hash/${this.hash}/${this.limit}`,e)}}class ts{target;filter;constructor(e,t){this.target=e,this.filter=t}toJSON(){return os.encode(this)}}class sh{convert(e){return d(e,"filter","target"),new ts(po.decode(e.target),uo.decode(e.filter))}}class ch{convert(e){return u(e,ts),{filter:uo.encode(e.filter),target:po.encode(e.target)}}}class ah extends E{encoder=new ch;decoder=new sh}const os=new ah;class Ne{transactionSummaries;constructor(e){this.transactionSummaries=e}toJSON(){return wo.encode(this)}}class ih{convert(e){return d(e,"transaction_summaries"),new Ne(me.decode(e.transaction_summaries))}}class dh{convert(e){return u(e,Ne),{transaction_summaries:me.encode(e.transactionSummaries)}}}class lh extends E{encoder=new dh;decoder=new ih}const wo=new lh;class g{namespace;name;site;blockExplorer;constructor(e,t,o,n){this.namespace=e,this.name=t,this.site=o,this.blockExplorer=n}}const uh=new g(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),hh=new g(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),ph=new g(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),wh=new g(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),mh=new g(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),fh=new g(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),gh=new g(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),Ch=new g(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),yh=new g(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),vh=new g(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),bh=new g(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),xh=1918988905,Eh=new g(xh,"RARI",new URL("https://rarichain.org/"),new URL("https://explorer.rarichain.org/")),Sh=1380012617,kh=new g(Sh,"RARI",new URL("https://rarichain.org/"),new URL("https://mainnet.explorer.rarichain.org/")),Rh=9369,Ih=new g(Rh,"LogX",new URL("https://logx.network/"),new URL("https://kartel-testnet-explorer.alt.technology/")),Bh=936369,Ah=new g(Bh,"LogX",new URL("https://logx.network/"),new URL("https://vzjuxmhfn70kgnlds27h-explorer.alt.technology")),Dh=466,Th=new g(Dh,"AppChain",new URL("https://appchain.xyz/"),new URL("https://explorer.appchain.xyz/")),Uh=4661,Nh=new g(Uh,"AppChain",new URL("https://appchain.xyz/"),new URL("https://appchaintestnet.explorer.caldera.xyz/")),Ph=360,_h=new g(Ph,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Lh=3609,Oh=new g(Lh,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Mh=33139,Fh=new g(Mh,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apescan.io/")),Hh=3313939,zh=new g(Hh,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apechain-testnet.explorer.caldera.xyz/")),Gh=13107,Wh=new g(Gh,"t3rn",new URL("https://t3rn.io/"),new URL("https://brn-testnet.explorer.caldera.xyz/")),Jh=819,qh=new g(Jh,"t3rn",new URL("https://t3rn.io/"),new URL("https://exporer.t3rn.io/")),ns=21341,jh=new g(ns,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus-sepolia-testnet.explorer.caldera.xyz/")),Vh=new g(ns,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus.calderaexplorer.xyz/")),$h=2524852,Qh=new g($h,"Huddle01",new URL("https://huddle01.com/"),new URL("https://hudlscan.com/txs")),Xh=1397311310,ss=new g(Xh,"Infinite Garden",new URL("https://infinitegarden.espressosys.com/"),new URL("https://explorer.main.net.espressosys.com/")),Kh=10101,Yh=new g(Kh,"Timeboost Decaf",new URL("https://espressosys.com/"),new URL("https://explorer.decaf.testnet.espresso.network/")),Zh=[ss,kh,Ah,_h,Th,Fh,qh,Vh],ep=[ss,Eh,Ih,Nh,Oh,zh,Wh,jh,Qh,Yh],rp=new Map([uh,hh,ph,yh,wh,mh,fh,gh,Ch,vh,bh,...Zh,...ep].map(r=>[r.namespace,r])),Pe=2147483648,tp=1103515245,op=12345;class le{state;constructor(e){this.state=e!==void 0?e:Math.floor(Math.random()*(Pe-1))}nextInt(){return this.state=(tp*this.state+op)%Pe,this.state}nextFloat(){return this.nextInt()/(Pe-1)}nextRange(e,t){const o=t-e,n=this.nextInt()/Pe;return e+Math.floor(n*o)}nextRangeBigInt(e,t){const o=t-e,n=BigInt(this.nextInt())*1000000n/BigInt(Pe);return e+n*o/1000000n}fillBytes(e){const t=new ArrayBuffer(e),o=new DataView(t);let n=0;for(;n<e-4;n+=4)o.setUint32(n,this.nextRange(0,4294967295));for(let c=n;c<e;c++)o.setUint8(c,this.nextRange(0,256));return t}}const lr=new Date,np=new Date(lr.getFullYear(),lr.getMonth(),lr.getDate()).valueOf();function sp(){return lr.valueOf()}function ur(){return np}const cs=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],as=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],is=["Linux","Unix","Windows","MacOS"],ds=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],cp=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],ls=[0,0,5,26,28,26,9,6],ap=ls.reduce((r,e)=>r+e,0),ip=ls.reduce((r,e)=>{const t=r[r.length-1]??0;return r.push(t+e),r},[]),dp=Array.from(bi(ip,cp,(r,e)=>[r,e]));function lp(r){const e=r.nextRange(0,ap),t=hi(dp,([a])=>a<=e),[,o]=gi(t),n=r.nextRange(0,o.length);return o[n]}function up(r){const e=r.nextRange(0,ds.length);return ds[e]}function hp(r){const e=r.nextRange(0,is.length);return is[e]}function pp(r){const e=r.nextRange(0,as.length);return as[e]}function wp(r){const e=r.nextRange(0,cs.length);return cs[e]}function mp(r){const[e,t]=up(r),[,o,n,c]=lp(r),a=hp(r),l=pp(r),m=wp(r);return{pubkey:new x("PUBKEY",r.fillBytes(32)),stateVerKey:new x("STATE_VER_KEY",r.fillBytes(32)),stake:r.nextRangeBigInt(0n,1000n)*1000000000000000000n,commission:r.nextRange(0,5e3),name:`${e} Node ${c} ${r.nextRange(0,100)}`,address:r.fillBytes(32),company:{name:e,website:t},location:{coords:[o,n],country:c},operatingSystem:a,networkType:m,nodeType:l}}function*fp(r=new le(ur())){const e=r.nextRange(100,350);for(let t=0;t<e;t++)yield mp(new le(t))}const us=Array.from(fp());async function*gp(){}function Cp(){const r=new Uint8Array(new Array(20).map(()=>0)).buffer;return{hash:new x("BLOCK",r),height:0,time:new Date(0),genTime:0,transactions:gp(),numTransactions:0,proposer:[],size:0,fees:[]}}async function*yp(r){let e=1,t=ur();const o=sp();for(;t<o;){const n=Math.floor(r.nextFloat()*14*1e3);yield vp(new le(e+n),e,t,t+n),t+=n,e++}}async function*P(r=new le(ur())){yield Cp(),yield*yp(r)}function vp(r,e,t,o){const n=Math.floor(r.nextRange(0,5)),c=r.nextRange(0,us.length),a=us[c];return{hash:new x("BLOCK",r.fillBytes(32)),height:e,genTime:o-t,time:new Date(o),numTransactions:n,transactions:xp(new le(e+t),e,t,o,n),proposer:[a.address],size:Math.floor(r.nextFloat()*1024*n)+8,fees:[j.ESP(BigInt(r.nextRange(0,1e9)*1e3))]}}const hs=Array.from(rp.keys());function bp(r){return r.nextFloat()>.98?1:hs[r.nextRange(0,hs.length)]}async function*xp(r,e,t,o,n){const c=(o-t)/n;for(let a=0,l=t;l<o;l+=c,a++){const m=bp(r),p=Math.floor(1024*r.nextFloat());yield{block:e,index:a,size:p,hash:new x("COMMIT",r.fillBytes(32)),time:new Date(l),sender:new x("PUBKEY",r.fillBytes(32)),tree:{namespace:m,data:r.fillBytes(p)}}}}async function*Ep(r){for(let e=r.next();!e.done;e=r.next())yield e.value}function Sp(r){return Ep(r[Symbol.iterator]())}async function*kp(r){for(let e=await r.next();!e.done;e=await r.next())yield e.value}async function*mo(r,e){for(let t=await r.next();!t.done;t=await r.next())e(t.value)&&(yield t.value)}function ps(r,e){return mo(r[Symbol.asyncIterator](),e)}async function*ue(r,e){for(let t=await r.next();!t.done;t=await r.next())yield await e(t.value)}function K(r,e){return ue(r[Symbol.asyncIterator](),e)}async function*ne(r,e){for(let t=0;t<e;t++){const o=await r.next();if(o.done)return;yield o.value}}function fo(r,e){return ne(r[Symbol.asyncIterator](),e)}async function*go(r,e){for(let t=await r.next();!t.done&&e(t.value);t=await r.next())yield t.value}function Co(r,e){return go(r[Symbol.asyncIterator](),e)}async function*se(r,e){for(let t=0;t<e;t++)if((await r.next()).done)return;yield*kp(r)}function hr(r,e){return se(r[Symbol.asyncIterator](),e)}async function _e(r){const e=await r.next();if(e.done)throw new ve;return e.value}async function Rp(r){return _e(r[Symbol.asyncIterator]())}async function Ip(r,e){for(let t=await r.next();!t.done;t=await r.next())if(e(t.value))return t.value}async function Bp(r,e){return Ip(r[Symbol.asyncIterator](),e)}async function ws(r){let e;for(let t=await r.next();!t.done;t=await r.next())e=t.value;if(e===void 0)throw new ve;return e}async function Ap(r){return ws(r[Symbol.asyncIterator]())}async function*ms(r,e){for(let t=await r.next();!t.done;t=await r.next())yield*e(t.value)}function fe(r,e){return ms(r[Symbol.asyncIterator](),e)}async function*yo(r){yield*yi(r)}async function Dp(r,e,t){const o=t;let n=e;for(let c=await o.next();!c.done;c=await o.next())n=r(await n,c.value);return n}async function*pr(r){let e=null;for(let t=await r.next();!t.done;t=await r.next())e=li(e,t.value);yield*fn(e)}function Le(r){return pr(r[Symbol.asyncIterator]())}function Y(r){return Dp(async(e,t)=>(e.push(t),e),Promise.resolve([]),r)}async function vo(r){return Y(r[Symbol.asyncIterator]())}new Promise(()=>{});function wr(r){return new dt(r.height,r.time.valueOf()/1e3,0,new st(0,"00","00"),[],new at(new ArrayBuffer(0)),new x("MERKLE_COMM",new Uint8Array([0,0,0,0]).buffer),new x("MERKLE_COMM",new Uint8Array([0,0,0,0]).buffer),new rt(new ArrayBuffer(0),new ArrayBuffer(0),0),new ot(new ArrayBuffer(0),new ArrayBuffer(0)))}async function Tp(r){return new ut(wr(r),new lt(await Y(K(r.transactions,async e=>new ke(e.tree.namespace,Array.from(new Uint8Array(e.tree.data)))))),new x("BLOCK",new Uint8Array([0,0,0,0]).buffer),r.size,r.numTransactions)}function Up(r){return new Ve(wr(r),new x("BLOCK",new Uint8Array([0,0,0,0]).buffer),r.size,r.numTransactions,r.proposer)}function Np(r){const e=r.transactions,t=wr(r);return K(e,async o=>new $e(o.hash,t,o.index,new ke(o.tree.namespace,Array.from(new Uint8Array(o.tree.data)))))}async function*Pp(r){const e=wr(r),t=r.transactions;yield*K(t,async o=>new Tt(new ke(o.tree.namespace,Array.from(new Uint8Array(o.tree.data))),new x("BLOCK",new Uint8Array([0,0,0,0]).buffer),new At(new x("POS",new Uint8Array([0,0,0,0]).buffer),[new Ke(new x("EMPTY",new Uint8Array([0,0,0,0]).buffer),[])]),e.height,new x("COMMIT",o.tree.data.slice(0,32))))}class _p{async getLeafFromHeight(e){const t=await this.getBlockFromHeight(e);return new vt(new Ct(e,new Xe(new Qe(new x("EMPTY",new Uint8Array([0,0,0,0]).buffer)),new x("EMPTY",new Uint8Array([0,0,0,0]).buffer),e,null,!1,null),new x("LEAF",new Uint8Array([0,0,0,0]).buffer),t.header,t.payload,[],t.header.timestamp,t.header.fee_info.account),new Xe(new Qe(new x("EMPTY",new Uint8Array([0,0,0,0]).buffer)),new x("EMPTY",new Uint8Array([0,0,0,0]).buffer),e,null,!1,null))}async getTransactionFromHeightAndOffset(e,t){const o=await _e(se(P(),e)),n=Pp(o);return await Rp(hr(n,t))}async getBlockSummaries(e,t){const o=se(P(),e),n=ne(o,t-e),c=ue(n,async a=>Up(a));return await Y(c)}async getBlockFromHeight(e){const t=se(P(),e),o=await _e(t);return Tp(o)}async*streamTransactionSummaries(e){const t=go(P(),c=>c.height<=e),o=pr(t);yield*fe(o,c=>Le(Np(c)))}async getTransactionSummaryRange(e,t,o){const n=this.streamTransactionSummaries(e),c=se(n,t),a=ne(c,o);return await Y(a)}async getTransactionSummaryRangeForRollup(e,t,o,n){const c=this.streamTransactionSummaries(t),a=mo(c,p=>p.transaction.vm===e),l=se(a,o),m=ne(l,n);return await Y(m)}}function fs(r){return new _t(r.hash,r.height,r.time,r.numTransactions,r.proposer,r.proposer,r.size,r.fees)}function bo(r){return new Ft(r.hash,r.height,r.proposer,r.numTransactions,r.size,r.time)}function gs(r,e){return new ao(new so(e.hash,e.block,!0,e.index,r.numTransactions,e.size,e.time,[],[]),[new oo(e.tree.namespace,e.tree.data)])}function mr(r,e){return new rr(e.hash,[e.tree.namespace],e.block,e.time,e.index,r.numTransactions)}class Lp{async getBlockDetail(e){const t=e.target,o=await(t===pe?Ap(P()):_e(hr(P(),t)));return new Lt(fs(o))}async getBlockSummaries(e){const t=go(P(),l=>e.from===pe||l.height<=e.from),o=pr(t),n=ne(o,e.limit),c=ue(n,async l=>bo(l)),a=await Y(c);return new zt(a)}async getTransactionDetail(e){const t=P();if(e instanceof Te){const o=Co(t,l=>l.height<=e.height),n=fe(o,l=>K(l.transactions,async m=>gs(l,m))),c=hr(Le(n),e.offset),a=await _e(c);return new tr(a)}if(e instanceof Ue){const o=fe(t,c=>K(c.transactions,async a=>gs(c,a))),n=await Bp(o,c=>c.details.hash===e.hash);if(!n)throw new $o(e.hash);return new tr(n)}throw new U}applyFilter(e,t){return t instanceof nr?ps(e,o=>o.height==t.block):t instanceof sr?ps(e,o=>o.rollups.indexOf(t.namespace)>=0):e}async getTransactionSummaries(e){const t=P(),{target:o,filter:n}=e;if(o instanceof ar){const a=fe(t,C=>K(C.transactions,async f=>mr(C,f))),l=Le(a),m=this.applyFilter(l,n),p=await vo(fo(m,o.limit));return new Ne(p)}if(o instanceof ir){const c=Co(t,f=>f.height<=o.height),a=fe(c,f=>K(f.transactions,async S=>mr(f,S))),l=Le(a),m=hr(l,o.offset),p=this.applyFilter(m,n),C=await vo(fo(p,o.limit));return new Ne(C)}if(o instanceof dr){const c=P(),a=fe(c,f=>K(f.transactions,async S=>new rr(S.hash,[S.tree.namespace],S.block,S.time,S.index,f.numTransactions))),l=Co(a,f=>f.hash!==o.hash),m=Le(l),p=this.applyFilter(m,n),C=await vo(fo(p,o.limit));return new Ne(C)}throw new U}async getExplorerOverview(){let e;const t=q(11),o=q(51),n=q(51),c=q(51),a=q(51),l=q(11);let m=0,p=0;const C=new Map;for await(const f of P()){e=fs(f),t.put(bo(f)),o.put(f.size),n.put(Math.round(f.genTime/1e3)),c.put(f.numTransactions),a.put(f.height),m++,p+=f.numTransactions;for await(const S of f.transactions){l.put(mr(f,S));const H=C.get(S.tree.namespace)||0;C.set(S.tree.namespace,H+1)}}return new Xt(new $t(e,new Wt(Array.from(C.keys()).length,p,m),Array.from(t),Array.from(l),new qt(Array.from(n),Array.from(o),Array.from(c),Array.from(a))))}async getSearchResult(e){const t=q(101),o=q(10),n=q(10);for await(const c of P())t.put(c);for(const c of t){c.hash.toString().startsWith(e.query)&&o.put(bo(c));for await(const a of c.transactions)a.hash.toString().startsWith(e.query)&&n.put(mr(c,a))}return new eo(new Yt(Array.from(o),Array.from(n)))}}class fr{constructor(e,t){this.lifetimeRewards=e,this.authData=t,Object.freeze(this)}toJSON(){return gr.encode(this)}}class Op{convert(e){return d(e,"lifetime_rewards","auth_data"),new fr(ae.decode(e.lifetime_rewards),R.decode(e.auth_data))}}class Mp{convert(e){return u(e,fr),{lifetime_rewards:ae.encode(e.lifetimeRewards),auth_data:R.encode(e.authData)}}}class Fp extends i{encoder=new Mp;decoder=new Op}const gr=new Fp,Cs=new J(new G(gr),new W(gr)),Hp=new le(ur());class zp{async getLatestRewardBalance(){return 123000000000000000000n}async getLatestRewardClaimInput(){return new fr(123000000000000000000n,Hp.fillBytes(5344))}async getRewardBalance(){return 123000000000000000000n}async getRewardClaimInput(e){const t=new le(e.height);return new fr(123000000000000000000n,t.fillBytes(5344))}}class Gp{async blockHeight(){return(await ws(P())).height}}class Wp{availability=new _p;status=new Gp;explorer=new Lp;rewardState=new zp;async setURL(){throw new U}}function M(r,e){return async t=>(await Jp(t,e),xo(t),r.convert(await t.json()))}async function Jp(r,e){if(!r.ok){if(r.status>=500&&r.status<600){try{if(xo(r),e!==void 0){const t=await r.json();throw e.convert(t)}}catch(t){if(t instanceof v)throw t;console.error("encountered an error attempting to decode a server error from the server",t)}throw new Po(r.status,r)}if(r.status>=400&&r.status<500){try{if(xo(r),e!==void 0){const t=await r.json();throw e.convert(t)}}catch(t){if(t instanceof v)throw t;console.error("encountered an error attempting to decode a client error from the server",t)}throw new Do(r.status,r)}throw new Uo(r.status,r)}}function xo(r){const e=r.headers.get("content-type");if(!e||!e.startsWith("application/json"))throw be.fromResponse(r,e||"undefined")}class ys{availability;constructor(e){this.availability=e}toJSON(){return vs.encode(this)}}class qp{convert(e){return d(e,"Availability"),new ys(Z.decode(e.Availability))}}class jp{convert(e){return u(e,ys),{Availability:Z.encode(e.availability)}}}class Vp extends i{encoder=new jp;decoder=new qp}const vs=new Vp;class $p{convert(e){return vs.decode(e).availability}}const Eo=new $p;async function Qp(r,e){return new Ve(r.header,r.hash,r.size,r.payload.transaction_nmt.length,[e.leaf.proposer_id])}async function*Xp(r,e){const t=e[Symbol.asyncIterator]();yield*K(Sp(r.leaf.block_payload.transaction_nmt),async o=>{const n=r.leaf.block_payload.transaction_nmt.indexOf(o),c=await t.next();if(c.done)throw new Error("Not enough transactions");return new $e(c.value.hash,r.leaf.block_header,n,o)})}class Kp{fetcher;baseURL;constructor(e,t){this.fetcher=e,this.baseURL=t}getLeafFromHeight(e){const t=new URL(`leaf/${e}`,this.baseURL);return this.fetcher(t).then(M(bt.decoder,Eo))}getTransactionFromHeightAndOffset(e,t){const o=new URL(`transaction/${e}/${t}`,this.baseURL);return this.fetcher(o).then(M(Ut.decoder,Eo))}async getBlockSummaries(e,t){const o=yo(t-e),n=ue(o,a=>Promise.all([this.getBlockFromHeight(e+a),this.getLeafFromHeight(e+a)])),c=ue(n,([a,l])=>Qp(a,l));return await Y(c)}getBlockFromHeight(e){const t=new URL(`block/${e}`,this.baseURL);return this.fetcher(t).then(M(ht.decoder,Eo))}async*streamBlocksFromHeightRange(e,t){const o=yo(e),n=ue(o,a=>this.getLeafFromHeight(e-a)),c=ms(n,a=>pr(Xp(a,ue(yo(a.leaf.block_payload.transaction_nmt.length),l=>this.getTransactionFromHeightAndOffset(a.leaf.block_header.height,l)))));if(t===void 0){yield*c;return}yield*ne(c,t)}async getTransactionSummaryRange(e,t,o){const n=this.streamBlocksFromHeightRange(e,50),c=se(n,t),a=ne(c,o);return await Y(a)}async getTransactionSummaryRangeForRollup(e,t,o,n){const c=this.streamBlocksFromHeightRange(t,50),a=mo(c,p=>p.transaction.vm===e),l=se(a,o),m=ne(l,n);return await Y(m)}}class bs{explorer;constructor(e){this.explorer=e}toJSON(){return Es.encode(this)}}class Yp{convert(e){return d(e,"Explorer"),new bs(So.decode(e.Explorer))}}class Zp{convert(e){return u(e,bs),{Explorer:So.encode(e.explorer)}}}class ew extends i{encoder=new Zp;decoder=new Yp}class xs{error;constructor(e){this.error=e}toJSON(){return So.encode(this)}}class rw{convert(e){return d(e,"error"),new xs(Z.decode(e.error))}}class tw{convert(e){return u(e,xs),{Explorer:Z.encode(e.error)}}}class ow extends i{encoder=new tw;decoder=new rw}const So=new ow,Es=new ew;class nw{convert(e){return Es.decode(e).explorer.error}}const ge=new nw;class sw{fetcher;baseURL;constructor(e,t){this.fetcher=e,this.baseURL=t}async getBlockDetail(e){const t=new URL(`block/${e.target}`,this.baseURL);return this.fetcher(t).then(M(Ot.decoder,ge))}async getBlockSummaries(e){const t=new URL(`blocks/${e.from}/${e.limit}`,this.baseURL);return this.fetcher(t).then(M(Gt.decoder,ge))}async getTransactionDetail(e){let t=null;if(e instanceof Ue?t=new URL(`transaction/hash/${e.hash}`,this.baseURL):e instanceof Te&&(t=new URL(`transaction/${e.height}/${e.offset}`,this.baseURL)),!t)throw new U;return this.fetcher(t).then(M(lo.decoder,ge))}async getTransactionSummaries(e){const{target:t,filter:o}=e;let n=t.convertURL(this.baseURL);return n=o.convertURL(n),this.fetcher(n).then(M(wo.decoder,ge))}async getExplorerOverview(){const e=new URL("explorer-summary",this.baseURL);return this.fetcher(e).then(M(Kt.decoder,ge))}async getSearchResult(e){const t=new URL(`search/${encodeURIComponent(e.query)}`,this.baseURL);return this.fetcher(t).then(M(ro.decoder,ge))}}class cw{fetcher;baseURL;rewardBalanceResponseValidator=M(Se.decoder);rewardClaimInputResponseValidator=M(gr.decoder);constructor(e,t){this.fetcher=e,this.baseURL=t}async getLatestRewardBalance(e){return this.fetcher(new URL(`reward-balance/latest/${e}`,this.baseURL)).then(this.rewardBalanceResponseValidator)}async getLatestRewardClaimInput(e){return this.fetcher(new URL(`reward-claim-input/latest/${e}`,this.baseURL)).then(this.rewardClaimInputResponseValidator)}async getRewardBalance(e){return this.fetcher(new URL(`reward-balance/${e.height}/${e.address}`,this.baseURL)).then(this.rewardBalanceResponseValidator)}async getRewardClaimInput(e){return this.fetcher(new URL(`reward-claim-input/${e.height}/${e.address}`,this.baseURL)).then(this.rewardClaimInputResponseValidator)}}class aw{fetcher;baseURL;blockHeightURL;blockHeightResponseValidator=M(s.decoder);constructor(e,t){this.fetcher=e,this.baseURL=t,this.blockHeightURL=new URL("block-height",this.baseURL)}blockHeight(){return this.fetcher(this.blockHeightURL).then(this.blockHeightResponseValidator)}}class Ss{availability;status;explorer;rewardState;constructor(e,t){this.availability=new Kp(e,new URL("availability/",t)),this.status=new aw(e,new URL("status/",t)),this.explorer=new sw(e,new URL("explorer/",t)),this.rewardState=new cw(e,new URL("reward-state-v2/",t))}async setURL(){throw new U}}class ks{constructor(e,t){this.height=e,this.address=t,Object.freeze(this)}toJSON(){return Oe.encode(this)}}class iw{convert(e){return d(e,"height","address"),new ks(s.decode(e.height),h.decode(e.address))}}class dw{convert(e){return u(e,ks),{height:s.encode(e.height),address:h.encode(e.address)}}}class lw extends i{encoder=new dw;decoder=new iw}const Oe=new lw;new J(new G(Oe),new W(Oe));class uw{service;constructor(e){this.service=e}blockHeight(){return this.service.blockHeight()}async handleRequest(e){switch(e.method){case"blockHeight":return this.blockHeight();default:throw new U}}}class hw{service;constructor(e){this.service=e}async getLeafFromHeight(e){return bt.encode(await this.service.getLeafFromHeight(e))}async getTransactionFromHeightAndOffset(e,t){return Ut.encode(await this.service.getTransactionFromHeightAndOffset(e,t))}async getBlockFromHeight(e){return ht.encode(await this.service.getBlockFromHeight(e))}async getBlockSummaries(e,t){return Ud.encode(await this.service.getBlockSummaries(e,t))}async getTransactionSummaryRange(e,t,o){return Bn.encode(await this.service.getTransactionSummaryRange(e,t,o))}async getTransactionSummaryRangeForRollup(e,t,o,n){return Bn.encode(await this.service.getTransactionSummaryRangeForRollup(e,t,o,n))}async handleRequest(e){switch(e.method){case"getLeafFromHeight":return await this.getLeafFromHeight(s.decode(e.param[0]));case"getTransactionFromHeightAndOffset":return await this.getTransactionFromHeightAndOffset(s.decode(e.param[0]),s.decode(e.param[1]));case"getBlockFromHeight":return await this.getBlockFromHeight(s.decode(e.param[0]));case"getBlockSummaries":return await this.getBlockSummaries(s.decode(e.param[0]),s.decode(e.param[1]));case"getTransactionSummaryRange":return await this.getTransactionSummaryRange(s.decode(e.param[0]),s.decode(e.param[1]),s.decode(e.param[2]));case"getTransactionSummaryRangeForRollup":return await this.getTransactionSummaryRangeForRollup(s.decode(e.param[0]),s.decode(e.param[1]),s.decode(e.param[2]),s.decode(e.param[3]));default:throw new U}}}class pw{service;constructor(e){this.service=e}async getBlockDetail(e){return Ot.encode(await this.service.getBlockDetail(e))}async getBlockSummaries(e){return Gt.encode(await this.service.getBlockSummaries(e))}async getTransactionDetail(e){return lo.encode(await this.service.getTransactionDetail(e))}async getTransactionSummaries(e){return wo.encode(await this.service.getTransactionSummaries(e))}async getExplorerOverview(){return Kt.encode(await this.service.getExplorerOverview())}async getSearchResult(e){return ro.encode(await this.service.getSearchResult(e))}async handleRequest(e){switch(e.method){case"getBlockDetail":return await this.getBlockDetail(Fn.decode(e.param[0]));case"getBlockSummaries":return await this.getBlockSummaries(Vn.decode(e.param[0]));case"getTransactionDetail":return this.getTransactionDetail(Zn.decode(e.param[0]));case"getTransactionSummaries":return this.getTransactionSummaries(os.decode(e.param[0]));case"getExplorerOverview":return this.getExplorerOverview();case"getSearchResult":return this.getSearchResult(Yn.decode(e.param[0]))}}}class ww{service;constructor(e){this.service=e}async getLatestRewardBalance(e){return Se.encode(await this.service.getLatestRewardBalance(e))}async getLatestRewardClaimInput(e){return Cs.encode(await this.service.getLatestRewardClaimInput(e))}async getRewardBalance(e){return Se.encode(await this.service.getRewardBalance(e))}async getRewardClaimInput(e){return Cs.encode(await this.service.getRewardClaimInput(e))}async handleRequest(e){switch(e.method){case"getLatestRewardBalance":return await this.getLatestRewardBalance(h.decode(e.param[0]));case"getLatestRewardClaimInput":return await this.getLatestRewardClaimInput(h.decode(e.param[0]));case"getRewardBalance":return await this.getRewardBalance(Oe.decode(e.param[0]));case"getRewardClaimInput":return await this.getRewardClaimInput(Oe.decode(e.param[0]));default:throw new U}}}class Rs{availability;status;explorer;rewardState;constructor(e){this.availability=new hw(e.availability),this.status=new uw(e.status),this.explorer=new pw(e.explorer),this.rewardState=new ww(e.rewardState)}async handleRequest(e){switch(e.api){case"availability":return this.availability.handleRequest(e);case"status":return this.status.handleRequest(e);case"explorer":return this.explorer.handleRequest(e);case"reward-state":return this.rewardState.handleRequest(e);default:throw new U}}}const Is=async(r,e)=>{try{return await fetch(r,e)}catch(t){throw new _o(t)}};async function mw(){try{const e=await(await fetch("/config.json")).json();if(e.hotshot_query_service_url){const t=new URL(e.hotshot_query_service_url);return new Ss(Is,t)}}catch{}return new Wp}async function fw(){return new Rs(await mw())}class gw{service;postMessage;requestChannel;constructor(e){this.postMessage=e,this.service=fw(),this.requestChannel=Qa(10),this.processRequests()}async handleProxyRequest(e){if(e.method==="set-url"){const t=e.param[0];if(!t||typeof t!="string")throw new U("Invalid URL provided");return this.service=Promise.resolve(new Rs(new Ss(Is,new URL(t)))),!0}else throw new U(`Unknown proxy method: ${e.method}`)}async processRequests(){for await(const e of this.requestChannel)try{const t=await this.service;let o;e.api==="proxy"?o=await this.handleProxyRequest(e):o=await t.handleRequest(e),this.postMessage(Sn.encode(new Zr(e.requestID,o)))}catch(t){this.postMessage(kn.encode(new et(e.requestID,t)))}}async handleEvent(e){const t=Qi.decode(e.data);await this.requestChannel.publish(t)}}self.addEventListener("message",new gw(self.postMessage.bind(self)))})();
