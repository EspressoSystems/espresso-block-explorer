var HA=Object.defineProperty;var WA=(le,Z,ve)=>Z in le?HA(le,Z,{enumerable:!0,configurable:!0,writable:!0,value:ve}):le[Z]=ve;var n=(le,Z,ve)=>WA(le,typeof Z!="symbol"?Z+"":Z,ve);(function(){"use strict";class le{assert(){}}function Z(){return new le}const ve=Z();function T(t,e){ve.assert(t,e)}function to(t,e){T(typeof t===e,`type assertion failed: expected "${e}", received "${typeof t}"`)}function $i(t){T(t!==null,"expected a non-null value, received null")}function A(t,e){T(t instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof t=="object"&&t!==null?t.constructor.name:typeof t}"`)}class oo extends Error{constructor(o,r,s=`expected object with key: "${r}", instead found ${o}`){super(s);n(this,"key");n(this,"haveType");this.haveType=o,this.key=r,Object.freeze(this)}toJSON(){return{code:oo.name,message:this.message,have:this.haveType,key:this.key}}}class ue{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class a extends ue{}function wt(t){return typeof t=="number"}function ee(t){return typeof t=="string"}function Xi(t){return typeof t=="bigint"}function as(t){return typeof t=="object"&&t!==null}function ft(t){return t!==void 0}function Yi(t,e){return Array.isArray(t)&&t.every(e)}function Ki(t){return e=>Yi(e,t)}function no(t,e,o){return as(t)&&e in t&&o(t[e])}function G(t,...e){return as(t)&&e.every(o=>o in t)}function d(t,...e){if(typeof t!="object")throw new Error("expected object");if(t===null)throw new Error("received null");for(const o of e)if(!(o in t))throw new oo("object",o)}function S(t,e){if(!ee(t.code))throw new Error("code must be a string");if(t.code!==e)throw new Error(`expected code to be ${e}, got ${t.code}`)}function he(t,e){if(!ee(t.type))throw new Error("type must be a string");if(t.type!==e)throw new Error(`expected type to be ${e}, got ${t.type}`)}class v extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return j.convert(this)}}class _{convert(e){return A(e,v),{code:e.code,message:e.message}}}const j=new _,Zi="NoCodecFoundError";class Le extends Error{constructor(o,r=`no codec found for: "${o}"`){super(r);n(this,"codec");this.codec=o,Object.freeze(this);debugger}toJSON(){return{code:u.encode(Le.name),message:u.encode(this.message),codec:u.encode(this.codec)}}get code(){return Zi}}const ro=new Map;class ed{convert(e){d(e,"code");const o=u.decode(e.code),r=ro.get(o);if(!r)throw new Le(o);return r.decode(e)}}class td{convert(e){const o=ro.get(e.code);if(!o)throw new Le(e.code);return o.encode(e)}}class od extends ue{constructor(){super(...arguments);n(this,"encoder",new td);n(this,"decoder",new ed)}}const pt=new od;function k(t,e){ro.set(t,e)}const so="InvalidTypeError";class m extends v{constructor(o,r,s=`invalid type: have "${o}", want "${r}"`){super(s);n(this,"have");n(this,"want");this.have=o,this.want=r,Object.freeze(this)}toJSON(){return is.encode(this)}get code(){return so}}class nd{convert(e){return d(e,"code","have","want","message"),S(e,so),new m(u.decode(e.have),u.decode(e.want),u.decode(e.message))}}class rd{convert(e){return A(e,m),{...j.convert(e),have:u.encode(e.have),want:u.encode(e.want)}}}class sd extends a{constructor(){super(...arguments);n(this,"encoder",new rd);n(this,"decoder",new nd)}}const is=new sd;k(so,is);const ds=Ki(ft);class cd{convert(e){return e}}const ls=new cd;class ad extends ue{constructor(){super(...arguments);n(this,"encoder",ls);n(this,"decoder",ls)}}const mt=new ad;class B{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){if(!ds(e)){const o=typeof e=="object"&&e!==null?e.constructor.name:typeof e,r="array";throw new Error(`invalid array value: have "${o}", want "${r}"`)}return e.map(o=>this.itemCodec.decode(o))}}class E{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return A(e,Array),e.map(o=>this.itemCodec.encode(o))}}class x extends a{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=r,this.decoder=o}}class V{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class U{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:($i(e),this.itemCodec.encode(e))}}class H extends a{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=r,this.decoder=o}}class id{convert(e){if(!ee(e))throw new m(typeof e,"string");return e}}class dd{convert(e){return to(e,"string"),e}}class ld extends a{constructor(){super(...arguments);n(this,"encoder",new dd);n(this,"decoder",new id)}}const u=new ld;new x(new B(u),new E(u));const J=new H(new V(u),new U(u));function Be(t){return!t||!t.trim()?null:t}class co extends v{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return us}}const us="CompleterAlreadyCompletedError";class ud{convert(e){return d(e,"code","message"),S(e,us),new co(u.decode(e.message))}}class hd extends _{}class wd extends a{constructor(){super(...arguments);n(this,"encoder",new hd);n(this,"decoder",new ud)}}const fd=new wd;k(co.name,fd);function gt(){return T(!1,"completer is not ready, this should never be reached")}function At(){throw new co}class pd{constructor(){n(this,"resolve",gt);n(this,"reject",gt);n(this,"completed",!1);n(this,"promise");this.promise=new Promise((e,o)=>{this.resolve=e,this.reject=o}),T(this.resolve!==gt,"resolve should be set"),T(this.reject!==gt,"resolve should be set")}get isCompleted(){return this.completed}complete(e){const o=this.resolve,r=this.reject;if(this.completed=!0,this.resolve=At,this.reject=At,e instanceof Promise){e.then(o,r);return}o(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=At,this.reject=At}}function we(){return new pd}class Me extends v{constructor(o,r,s){super(s);n(this,"response");n(this,"status");this.status=o,this.response=r}toJSON(){return hs.convert(this)}}class Ct{convert(e){return A(e,Me),{...j.convert(e),status:e.status}}}const hs=new Ct,ao="BadResponseClientError";class md extends Me{constructor(e,o,r="bad server response: client error"){super(e,o,r),Object.freeze(this)}get code(){return ao}toJSON(){return ws.encode(this)}}class gd{convert(e){return d(e,"code","message","status"),S(e,ao),new md(Number(e.status),null,u.decode(e.message))}}class Ad extends Ct{}class Cd extends a{constructor(){super(...arguments);n(this,"encoder",new Ad);n(this,"decoder",new gd)}}const ws=new Cd;k(ao,ws);const io="BadResponseError";class bd extends Me{constructor(e,o,r="bad server response"){super(e,o,r),Object.freeze(this)}get code(){return io}toJSON(){return fs.encode(this)}}class yd{convert(e){return d(e,"code","message","status"),S(e,io),new bd(Number(e.status),null,u.decode(e.message))}}class Sd extends Ct{}class kd extends a{constructor(){super(...arguments);n(this,"encoder",new Sd);n(this,"decoder",new yd)}}const fs=new kd;k(io,fs);class vd extends Me{constructor(e,o,r="bad server response: server error"){super(e,o,r),Object.freeze(this)}get code(){return lo}}const lo="BadResponseServerError";class Bd{convert(e){return d(e,"code","message","status"),S(e,lo),new vd(Number(e.status),null,u.decode(e.message))}}class Ed extends Ct{}class xd extends a{constructor(){super(...arguments);n(this,"encoder",new Ed);n(this,"decoder",new Bd)}}const Rd=new xd;k(lo,Rd);const uo="ChannelClosedError";class Ve extends v{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return uo}}class Nd{convert(e){return d(e,"code","message"),S(e,uo),new Ve(u.decode(e.message))}}class Id extends _{}class Dd extends a{constructor(){super(...arguments);n(this,"encoder",new Id);n(this,"decoder",new Nd)}}const Pd=new Dd;k(uo,Pd);const ho="FetchError";class Od extends v{constructor(o,r=`fetch failed: ${String(o)}`){super(r);n(this,"cause");this.cause=o,Object.freeze(this)}get code(){return ho}}class Td{convert(e){return d(e,"code","message"),S(e,ho),new Od({},u.decode(e.message))}}class Ld extends _{}class Md extends a{constructor(){super(...arguments);n(this,"encoder",new Ld);n(this,"decoder",new Td)}}const Vd=new Md;k(ho,Vd);const wo="IncorrectBase64PaddingError";class ps extends v{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return wo}}class Ud{convert(e){return d(e,"code","message"),S(e,wo),new ps(u.decode(e.message))}}class Hd extends _{}class Wd extends a{constructor(){super(...arguments);n(this,"encoder",new Hd);n(this,"decoder",new Ud)}}const _d=new Wd;k(wo,_d);class zd{convert(e){if(!wt(e))throw new m(typeof e,"number");return e}}class Fd{convert(e){return to(e,"number"),e}}class Jd extends a{constructor(){super(...arguments);n(this,"encoder",new Fd);n(this,"decoder",new zd)}}const h=new Jd,ms=new H(new V(h),new U(h)),fe=new x(new B(h),new E(h)),re=new x(new B(ms),new E(ms)),fo="InvalidBase64AlphabetLengthError";class po extends v{constructor(o,r=`alphabet needs to be 64 characters, received ${o}`){super(r);n(this,"length");this.length=o,Object.freeze(this)}toJSON(){return gs.encode(this)}get code(){return fo}}class Gd{convert(e){return d(e,"code","length","message"),S(e,fo),new po(h.decode(e.length),u.decode(e.message))}}class Qd{convert(e){return A(e,po),{...j.convert(e),length:h.encode(e.length)}}}class qd extends a{constructor(){super(...arguments);n(this,"encoder",new Qd);n(this,"decoder",new Gd)}}const gs=new qd;k(fo,gs);const mo="InvalidHexStringError";class As extends v{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return mo}}class jd{convert(e){return d(e,"code","message"),S(e,mo),new As(u.decode(e.message))}}class $d extends _{}class Xd extends a{constructor(){super(...arguments);n(this,"encoder",new $d);n(this,"decoder",new jd)}}const Yd=new Xd;k(mo,Yd);const go="InvalidHexValueError";class Cs extends v{constructor(o,r=`invalid hex value "${o}"`){super(r);n(this,"value");this.value=o,Object.freeze(this)}toJSON(){return bs.encode(this)}get code(){return go}}class Kd{convert(e){return d(e,"code","value","message"),S(e,go),new Cs(h.decode(e.value),u.decode(e.message))}}class Zd{convert(e){return{...j.convert(e),value:h.encode(e.value)}}}class el extends a{constructor(){super(...arguments);n(this,"encoder",new Zd);n(this,"decoder",new Kd)}}const bs=new el;k(go,bs);const Ao="InvalidInputError";class se extends v{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return Ao}}class tl{convert(e){return d(e,"code","message"),S(e,Ao),new se(u.decode(e.message))}}class ol extends _{}class nl extends a{constructor(){super(...arguments);n(this,"encoder",new ol);n(this,"decoder",new tl)}}const rl=new nl;k(Ao,rl);const Co="InvalidStringValueError";class ys extends v{constructor(o,r,s=`invalid string value: have "${o}", want "${r}"`){super(s);n(this,"have");n(this,"want");this.have=o,this.want=r,Object.freeze(this)}toJSON(){return Ss.encode(this)}get code(){return Co}}class sl{convert(e){return d(e,"code","have","want","message"),S(e,Co),new ys(u.decode(e.have),u.decode(e.want),u.decode(e.message))}}class cl{convert(e){return A(e,ys),{...j.convert(e),have:u.encode(e.have),want:u.encode(e.want)}}}class al extends a{constructor(){super(...arguments);n(this,"encoder",new cl);n(this,"decoder",new sl)}}const Ss=new al;k(Co,Ss);const bo="InvalidTaggedBase64EncodingError";class ks extends v{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return vs.encode(this)}get code(){return bo}}class il{convert(e){return d(e,"code","message"),S(e,bo),new ks(u.decode(e.message))}}class dl extends _{}class ll extends a{constructor(){super(...arguments);n(this,"encoder",new dl);n(this,"decoder",new il)}}const vs=new ll;k(bo,vs);const yo="MissingElementError";class bt extends v{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return yo}}class ul{convert(e){return d(e,"code","message"),S(e,yo),new bt(u.decode(e.message))}}class hl extends _{}class wl extends a{constructor(){super(...arguments);n(this,"encoder",new hl);n(this,"decoder",new ul)}}const fl=new wl;k(yo,fl);const So="NoCompleterFoundForRequestID";class Bs extends v{constructor(o,r=`no completer found for request id "${o}"`){super(r);n(this,"requestID");this.requestID=o,Object.freeze(this)}toJSON(){return Es.encode(this)}get code(){return So}}class pl{convert(e){return d(e,"code","requestID","message"),S(e,So),new Bs(mt.decode(e.requestID),u.decode(e.message))}}class ml{convert(e){return A(e,Bs),{...j.convert(e),requestID:mt.encode(e.requestID)}}}class gl extends a{constructor(){super(...arguments);n(this,"encoder",new ml);n(this,"decoder",new pl)}}const Es=new gl;k(So,Es);const ko="NotFoundError";class Al extends v{constructor(o,r=`Not Found: ${o}`){super(r);n(this,"key");this.key=o,Object.freeze(this)}get code(){return ko}}class xs{constructor(e){n(this,"codec");this.codec=e}convert(e){return d(e,"code","key"),S(e,ko),new Al(this.codec.decode(e.key))}}class Rs{constructor(e){n(this,"codec");this.codec=e}convert(e){return{...j.convert(e),key:this.codec.encode(e.key)}}}class Ns extends a{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=o,this.decoder=r}}new Ns(new Rs(u),new xs(u));const Cl=new Ns(new Rs(mt),new xs(mt));k(ko,Cl);const vo="NoURLProvidedError";class bl extends v{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return vo}}class yl{convert(e){return d(e,"code","message"),S(e,vo),new bl(u.decode(e.message))}}class Sl extends _{}class kl extends a{constructor(){super(...arguments);n(this,"encoder",new Sl);n(this,"decoder",new yl)}}const vl=new kl;k(vo,vl);const Bo="UnimplementedError";class z extends v{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return Bo}}class Bl{convert(e){return d(e,"code","message"),S(e,Bo),new z(u.decode(e.message))}}class El extends _{}class xl extends a{constructor(){super(...arguments);n(this,"encoder",new El);n(this,"decoder",new Bl)}}const Rl=new xl;k(Bo,Rl);const Eo="QUERY_ERROR";class Nl extends v{constructor(o,r="missing element"){super(r);n(this,"error");this.error=o,Object.freeze(this)}get code(){return Eo}}class Il{convert(e){return d(e,"code","error","message"),S(e,Eo),new Nl(Os.decode(e.error),u.decode(e.message))}}class Dl{convert(e){return{code:e.code,error:Os.encode(e.error),message:u.encode(e.message)}}}class Pl extends a{constructor(){super(...arguments);n(this,"encoder",new Dl);n(this,"decoder",new Il)}}const Ol=new Pl;class xo{}const Ro="NotFound";class Is extends xo{constructor(){super(),Object.freeze(this)}valueOf(){return Ro}toJSON(){return this.valueOf()}}const Tl=new Is,No="Missing";class Ds extends xo{constructor(){super(),Object.freeze(this)}valueOf(){return No}toJSON(){return this.valueOf()}}const Ll=new Ds;class Ps extends xo{constructor(o){super();n(this,"error");this.error=o,Object.freeze(this)}toJSON(){return Do.encode(this)}}class Ml{constructor(e){n(this,"message");this.message=e,Object.freeze(this)}toJSON(){return Io.encode(this)}}class Vl{convert(e){return d(e,"message"),new Ml(u.decode(e.message))}}class Ul{convert(e){return{message:u.encode(e.message)}}}class Hl extends a{constructor(){super(...arguments);n(this,"encoder",new Ul);n(this,"decoder",new Vl)}}const Io=new Hl;class Wl{convert(e){return d(e,"Error"),new Ps(Io.decode(e.Error))}}class _l{convert(e){return{Error:Io.encode(e.error)}}}class zl extends a{constructor(){super(...arguments);n(this,"encoder",new _l);n(this,"decoder",new Wl)}}const Do=new zl;class Fl{convert(e){return e===Ro?Tl:e===No?Ll:Do.decode(e)}}class Jl{convert(e){if(e instanceof Is)return Ro;if(e instanceof Ds)return No;if(e instanceof Ps)return Do.encode(e);throw new z}}class Gl extends a{constructor(){super(...arguments);n(this,"encoder",new Jl);n(this,"decoder",new Fl)}}const Os=new Gl;k(Eo,Ol);const Ts="ResponseContentTypeIsNotApplicationJSONError";class yt extends Me{constructor(o,r,s,c="response content type is not application/json"){super(r,s,c);n(this,"haveHeaderType");this.haveHeaderType=o,Object.freeze(this)}static fromResponse(o,r){return new yt(o.headers.get("content-type")??"undefined",o.status,o,r)}toJSON(){return Ls.encode(this)}get code(){return Ts}}class Ql{convert(e){return d(e,"code","status","have","want","message"),S(e,Ts),new yt(u.decode(e.code),h.decode(e.status),null,u.decode(e.message))}}class ql{convert(e){return{...hs.convert(e),have:u.encode(e.haveHeaderType),want:u.encode("application/json")}}}class jl extends a{constructor(){super(...arguments);n(this,"encoder",new ql);n(this,"decoder",new Ql)}}const Ls=new jl;k(yt.name,Ls);const Po="WebWorkerErrorResponse";class $l extends v{constructor(o,r="error in web worker"){super(r);n(this,"error");this.error=o,Object.freeze(this)}toJSON(){return Ms.encode(this)}get code(){return Po}}class Xl{convert(e){return d(e,"code","error","message"),S(e,Po),new $l(pt.decode(e.error),u.decode(e.message))}}class Yl{convert(e){return{...j.convert(e),error:pt.encode(e.error)}}}class Kl extends a{constructor(){super(...arguments);n(this,"encoder",new Yl);n(this,"decoder",new Xl)}}const Ms=new Kl;k(Po,Ms);var Vs=(t=>(t[t.success=0]="success",t[t.full=1]="full",t[t.failed=2]="failed",t))(Vs||{});class Zl{getFromEmpty(){}}class eu{getFromEmpty(){throw new bt}}const Us={returnUndefined:new Zl,throwMissingElement:new eu};class tu{constructor(e){n(this,"maxSize");T(!Number.isNaN(e),"maxSize must not be NaN"),T(Number.isInteger(e),"maxSize must be an integer"),T(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return T(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class ou{constructor(e){n(this,"preComputedSizeMinus1");T(!Number.isNaN(e),"maxSize must not be NaN"),T(Number.isInteger(e),"maxSize must be an integer"),T(e>0,"maxSize must be greater than 0"),T(Hs(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return T(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function Hs(t){return(t&t-1)===0}const Oo="BufferFullError";class Ws extends v{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return Oo}}class nu{convert(e){return d(e,"code","message"),S(e,Oo),new Ws(u.decode(e.message))}}class ru extends _{}class su extends a{constructor(){super(...arguments);n(this,"encoder",new ru);n(this,"decoder",new nu)}}const cu=new su;k(Oo,cu);class au{putToFull(e,o){return e.get(),e.put(o)}}class iu{putToFull(){throw new Ws}}const _s={overwriteOldest:new au,throw:new iu};function du(t){return Hs(t)?new ou(t):new tu(t)}class lu{constructor(e,o,r){n(this,"readIndex",0);n(this,"writeIndex",0);n(this,"buffer");n(this,"nextIndex");n(this,"getOnEmpty");n(this,"putOnFull");T(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=du(e),this.getOnEmpty=o,this.putOnFull=r}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const o=this.nextIndex.nextIndex(this.writeIndex);return o===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=o,Vs.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new uu(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new hu(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class uu{constructor(e){n(this,"buffer");this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class hu{constructor(e,o,r,s){n(this,"readIndex");n(this,"writeIndex");n(this,"buffer");n(this,"nextIndex");this.readIndex=e,this.writeIndex=o,this.buffer=r,this.nextIndex=s}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function pe(t=32,e=Us.returnUndefined,o=_s.overwriteOldest){return new lu(t,e,o)}class wu{constructor(e){n(this,"publishQueue");n(this,"pollBlocked");n(this,"publishBlocked");n(this,"capacity");n(this,"closed",!1);this.publishQueue=pe(Math.max(2,e),Us.throwMissingElement,_s.throw);const o=we();this.pollBlocked=o,this.publishBlocked=o,o.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new Ve;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new Ve;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const o=we();this.publishBlocked=o,await o.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new Ve;if(this.pollBlocked.isCompleted){const o=we();this.pollBlocked=o}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new fu(this)}}class fu{constructor(e){n(this,"channel");this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof Ve)return{done:!0,value:void 0};throw e}}}function me(t){return new wu(t)}class pu{constructor(e){n(this,"channel");this.channel=e}async send(e){await this.channel.publish(e)}}function ge(t){return new pu(t)}const To="CorruptBase64InputError";class ce extends v{constructor(o,r=`corrupt input error at ${o}`){super(r);n(this,"offset");this.offset=o,Object.freeze(this)}get code(){return To}toJSON(){return zs.encode(this)}}class mu{convert(e){return d(e,"code","offset","message"),S(e,To),new ce(h.decode(e.offset),u.decode(e.message))}}class gu{convert(e){return A(e,ce),{...j.convert(e),offset:h.encode(e.offset),message:u.encode(e.message)}}}class Au extends a{constructor(){super(...arguments);n(this,"encoder",new gu);n(this,"decoder",new mu)}}const zs=new Au;k(To,zs);const Cu=new TextEncoder;function Fs(t){return Cu.encode(t)}const bu=new TextDecoder;function yu(t){return bu.decode(t)}function*Js(t){yield*Fs(t)}function*Su(){for(let t=0;t<256;t++)yield 255}const Ue=-1,ku=61;class He{constructor(e,o,r=ku,s=!1){n(this,"encodeMap");n(this,"decodeMap");n(this,"padChar");n(this,"strict");this.encodeMap=e,this.decodeMap=o,this.padChar=r,this.strict=s}static withAlphabet(e){const o=e.length;if(o!==64)throw new po(o);const r=Array.from(Js(e)),s=Array.from(Su());for(let c=0;c<o;c++)s[r[c]]=c;return new He(r,s)}withPadding(e){return new He(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let o=0,r=0;const s=Math.floor(e.byteLength/3)*3,c=Math.ceil(e.byteLength/3)*4,i=new ArrayBuffer(c),l=new DataView(e),f=new DataView(i);for(;r<s;){const O=l.getUint8(r+0)<<16|l.getUint8(r+1)<<8|l.getUint8(r+2);f.setUint8(o+0,this.encodeMap[O>>18&63]),f.setUint8(o+1,this.encodeMap[O>>12&63]),f.setUint8(o+2,this.encodeMap[O>>6&63]),f.setUint8(o+3,this.encodeMap[O&63]),r+=3,o+=4}const w=e.byteLength-r;if(w===0)return i;let b=l.getUint8(r+0)<<16;switch(w===2&&(b|=l.getUint8(r+1)<<8),f.setUint8(o+0,this.encodeMap[b>>18&63]),f.setUint8(o+1,this.encodeMap[b>>12&63]),w){case 2:return f.setUint8(o+2,this.encodeMap[b>>6&63]),this.padChar!==Ue?(f.setUint8(o+3,this.padChar),i.slice(0,o+4)):i.slice(0,o+3);case 1:if(this.padChar!==Ue)return f.setUint8(o+2,this.padChar),f.setUint8(o+3,this.padChar),i.slice(0,o+4);break}return i.slice(0,o+2)}decode(e){const o=e.byteLength;if(o===0)return new ArrayBuffer(0);const r=new DataView(e),s=new ArrayBuffer(Math.floor(o/4*3)),c=new DataView(s),i=new ArrayBuffer(4),l=new DataView(i);let f=0,w=0,b=0,O=!1;for(;w<o&&!O;){let g=3,p=4;for(let I=0;I<4;I++){if(w===o){if(I===0)return s;if(I===1||this.padChar!==Ue)throw new ce(w-I);g=I-1,p=I,O=!0;break}const F=r.getUint8(w);w++;const ht=this.decodeMap[F];if(ht!==255){l.setUint8(I,ht);continue}if(F===10||F===13){I--;continue}if(F===this.padChar){switch(I){case 0:case 1:throw new ps;case 2:for(;w<o&&(r.getUint8(w)===10||r.getUint8(w)===13);)w++;if(w===o)throw new ce(o);w++}for(;w<o&&(r.getUint8(w)===10||r.getUint8(w)===13);)w++;if(w<o)throw new ce(w);g=3,p=I,O=!0;break}throw new ce(w-1)}const L=l.getUint8(0)<<18|l.getUint8(1)<<12|l.getUint8(2)<<6|l.getUint8(3);switch(l.setUint8(2,L>>0&255),l.setUint8(1,L>>8&255),l.setUint8(0,L>>16&255),p){case 4:c.setUint8(b+2,l.getUint8(2)),l.setUint8(2,0);case 3:if(c.setUint8(b+1,l.getUint8(1)),this.strict&&l.getUint8(2)!==0)throw new ce(w-1);case 2:if(c.setUint8(b+0,l.getUint8(0)),this.strict&&(l.getUint8(1)!==0||l.getUint8(2)!==0))throw new ce(w-2)}b+=g,f+=p-1}return s.slice(0,f)}decodeString(e){return this.decode(Fs(e).buffer)}encodeToString(e){return yu(this.encode(e))}}const Lo=He.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),vu=Lo.withPadding(Ue),Gs=He.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Mo=Gs.withPadding(Ue);function*Bu(t,e){for(let o=t.next();!o.done;o=t.next())e(o.value)&&(yield o.value)}function Vo(t,e){return Bu(t[Symbol.iterator](),e)}function*Qs(t,e){for(let o=t.next();!o.done;o=t.next())yield e(o.value)}function $(t,e){return Qs(t[Symbol.iterator](),e)}function*Eu(t,e){for(let o=0;o<e;o++){const r=t.next();if(r.done)return;yield r.value}}function xu(t,e){return Eu(t[Symbol.iterator](),e)}function qs(t){const e=t.next();if(e.done)throw new bt;return e.value}function Ru(t){let e;for(let o=t.next();!o.done;o=t.next())e=o.value;if(e===void 0)throw new bt;return e}function Nu(t){return Ru(t[Symbol.iterator]())}function*Iu(t,e){for(let o=t.next();!o.done;o=t.next())yield*e(o.value)}function Uo(t,e){return Iu(t[Symbol.iterator](),e)}function*Du(){let t=0;for(;;)yield t++}function Ho(t){return xu(Du(),Math.ceil(t))}function js(t,e,o){const r=o;let s=e;for(let c=r.next();!c.done;c=r.next())s=t(s,c.value);return s}function*Pu(t,e,o){for(let r=t.next(),s=e.next();!r.done&&!s.done;r=t.next(),s=e.next())yield o(r.value,s.value)}function Wo(t,e,o){return Pu(t[Symbol.iterator](),e[Symbol.iterator](),o)}function _o(t){if(t.startsWith("0x"))return _o(t.substring(2));if((t.length&1)!==0)return _o("0"+t);const e=new ArrayBuffer(t.length/2);return Ou(Js(t),e),e}function Ou(t,e){const o=new DataView(e);let r=0;for(;r<e.byteLength;){const s=t.next(),c=t.next();if(s.done||c.done)throw new As;const i=$s(s.value),l=$s(c.value),f=i<<4|l;o.setUint8(r,f),r++}}function $s(t){if(t>=48&&t<=57)return t-48;if(t>=97&&t<=102)return t-97+10;if(t>=65&&t<=70)return t-65+10;throw new Cs(t)}function Tu(t){return t.toString(16).padStart(2,"0")}function*Lu(t){yield*Qs(t,Tu)}function Xs(t){return Lu(t[Symbol.iterator]())}class Mu{convert(e){if(typeof e!="string")throw new m(typeof e,"string");return _o(e)}}class Vu{convert(e){return["0x",...Xs(new Uint8Array(e))].join("")}}class Uu extends a{constructor(){super(...arguments);n(this,"encoder",new Vu);n(this,"decoder",new Mu)}}const M=new Uu;new H(new V(M),new U(M));const Ys=new x(new B(M),new E(M));class Hu{convert(e){return e instanceof Array?Ys.decode(e):[M.decode(e)]}}class Wu{convert(e){return Ys.encode(e)}}class _u extends a{constructor(){super(...arguments);n(this,"encoder",new Wu);n(this,"decoder",new Hu)}}const ae=new _u;class zu{constructor(e){n(this,"encoding");this.encoding=e}convert(e){if(typeof e!="string")throw new m(typeof e,"string");return this.encoding.decodeString(e)}}class Fu{constructor(e){n(this,"encoding");this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class St extends a{constructor(o){super();n(this,"encoder");n(this,"decoder");this.encoder=new Fu(o),this.decoder=new zu(o)}}new St(Mo),new St(vu);const Ks=new St(Gs),Zs=new St(Lo);class Ju{convert(e){if(Xi(e))return e;if(wt(e))return BigInt(e);if(!ee(e))throw new m(typeof e,"string | bigint | number");return BigInt(e)}}class Gu{convert(e){return to(e,"bigint"),`0x${e.toString(16)}`}}class Qu extends a{constructor(){super(...arguments);n(this,"encoder",new Gu);n(this,"decoder",new Ju)}}const te=new Qu,ec=new H(new V(te),new U(te));new x(new B(te),new E(te)),new x(new B(ec),new E(ec));class qu{convert(e){if(!ee(e))throw new m(typeof e,"string");const o=new Date(e);if(Number.isNaN(o.valueOf()))throw new m("NaN","number");return o}}class ju{convert(e){return A(e,Date),e.toISOString()}}class $u extends a{constructor(){super(...arguments);n(this,"encoder",new ju);n(this,"decoder",new qu)}}const Ee=new $u,tc=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];function kt(t){for(let e=0;e<24;++e){const o=t[0]^t[10]^t[20]^t[30]^t[40],r=t[1]^t[11]^t[21]^t[31]^t[41],s=t[2]^t[12]^t[22]^t[32]^t[42],c=t[3]^t[13]^t[23]^t[33]^t[43],i=t[4]^t[14]^t[24]^t[34]^t[44],l=t[5]^t[15]^t[25]^t[35]^t[45],f=t[6]^t[16]^t[26]^t[36]^t[46],w=t[7]^t[17]^t[27]^t[37]^t[47],b=t[8]^t[18]^t[28]^t[38]^t[48],O=t[9]^t[19]^t[29]^t[39]^t[49];let g=b^(s<<1|c>>>31),p=O^(c<<1|s>>>31);const L=t[0]^g,I=t[1]^p,F=t[10]^g,ht=t[11]^p,ni=t[20]^g,ri=t[21]^p,si=t[30]^g,ci=t[31]^p,ai=t[40]^g,ii=t[41]^p;g=o^(i<<1|l>>>31),p=r^(l<<1|i>>>31);const di=t[2]^g,li=t[3]^p,ui=t[12]^g,hi=t[13]^p,wi=t[22]^g,fi=t[23]^p,pi=t[32]^g,mi=t[33]^p,gi=t[42]^g,Ai=t[43]^p;g=s^(f<<1|w>>>31),p=c^(w<<1|f>>>31);const Ci=t[4]^g,bi=t[5]^p,yi=t[14]^g,Si=t[15]^p,ki=t[24]^g,vi=t[25]^p,Bi=t[34]^g,Ei=t[35]^p,xi=t[44]^g,Ri=t[45]^p;g=i^(b<<1|O>>>31),p=l^(O<<1|b>>>31);const Ni=t[6]^g,Ii=t[7]^p,Di=t[16]^g,Pi=t[17]^p,Oi=t[26]^g,Ti=t[27]^p,Li=t[36]^g,Mi=t[37]^p,Vi=t[46]^g,Ui=t[47]^p;g=f^(o<<1|r>>>31),p=w^(r<<1|o>>>31);const Hi=t[8]^g,Wi=t[9]^p,_i=t[18]^g,zi=t[19]^p,Fi=t[28]^g,Ji=t[29]^p,Gi=t[38]^g,Qi=t[39]^p,qi=t[48]^g,ji=t[49]^p,ur=L,hr=I,wr=ht<<4|F>>>28,fr=F<<4|ht>>>28,pr=ni<<3|ri>>>29,mr=ri<<3|ni>>>29,gr=ci<<9|si>>>23,Ar=si<<9|ci>>>23,Cr=ai<<18|ii>>>14,br=ii<<18|ai>>>14,yr=di<<1|li>>>31,Sr=li<<1|di>>>31,kr=hi<<12|ui>>>20,vr=ui<<12|hi>>>20,Br=wi<<10|fi>>>22,Er=fi<<10|wi>>>22,xr=mi<<13|pi>>>19,Rr=pi<<13|mi>>>19,Nr=gi<<2|Ai>>>30,Ir=Ai<<2|gi>>>30,Dr=bi<<30|Ci>>>2,Pr=Ci<<30|bi>>>2,Or=yi<<6|Si>>>26,Tr=Si<<6|yi>>>26,Lr=vi<<11|ki>>>21,Mr=ki<<11|vi>>>21,Vr=Bi<<15|Ei>>>17,Ur=Ei<<15|Bi>>>17,Hr=Ri<<29|xi>>>3,Wr=xi<<29|Ri>>>3,_r=Ni<<28|Ii>>>4,zr=Ii<<28|Ni>>>4,Fr=Pi<<23|Di>>>9,Jr=Di<<23|Pi>>>9,Gr=Oi<<25|Ti>>>7,Qr=Ti<<25|Oi>>>7,qr=Li<<21|Mi>>>11,jr=Mi<<21|Li>>>11,$r=Ui<<24|Vi>>>8,Xr=Vi<<24|Ui>>>8,Yr=Hi<<27|Wi>>>5,Kr=Wi<<27|Hi>>>5,Zr=_i<<20|zi>>>12,es=zi<<20|_i>>>12,ts=Ji<<7|Fi>>>25,os=Fi<<7|Ji>>>25,ns=Gi<<8|Qi>>>24,rs=Qi<<8|Gi>>>24,ss=qi<<14|ji>>>18,cs=ji<<14|qi>>>18;t[0]=ur^~kr&Lr,t[1]=hr^~vr&Mr,t[10]=_r^~Zr&pr,t[11]=zr^~es&mr,t[20]=yr^~Or&Gr,t[21]=Sr^~Tr&Qr,t[30]=Yr^~wr&Br,t[31]=Kr^~fr&Er,t[40]=Dr^~Fr&ts,t[41]=Pr^~Jr&os,t[2]=kr^~Lr&qr,t[3]=vr^~Mr&jr,t[12]=Zr^~pr&xr,t[13]=es^~mr&Rr,t[22]=Or^~Gr&ns,t[23]=Tr^~Qr&rs,t[32]=wr^~Br&Vr,t[33]=fr^~Er&Ur,t[42]=Fr^~ts&gr,t[43]=Jr^~os&Ar,t[4]=Lr^~qr&ss,t[5]=Mr^~jr&cs,t[14]=pr^~xr&Hr,t[15]=mr^~Rr&Wr,t[24]=Gr^~ns&Cr,t[25]=Qr^~rs&br,t[34]=Br^~Vr&$r,t[35]=Er^~Ur&Xr,t[44]=ts^~gr&Nr,t[45]=os^~Ar&Ir,t[6]=qr^~ss&ur,t[7]=jr^~cs&hr,t[16]=xr^~Hr&_r,t[17]=Rr^~Wr&zr,t[26]=ns^~Cr&yr,t[27]=rs^~br&Sr,t[36]=Vr^~$r&Yr,t[37]=Ur^~Xr&Kr,t[46]=gr^~Nr&Dr,t[47]=Ar^~Ir&Pr,t[8]=ss^~ur&kr,t[9]=cs^~hr&vr,t[18]=Hr^~_r&Zr,t[19]=Wr^~zr&es,t[28]=Cr^~yr&Or,t[29]=br^~Sr&Tr,t[38]=$r^~Yr&wr,t[39]=Xr^~Kr&fr,t[48]=Nr^~Dr&Fr,t[49]=Ir^~Pr&Jr,t[0]^=tc[e*2],t[1]^=tc[e*2+1]}}class Xu{constructor(){n(this,"state",[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);n(this,"blockSize",0);n(this,"count",0);n(this,"squeezing",!1)}initialize(e,o){for(let r=0;r<50;++r)this.state[r]=0;this.blockSize=e/8,this.count=0,this.squeezing=!1}absorb(e){for(let o=0;o<e.length;++o)this.state[~~(this.count/4)]^=e[o]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(kt(this.state),this.count=0)}absorbLastFewBits(e){this.state[~~(this.count/4)]^=e<<8*(this.count%4),(e&128)!==0&&this.count===this.blockSize-1&&kt(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),kt(this.state),this.count=0,this.squeezing=!0}squeeze(e){this.squeezing||this.absorbLastFewBits(1);const o=new Uint8Array(e);for(let r=0;r<e;++r)o[r]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(kt(this.state),this.count=0);return o}copy(e){for(let o=0;o<50;++o)e.state[o]=this.state[o];e.blockSize=this.blockSize,e.count=this.count,e.squeezing=this.squeezing}}class ie{constructor(e,o,r,s){n(this,"_rate");n(this,"_capacity");n(this,"_delimitedSuffix");n(this,"_hashBitLength");n(this,"_state");n(this,"_finalized");this._rate=e,this._capacity=o,this._delimitedSuffix=r,this._hashBitLength=s,this._state=new Xu,this._state.initialize(e,o),this._finalized=!1}update(e){if(this._finalized)throw new Error("Digest already called");return this._state.absorb(new Uint8Array(e)),this}digest(){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);const e=this._state.squeeze(this._hashBitLength/8);return this._resetState(),e.buffer}_resetState(){return this._state.initialize(this._rate,this._capacity),this}}function Yu(t){switch(t.toLowerCase()){case"keccak224":return new ie(1152,448,null,224);case"keccak256":return new ie(1088,512,null,256);case"keccak384":return new ie(832,768,null,384);case"keccak512":return new ie(576,1024,null,512);case"sha3-224":return new ie(1152,448,6,224);case"sha3-256":return new ie(1088,512,6,256);case"sha3-384":return new ie(832,768,6,384);case"sha3-512":return new ie(576,1024,6,512);default:throw new Error("invalid algorithm: "+t)}}const Ku=48,Zu=57,eh=97,th=102;class oh{convert(e){if(A(e,ArrayBuffer),e.byteLength!==20)throw new m(typeof e,"20-byte ArrayBuffer");const r=[...Uo(Xs(new Uint8Array(e)),f=>f.split(""))],s=Yu("keccak256"),c=new TextEncoder;s.update(c.encode(r.join("")));const i=new Uint8Array(s.digest());return["0x",...$(Wo(Ho(e.byteLength*2),r,(f,w)=>[f,w]),([f,w])=>{const b=w.charCodeAt(0);if(b>=Ku&&b<=Zu)return w;if(b>=eh&&b<=th){const O=Math.floor(f/2),g=f&1,p=i[O];return(g===0?p>>4:p&15)>7?w.toUpperCase():w}throw new z})].join("")}}const nh=new oh;class rh{constructor(e,o){n(this,"keyCodec");n(this,"valueCodec");this.keyCodec=e,this.valueCodec=o}convert(e){if(typeof e!="object"||e===null)throw new Error(`invalid map value: expected an object, got ${typeof e}`);const o=new Map;for(const[r,s]of Object.entries(e)){const c=this.keyCodec.decode(r),i=this.valueCodec.decode(s);o.set(c,i)}return o}}class sh{constructor(e,o){n(this,"keyCodec");n(this,"valueCodec");this.keyCodec=e,this.valueCodec=o}convert(e){A(e,Map);const o={};for(const[r,s]of e.entries()){const c=this.keyCodec.encode(r),i=this.valueCodec.encode(s);o[c]=i}return o}}class zo extends a{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=r,this.decoder=o}static keyStringCodec(o){return new zo(new rh(u,o),new sh(u,o))}}class ch{convert(e){if(!ee(e))throw new m(typeof e,"string");return new URL(e)}}class ah{convert(e){return e.toString()}}class ih extends a{constructor(){super(...arguments);n(this,"encoder",new ah);n(this,"decoder",new ch)}}const oc=new ih,vt=new H(new V(oc),new U(oc));class Fo{}const We="Set-Url";class Jo extends Fo{constructor(o){super();n(this,"url");this.url=o}valueOf(){return We}toJSON(){return Go.encode(this)}}class dh{convert(e){return{[We]:e.url}}}class lh{convert(e){d(e,We);const o=e[We];if(typeof o!="string")throw new m(typeof o,"string");return new Jo(o)}}class uh extends a{constructor(){super(...arguments);n(this,"encoder",new dh);n(this,"decoder",new lh)}}const Go=new uh;class nc{}const _e="Close";class ze extends Fo{valueOf(){return _e}}class hh{convert(){return _e}}class wh{convert(e){if(typeof e!="string")throw new m(typeof e,"string");if(e!==_e)throw new m(e,_e);return new ze}}class fh extends a{constructor(){super(...arguments);n(this,"encoder",new hh);n(this,"decoder",new wh)}}const rc=new fh,Fe="Connect";class Je extends Fo{valueOf(){return Fe}toJSON(){return Qo.encode(this)}}class ph{convert(){return Fe}}class mh{convert(e){if(typeof e!="string")throw new m(typeof e,"string");if(e!==Fe)throw new m(e,Fe);return new Je}}class gh extends a{constructor(){super(...arguments);n(this,"encoder",new ph);n(this,"decoder",new mh)}}const Qo=new gh;class Ah{convert(e){if(e===Fe)return Qo.decode(e);if(e===_e)return rc.decode(e);if(typeof e=="object"&&e!==null&&We in e)return Go.decode(e);throw new z}}class Ch{convert(e){if(e instanceof Je)return Qo.encode(e);if(e instanceof ze)return rc.encode(e);if(e instanceof Jo)return Go.encode(e);throw new z}}class bh extends a{constructor(){super(...arguments);n(this,"encoder",new Ch);n(this,"decoder",new Ah)}}const sc=new bh;class Ge extends nc{constructor(o){super();n(this,"command");this.command=o}get type(){return Qe}toJSON(){return cc.encode(this)}}const Qe="WebSocket";class yh{convert(e){return{[Qe]:sc.encode(e.command)}}}class Sh{convert(e){return d(e,Qe),new Ge(sc.decode(e[Qe]))}}class kh extends a{constructor(){super(...arguments);n(this,"encoder",new yh);n(this,"decoder",new Sh)}}const cc=new kh,Ae=new Map;Ae.set(Qe,cc);class vh{convert(e){const o=Ae.get(e.type);if(!o)throw new m(e.type,`one of ${Array.from($(Ae.keys(),r=>`"${r}"`)).join(", ")}`);return{[e.type]:o.encode(e)}}}class Bh{convert(e){if(typeof e!="object"||e===null)throw new m(typeof e,"object");const o=Object.keys(e);if(o.length!==1)throw new z("multiple values contained within the Request object, unexpected");const[r]=o,s=Ae.get(r);if(d(e,r),!s)throw new m(r,`one of ${Array.from($(Ae.keys(),c=>`"${c}"`)).join(", ")}`);return s.decode(e[r])}}class Eh extends a{constructor(){super(...arguments);n(this,"encoder",new vh);n(this,"decoder",new Bh)}}function xh(t,e){Ae.has(t)||Ae.set(t,e)}const Rh=new Eh;class qo{}const qe="Error";class ac extends qo{constructor(o){super();n(this,"error");this.error=o}get type(){return qe}toJSON(){return ic.encode(this)}}class Nh{convert(e){return{[qe]:pt.encode(e.error)}}}class Ih{convert(e){return d(e,qe),new ac(pt.decode(e[qe]))}}class Dh extends a{constructor(){super(...arguments);n(this,"encoder",new Nh);n(this,"decoder",new Ih)}}const ic=new Dh;class jo{}const je="Closed";class xe extends jo{valueOf(){return je}toJSON(){return $o.encode(this)}}class Ph{convert(e){if(typeof e!="string")throw new m(typeof e,"string");if(e!==je)throw new m(e,je);return new xe}}class Oh{convert(){return je}}class Th extends a{constructor(){super(...arguments);n(this,"encoder",new Oh);n(this,"decoder",new Ph)}}const $o=new Th,$e="Connecting";class Xe extends jo{valueOf(){return $e}toJSON(){return Xo.encode(this)}}class Lh{convert(e){if(typeof e!="string")throw new m(typeof e,"string");if(e!==$e)throw new m(e,$e);return new Xe}}class Mh{convert(){return $e}}class Vh extends a{constructor(){super(...arguments);n(this,"encoder",new Mh);n(this,"decoder",new Lh)}}const Xo=new Vh,Ye="Opened";class Ke extends jo{valueOf(){return Ye}toJSON(){return Yo.encode(this)}}class Uh{convert(e){if(typeof e!="string")throw new m(typeof e,"string");if(e!==Ye)throw new m(e,Ye);return new Ke}}class Hh{convert(){return Ye}}class Wh extends a{constructor(){super(...arguments);n(this,"encoder",new Hh);n(this,"decoder",new Uh)}}const Yo=new Wh;class _h{convert(e){if(e===Ye)return Yo.decode(e);if(e===je)return $o.decode(e);if(e===$e)return Xo.decode(e);throw new z}}class zh{convert(e){if(e instanceof Ke)return Yo.encode(e);if(e instanceof xe)return $o.encode(e);if(e instanceof Xe)return Xo.encode(e);throw new z}}class Fh extends a{constructor(){super(...arguments);n(this,"encoder",new zh);n(this,"decoder",new _h)}}const dc=new Fh;class lc extends qo{constructor(o){super();n(this,"status");this.status=o}get type(){return Ze}toJSON(){return uc.encode(this)}}const Ze="WebSocket";class Jh{convert(e){return{[Ze]:dc.encode(e.status)}}}class Gh{convert(e){return d(e,Ze),new lc(dc.decode(e[Ze]))}}class Qh extends a{constructor(){super(...arguments);n(this,"encoder",new Jh);n(this,"decoder",new Gh)}}const uc=new Qh,de=new Map;de.set(qe,ic),de.set(Ze,uc);class qh{convert(e){const o=de.get(e.type);if(!o)throw new m(e.type,`one of ${Array.from($(de.keys(),r=>`"${r}"`)).join(", ")}`);return{[e.type]:o.encode(e)}}}class jh{convert(e){if(typeof e!="object"||e===null)throw new m(typeof e,"object");const o=Object.keys(e);if(o.length!==1)throw new z("multiple values contained within the response object, unexpected");const[r]=o,s=de.get(r);if(d(e,r),!s)throw new m(r,`one of ${Array.from($(de.keys(),c=>`"${c}"`)).join(", ")}`);return s.decode(e[r])}}class $h extends a{constructor(){super(...arguments);n(this,"encoder",new qh);n(this,"decoder",new jh)}}function Xh(t,e){de.has(t)||de.set(t,e)}const Yh=new $h;class Kh{convert(e){return new ac(e)}}const Zh=new Kh;class ew{convert(e){return new lc(e)}}const Ko=new ew;class tw{constructor(e,o){this.sink=e,this.converter=o,this.sink=e,this.converter=o}async send(e){await this.sink.send(this.converter.convert(e))}}function Ce(t,e){return new tw(t,e)}async function Zo(t){return new Promise(e=>{const o=setTimeout(()=>{clearTimeout(o),e()},t)})}class oe{constructor(e,o,r){n(this,"significantDigitsMultiplier");this.alpha3Code=e,this.code=o,this.significantDigits=r,this.alpha3Code=e,this.code=o,this.significantDigits=r,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}toJSON(){return Bt.encode(this)}}const hc=new oe("JPY",392,0),ow=new oe("GBP",826,2),wc=new oe("USD",840,2),nw=new oe("EUR",978,2),rw=new oe("XXX",999,2),fc=new oe("ETH",1001,18),en=new oe("XBT",1002,8),pc=new oe("ESP",10001,18),sw=[hc,ow,wc,nw,rw,fc,en,pc],cw=new Map(sw.map(t=>[t.alpha3Code,t]));class aw{convert(e){if(typeof e!="string")throw new se("CurrencyCodeDecoder: expected string");if(e==="BTC")return en;const o=cw.get(e);if(o===void 0)throw new se(`CurrencyCodeDecoder: unknown currency: "${e}"`);return o}}class iw{convert(e){return A(e,oe),e.alpha3Code}}class dw extends a{constructor(){super(...arguments);n(this,"decoder",new aw);n(this,"encoder",new iw)}}const Bt=new dw;class X{constructor(e,o){this.currency=e,this.value=o,this.currency=e,this.value=o}static USD(e){return new X(wc,BigInt(e))}static ETH(e){return new X(fc,BigInt(e))}static ESP(e){return new X(pc,BigInt(e))}static JPY(e){return new X(hc,BigInt(e))}static BTC(e){return new X(en,BigInt(e))}toString(){return Et.encode(this)}toJSON(){return Et.encode(this)}}function lw(t){return t==="."||t===","||t===" "}function uw(t,e){let o=-1;const r=t.length;for(let s=0;s<r;s++)e(t[s])&&(o=s);return o}class hw{parseCurrencyCode(e){return Bt.decode(e)}parseValue(e,o){let r=1n;o[0]==="-"&&(r=-1n,o=o.substring(1));const s=uw(o,lw);if(s===-1){const w=BigInt(o.replace(/\D/g,""))*e.significantDigitsMultiplier;return r*w}const c=o.substring(0,s).replace(/\D/g,""),i=o.substring(s+1).replace(/\D/g,""),l=BigInt(c)*e.significantDigitsMultiplier,f=BigInt(i)*10n**BigInt(e.significantDigits-i.length);return r*(l+f)}convert(e){if(typeof e!="string")throw new se("MonetaryValueDecoder: expected string");const o=e.indexOf(" ");if(o<=-1)throw new se("MonetaryValueDecoder: missing non-breaking space");const r=e.substring(0,o),s=e.substring(o+1);if(/^-?[\d .,]+$/.test(r)){const i=this.parseCurrencyCode(s);return new X(i,this.parseValue(i,r))}const c=this.parseCurrencyCode(r);return new X(c,this.parseValue(c,s))}}class ww{convert(e){A(e,X);const o=e.value<0n?"-":"",r=e.value<0n?-e.value:e.value,s=r%e.currency.significantDigitsMultiplier,c=r/e.currency.significantDigitsMultiplier,i=String(c),l=String(s);return/^0+$/.test(l)?`${Bt.encode(e.currency)} ${o}${i}`:`${Bt.encode(e.currency)} ${o}${c}.${String(s).padStart(e.currency.significantDigits,"0")}`}}class fw extends a{constructor(){super(...arguments);n(this,"decoder",new hw);n(this,"encoder",new ww)}}const Et=new fw,mc=new x(new B(Et),new E(Et));class y{constructor(e,o,r,s){n(this,"namespace");n(this,"name");n(this,"site");n(this,"blockExplorer");this.namespace=e,this.name=o,this.site=r,this.blockExplorer=s}}const pw=new y(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),mw=new y(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),gw=new y(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),Aw=new y(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),Cw=new y(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),bw=new y(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),yw=new y(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),Sw=new y(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),kw=new y(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),vw=new y(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),Bw=new y(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),Ew=1918988905,xw=new y(Ew,"RARI",new URL("https://rarichain.org/"),new URL("https://explorer.rarichain.org/")),Rw=1380012617,Nw=new y(Rw,"RARI",new URL("https://rarichain.org/"),new URL("https://mainnet.explorer.rarichain.org/")),Iw=9369,Dw=new y(Iw,"LogX",new URL("https://logx.network/"),new URL("https://kartel-testnet-explorer.alt.technology/")),Pw=936369,Ow=new y(Pw,"LogX",new URL("https://logx.network/"),new URL("https://vzjuxmhfn70kgnlds27h-explorer.alt.technology")),Tw=466,Lw=new y(Tw,"AppChain",new URL("https://appchain.xyz/"),new URL("https://explorer.appchain.xyz/")),Mw=4661,Vw=new y(Mw,"AppChain",new URL("https://appchain.xyz/"),new URL("https://appchaintestnet.explorer.caldera.xyz/")),Uw=360,Hw=new y(Uw,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Ww=3609,_w=new y(Ww,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),zw=33139,Fw=new y(zw,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apescan.io/")),Jw=3313939,Gw=new y(Jw,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apechain-testnet.explorer.caldera.xyz/")),Qw=13107,qw=new y(Qw,"t3rn",new URL("https://t3rn.io/"),new URL("https://brn-testnet.explorer.caldera.xyz/")),jw=819,$w=new y(jw,"t3rn",new URL("https://t3rn.io/"),new URL("https://exporer.t3rn.io/")),gc=21341,Xw=new y(gc,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus-sepolia-testnet.explorer.caldera.xyz/")),Yw=new y(gc,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus.calderaexplorer.xyz/")),Kw=1397311310,Ac=new y(Kw,"Infinite Garden",new URL("https://infinitegarden.espressosys.com/"),new URL("https://explorer.main.net.espressosys.com/")),Zw=[Ac,Nw,Ow,Hw,Lw,Fw,$w,Yw],ef=[Ac,xw,Dw,Vw,_w,Gw,qw,Xw],tf=new Map([pw,mw,gw,kw,Aw,Cw,bw,yw,Sw,vw,Bw,...Zw,...ef].map(t=>[t.namespace,t]));class ne{constructor(e,o){n(this,"tag");n(this,"data");this.tag=e,this.data=o}static fromString(e){const o=e.indexOf("~");if(o<0)throw new ks;const r=e.substring(0,o),s=Mo.decodeString(e.substring(o+1));return new ne(r,s)}static inflate(e){return C.decode(e)}toString(){return`${this.tag}~${Mo.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class of{convert(e){if(typeof e!="string")throw new m(typeof e,"string");return ne.fromString(e)}}class nf{convert(e){return A(e,ne),e.toString()}}class rf extends a{constructor(){super(...arguments);n(this,"encoder",new nf);n(this,"decoder",new of)}}const C=new rf,Cc=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],bc=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],yc=["Linux","Unix","Windows","MacOS"],Sc=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],xt=2147483648,sf=1103515245,cf=12345;class be{constructor(e){n(this,"state");this.state=e!==void 0?e:Math.floor(Math.random()*(xt-1))}nextInt(){return this.state=(sf*this.state+cf)%xt,this.state}nextFloat(){return this.nextInt()/(xt-1)}nextRange(e,o){const r=o-e,s=this.nextInt()/xt;return e+Math.floor(s*r)}fillBytes(e){const o=new ArrayBuffer(e),r=new DataView(o);let s=0;for(;s<e-4;s+=4)r.setUint32(s,this.nextRange(0,4294967295));for(let c=s;c<e;c++)r.setUint8(c,this.nextRange(0,256));return o}}const af=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],kc=[0,0,5,26,28,26,9,6],df=kc.reduce((t,e)=>t+e,0),lf=kc.reduce((t,e)=>{const o=t[t.length-1]??0;return t.push(o+e),t},[]),uf=Array.from(Wo(lf,af,(t,e)=>[t,e])),Rt=new Date,Nt=new Date(Rt.getFullYear(),Rt.getMonth(),Rt.getDate()).valueOf();function hf(){return Nt}async function*wf(){}function vc(){const t=new Uint8Array(new Array(20).map(()=>0)).buffer;return{hash:new ne("BLOCK",t),height:0,time:new Date(0),genTime:0,transactions:wf(),numTransactions:0,proposer:[],size:0,fees:[]}}async function*ff(t){let e=1,o=Nt;for(;o<Rt.valueOf();){const r=Math.floor(t.nextFloat()*14*1e3);yield Bc(new be(e+r),e,o,o+r),o+=r,e++}}async function*pf(t=new be(Nt)){yield vc(),yield*ff(t)}async function*mf(t,e,o){let r=e,s=o;for(;;){const c=Math.floor(t.nextFloat()*14*1e3),i=r+c-Date.now();await Zo(i),yield Bc(new be(s+c),s,r,r+c),r+=c,s++}}function Bc(t,e,o,r){const s=Math.floor(t.nextRange(0,5)),c=t.nextRange(0,et.length),i=et[c];return{hash:new ne("BLOCK",t.fillBytes(32)),height:e,genTime:r-o,time:new Date(r),numTransactions:s,transactions:Af(new be(e+o),e,o,r,s),proposer:[i.address],size:Math.floor(t.nextFloat()*1024*s)+8,fees:[X.ESP(BigInt(t.nextRange(0,1e9)*1e3))]}}const Ec=Array.from(tf.keys());function gf(t){return t.nextFloat()>.98?1:Ec[t.nextRange(0,Ec.length)]}async function*Af(t,e,o,r,s){const c=(r-o)/s;for(let i=0,l=o;l<r;l+=c,i++){const f=gf(t),w=Math.floor(1024*t.nextFloat());yield{block:e,index:i,size:w,hash:new ne("COMMIT",t.fillBytes(32)),time:new Date(l),sender:new ne("PUBKEY",t.fillBytes(32)),tree:{namespace:f,data:t.fillBytes(w)}}}}function Cf(t){const e=t.nextRange(0,df),o=Vo(uf,([i])=>i<=e),[,r]=Nu(o),s=t.nextRange(0,r.length);return r[s]}function bf(t){const e=t.nextRange(0,Sc.length);return Sc[e]}function yf(t){const e=t.nextRange(0,yc.length);return yc[e]}function Sf(t){const e=t.nextRange(0,bc.length);return bc[e]}function kf(t){const e=t.nextRange(0,Cc.length);return Cc[e]}function vf(t){const[e,o]=bf(t),[,r,s,c]=Cf(t),i=yf(t),l=Sf(t),f=kf(t);return{pubkey:new ne("PUBKEY",t.fillBytes(32)),name:`${e} Node ${c} ${t.nextRange(0,100)}`,address:t.fillBytes(32),company:{name:e,website:o},location:{coords:[r,s],country:c},operatingSystem:i,networkType:f,nodeType:l}}function*Bf(){const t=new be(Nt),e=t.nextRange(50,150);for(let o=0;o<e;o++)yield vf(t)}const et=Array.from(Bf());class tt{constructor(e){this.value=e,this.value=e}valueOf(){return Number(this.value)}toString(){return Number(this.value).toString()}}function tn(t,e){return t.valueOf()<e.valueOf()}function Ef(t,e){return t.valueOf()<=e.valueOf()}function It(t,e){return t.valueOf()>e.valueOf()}function xc(t,e){return Ef(t,e)?t:e}function Rc(t,e){return It(t,e)?t:e}class on{constructor(e,o){n(this,"min");n(this,"max");this.min=e,this.max=o}contains(e){return!(tn(e.lat,this.min.lat)||It(e.lat,this.max.lat)||tn(e.lng,this.min.lng)||It(e.lng,this.max.lng))}}function ot(t){const e=t[Symbol.iterator](),o=qs(e),[r,s]=js(([c,i],l)=>[c.min(l.bbox.min),i.max(l.bbox.max)],[o.bbox.min,o.bbox.max],e);return new on(r,s)}function xf(t){const e=t[Symbol.iterator](),o=qs(e),[r,s]=js(([c,i],l)=>[c.min(l),i.max(l)],[o,o],e);return new on(r,s)}class ye{}const Nc=new Map;function Se(t,e){Nc.set(t,e)}function Ic(t){const e=Nc.get(t);if(!e)throw new Le(t);return e}class Rf{convert(e){return Ic(e.type).encode(e)}}class Nf{convert(e){if(d(e,"type","coordinates"),!ee(e.type))throw new m(typeof e.type,"string");return Ic(e.type).decode(e)}}class If extends a{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new Rf,this.decoder=new Nf}}const Dc=new If,Pc=new x(new B(Dc),new E(Dc)),nn="GeometryCollection";class Df extends ye{constructor(o){super();n(this,"type",nn);n(this,"geometries");n(this,"bbox");this.geometries=o,this.bbox=ot(o)}toJSON(){return Oc.encode(this)}}class Pf{constructor(e){n(this,"listGeometryCodec");this.listGeometryCodec=e}convert(e){return{type:e.type,geometries:this.listGeometryCodec.encode(e.geometries)}}}class Of{constructor(e){n(this,"listGeometryCodec");this.listGeometryCodec=e}convert(e){return d(e,"type","geometries"),he(e,nn),new Df(this.listGeometryCodec.decode(e.geometries))}}class Tf extends a{constructor(){super(...arguments);n(this,"encoder",new Pf(Pc));n(this,"decoder",new Of(Pc))}}const Oc=new Tf;Se(nn,Oc);class W extends tt{toString(){return`${Number(this)}°`}}class Lf{convert(e){return Number(e)}}class Mf{convert(e){if(!wt(e))throw new m(typeof e,"number");return new W(e)}}class Vf extends a{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new Lf,this.decoder=new Mf}}const Uf=new Vf;class D extends tt{toString(){return`${String(this.value)} lat`}}class P extends tt{toString(){return`${String(this.value)} lng`}}class Y extends tt{toString(){return`${Number(this)} rad`}}class Hf{convert(e){return Number(e)}}class Wf{convert(e){if(!wt(e))throw new m(typeof e,"number");return new Y(e)}}class _f extends a{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new Hf,this.decoder=new Wf}}const zf=new _f;class R{constructor(e,o){this.lat=e,this.lng=o,this.lat=e,this.lng=o}min(e){return new R(xc(this.lat,e.lat),xc(this.lng,e.lng))}max(e){return new R(Rc(this.lat,e.lat),Rc(this.lng,e.lng))}toString(){return`${this.lat}, ${this.lng}`}}class Ff{constructor(e){n(this,"unitCodec");this.unitCodec=e}convert(e){return[this.unitCodec.encode(e.lat.value),this.unitCodec.encode(e.lng.value)]}}class Jf{constructor(e){n(this,"unitCodec");this.unitCodec=e}convert(e){if(!(e instanceof Array))throw new m(typeof e,"Array");if(e.length!==2)throw new TypeError(`Expected array of length 2, got ${e.length}`);const[o,r]=e;return new R(new D(this.unitCodec.decode(o)),new P(this.unitCodec.decode(r)))}}class Tc extends a{constructor(o){super();n(this,"encoder");n(this,"decoder");this.encoder=new Ff(o),this.decoder=new Jf(o)}}const Lc=new Tc(Uf),Mc=new Tc(zf),Vc=new H(new V(Lc),new U(Lc));new H(new V(Mc),new U(Mc));class Gf{convert(e){return[Number(e.lng),Number(e.lat)]}}class Qf{convert(e){if(!(e instanceof Array))throw new m(typeof e,"Array");if(e.length!==2)throw new TypeError(`Expected array of length 2, got ${e.length}`);return new R(new D(new W(e[1])),new P(new W(e[0])))}}class qf extends a{constructor(){super(...arguments);n(this,"encoder",new Gf);n(this,"decoder",new Qf)}}const Dt=new qf,Re=new x(new B(Dt),new E(Dt)),Ne=new x(new B(Re),new E(Re)),Uc=new x(new B(Ne),new E(Ne)),rn="LineString";class Hc extends ye{constructor(o){super();n(this,"type",rn);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=xf(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return Wc.encode(this)}}class jf{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates)}}}class $f{constructor(e){n(this,"codec");this.codec=e}convert(e){d(e,"type","coordinates"),he(e,rn);const o=this.codec.decode(e.coordinates);return new Hc(o)}}class Xf extends a{constructor(){super(...arguments);n(this,"encoder",new jf(Re));n(this,"decoder",new $f(Re))}}const Wc=new Xf;Se(rn,Wc);const sn="MultiLineString";class Yf extends ye{constructor(o){super();n(this,"type",sn);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=ot(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return _c.encode(this)}}class Kf{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates))}}}class Zf{constructor(e){n(this,"codec");this.codec=e}convert(e){d(e,"type","coordinates"),he(e,sn);const o=this.codec.decode(e.coordinates);return new Yf(o.map(r=>new Hc(r)))}}class ep extends a{constructor(){super(...arguments);n(this,"encoder",new Kf(Ne));n(this,"decoder",new Zf(Ne))}}const _c=new ep;Se(sn,_c);const cn="Point";class Pt extends ye{constructor(o){super();n(this,"type",cn);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=new on(this.coordinates,this.coordinates)}toJSON(){return zc.encode(this)}}class tp{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates)}}}class op{constructor(e){n(this,"codec");this.codec=e}convert(e){return d(e,"type","coordinates"),he(e,cn),new Pt(this.codec.decode(e.coordinates))}}class np extends a{constructor(){super(...arguments);n(this,"encoder",new tp(Dt));n(this,"decoder",new op(Dt))}}const zc=new np;Se(cn,zc);const an="MultiPoint";class dn extends ye{constructor(o){super();n(this,"type",an);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=ot(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return Fc.encode(this)}}class rp{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates))}}}class sp{constructor(e){n(this,"codec");this.codec=e}convert(e){d(e,"type","coordinates"),he(e,an);const o=this.codec.decode(e.coordinates);return new dn(o.map(r=>new Pt(r)))}}class cp extends a{constructor(){super(...arguments);n(this,"encoder",new rp(Re));n(this,"decoder",new sp(Re))}}const Fc=new cp;Se(an,Fc);const ln="Polygon";class Jc extends ye{constructor(o){super();n(this,"type",ln);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=ot(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return Gc.encode(this)}}class ap{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates.map(r=>r.coordinates)))}}}class ip{constructor(e){n(this,"codec");this.codec=e}convert(e){d(e,"type","coordinates"),he(e,ln);const o=this.codec.decode(e.coordinates);return new Jc(o.map(r=>new dn(r.map(s=>new Pt(s)))))}}class dp extends a{constructor(){super(...arguments);n(this,"encoder",new ap(Ne));n(this,"decoder",new ip(Ne))}}const Gc=new dp;Se(ln,Gc);const un="MultiPolygon";class lp extends ye{constructor(o){super();n(this,"type",un);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=ot(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return Qc.encode(this)}}class up{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates.map(r=>r.coordinates.map(s=>s.coordinates))))}}}class hp{constructor(e){n(this,"codec");this.codec=e}convert(e){d(e,"type","coordinates"),he(e,un);const o=this.codec.decode(e.coordinates);return new lp(o.map(r=>new Jc(r.map(s=>new dn(s.map(c=>new Pt(c)))))))}}class wp extends a{constructor(){super(...arguments);n(this,"encoder",new up(Uc));n(this,"decoder",new hp(Uc))}}const Qc=new wp;Se(un,Qc);const eo=class eo{constructor(e,o,r,s){n(this,"inputMin");n(this,"inputMax");n(this,"outputMin");n(this,"outputMax");n(this,"inputRangeInv");n(this,"outputRange");this.inputMin=e,this.inputMax=o,this.outputMin=r,this.outputMax=s,this.inputRangeInv=1/(this.inputMax-this.inputMin),this.outputRange=this.outputMax-this.outputMin}transform(e){return(e-this.inputMin)*this.inputRangeInv*this.outputRange+this.outputMin}};n(eo,"identity",new eo(0,1,0,1));let Ie=eo;class K extends tt{toString(){return`${Number(this)} dp`}}class fp{constructor(e,o,r,s){n(this,"minInput");n(this,"maxInput");n(this,"minOutput");n(this,"maxOutput");n(this,"horizontalAffine");n(this,"inverseHorizontalAffine");n(this,"verticalAffine");n(this,"inverseVerticalAffine");this.minInput=e,this.maxInput=o,this.minOutput=r,this.maxOutput=s,this.horizontalAffine=new Ie(Number(e.lat),Number(o.lat),Number(r.lat),Number(s.lat)),this.inverseHorizontalAffine=new Ie(Number(r.lat),Number(s.lat),Number(e.lat),Number(o.lat)),this.verticalAffine=new Ie(Number(e.lng),Number(o.lng),Number(r.lng),Number(s.lng)),this.inverseVerticalAffine=new Ie(Number(r.lng),Number(s.lng),Number(e.lng),Number(o.lng))}project(e){return new R(new D(new K(this.horizontalAffine.transform(Number(e.lat)))),new P(new K(this.verticalAffine.transform(Number(e.lng)))))}inverseProject(e){const o=new Y(this.inverseHorizontalAffine.transform(Number(e.lat))),r=new Y(this.inverseVerticalAffine.transform(Number(e.lng)));return new R(new D(o),new P(r))}}class pp{constructor(){n(this,"minInput",new R(new D(new W(-90)),new P(new W(-180))));n(this,"maxInput",new R(new D(new W(90)),new P(new W(180))));n(this,"minOutput",new R(new D(new Y(-Math.PI/2)),new P(new Y(-Math.PI))));n(this,"maxOutput",new R(new D(new Y(Math.PI/2)),new P(new Y(Math.PI))))}projectLatitude(e){return new D(this.convertDegreesToRadians(e))}convertDegreesToRadians(e){return new Y(Number(e)*(Math.PI/180))}convertRadiansToDegrees(e){return new W(Number(e)*(180/Math.PI))}projectLongitude(e){return new P(this.convertDegreesToRadians(e))}inverseProjectLatitude(e){return new D(this.convertRadiansToDegrees(e))}inverseProjectLongitude(e){return new P(this.convertRadiansToDegrees(e))}project(e){return new R(this.projectLatitude(e.lat),this.projectLongitude(e.lng))}inverseProject(e){return new R(this.inverseProjectLatitude(e.lat),this.inverseProjectLongitude(e.lng))}}const qc=new pp,jc=85.05133,N=class N{constructor(){n(this,"minInput",N.min);n(this,"maxInput",N.max);n(this,"minOutput",N.minProjection);n(this,"maxOutput",N.maxProjection)}static projectLongitude(e){return new P(Number(e))}static ensureLatitudeBounds(e){return It(e,N.max.lat)?N.max.lat:tn(e,N.min.lat)?N.min.lat:e}static projectLatitude(e){return new D(Math.log(Math.tan(Math.PI/4+Number(this.ensureLatitudeBounds(e))/2)))}static inverseProjectLongitude(e){return new P(new Y(Number(e)))}static inverseProjectLatitude(e){return new D(new Y(2*Math.atan(Math.exp(Number(e)))-Math.PI/2))}static staticProject(e){return new R(this.projectLatitude(e.lat),this.projectLongitude(e.lng))}project(e){return N.staticProject(e)}static staticInverseProject(e){return new R(this.inverseProjectLatitude(e.lat),this.inverseProjectLongitude(e.lng))}inverseProject(e){return N.staticInverseProject(e)}};n(N,"min",qc.project(new R(new D(new W(-jc)),new P(new W(-180))))),n(N,"max",qc.project(new R(new D(new W(jc)),new P(new W(180))))),n(N,"minProjection",N.staticProject(N.min)),n(N,"maxProjection",N.staticProject(N.max));let Ot=N;const mp="AwABAQEcDQABDA0AAQYNAAEEDgABgAwAAQINAAEWAWEMAAF6AfgMAAH/AfIMAAH/AfwMAAH/AfgMAAH/AeAMAAF/AdAMAAF/AfAMAAF/AeAMAAF/AeAMAAE/AfAMAAEfAfAMAAEfAfwMAAE/AfwMAAF/Af4MAAF/Af8BgAsAAT8B/wHgCgABHwE/Av8BgAkAAZ8BPwL/AeAIAAEDAUwBPwL/AfAIAAEDAU8B3wL/AfgIAAEFAUMBzwL/AfoIAAEMAWMB7wL/Af0IAAEBAaMB7wP/CQABZwHPA/8BgAcAATgBoAHvA/8B4AcAARwBQAFvA/8B4AcAAYQB7gEPA/8B8AcAAQwBDgEvAv8B/gEwBgABAwGBAS8BzwHvAf8B/AEQBgABAwH4AYwBfwGDAf8B/AEYBgABCAHyAeMBHwEDAf8B/AE4BgABHgF9AS8BhgEBAf8B/AEIBgABKwHXAWwBvQGBAf8B/AEOBgABHgH/AW8B+QEBAf8B/gcAAe4B/wEHAYABQAE/AfABAAEYBQABfwH8AQcBwQHpAf8B8AHBAT4FAAH/AdgBAwHgAX8B/wHAAQMB/wGAAQABoAIAAf8BwAEBAfcBPwH/AQABAwH/AcABHQH8AgAB/gEIAQABfwGfAfYBAAEjAf8BxwH/AfgCAAH+AR8BgAFfAUcB7AEAAQMD/wHkAgABfQGfAYABDQGPAf4BAAEDAv8B/gMAATEB/wEAAQQBDwHkAQABAwL/AfgDAAEPAf8BgAEAAQEB4AEAAQEC/wHwAwABFwH/AYABAAEBAdACAAL/AfADAAEfAf8B8AIAAZACAAL/AcADAAEHAf8B/gFMBAAC/wHAAwABDwL/AV8EAAF/Af8BgAMAAT8D/wHAAwABHwH+BAABfwP/AeADAAEfAfgEAAFfA/8B8AMAAQ8B8AQABP8BgAMAAQ8B8AQAAX8C/wH8BAABDwHAAwABAwP/AfwEAAEGBAABAwF/Av8B+AkAAQMD/wHgCQABAwHvAv8B8AkAAQEC/wH+AeAKAAFnAf8B+wFACgABXwH+AbgBgAoAAQ8BogFQAQMKAAEGAQABIAEDCgABDgIAAQMDAAH8BgABDAUAAQEB/wwAAQMB/woAAQEBgQHPAf8BgAkAAQYBAQL/AYAJAAEFAdEB3wH/AYAKAALfAf8LAAI/Af8LAAF+AT8B/woAAXgB/gE/Af8BgAkAAXsB/QG/Af8BgAYAAWABAAEBAfkB/gEPAf8B+AYAATwBAAEXAf4B/QEPAv8B8AUAAXsBAAEfAfwB/gHHAv8B/gUAAZgBAAE/AZQB/gEHA/8BwAQAAZgBAAE/AQMB/wGPA/8BwAQAAeQBAAF8AesB/wFHA/8BwAQAAcABAAF/Ae8B/wFHA/8BwAYAAX8B7wH+AccD/wGABgABPwH/AfgBxwP/BwABPwH/Af0B5QL/AfwHAAE8Af8B+AHOAX8B/wHgBwABHQH/AfwB/wEfAf8BwAcAAQ8B/wH+Af8BzwHxAYAHAAEHA/8B9wHgCAABFwP/AfsBwAF8BQABgAEAAQcB/wH5Af8B+wGAAXgEAAEDAYABAAEvAf8B+AE8AfoBAAGABgABAQEfAf8B+wE+AfAIAAEPAY8C/wH+AfAGAAEGAQABOAGfA/8BYAYAAQEBAAFgAV8D/wkAAcABPwP/BwABAgEAAYABPwP/CAABAQGAAV8D/wkAAQME/wGACAABAwH7A/8BwAgAAQUBbwP/AfgIAAEBAd8D/wH+CAABBwT/Af4IAAEFBP8B8QgAAQcE/wHgCAABDwT/AcAIAAE/BP8BgAgAAX8E/wGABgABAwGAAX8E/wHABgABAwFgBf8B8AGABgABcAF/BP8B+AFABgABCAX/AfgBoAYAARsF/wH8AVgGAAEDBf8B/gEcBwAF/wHMAQQHAAHvBP8B4AEwBwABfwT/AcABcAcAAQcE/wGAAXABDwYAAQcE/wGAAeABHwHABQABAwP/Ab4BAAEYAR8BwAUAAQMD/wGAAQEBKAE/AcAFAAEPA/8BgAEFARIBfwGABQABBwP/AeACAAF/AYAGAAP/AwABfwGABgAC/wH+ARABAAEQAf8BgAYAAv8B/gMAAf8BgAYAAf8B/gH8ATABAAEIAf8BwAUAAWIB/wH8AfABIAEAAQwBPwHgBQABawH/AfABAgGAAQABDgH/AfAFAAFDAf8B8AECAgABDAF/AfAFAAEBAf8B8AMAAQQBHwH2BQABIQH/AfADAAECAQ8B8AYAAf8B8AQAAQcBwAYAAf8B8AwAAf8B4wGACwAB/wHHAYALAAE/Ae8DAAECCAABPwGQDAABPwHgDAABfwHgBQABAQYAAV8B4AUAAQMGAAE/AcAFAAEGBgABPwHABQABHAYAAT4BgAgA";function gp(t){const e=new DataView(t),o=new Array(t.byteLength*8),r=t.byteLength;for(let s=0;s<r;s++){const c=e.getUint8(s);for(let i=0;i<8;i++){const l=7-i,f=s;o[f*8+i]=!!(c&1<<l)}}return o}function Ap(t){const e=new DataView(t),o=t.byteLength;let r=0;for(let i=0;i<o;i+=2)r+=e.getUint8(i);const s=new ArrayBuffer(r),c=new DataView(s);for(let i=0,l=0;i<o;i+=2){const f=e.getUint8(i),w=e.getUint8(i+1);for(let b=0;b<f;b++)c.setUint8(l++,w)}return s}const Tt=new K(12*7*16),Cp=new K(Math.floor(Number(Tt)*.75)),nt=new K(9),bp=Tt,yp=Tt;new fp(Ot.minProjection,Ot.maxProjection,new R(new D(yp),new P(new K(0))),new R(new D(new K(0)),new P(bp)));const Sp=Tt,kp=Cp,$c=new K(Math.floor(Number(nt)/2)),vp=Math.floor(Number(Sp)/Number(nt)),Bp=Math.floor(Number(kp)/Number(nt)),Ep=Array.from($(Ho(Bp),t=>new D(new K(t*Number(nt)+Number($c))))),xp=Array.from($(Ho(vp),t=>new P(new K(t*Number(nt)+Number($c))))),Xc=Array.from(Uo(xp,t=>$(Ep,e=>new R(e,t))));Math.ceil(Xc.length/8);const Rp=Lo.decodeString(mp),Np=Ap(Rp),Ip=gp(Np),Dp=Wo(Xc,Ip,(t,e)=>[t,e]),Pp=Vo(Dp,([,t])=>t),Op=$(Pp,([t])=>t);Array.from(Op);class hn{constructor(e,o){n(this,"width");n(this,"index");this.width=e,this.index=o}toJSON(){return wn.encode(this)}}class Tp{convert(e){return d(e,"width","index"),new hn(h.decode(e.width),h.decode(e.index))}}class Lp{convert(e){return A(e,hn),{width:h.encode(e.width),index:h.encode(e.index)}}}class Mp extends a{constructor(){super(...arguments);n(this,"encoder",new Lp);n(this,"decoder",new Tp)}}const wn=new Mp;class De{static get lsb0(){return Up}static get msb0(){return Wp}valueOf(){return this.toString()}toJSON(){return this.toString()}}const Yc="bitvec::order::Lsb0",Kc="bitvec::order::Msb0";class Vp extends De{toString(){return Yc}}const Up=new Vp;class Hp extends De{toString(){return Kc}}const Wp=new Hp;class _p{convert(e){if(typeof e!="string")throw new m(typeof e,"string");switch(e){case Yc:return De.lsb0;case Kc:return De.msb0;default:throw new m(e,"CappuccinoAPIBitVecOrder")}}}class zp{convert(e){return e.toString()}}class Fp extends a{constructor(){super(...arguments);n(this,"encoder",new zp);n(this,"decoder",new _p)}}const Zc=new Fp;class fn{constructor(e,o,r,s){n(this,"order");n(this,"head");n(this,"bits");n(this,"data");this.order=e,this.head=o,this.bits=r,this.data=s}getBitVecIndexIterable(){return this.order===De.lsb0?new $p(this.head.width,this.bits):new Yp(this.head.width,this.bits)}[Symbol.iterator](){const e=this.getBitVecIndexIterable();return $(e,o=>qp(this.data,o))[Symbol.iterator]()}toJSON(){return ke.encode(this)}}class Jp{convert(e){return d(e,"order","head","bits","data"),new fn(Zc.decode(e.order),wn.decode(e.head),h.decode(e.bits),fe.decode(e.data))}}class Gp{convert(e){return A(e,fn),{order:Zc.encode(e.order),head:wn.encode(e.head),bits:h.encode(e.bits),data:fe.encode(e.data)}}}class Qp extends a{constructor(){super(...arguments);n(this,"encoder",new Gp);n(this,"decoder",new Jp)}}const ke=new Qp,ea=new x(new B(ke),new E(ke));function qp(t,e){return(t[e.bucket]>>e.bitOffset&1)===1}class ta{constructor(e,o){n(this,"bucket");n(this,"bitOffset");this.bucket=e,this.bitOffset=o}}function oa(t){switch(T(t===8||t===16||t===32,"bit width should be a power of two that is supported"),t){case 8:return 3;case 16:return 4;case 32:return 5;default:throw new z}}class jp{constructor(e,o){n(this,"totalBits");n(this,"bitWidthMask");n(this,"bitWidthShift");n(this,"offset",0);this.totalBits=o;const r=oa(e);this.bitWidthMask=e-1,this.bitWidthShift=r}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,o=this.offset&this.bitWidthMask;return this.offset+=1,{done:!1,value:new ta(e,o)}}}class $p{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");this.bitWidth=e,this.totalBits=o}[Symbol.iterator](){return new jp(this.bitWidth,this.totalBits)}}class Xp{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");n(this,"bitWidthMask");n(this,"bitWidthShift");n(this,"offset",0);this.bitWidth=e,this.totalBits=o;const r=oa(e);this.bitWidthMask=e-1,this.bitWidthShift=r}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,o=this.bitWidth-1-(this.offset&this.bitWidthMask);return this.offset+=1,{done:!1,value:new ta(e,o)}}}class Yp{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");this.bitWidth=e,this.totalBits=o}[Symbol.iterator](){return new Xp(this.bitWidth,this.totalBits)}}class na{constructor(e,o,r){n(this,"r");n(this,"s");n(this,"v");this.r=e,this.s=o,this.v=r}toJSON(){return pn.encode(this)}}class Kp{convert(e){return d(e,"r","s","v"),new na(M.decode(e.r),M.decode(e.s),h.decode(e.v))}}class Zp{convert(e){return A(e,na),{r:M.encode(e.r),s:M.encode(e.s),v:h.encode(e.v)}}}class em extends a{constructor(){super(...arguments);n(this,"encoder",new Zp);n(this,"decoder",new Kp)}}const pn=new em;class ra{constructor(e,o){n(this,"account");n(this,"amount");this.account=e,this.amount=o}toJSON(){return mn.encode(this)}}class tm{convert(e){return d(e,"account","amount"),new ra(M.decode(e.account),M.decode(e.amount))}}class om{convert(e){return A(e,ra),{account:M.encode(e.account),amount:M.encode(e.amount)}}}class nm extends a{constructor(){super(...arguments);n(this,"encoder",new om);n(this,"decoder",new tm)}}const mn=new nm;class sa{constructor(e,o,r){n(this,"number");n(this,"timestamp");n(this,"hash");this.number=e,this.timestamp=o,this.hash=r}toJSON(){return gn.encode(this)}}class rm{convert(e){return d(e,"number","timestamp","hash"),new sa(h.decode(e.number),u.decode(e.timestamp),u.decode(e.hash))}}class sm{convert(e){return A(e,sa),{number:h.encode(e.number),timestamp:u.encode(e.timestamp),hash:u.encode(e.hash)}}}class cm extends a{constructor(){super(...arguments);n(this,"encoder",new sm);n(this,"decoder",new rm)}}const gn=new cm,ca=new H(new V(gn),new U(gn));class aa{constructor(e){n(this,"bytes");this.bytes=e}toJSON(){return An.encode(this)}}class am{convert(e){return d(e,"bytes"),new aa(Ks.decode(e.bytes))}}class im{convert(e){return A(e,aa),{bytes:Ks.encode(e.bytes)}}}class dm extends a{constructor(){super(...arguments);n(this,"encoder",new im);n(this,"decoder",new am)}}const An=new dm;class ia{constructor(e,o,r,s,c,i,l,f,w,b){n(this,"height");n(this,"timestamp");n(this,"l1_head");n(this,"l1_finalized");n(this,"payload_commitment");n(this,"ns_table");n(this,"block_merkle_root");n(this,"fee_merkle_root");n(this,"builder_signature");n(this,"fee_info");this.height=e,this.timestamp=o,this.l1_head=r,this.l1_finalized=s,this.payload_commitment=c,this.ns_table=i,this.block_merkle_root=l,this.fee_merkle_root=f,this.builder_signature=w,this.fee_info=b}toJSON(){return rt.encode(this)}}class lm{convert(e){return d(e,"height","timestamp","l1_head","l1_finalized","payload_commitment","ns_table","block_merkle_root","fee_merkle_root","builder_signature","fee_info"),new ia(h.decode(e.height),h.decode(e.timestamp),h.decode(e.l1_head),ca.decode(e.l1_finalized),fe.decode(e.payload_commitment),An.decode(e.ns_table),C.decode(e.block_merkle_root),C.decode(e.fee_merkle_root),pn.decode(e.builder_signature),mn.decode(e.fee_info))}}class um{convert(e){return A(e,ia),{height:h.encode(e.height),timestamp:h.encode(e.timestamp),l1_head:h.encode(e.l1_head),l1_finalized:ca.encode(e.l1_finalized),payload_commitment:fe.encode(e.payload_commitment),ns_table:An.encode(e.ns_table),block_merkle_root:C.encode(e.block_merkle_root),fee_merkle_root:C.encode(e.fee_merkle_root),builder_signature:pn.encode(e.builder_signature),fee_info:mn.encode(e.fee_info)}}}class hm extends a{constructor(){super(...arguments);n(this,"encoder",new um);n(this,"decoder",new lm)}}const rt=new hm;class da{constructor(e,o){n(this,"vm");n(this,"payload");this.vm=e,this.payload=o}toJSON(){return st.encode(this)}}class wm{convert(e){return d(e,"vm","payload"),new da(h.decode(e.vm),fe.decode(e.payload))}}class fm{convert(e){return A(e,da),{vm:h.encode(e.vm),payload:fe.encode(e.payload)}}}class pm extends a{constructor(){super(...arguments);n(this,"encoder",new fm);n(this,"decoder",new wm)}}const st=new pm;new x(new B(st),new E(st));class la{constructor(e,o,r,s,c){n(this,"header");n(this,"hash");n(this,"size");n(this,"num_transactions");n(this,"proposer_id");this.header=e,this.hash=o,this.size=r,this.num_transactions=s,this.proposer_id=c}toJSON(){return Cn.encode(this)}}class mm{convert(e){return d(e,"header","hash","size","num_transactions","proposer_id"),new la(rt.decode(e.header),C.decode(e.hash),h.decode(e.size),h.decode(e.num_transactions),ae.decode(e.proposer_id))}}class gm{convert(e){return A(e,la),{header:rt.encode(e.header),hash:C.encode(e.hash),size:h.encode(e.size),num_transactions:h.encode(e.num_transactions),proposer_id:ae.encode(e.proposer_id)}}}class Am extends a{constructor(){super(...arguments);n(this,"encoder",new gm);n(this,"decoder",new mm)}}const Cn=new Am;new x(new B(Cn),new E(Cn));class ua{constructor(e,o,r,s){n(this,"hash");n(this,"header");n(this,"offset");n(this,"transaction");this.hash=e,this.header=o,this.offset=r,this.transaction=s}toJSON(){return bn.encode(this)}}class Cm{convert(e){return d(e,"hash","header","offset","transaction"),new ua(C.decode(e.hash),rt.decode(e.header),h.decode(e.offset),st.decode(e.transaction))}}class bm{convert(e){return A(e,ua),{hash:C.encode(e.hash),header:rt.encode(e.header),offset:h.encode(e.offset),transaction:st.encode(e.transaction)}}}class ym extends a{constructor(){super(...arguments);n(this,"encoder",new bm);n(this,"decoder",new Cm)}}const bn=new ym;new x(new B(bn),new E(bn));class ha{constructor(e,o){n(this,"signature");n(this,"bitvec");this.signature=e,this.bitvec=o}toJSON(){return yn.encode(this)}}class Sm{convert(e){if(!ds(e)||e.length!==2)throw new m(typeof e,"Array");return new ha(C.decode(e[0]),ke.decode(e[1]))}}class km{convert(e){return A(e,ha),[C.encode(e.signature),ke.encode(e.bitvec)]}}class vm extends a{constructor(){super(...arguments);n(this,"encoder",new km);n(this,"decoder",new Sm)}}const yn=new vm;new H(new V(yn),new U(yn));class ct{}class Sn extends ct{toJSON(){return kn.encode(this)}}class Bm{convert(e){if(!ee(e)||e!=="Empty")throw new se;return new Sn}}class Em{convert(e){return A(e,Sn),"Empty"}}class xm extends a{constructor(){super(...arguments);n(this,"encoder",new Em);n(this,"decoder",new Bm)}}const kn=new xm;class vn extends ct{constructor(o,r,s){super();n(this,"value");n(this,"pos");n(this,"elem");this.value=o,this.pos=r,this.elem=s}toJSON(){return Bn.encode(this)}}class Rm{convert(e){d(e,"Leaf");const o=e.Leaf;return d(o,"value","pos","elem"),new vn(C.decode(o.value),C.decode(o.pos),C.decode(o.elem))}}class Nm{convert(e){return A(e,vn),{Leaf:{value:C.encode(e.value),pos:C.encode(e.pos),elem:C.encode(e.elem)}}}}class Im extends ue{constructor(){super(...arguments);n(this,"encoder",new Nm);n(this,"decoder",new Rm)}}const Bn=new Im;class En extends ct{constructor(o){super();n(this,"value");this.value=o}toJSON(){return xn.encode(this)}}class Dm{convert(e){d(e,"ForgettenSubtree");const o=e.ForgettenSubtree;return d(o,"value"),new En(C.decode(o.value))}}class Pm{convert(e){return A(e,En),{ForgettenSubtree:{value:C.encode(e.value)}}}}class Om extends ue{constructor(){super(...arguments);n(this,"encoder",new Pm);n(this,"decoder",new Dm)}}const xn=new Om;class Rn extends ct{constructor(o,r){super();n(this,"value");n(this,"children");this.value=o,this.children=r}toJSON(){return Nn.encode(this)}}class Tm{convert(e){d(e,"Branch");const o=e.Branch;return d(o,"value","children"),new Rn(C.decode(o.value),fa.decode(o.children))}}class Lm{convert(e){return A(e,Rn),{Branch:{value:C.encode(e.value),children:fa.encode(e.children)}}}}class Mm extends a{constructor(){super(...arguments);n(this,"encoder",new Lm);n(this,"decoder",new Tm)}}const Nn=new Mm;class Vm{convert(e){if(no(e,"Leaf",ft))return Bn.decoder.convert(e);if(no(e,"Branch",ft))return Nn.decoder.convert(e);if(no(e,"ForgettenSubtree",ft))return xn.decoder.convert(e);if(ee(e))return kn.decoder.convert(e);throw new se}}class Um{convert(e){if(A(e,ct),e instanceof vn)return Bn.encode(e);if(e instanceof Rn)return Nn.encode(e);if(e instanceof En)return xn.encode(e);if(e instanceof Sn)return kn.encode(e);throw new se}}class Hm extends a{constructor(){super(...arguments);n(this,"encoder",new Um);n(this,"decoder",new Vm)}}const wa=new Hm,fa=new x(new B(wa),new E(wa));class In{constructor(e,o,r,s,c,i,l,f){n(this,"hash");n(this,"height");n(this,"time");n(this,"numTransactions");n(this,"proposerID");n(this,"feeRecipient");n(this,"size");n(this,"blockReward");this.hash=e,this.height=o,this.time=r,this.numTransactions=s,this.proposerID=c,this.feeRecipient=i,this.size=l,this.blockReward=f}toJSON(){return at.encode(this)}}class Wm{convert(e){return d(e,"hash","height","time","num_transactions","proposer_id","fee_recipient","size","block_reward"),new In(C.decode(e.hash),h.decode(e.height),Ee.decode(e.time),h.decode(e.num_transactions),ae.decode(e.proposer_id),ae.decode(e.fee_recipient),h.decode(e.size),mc.decode(e.block_reward))}}class _m{convert(e){return A(e,In),{hash:C.encode(e.hash),height:h.encode(e.height),time:Ee.encode(e.time),num_transactions:h.encode(e.numTransactions),proposer_id:ae.encode(e.proposerID),fee_recipient:ae.encode(e.feeRecipient),size:h.encode(e.size),block_reward:mc.encode(e.blockReward)}}}class zm extends ue{constructor(){super(...arguments);n(this,"encoder",new _m);n(this,"decoder",new Wm)}}const at=new zm,pa=new x(new B(at),new E(at));class ma{constructor(e,o,r,s,c,i){n(this,"hash");n(this,"height");n(this,"proposerID");n(this,"numTransactions");n(this,"size");n(this,"time");this.hash=e,this.height=o,this.proposerID=r,this.numTransactions=s,this.size=c,this.time=i}toJSON(){return Dn.encode(this)}}class Fm{convert(e){return d(e,"hash","height","proposer_id","num_transactions","size","time"),new ma(C.decode(e.hash),h.decode(e.height),ae.decode(e.proposer_id),h.decode(e.num_transactions),h.decode(e.size),Ee.decode(e.time))}}class Jm{convert(e){return A(e,ma),{hash:C.encode(e.hash),height:h.encode(e.height),proposer_id:ae.encode(e.proposerID),num_transactions:h.encode(e.numTransactions),size:h.encode(e.size),time:Ee.encode(e.time)}}}class Gm extends ue{constructor(){super(...arguments);n(this,"encoder",new Jm);n(this,"decoder",new Fm)}}const Dn=new Gm;new x(new B(Dn),new E(Dn));function Qm(t,e){return t.blockHeights-e.blockHeights}class Lt{constructor(e,o,r,s){n(this,"blockTime");n(this,"blockSize");n(this,"blockTransactions");n(this,"blockHeights");const c=[],i=Math.min(e.length,o.length,r.length,s.length);for(let L=0;L<i;L++){const I=s[L];I!==null&&c.push({blockTime:e[L],blockSize:o[L],blockTransactions:r[L],blockHeights:I})}c.sort(Qm);const l=c[0].blockHeights,f=c[c.length-1].blockHeights,w=[],b=[],O=[],g=[];for(let L=l,I=0;L<=f;L++){const F=c[I];if(F.blockHeights!==L){w.push(null),b.push(null),O.push(null),g.push(null);continue}w.push(F.blockTime),b.push(F.blockSize),O.push(F.blockTransactions),g.push(F.blockHeights),I++}const p=Math.max(0,g.length-50);this.blockTime=w.slice(p),this.blockSize=b.slice(p),this.blockTransactions=O.slice(p),this.blockHeights=g.slice(p)}toJSON(){return Pn.encode(this)}}class qm{convert(e){return d(e,"block_time","block_size","block_transactions","block_heights"),new Lt(re.decode(e.block_time),re.decode(e.block_size),re.decode(e.block_transactions),re.decode(e.block_heights))}}class jm{convert(e){return A(e,Lt),{block_time:re.encode(e.blockTime),block_size:re.encode(e.blockSize),block_transactions:re.encode(e.blockTransactions),block_heights:re.encode(e.blockHeights)}}}class $m extends a{constructor(){super(...arguments);n(this,"encoder",new jm);n(this,"decoder",new qm)}}const Pn=new $m,ga=fe;class Aa{constructor(e,o,r,s,c,i){n(this,"hash");n(this,"rollups");n(this,"height");n(this,"time");n(this,"offset");n(this,"numTransactions");this.hash=e,this.rollups=o,this.height=r,this.time=s,this.offset=c,this.numTransactions=i}toJSON(){return On.encode(this)}}class Xm{convert(e){return d(e,"hash","rollups","height","time","offset","num_transactions"),new Aa(C.decode(e.hash),ga.decode(e.rollups),h.decode(e.height),Ee.decode(e.time),h.decode(e.offset),h.decode(e.num_transactions))}}class Ym{convert(e){return A(e,Aa),{hash:C.encode(e.hash),rollups:ga.encode(e.rollups),height:h.encode(e.height),time:Ee.encode(e.time),offset:h.encode(e.offset),num_transactions:h.encode(e.numTransactions)}}}class Km extends a{constructor(){super(...arguments);n(this,"encoder",new Ym);n(this,"decoder",new Xm)}}const On=new Km;new x(new B(On),new E(On));const Ca=h;class ba{constructor(e,o){n(this,"namespace");n(this,"payload");this.namespace=e,this.payload=o}toJSON(){return Tn.encode(this)}}class Zm{convert(e){return d(e,"namespace","payload"),new ba(Ca.decode(e.namespace),Zs.decode(e.payload))}}class eg{convert(e){return A(e,ba),{namespace:Ca.encode(e.namespace),payload:Zs.encode(e.payload)}}}class tg extends a{constructor(){super(...arguments);n(this,"encoder",new eg);n(this,"decoder",new Zm)}}const Tn=new tg;new x(new B(Tn),new E(Tn));class ya{constructor(e,o){n(this,"coords");n(this,"country");this.coords=e,this.country=o}toJSON(){return Ln.encode(this)}}class og{convert(e){return{coords:Vc.encode(e.coords),country:J.encode(e.country)}}}class ng{convert(e){return d(e,"coords","country"),new ya(Vc.decode(e.coords),Be(J.decode(e.country)))}}class rg extends a{constructor(){super(...arguments);n(this,"encoder",new og);n(this,"decoder",new ng)}}const Ln=new rg,Sa=new H(new V(Ln),new U(Ln));class ka{constructor(e,o,r,s,c,i,l,f,w){n(this,"publicKey");n(this,"name");n(this,"publicURL");n(this,"company");n(this,"companyWebsite");n(this,"location");n(this,"operatingSystem");n(this,"nodeType");n(this,"networkType");this.publicKey=e,this.name=o,this.publicURL=r,this.company=s,this.companyWebsite=c,this.location=i,this.operatingSystem=l,this.nodeType=f,this.networkType=w}toJSON(){return it.encode(this)}}class sg{convert(e){return{public_key:C.encode(e.publicKey),name:J.encode(e.name),public_url:vt.encode(e.publicURL),company:J.encode(e.company),company_website:vt.encode(e.companyWebsite),location:Sa.encode(e.location),operating_system:J.encode(e.operatingSystem),node_type:J.encode(e.nodeType),network_type:J.encode(e.networkType)}}}class cg{convert(e){return d(e,"public_key","name","public_url","company","company_website","location","operating_system","node_type","network_type"),new ka(C.decode(e.public_key),Be(J.decode(e.name)),vt.decode(e.public_url),Be(J.decode(e.company)),vt.decode(e.company_website),Sa.decode(e.location),Be(J.decode(e.operating_system)),Be(J.decode(e.node_type)),Be(J.decode(e.network_type)))}}class ag extends a{constructor(){super(...arguments);n(this,"encoder",new sg);n(this,"decoder",new cg)}}const it=new ag,va=new x(new B(it),new E(it));class Q{}const Ba="SubscribeNodeIdentity";class Mn extends Q{valueOf(){return Ba}}const Ea="SubscribeLatestBlock";class Vn extends Q{valueOf(){return Ea}}const xa="SubscribeVoters";class Un extends Q{valueOf(){return xa}}const Ra="SubscribeValidators";class ig extends Q{valueOf(){return Ra}}const Na="SubscribeStakeTables";class dg extends Q{valueOf(){return Na}}const Ia="RequestNodeIdentitySnapshot";class Hn extends Q{valueOf(){return Ia}}const Da="RequestBlocksSnapshot";class Wn extends Q{valueOf(){return Da}}const Pa="RequestHistogramSnapshot";class _n extends Q{valueOf(){return Pa}}const Oa="RequestVotersSnapshot";class zn extends Q{valueOf(){return Oa}}const Ta="RequestValidatorsSnapshot";class lg extends Q{valueOf(){return Ta}}const La="RequestStakeTableSnapshot";class ug extends Q{valueOf(){return La}}class hg{convert(e){return e.valueOf()}}class wg{convert(e){if(typeof e!="string")throw new m(typeof e,"string");switch(e){case Ba:return new Mn;case Ea:return new Vn;case xa:return new Un;case Ia:return new Hn;case Da:return new Wn;case Pa:return new _n;case Oa:return new zn;case Ra:return new ig;case Na:return new dg;case Ta:return new lg;case La:return new ug;default:throw new m(e,"CappuccinoNodeValidatorRequest")}}}class fg extends a{constructor(){super(...arguments);n(this,"encoder",new hg);n(this,"decoder",new wg)}}const Fn=new fg,dt="NodeValidatorRequest";class Mt extends nc{constructor(o){super();n(this,"request");this.request=o}get type(){return dt}toJSON(){return Ma.encode(this)}}class pg{convert(e){return{[dt]:Fn.encode(e.request)}}}class mg{convert(e){return d(e,dt),new Mt(Fn.decode(e[dt]))}}class gg extends a{constructor(){super(...arguments);n(this,"encoder",new pg);n(this,"decoder",new mg)}}const Ma=new gg;class q{}const Vt="BlocksSnapshot";class Jn extends q{constructor(o){super();n(this,"blocks");this.blocks=o}toJSON(){return Gn.encode(this)}}class Ag{convert(e){d(e,Vt);const o=e[Vt];return new Jn(pa.decode(o))}}class Cg{convert(e){return{[Vt]:pa.encode(e.blocks)}}}class bg extends a{constructor(){super(...arguments);n(this,"encoder",new Cg);n(this,"decoder",new Ag)}}const Gn=new bg,Ut="HistogramSnapshot";class Ht extends q{constructor(o){super();n(this,"histograms");this.histograms=o}toJSON(){return Qn.encode(this)}}class yg{convert(e){return d(e,Ut),new Ht(Pn.decode(e[Ut]))}}class Sg{convert(e){return{[Ut]:Pn.encode(e.histograms)}}}class kg extends a{constructor(){super(...arguments);n(this,"encoder",new Sg);n(this,"decoder",new yg)}}const Qn=new kg,Wt="LatestBlock";class _t extends q{constructor(o){super();n(this,"latestBlock");this.latestBlock=o}toJSON(){return qn.encode(this)}}class vg{convert(e){return d(e,Wt),new _t(at.decode(e[Wt]))}}class Bg{convert(e){return{[Wt]:at.encode(e.latestBlock)}}}class Eg extends a{constructor(){super(...arguments);n(this,"encoder",new Bg);n(this,"decoder",new vg)}}const qn=new Eg,zt="LatestVoters";class jn extends q{constructor(o){super();n(this,"latestVoter");this.latestVoter=o}toJSON(){return $n.encode(this)}}class xg{convert(e){return d(e,zt),new jn(ke.decode(e[zt]))}}class Rg{convert(e){return{[zt]:ke.encode(e.latestVoter)}}}class Ng extends a{constructor(){super(...arguments);n(this,"encoder",new Rg);n(this,"decoder",new xg)}}const $n=new Ng,Ft="NodeIdentitySnapshot";class Jt extends q{constructor(o){super();n(this,"nodes");this.nodes=o}toJSON(){return Xn.encode(this)}}class Ig{convert(e){d(e,Ft);const o=e[Ft];return new Jt(va.decode(o))}}class Dg{convert(e){return{[Ft]:va.encode(e.nodes)}}}class Pg extends a{constructor(){super(...arguments);n(this,"encoder",new Dg);n(this,"decoder",new Ig)}}const Xn=new Pg,Gt="LatestNodeIdentity";class Va extends q{constructor(o){super();n(this,"nodeIdentity");this.nodeIdentity=o}toJSON(){return Yn.encode(this)}}class Og{convert(e){return d(e,Gt),new Va(it.decode(e[Gt]))}}class Tg{convert(e){return{[Gt]:it.encode(e.nodeIdentity)}}}class Lg extends a{constructor(){super(...arguments);n(this,"encoder",new Tg);n(this,"decoder",new Og)}}const Yn=new Lg;class Ua{constructor(e,o){n(this,"stakeKey");n(this,"stakeAmount");this.stakeKey=e,this.stakeAmount=o}}class Mg{convert(e){return d(e,"stake_key","stake_amount"),new Ua(C.decode(e.stake_key),te.decode(e.stake_amount))}}class Vg{convert(e){return A(e,Ua),{stake_key:C.encode(e.stakeKey),stake_amount:te.encode(e.stakeAmount)}}}class Ug extends a{constructor(){super(...arguments);n(this,"encoder",new Vg);n(this,"decoder",new Mg)}}const Pe=new Ug;new H(new V(Pe),new U(Pe)),new x(new B(Pe),new E(Pe));class Ha{constructor(e,o){n(this,"stakeTableEntry");n(this,"stateVerKey");this.stakeTableEntry=e,this.stateVerKey=o}}class Hg{convert(e){return d(e,"stake_table_entry","state_ver_key"),new Ha(Pe.decode(e.stake_table_entry),C.decode(e.state_ver_key))}}class Wg{convert(e){return A(e,Ha),{stake_table_entry:Pe.encode(e.stakeTableEntry),state_ver_key:C.encode(e.stateVerKey)}}}class _g extends a{constructor(){super(...arguments);n(this,"encoder",new Wg);n(this,"decoder",new Hg)}}const Qt=new _g;new H(new V(Qt),new U(Qt));const qt=new x(new B(Qt),new E(Qt)),jt="LatestStakeTable";class Wa extends q{constructor(o){super();n(this,"stakeTable");this.stakeTable=o}toJSON(){return Kn.encode(this)}}class zg{convert(e){return d(e,jt),new Wa(qt.decode(e[jt]))}}class Fg{convert(e){return{[jt]:qt.encode(e.stakeTable)}}}class Jg extends a{constructor(){super(...arguments);n(this,"encoder",new Fg);n(this,"decoder",new zg)}}const Kn=new Jg;class Gg{constructor(e){n(this,"address");this.address=e,Object.freeze(this)}toJSON(){return Oe.encode(this)}toString(){return Oe.encode(this)}}class Qg{convert(e){return e.address.byteLength!==20?M.encode(e.address):nh.convert(e.address)}}class qg{convert(e){return new Gg(M.decode(e))}}class jg extends a{constructor(){super(...arguments);n(this,"encoder",new Qg);n(this,"decoder",new qg)}}const Oe=new jg;new H(new V(Oe),new U(Oe));const Zn=1e4,_a=0,$g="PercentageOutOfRange";class Xg extends v{constructor(o,r=`the commission percentage is outside of the range [${_a}, ${Zn}], have ${o}`){super(r);n(this,"value");this.value=o,Object.freeze(this)}get code(){return $g}}class za{constructor(e){n(this,"value");if(e<_a||e>Zn)throw new Xg(e);this.value=e}toString(){return`${this.value/100}%`}toJSON(){return this.value}valueOf(){return this.value/Zn}}class Yg{convert(e){if(typeof e!="number")throw new m(typeof e,"number");return new za(e)}}class Kg{convert(e){if(!(e instanceof za))throw new m(e,"CommissionPercent");return Math.floor(e.value)}}class Zg extends a{constructor(){super(...arguments);n(this,"encoder",new Kg);n(this,"decoder",new Yg)}}const Fa=new Zg,Ja=zo.keyStringCodec(te);class Ga{constructor(e,o,r,s,c,i){n(this,"account");n(this,"stakeTableKey");n(this,"stateVerKey");n(this,"stake");n(this,"commission");n(this,"delegators");this.account=e,this.stakeTableKey=o,this.stateVerKey=r,this.stake=s,this.commission=c,this.delegators=i}}class eA{convert(e){return d(e,"account","stake_table_key","state_ver_key","stake","commission","delegators"),new Ga(Oe.decode(e.account),C.decode(e.stake_table_key),C.decode(e.state_ver_key),te.decode(e.stake),Fa.decode(e.commission),Ja.decode(e.delegators))}}class tA{convert(e){return A(e,Ga),{account:Oe.encode(e.account),stake_table_key:C.encode(e.stakeTableKey),state_ver_key:C.encode(e.stateVerKey),stake:te.encode(e.stake),commission:Fa.encode(e.commission),delegators:Ja.encode(e.delegators)}}}class oA extends a{constructor(){super(...arguments);n(this,"encoder",new tA);n(this,"decoder",new eA)}}const Te=new oA;new H(new V(Te),new U(Te));const Qa=new x(new B(Te),new E(Te)),$t="LatestValidator";class qa extends q{constructor(o){super();n(this,"validator");this.validator=o}toJSON(){return er.encode(this)}}class nA{convert(e){return d(e,$t),new qa(Te.decode(e[$t]))}}class rA{convert(e){return{[$t]:Te.encode(e.validator)}}}class sA extends a{constructor(){super(...arguments);n(this,"encoder",new rA);n(this,"decoder",new nA)}}const er=new sA,Xt="StakeTableSnapshot";class ja extends q{constructor(o){super();n(this,"stakeTable");this.stakeTable=o}toJSON(){return tr.encode(this)}}class cA{convert(e){d(e,Xt);const o=e[Xt];return new ja(qt.decode(o))}}class aA{convert(e){return{[Xt]:qt.encode(e.stakeTable)}}}class iA extends a{constructor(){super(...arguments);n(this,"encoder",new aA);n(this,"decoder",new cA)}}const tr=new iA,Yt="ValidatorsSnapshot";class $a extends q{constructor(o){super();n(this,"validators");this.validators=o}toJSON(){return or.encode(this)}}class dA{convert(e){d(e,Yt);const o=e[Yt];return new $a(Qa.decode(o))}}class lA{convert(e){return{[Yt]:Qa.encode(e.validators)}}}class uA extends a{constructor(){super(...arguments);n(this,"encoder",new lA);n(this,"decoder",new dA)}}const or=new uA,Kt="VotersSnapshot";class nr extends q{constructor(o){super();n(this,"voters");this.voters=o}toJSON(){return rr.encode(this)}}class hA{convert(e){d(e,Kt);const o=e[Kt];return new nr(ea.decode(o))}}class wA{convert(e){return{[Kt]:ea.encode(e.voters)}}}class fA extends a{constructor(){super(...arguments);n(this,"encoder",new wA);n(this,"decoder",new hA)}}const rr=new fA;class pA{convert(e){if(G(e,Vt))return Gn.decode(e);if(G(e,Ut))return Qn.decode(e);if(G(e,Wt))return qn.decode(e);if(G(e,Gt))return Yn.decode(e);if(G(e,zt))return $n.decode(e);if(G(e,$t))return er.decode(e);if(G(e,jt))return Kn.decode(e);if(G(e,Ft))return Xn.decode(e);if(G(e,Kt))return rr.decode(e);if(G(e,Yt))return or.decode(e);if(G(e,Xt))return tr.decode(e);throw new z}}class mA{convert(e){if(e instanceof Jn)return Gn.encode(e);if(e instanceof Ht)return Qn.encode(e);if(e instanceof _t)return qn.encode(e);if(e instanceof Va)return Yn.encode(e);if(e instanceof jn)return $n.encode(e);if(e instanceof qa)return er.encode(e);if(e instanceof Wa)return Kn.encode(e);if(e instanceof Jt)return Xn.encode(e);if(e instanceof nr)return rr.encode(e);if(e instanceof $a)return or.encode(e);if(e instanceof ja)return tr.encode(e);throw new z}}class gA extends a{constructor(){super(...arguments);n(this,"encoder",new mA);n(this,"decoder",new pA)}}const Zt=new gA,lt="NodeValidatorResponse";class Xa extends qo{constructor(o){super();n(this,"response");this.response=o}get type(){return lt}toJSON(){return Ya.encode(this)}}class AA{convert(e){return{[lt]:Zt.encode(e.response)}}}class CA{convert(e){d(e,lt);const o=e[lt];return new Xa(Zt.decode(o))}}class bA extends a{constructor(){super(...arguments);n(this,"encoder",new AA);n(this,"decoder",new CA)}}const Ya=new bA;class yA{convert(e){return new Xa(e)}}const sr=new yA;function cr(t){return new In(t.hash,t.height,t.time,t.numTransactions,t.proposer,t.proposer,t.size,t.fees)}function Ka(t){return new ka(t.pubkey,t.name,null,t.company.name,new URL(t.company.website),new ya(new R(new D(new W(t.location.coords[0])),new P(new W(t.location.coords[1]))),t.location.country),t.operatingSystem,t.nodeType,t.networkType)}class ar{constructor(e,o){n(this,"responseStream");n(this,"requestStream");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");n(this,"prng",new be(hf()));n(this,"latestBlock",cr(vc()));n(this,"latestBlocks",pe(50));n(this,"latestVoters",pe(50));n(this,"histogramBlockTimeData",pe(50));n(this,"histogramBlockSizeData",pe(50));n(this,"histogramBlockTransactionData",pe(50));n(this,"histogramBlockHeightData",pe(50));n(this,"isConnected",!1);n(this,"isSubscribedToLatestBlock",!1);n(this,"isSubscribedToVoters",!1);this.requestStream=e,this.responseStream=o,this.lifecycleResponseSink=Ce(ge(o),Ko),this.nodeValidatorResponseSink=Ce(ge(o),sr)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}generateVotersFromBlockDetail(e){const o=new be(e.time.valueOf()),r=et.length,s=Math.ceil(r/16),c=new Uint16Array(o.fillBytes(s*2));return new fn(De.lsb0,new hn(16,0),r,Array.from(c))}async updateBlockDetails(e){const o=this.latestBlock,r=(e.time.valueOf()-o.time.valueOf())/1e3,s=this.generateVotersFromBlockDetail(e);this.latestBlock=e,this.latestBlocks.put(e),this.latestVoters.put(s),this.histogramBlockTimeData.put(r),this.histogramBlockSizeData.put(e.size),this.histogramBlockTransactionData.put(e.numTransactions),this.histogramBlockHeightData.put(e.height),this.isConnected&&(this.isSubscribedToLatestBlock&&await this.nodeValidatorResponseSink.send(new _t(e)),this.isSubscribedToVoters&&this.nodeValidatorResponseSink.send(new jn(s)))}async initializeState(){for await(const e of pf(this.prng))this.updateBlockDetails(cr(e));await this.nodeValidatorResponseSink.send(new _t(this.latestBlock)),await this.nodeValidatorResponseSink.send(new Ht(new Lt(Array.from(this.histogramBlockTimeData.immutableIterable()),Array.from(this.histogramBlockSizeData.immutableIterable()),Array.from(this.histogramBlockTransactionData.immutableIterable()),Array.from(this.histogramBlockHeightData.immutableIterable())))),this.nodeValidatorResponseSink.send(new Jt(et.map(Ka)))}async startProcessing(){await this.initializeState(),this.handleRequests(),this.streamBlocks()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async streamBlocks(){const e=this.latestBlock;for await(const o of mf(this.prng,e.time.valueOf(),e.height)){const r=cr(o);this.updateBlockDetails(r)}}async handleRequest(e){if(e instanceof Ge){try{await this.handleWebSocketCommand(e.command)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof Mt){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unrecognized request type",e)}async handleWebSocketCommand(e){if(e instanceof Je){await this.handleConnect();return}if(e instanceof ze){await this.handleClose();return}}async handleNodeValidatorRequest(e){if(e instanceof Vn){await this.handleSubscribeLatestBlock();return}if(e instanceof Mn){await this.handleSubscribeNodeIdentity();return}if(e instanceof Un){await this.handleSubscribeVoters();return}if(e instanceof Wn){await this.handleRequestBlocksSnapshot();return}if(e instanceof _n){await this.handleRequestHistogramSnapshot();return}if(e instanceof Hn){await this.handleRequestNodeIdentitySnapshot();return}if(e instanceof zn){await this.handleRequestVotersSnapshot();return}}async handleConnect(){if(this.isConnected)throw new Error("already connected to WebSocket");this.isConnected=!0,await this.lifecycleResponseSink.send(new Xe),await this.lifecycleResponseSink.send(new Ke)}async handleClose(){if(!this.isConnected)throw new Error("not connected to WebSocket");this.isConnected=!1,this.isSubscribedToLatestBlock=!1,this.isSubscribedToVoters=!1,await this.lifecycleResponseSink.send(new xe)}async assertIsConnected(){if(!this.isConnected)throw new Error("not connected to WebSocket")}async handleSubscribeLatestBlock(){await this.assertIsConnected(),this.isSubscribedToLatestBlock=!0}async handleSubscribeNodeIdentity(){await this.assertIsConnected()}async handleSubscribeVoters(){await this.assertIsConnected(),this.isSubscribedToVoters=!0}async handleRequestBlocksSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Jn(Array.from(this.latestBlocks.immutableIterable())))}async handleRequestHistogramSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Ht(new Lt(Array.from(this.histogramBlockTimeData.immutableIterable()),Array.from(this.histogramBlockSizeData.immutableIterable()),Array.from(this.histogramBlockTransactionData.immutableIterable()),Array.from(this.histogramBlockHeightData.immutableIterable()))))}async handleRequestNodeIdentitySnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Jt(et.map(Ka)))}async handleRequestVotersSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new nr(Array.from(this.latestVoters.immutableIterable())))}}class ir{constructor(e,o,r){n(this,"responseStream");n(this,"requestStream");n(this,"capturedHAR");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");this.requestStream=e,this.responseStream=o,this.capturedHAR=r,this.lifecycleResponseSink=Ce(ge(o),Ko),this.nodeValidatorResponseSink=Ce(ge(o),sr)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async startProcessing(){this.handleRequests()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async handleRequest(e){if(e instanceof Ge){try{await this.handleWebSocketCommand(e.command)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof Mt){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unknown request type",e)}async handleWebSocketCommand(e){if(e instanceof Je){await this.handleConnect();return}if(e instanceof ze){await this.handleClose();return}}async handleNodeValidatorRequest(e){if(e instanceof Vn){await this.handleSubscribeLatestBlock();return}if(e instanceof Mn){await this.handleSubscribeNodeIdentity();return}if(e instanceof Un){await this.handleSubscribeVoters();return}if(e instanceof Wn){await this.handleRequestBlocksSnapshot();return}if(e instanceof _n){await this.handleRequestHistogramSnapshot();return}if(e instanceof Hn){await this.handleRequestNodeIdentitySnapshot();return}if(e instanceof zn){await this.handleRequestVotersSnapshot();return}}async handleConnect(){await this.lifecycleResponseSink.send(new Xe),await this.lifecycleResponseSink.send(new Ke);const e=Uo(this.capturedHAR.log.entries,s=>"_webSocketMessages"in s?s._webSocketMessages:[]),o=Vo(e,s=>s.type==="receive");let r=0;for(const s of o){if(r>0){const c=s.time*1e3-r*1e3;await Zo(c)}r=s.time;try{const c=Zt.decode(JSON.parse(s.data));await this.nodeValidatorResponseSink.send(c)}catch(c){console.error(`Failed to decode message: ${s.data}`,c);continue}}await this.lifecycleResponseSink.send(new xe)}async handleClose(){}async handleSubscribeLatestBlock(){}async handleSubscribeNodeIdentity(){}async handleSubscribeVoters(){}async handleRequestBlocksSnapshot(){}async handleRequestHistogramSnapshot(){}async handleRequestNodeIdentitySnapshot(){}async handleRequestVotersSnapshot(){}}const dr="WebSocketError";class ut extends v{constructor(o,r=`websocket error: ${String(o)}`){super(r);n(this,"cause");this.cause=o,Object.freeze(this)}get code(){return dr}}class SA{convert(e){return d(e,"code","message"),S(e,dr),new ut({},u.decode(e.message))}}class kA extends _{}class vA extends a{constructor(){super(...arguments);n(this,"encoder",new kA);n(this,"decoder",new SA)}}const BA=new vA;k(dr,BA);class EA{constructor(e,o,r){n(this,"completer");n(this,"lifecycleResponseSink");n(this,"onClose");this.completer=e,this.lifecycleResponseSink=o,this.onClose=r}async handleEvent(){await this.lifecycleResponseSink.send(new xe),this.completer.isCompleted||this.completer.completeError(new ut(null,"web socket error: unknown error")),this.onClose()}}class xA{constructor(e,o){n(this,"completer");n(this,"errorResponseSink");this.completer=e,this.errorResponseSink=o}errorFromEvent(e){return"error"in e?new ut(e.error):new ut(null,"web socket error: unknown error")}handleEvent(e){const o=this.errorFromEvent(e);this.errorResponseSink.send(o),this.completer.isCompleted||this.completer.completeError(o)}}class RA{constructor(e){n(this,"nodeValidatorResponseSink");this.nodeValidatorResponseSink=e}decodeMessage(e){return Zt.decode(JSON.parse(e.data))}async relayMessage(e){try{await this.nodeValidatorResponseSink.send(e)}catch(o){console.error("attempt to publish message to response stream failed",o)}}async handleEvent(e){try{const o=this.decodeMessage(e);this.relayMessage(o)}catch(o){console.error("Failed to decode server message from web socket",o);return}}}class NA{constructor(e,o){n(this,"completer");n(this,"lifecycleResponseSink");this.completer=e,this.lifecycleResponseSink=o}handleEvent(e){this.completer.complete(e.target),this.lifecycleResponseSink.send(new Ke)}}class IA{constructor(e,o,r,s,c,i=l=>new WebSocket(l)){n(this,"webSocket",null);const l=i(e);l.addEventListener("open",r),l.addEventListener("message",o),l.addEventListener("close",s),l.addEventListener("error",c),l.addEventListener("close",()=>{l.removeEventListener("open",r),l.removeEventListener("message",o),l.removeEventListener("close",s),l.removeEventListener("error",c),this.webSocket=null}),this.webSocket=l}send(e){if(this.webSocket===null)throw new Error("WebSocket is not connected");this.webSocket.send(e)}async close(e=1e3,o="done"){if(this.webSocket===null)return;const r=we();return this.webSocket.addEventListener("close",()=>{r.complete()}),this.webSocket.close(e,o),r.promise}}function DA(t,e,o,r,s,c=i=>new WebSocket(i)){return new IA(t,e,o,r,s,c)}const PA=1e3,OA=250,TA=5e3;class lr{constructor(e,o,r,s=c=>new WebSocket(c)){n(this,"responseStream");n(this,"requestStream");n(this,"serviceBaseURL");n(this,"webSocketCreator");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");n(this,"errorResponseSink");n(this,"lastConnectTime",null);n(this,"rapidConnectCount",0);n(this,"webSocket",null);this.requestStream=e,this.responseStream=o,this.serviceBaseURL=r,this.webSocketCreator=s,this.lifecycleResponseSink=Ce(ge(o),Ko),this.nodeValidatorResponseSink=Ce(ge(o),sr),this.errorResponseSink=Ce(ge(o),Zh)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async startProcessing(){this.handleRequests()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async handleRequest(e){if(e instanceof Ge){try{await this.handleWebSocketCommand(e.command)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof Mt){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unrecognized request",e)}async handleWebSocketCommand(e){if(e instanceof Je){await this.handleConnect();return}if(e instanceof ze){await this.handleClose();return}}async handleNodeValidatorRequest(e){this.assertConnected(),this.webSocket.send(JSON.stringify(Fn.encode(e)))}assertConnected(){if(this.webSocket===null)throw new Error("Not connected")}async rapidReconnectProtection(){if(this.lastConnectTime===null){this.lastConnectTime=new Date;return}if(new Date().getTime()-this.lastConnectTime.getTime()<PA?this.rapidConnectCount++:this.rapidConnectCount=0,this.rapidConnectCount<=0)return;const r=2**(this.rapidConnectCount-1),s=Math.min(OA*r,TA);console.info("Delaying connection attempt due to rapid connects:",this.rapidConnectCount,r,s),await Zo(s),this.lastConnectTime=new Date}async handleConnect(){if(this.webSocket!==null)return;const e=new URL("node-validator/details",this.serviceBaseURL),o=we();try{const r=new Xe;await this.lifecycleResponseSink.send(r),await this.rapidReconnectProtection();const s=new RA(this.nodeValidatorResponseSink),c=new NA(o,this.lifecycleResponseSink),i=new EA(o,this.lifecycleResponseSink,()=>this.webSocket=null),l=new xA(o,this.errorResponseSink);this.webSocket=DA(e,s,c,i,l,this.webSocketCreator)}catch(r){const s=new ut(r);this.errorResponseSink.send(s),o.completeError(s)}await o.promise}async handleClose(){const e=this.webSocket;if(e===null){this.lifecycleResponseSink.send(new xe);return}await e.close()}}xh(dt,Ma),Xh(lt,Ya);async function LA(t){const e=t.pathname,o=await fetch(e);if(!o.ok)throw new z;const r=await o.json(),s=me(1024),c=me(1024),i=new ir(s,c,r);return i.startProcessing(),i}async function Za(t){const e=new URL(t);if(e.protocol==="replay:")return LA(e);if(e.protocol==="ws:"||e.protocol==="wss:"){const o=me(1024),r=me(1024),s=new lr(o,r,e);return s.startProcessing(),s}return null}async function MA(){try{const s=await(await fetch("/config.json")).json();if(s.node_validator_service_url){const c=await Za(s.node_validator_service_url);if(c!==null)return c}}catch(r){console.warn("error determining service implementation, from configuration file",r)}const t=me(1024),e=me(1024),o=new ar(t,e);return o.startProcessing(),o}async function VA(){return new ei(await MA())}class ei{constructor(e){n(this,"service");this.service=e}get stream(){return this.service.stream}async send(e){return this.service.send(e)}}class ti{}async function oi(t,e,o){const s=(await t).stream[Symbol.asyncIterator]();for(;;){const c=await Promise.race([e,s.next()]);if(c instanceof ti||c.done)return;const i=c.value;o(Yh.encode(i))}}class UA{constructor(e){n(this,"service");n(this,"stopPublishingResponses");n(this,"postMessage");n(this,"requestChannel");const o=VA();this.service=o;const r=we();this.stopPublishingResponses=r,this.requestChannel=me(1024),this.postMessage=e,this.processRequests(),oi(o,r.promise,this.postMessage)}async setURL(e){try{switch(new URL(e).protocol){case"replay:":case"ws:":case"wss:":break;default:return console.warn("Invalid protocol for node validator URL:",e),!1}const r=await this.service;this.stopPublishingResponses.complete(new ti),(r instanceof ar||r instanceof ir||r instanceof lr)&&r.responseStream.close(),(r instanceof ar||r instanceof ir||r instanceof lr)&&r.requestStream.close();const s=await Za(e);if(s===null)return console.warn("Unable to determine service implementation from URL:",e),!1;const c=new ei(s),i=we();return this.service=Promise.resolve(c),this.stopPublishingResponses=i,oi(Promise.resolve(c),i.promise,this.postMessage),!0}catch(o){return console.warn("error setting URL for node validator",e,o),!1}}async processRequests(){for await(const e of this.requestChannel)try{const o=await this.service;if(e instanceof Ge&&e.command instanceof Jo){await this.setURL(e.command.url);continue}o.send(e)}catch(o){console.warn("error processing message from event",o)}}async handleEvent(e){const o=Rh.decode(e.data);await this.requestChannel.publish(o)}}self.addEventListener("message",new UA(self.postMessage.bind(self)))})();
