import{c as F,b as P}from"./assert-BI051aL8.js";import{T as C,A as S,e as K,I as W,j as k,k as O,N as q,g as G,h as H,B,s as y,d as V,b as v,c as m,r as I,a as Q}from"./string-Bj9RBsFG.js";class X{convert(e){if(!K(e))throw new W(typeof e,"number");return e}}class Y{convert(e){return F(e,"number"),e}}class Z extends C{encoder=new Y;decoder=new X}const f=new Z,N=new q(new G(f),new H(f)),Ae=new S(new k(f),new O(f)),Be=new S(new k(N),new O(N)),M="CorruptBase64InputError";class g extends B{offset;constructor(e,r=`corrupt input error at ${e}`){super(r),this.offset=e,Object.freeze(this)}get code(){return M}toJSON(){return j.encode(this)}}class ${convert(e){return v(e,"code","offset","message"),m(e,M),new g(f.decode(e.offset),y.decode(e.message))}}class _{convert(e){return P(e,g),{...V.convert(e),offset:f.encode(e.offset),message:y.encode(e.message)}}}class ee extends C{encoder=new _;decoder=new $}const j=new ee;I(M,j);const x="IncorrectBase64PaddingError";class z extends B{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return x}}class re{convert(e){return v(e,"code","message"),m(e,x),new z(y.decode(e.message))}}class te extends Q{}class ne extends C{encoder=new te;decoder=new re}const se=new ne;I(x,se);const L="InvalidBase64AlphabetLengthError";class D extends B{length;constructor(e,r=`alphabet needs to be 64 characters, received ${e}`){super(r),this.length=e,Object.freeze(this)}toJSON(){return J.encode(this)}get code(){return L}}class oe{convert(e){return v(e,"code","length","message"),m(e,L),new D(f.decode(e.length),y.decode(e.message))}}class ce{convert(e){return P(e,D),{...V.convert(e),length:f.encode(e.length)}}}class ae extends C{encoder=new ce;decoder=new oe}const J=new ae;I(L,J);class de{convert(e){const r=new ArrayBuffer(e.byteLength);return new Uint8Array(r).set(e),r}}class ie{convert(e){return new Uint8Array(e)}}class he extends C{encoder=new de;decoder=new ie}const le=new he,we=new TextEncoder;function R(t){return we.encode(t)}const ge=new TextDecoder;function fe(t){return ge.decode(t)}function*ue(t){yield*R(t)}function*Ue(){for(let t=0;t<256;t++)yield 255}const u=-1,Ce=61;class U{encodeMap;decodeMap;padChar;strict;constructor(e,r,o=Ce,d=!1){this.encodeMap=e,this.decodeMap=r,this.padChar=o,this.strict=d}static withAlphabet(e){const r=e.length;if(r!==64)throw new D(r);const o=Array.from(ue(e)),d=Array.from(Ue());for(let i=0;i<r;i++)d[o[i]]=i;return new U(o,d)}withPadding(e){return new U(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let r=0,o=0;const d=Math.floor(e.byteLength/3)*3,i=Math.ceil(e.byteLength/3)*4,l=new ArrayBuffer(i),s=new DataView(e),c=new DataView(l);for(;o<d;){const w=s.getUint8(o+0)<<16|s.getUint8(o+1)<<8|s.getUint8(o+2);c.setUint8(r+0,this.encodeMap[w>>18&63]),c.setUint8(r+1,this.encodeMap[w>>12&63]),c.setUint8(r+2,this.encodeMap[w>>6&63]),c.setUint8(r+3,this.encodeMap[w&63]),o+=3,r+=4}const n=e.byteLength-o;if(n===0)return l;let h=s.getUint8(o+0)<<16;switch(n===2&&(h|=s.getUint8(o+1)<<8),c.setUint8(r+0,this.encodeMap[h>>18&63]),c.setUint8(r+1,this.encodeMap[h>>12&63]),n){case 2:return c.setUint8(r+2,this.encodeMap[h>>6&63]),this.padChar!==u?(c.setUint8(r+3,this.padChar),l.slice(0,r+4)):l.slice(0,r+3);case 1:if(this.padChar!==u)return c.setUint8(r+2,this.padChar),c.setUint8(r+3,this.padChar),l.slice(0,r+4);break}return l.slice(0,r+2)}decode(e){const r=e.byteLength;if(r===0)return new ArrayBuffer(0);const o=new DataView(e),d=new ArrayBuffer(Math.floor(r/4*3)),i=new DataView(d),l=new ArrayBuffer(4),s=new DataView(l);let c=0,n=0,h=0,w=!1;for(;n<r&&!w;){let E=3,p=4;for(let a=0;a<4;a++){if(n===r){if(a===0)return d;if(a===1||this.padChar!==u)throw new g(n-a);E=a-1,p=a,w=!0;break}const b=o.getUint8(n);n++;const T=this.decodeMap[b];if(T!==255){s.setUint8(a,T);continue}if(b===10||b===13){a--;continue}if(b===this.padChar){switch(a){case 0:case 1:throw new z;case 2:for(;n<r&&(o.getUint8(n)===10||o.getUint8(n)===13);)n++;if(n===r)throw new g(r);n++}for(;n<r&&(o.getUint8(n)===10||o.getUint8(n)===13);)n++;if(n<r)throw new g(n);E=3,p=a,w=!0;break}throw new g(n-1)}const A=s.getUint8(0)<<18|s.getUint8(1)<<12|s.getUint8(2)<<6|s.getUint8(3);switch(s.setUint8(2,A>>0&255),s.setUint8(1,A>>8&255),s.setUint8(0,A>>16&255),p){case 4:i.setUint8(h+2,s.getUint8(2)),s.setUint8(2,0);case 3:if(i.setUint8(h+1,s.getUint8(1)),this.strict&&s.getUint8(2)!==0)throw new g(n-1);case 2:if(i.setUint8(h+0,s.getUint8(0)),this.strict&&(s.getUint8(1)!==0||s.getUint8(2)!==0))throw new g(n-2)}h+=E,c+=p-1}return d.slice(0,c)}decodeString(e){return this.decode(le.encode(R(e)))}encodeToString(e){return fe(this.encode(e))}}const pe=U.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ve=pe.withPadding(u),be=U.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),me=be.withPadding(u);export{ve as a,be as b,ue as c,Ae as d,Be as e,f as n,me as r,pe as s,le as u};
