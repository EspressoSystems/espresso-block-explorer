import{j as e}from"./jsx-runtime-BlAj40OV.js";import{D}from"./LoadingProvider-DpAvs9pm.js";import{N as G}from"./NumberText-C4Z_0tU7.js";import{l as I}from"./typography-D2UEeKZ7.js";import{R as x}from"./index-Cs7sjTYM.js";import{T as Y}from"./Text-BU7JBOLk.js";import{S as w}from"./SVGPathBuilder-XZx_HA2Y.js";import{u as $,S,a as A,b as B,c as R,d as z,e as E,f as k}from"./SVGToolTip-PiyluX_7.js";const U=I("text"),W=14,re=x.createContext(()=>e.jsx(e.Fragment,{})),f=x.createContext(null),_=r=>{const a=r.values,[l,o]=$();if(!a)return e.jsx(e.Fragment,{});if(a.length<=0)return e.jsx(e.Fragment,{});const m=o??{x:0,y:0,width:100,height:100},{x:g,y:v,width:c,height:h}=m,t=Math.min(c,h)/2;if(a.length===1)return e.jsx("svg",{ref:l,viewBox:`${g} ${v} ${c} ${h}`,role:"graphics-datachart","aria-roledescription":"pie chart",children:e.jsx(S.Provider,{value:Number(c),children:e.jsxs(A.Provider,{value:Number(h),children:[e.jsx("g",{className:"pie-chart-sections",role:"graphics-datagroup",children:e.jsx("circle",{cx:t,cy:t,r:t,"data-label":a[0].label,role:"graphics-datascale","aria-valuemax":1})}),e.jsx("g",{className:"pie-chart-tooltip-hitboxes",children:e.jsx(f.Provider,{value:{startX:t,startY:t,endX:t,endY:t,label:a[0].label,value:a[0].value,startAngle:0,endAngle:2*Math.PI,endPercentage:1},children:e.jsxs("g",{className:"pie-chart-tooltip-hitbox",children:[e.jsx("circle",{className:"pie-chart-section-hitbox",cx:t,cy:t,r:t,"data-label":a[0].label}),e.jsx(V,{})]})})})]})})});const y=a.reduce((n,s)=>n+s.value,0),M=a.reduce((n,s)=>{const i=(n[n.length-1]??0)+s.value/y;return n.push(i),n},[]),X=a.map((n,s)=>{const d=M[s]??0,i=(M[s-1]??0)*2*Math.PI,p=d*2*Math.PI,P=t+Math.cos(i)*t,j=t+Math.sin(i)*t,b=t+Math.cos(p)*t,T=t+Math.sin(p)*t;return{startX:P,startY:j,endX:b,endY:T,startAngle:i,endAngle:p,endPercentage:d,label:n.label,value:n.value}});return e.jsx("svg",{ref:l,viewBox:`${g} ${v} ${c} ${h}`,role:"graphics-datachart","aria-roledescription":"pie chart",children:e.jsx(S.Provider,{value:Number(c),children:e.jsxs(A.Provider,{value:Number(h),children:[e.jsx("g",{className:"pie-chart-sections",role:"graphics-datagroup",children:X.map((n,s)=>{const{startX:d,startY:i,endX:p,endY:P,label:j,value:b,startAngle:T,endAngle:N}=n,u=N-T>Math.PI?1:0,C=new w;return C.moveTo(t,t),C.lineTo(d,i),C.arcTo(t,t,0,u,1,p,P),C.close(),e.jsx("path",{d:C.instructionToString(),"data-label":j,role:"graphics-datascale","aria-valuemax":b/y},s)})}),e.jsx("g",{className:"pie-chart-tooltip-hitboxes",children:X.map((n,s)=>{const{startX:d,startY:i,endX:p,endY:P,label:j,endAngle:b,startAngle:T}=n,N=b-T>Math.PI?1:0,u=new w;return u.moveTo(t,t),u.lineTo(d,i),u.arcTo(t,t,0,N,1,p,P),u.close(),e.jsx(f.Provider,{value:n,children:e.jsxs("g",{className:"pie-chart-tooltip-hitbox",children:[e.jsx("path",{className:"pie-chart-section-hitbox",d:u.instructionToString(),"data-label":j},s),e.jsx(V,{})]})},s)})})]})})})};function q(r,a,l,o){const m=r*.5,g=a*.5;if(o.endAngle>=2*Math.PI&&o.startAngle<=0)return[m,g];const v=(o.endAngle+o.startAngle)/2,c=m+Math.cos(v)*l,h=g+Math.sin(v)*l;return[c,h]}const H=2/3,V=()=>{const r=x.useContext(A),a=x.useContext(S),l=x.useContext(f);if(!l)return e.jsx(e.Fragment,{});const[o,m]=q(a,r,Math.min(a,r)*.5*H,l);return e.jsx(B.Provider,{value:L,children:e.jsx(R.Provider,{value:Number(o),children:e.jsx(z.Provider,{value:Number(m),children:e.jsx(E.Provider,{value:o/a,children:e.jsx(k,{})})})})})},L=()=>{const r=x.useContext(f);return r?e.jsxs(U,{x:0,y:W,textAnchor:"center",children:[e.jsx(Y,{text:r.label}),e.jsx(Y,{text:" "}),e.jsx(G,{number:r.value})]}):e.jsx(e.Fragment,{})},F=()=>{const r=x.useContext(D);return e.jsx(_,{values:r})};try{_.displayName="PieChart",_.__docgenInfo={description:"PieChart is a component that takes the given data and creates a pie chart",displayName:"PieChart",props:{values:{defaultValue:null,description:"",name:"values",required:!0,type:{name:"PieChartEntry[]"}}}}}catch{}try{F.displayName="PieChartFromData",F.__docgenInfo={description:"PieChartFromData is a convenience component that uses the DataContext,\ninterpreted as a list of entries of type `PieChartEntry`, to render a\nPieChart.",displayName:"PieChartFromData",props:{}}}catch{}export{F as P,_ as a,re as b};
