import{o as u,p as y,s as w,q as k,r as b,t as L,u as O,v as R,w as x,x as E,H as h,y as M}from"./en_US-KAK2ZBDO-DGANWWhU.js";import"./iframe-DIKNrIIb.js";import"./preload-helper-PPVm8Dsz.js";import"./higher_order-CERhs-Yx.js";import"./environment_banner-CTDpxXvK.js";import"./typography-C-u2xTwd.js";import"./text-CEhLEmI-.js";import"./index-B1u9hlBx.js";import"./index-C8ROo_QO.js";import"./loading_provider-Dn9ytlaz.js";import"./missing_element_error-Bky0HlCJ.js";import"./string-DO2hqbbz.js";import"./assert-B20_bgky.js";import"./unimplemented_error-BGJ4_cDZ.js";import"./async_iterable_resolver-B2HzFsrP.js";import"./provide_async_states-BI-8x1rH.js";import"./transaction_detail_loader-CPL1cunz.js";import"./tagged_base64-DlPC3yRR.js";import"./base64-Dpbg5EzT.js";import"./promise_resolver-BBokiobc.js";import"./path_resolver_provider-D_k7zmI5.js";import"./block_summary-CBGYsBbN.js";import"./data_table-D7kIY5bn.js";import"./chevron_up-BShDt5bd.js";import"./svg_icon_base-CJsibPKU.js";import"./labeled_anchor_button-DvI8IUHk.js";import"./anchor_button-CVIibbZU.js";import"./date_time_formatters_provider-DhcWWpu8.js";import"./locale_provider-DYOAFLcG.js";import"./page_path_provider-B1N-ENWh.js";import"./now_provider-DNU3NT7E.js";import"./number_formatters_provider-CoB2HbbC.js";import"./transaction_summary-_-RUzodv.js";import"./cappuccino_hot_shot_query_service_api_context-r0klQ_HY.js";import"./explorer-CHE_VWBP.js";import"./blocks-D62ayDG_.js";import"./monetary_value-CGCIrnLJ.js";import"./bigint-Rw5otYDY.js";import"./data-QnfQTY7I.js";import"./nodes-BtP9A9m5.js";import"./functional-DLuq-Zgx.js";import"./array_buffer-DYdk84gS.js";import"./url-BkzmLfUb.js";import"./fetch_error-DuIs0boE.js";import"./not_found_error-bihNLxJz.js";import"./validator-DiMZuNkp.js";import"./wallet_address-cs0DJHAB.js";class q extends u{constructor({callbackSelector:a,cause:t,data:s,extraData:i,sender:n,urls:r}){super(t.shortMessage||"An error occurred while fetching for an offchain result.",{cause:t,metaMessages:[...t.metaMessages||[],t.metaMessages?.length?"":[],"Offchain Gateway Call:",r&&["  Gateway URL(s):",...r.map(p=>`    ${y(p)}`)],`  Sender: ${n}`,`  Data: ${s}`,`  Callback selector: ${a}`,`  Extra data: ${i}`].flat(),name:"OffchainLookupError"})}}class S extends u{constructor({result:a,url:t}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${y(t)}`,`Response: ${w(a)}`],name:"OffchainLookupResponseMalformedError"})}}class $ extends u{constructor({sender:a,to:t}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${t}`,`OffchainLookup sender address: ${a}`],name:"OffchainLookupSenderMismatchError"})}}const Et="0x556f1830",T={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function Mt(c,{blockNumber:a,blockTag:t,data:s,to:i}){const{args:n}=k({data:s,abi:[T]}),[r,p,m,e,o]=n,{ccipRead:d}=c,f=d&&typeof d?.request=="function"?d.request:C;try{if(!b(i,r))throw new $({sender:r,to:i});const l=p.includes(L)?await O({data:m,ccipRequest:f}):await f({data:m,sender:r,urls:p}),{data:g}=await R(c,{blockNumber:a,blockTag:t,data:x([e,E([{type:"bytes"},{type:"bytes"}],[l,o])]),to:i});return g}catch(l){throw new q({callbackSelector:e,cause:l,data:s,extraData:o,sender:r,urls:p})}}async function C({data:c,sender:a,urls:t}){let s=new Error("An unknown error occurred.");for(let i=0;i<t.length;i++){const n=t[i],r=n.includes("{data}")?"GET":"POST",p=r==="POST"?{data:c,sender:a}:void 0,m=r==="POST"?{"Content-Type":"application/json"}:{};try{const e=await fetch(n.replace("{sender}",a.toLowerCase()).replace("{data}",c),{body:JSON.stringify(p),headers:m,method:r});let o;if(e.headers.get("Content-Type")?.startsWith("application/json")?o=(await e.json()).data:o=await e.text(),!e.ok){s=new h({body:p,details:o?.error?w(o.error):e.statusText,headers:e.headers,status:e.status,url:n});continue}if(!M(o)){s=new S({result:o,url:n});continue}return o}catch(e){s=new h({body:p,details:e.message,url:n})}}throw s}export{C as ccipRequest,Mt as offchainLookup,T as offchainLookupAbiItem,Et as offchainLookupSignature};
