var bf=Object.defineProperty;var Bf=(re,q,me)=>q in re?bf(re,q,{enumerable:!0,configurable:!0,writable:!0,value:me}):re[q]=me;var n=(re,q,me)=>Bf(re,typeof q!="symbol"?q+"":q,me);(function(){"use strict";class re{assert(){}}function q(){return new re}const me=q();function I(t,e){me.assert(t,e)}function Hn(t,e){I(typeof t===e,`type assertion failed: expected "${e}", received "${typeof t}"`)}function ac(t){I(t!==null,"expected a non-null value, received null")}function f(t,e){I(t instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof t=="object"&&t!==null?t.constructor.name:typeof t}"`)}class Tt extends Error{constructor(o,r,s=`expected object with key: "${r}", instead found ${o}`){super(s);n(this,"key");n(this,"haveType");this.haveType=o,this.key=r,Object.freeze(this)}toJSON(){return{code:Tt.name,message:this.message,have:this.haveType,key:this.key}}}class se{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class c extends se{}function Mt(t){return typeof t=="number"}function Y(t){return typeof t=="string"}function Vn(t){return typeof t=="object"&&t!==null}function Qe(t){return t!==void 0}function ic(t,e){return Array.isArray(t)&&t.every(e)}function dc(t){return e=>ic(e,t)}function Ht(t,e,o){return Vn(t)&&e in t&&o(t[e])}function M(t,...e){return Vn(t)&&e.every(o=>o in t)}function i(t,...e){if(typeof t!="object")throw new Error("expected object");if(t===null)throw new Error("received null");for(const o of e)if(!(o in t))throw new Tt("object",o)}function g(t,e){if(!Y(t.code))throw new Error("code must be a string");if(t.code!==e)throw new Error(`expected code to be ${e}, got ${t.code}`)}function ce(t,e){if(!Y(t.type))throw new Error("type must be a string");if(t.type!==e)throw new Error(`expected type to be ${e}, got ${t.type}`)}class y extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return J.convert(this)}}class L{convert(e){return f(e,y),{code:e.code,message:e.message}}}const J=new L,lc="NoCodecFoundError";class ve extends Error{constructor(o,r=`no codec found for: "${o}"`){super(r);n(this,"codec");this.codec=o,Object.freeze(this);debugger}toJSON(){return{code:u.encode(ve.name),message:u.encode(this.message),codec:u.encode(this.codec)}}get code(){return lc}}const Vt=new Map;class uc{convert(e){i(e,"code");const o=u.decode(e.code),r=Vt.get(o);if(!r)throw new ve(o);return r.decode(e)}}class hc{convert(e){const o=Vt.get(e.code);if(!o)throw new ve(e.code);return o.encode(e)}}class wc extends se{constructor(){super(...arguments);n(this,"encoder",new hc);n(this,"decoder",new uc)}}const ze=new wc;function C(t,e){Vt.set(t,e)}const Ut="InvalidTypeError";class A extends y{constructor(o,r,s=`invalid type: have "${o}", want "${r}"`){super(s);n(this,"have");n(this,"want");this.have=o,this.want=r,Object.freeze(this)}toJSON(){return Un.encode(this)}get code(){return Ut}}class fc{convert(e){return i(e,"code","have","want","message"),g(e,Ut),new A(u.decode(e.have),u.decode(e.want),u.decode(e.message))}}class pc{convert(e){return f(e,A),{...J.convert(e),have:u.encode(e.have),want:u.encode(e.want)}}}class mc extends c{constructor(){super(...arguments);n(this,"encoder",new pc);n(this,"decoder",new fc)}}const Un=new mc;C(Ut,Un);const Fn=dc(Qe);class Ac{convert(e){return e}}const Jn=new Ac;class gc extends se{constructor(){super(...arguments);n(this,"encoder",Jn);n(this,"decoder",Jn)}}const qe=new gc;class S{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){if(!Fn(e)){const o=typeof e=="object"&&e!==null?e.constructor.name:typeof e,r="array";throw new Error(`invalid array value: have "${o}", want "${r}"`)}return e.map(o=>this.itemCodec.decode(o))}}class v{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return f(e,Array),e.map(o=>this.itemCodec.encode(o))}}class E extends c{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=r,this.decoder=o}}class X{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class K{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:(ac(e),this.itemCodec.encode(e))}}class Z extends c{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=r,this.decoder=o}}class Cc{convert(e){if(!Y(e))throw new A(typeof e,"string");return e}}class yc{convert(e){return Hn(e,"string"),e}}class bc extends c{constructor(){super(...arguments);n(this,"encoder",new yc);n(this,"decoder",new Cc)}}const u=new bc;new E(new S(u),new v(u));const H=new Z(new X(u),new K(u));function Ae(t){return!t||!t.trim()?null:t}class Ft extends y{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return Gn}}const Gn="CompleterAlreadyCompletedError";class Bc{convert(e){return i(e,"code","message"),g(e,Gn),new Ft(u.decode(e.message))}}class Sc extends L{}class vc extends c{constructor(){super(...arguments);n(this,"encoder",new Sc);n(this,"decoder",new Bc)}}const Ec=new vc;C(Ft.name,Ec);function _e(){return I(!1,"completer is not ready, this should never be reached")}function je(){throw new Ft}class xc{constructor(){n(this,"resolve",_e);n(this,"reject",_e);n(this,"completed",!1);n(this,"promise");this.promise=new Promise((e,o)=>{this.resolve=e,this.reject=o}),I(this.resolve!==_e,"resolve should be set"),I(this.reject!==_e,"resolve should be set")}get isCompleted(){return this.completed}complete(e){const o=this.resolve,r=this.reject;if(this.completed=!0,this.resolve=je,this.reject=je,e instanceof Promise){e.then(o,r);return}o(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=je,this.reject=je}}function $e(){return new xc}class Ee extends y{constructor(o,r,s){super(s);n(this,"response");n(this,"status");this.status=o,this.response=r}toJSON(){return Wn.convert(this)}}class Ye{convert(e){return f(e,Ee),{...J.convert(e),status:e.status}}}const Wn=new Ye,Jt="BadResponseClientError";class kc extends Ee{constructor(e,o,r="bad server response: client error"){super(e,o,r),Object.freeze(this)}get code(){return Jt}toJSON(){return Qn.encode(this)}}class Nc{convert(e){return i(e,"code","message","status"),g(e,Jt),new kc(Number(e.status),null,u.decode(e.message))}}class Ic extends Ye{}class Rc extends c{constructor(){super(...arguments);n(this,"encoder",new Ic);n(this,"decoder",new Nc)}}const Qn=new Rc;C(Jt,Qn);const Gt="BadResponseError";class Dc extends Ee{constructor(e,o,r="bad server response"){super(e,o,r),Object.freeze(this)}get code(){return Gt}toJSON(){return zn.encode(this)}}class Pc{convert(e){return i(e,"code","message","status"),g(e,Gt),new Dc(Number(e.status),null,u.decode(e.message))}}class Oc extends Ye{}class Lc extends c{constructor(){super(...arguments);n(this,"encoder",new Oc);n(this,"decoder",new Pc)}}const zn=new Lc;C(Gt,zn);class Tc extends Ee{constructor(e,o,r="bad server response: server error"){super(e,o,r),Object.freeze(this)}get code(){return Wt}}const Wt="BadResponseServerError";class Mc{convert(e){return i(e,"code","message","status"),g(e,Wt),new Tc(Number(e.status),null,u.decode(e.message))}}class Hc extends Ye{}class Vc extends c{constructor(){super(...arguments);n(this,"encoder",new Hc);n(this,"decoder",new Mc)}}const Uc=new Vc;C(Wt,Uc);const Qt="ChannelClosedError";class xe extends y{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return Qt}}class Fc{convert(e){return i(e,"code","message"),g(e,Qt),new xe(u.decode(e.message))}}class Jc extends L{}class Gc extends c{constructor(){super(...arguments);n(this,"encoder",new Jc);n(this,"decoder",new Fc)}}const Wc=new Gc;C(Qt,Wc);const zt="FetchError";class Qc extends y{constructor(o,r=`fetch failed: ${String(o)}`){super(r);n(this,"cause");this.cause=o,Object.freeze(this)}get code(){return zt}}class zc{convert(e){return i(e,"code","message"),g(e,zt),new Qc({},u.decode(e.message))}}class qc extends L{}class _c extends c{constructor(){super(...arguments);n(this,"encoder",new qc);n(this,"decoder",new zc)}}const jc=new _c;C(zt,jc);const qt="IncorrectBase64PaddingError";class qn extends y{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return qt}}class $c{convert(e){return i(e,"code","message"),g(e,qt),new qn(u.decode(e.message))}}class Yc extends L{}class Xc extends c{constructor(){super(...arguments);n(this,"encoder",new Yc);n(this,"decoder",new $c)}}const Kc=new Xc;C(qt,Kc);class Zc{convert(e){if(!Mt(e))throw new A(typeof e,"number");return e}}class ea{convert(e){return Hn(e,"number"),e}}class ta extends c{constructor(){super(...arguments);n(this,"encoder",new ea);n(this,"decoder",new Zc)}}const h=new ta,R=new E(new S(h),new v(h)),_t="InvalidBase64AlphabetLengthError";class jt extends y{constructor(o,r=`alphabet needs to be 64 characters, received ${o}`){super(r);n(this,"length");this.length=o,Object.freeze(this)}toJSON(){return _n.encode(this)}get code(){return _t}}class oa{convert(e){return i(e,"code","length","message"),g(e,_t),new jt(h.decode(e.length),u.decode(e.message))}}class na{convert(e){return f(e,jt),{...J.convert(e),length:h.encode(e.length)}}}class ra extends c{constructor(){super(...arguments);n(this,"encoder",new na);n(this,"decoder",new oa)}}const _n=new ra;C(_t,_n);const $t="InvalidHexStringError";class Yt extends y{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return $t}}class sa{convert(e){return i(e,"code","message"),g(e,$t),new Yt(u.decode(e.message))}}class ca extends L{}class aa extends c{constructor(){super(...arguments);n(this,"encoder",new ca);n(this,"decoder",new sa)}}const ia=new aa;C($t,ia);const Xt="InvalidHexValueError";class jn extends y{constructor(o,r=`invalid hex value "${o}"`){super(r);n(this,"value");this.value=o,Object.freeze(this)}toJSON(){return $n.encode(this)}get code(){return Xt}}class da{convert(e){return i(e,"code","value","message"),g(e,Xt),new jn(h.decode(e.value),u.decode(e.message))}}class la{convert(e){return{...J.convert(e),value:h.encode(e.value)}}}class ua extends c{constructor(){super(...arguments);n(this,"encoder",new la);n(this,"decoder",new da)}}const $n=new ua;C(Xt,$n);const Kt="InvalidInputError";class ee extends y{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return Kt}}class ha{convert(e){return i(e,"code","message"),g(e,Kt),new ee(u.decode(e.message))}}class wa extends L{}class fa extends c{constructor(){super(...arguments);n(this,"encoder",new wa);n(this,"decoder",new ha)}}const pa=new fa;C(Kt,pa);const Zt="InvalidStringValueError";class Yn extends y{constructor(o,r,s=`invalid string value: have "${o}", want "${r}"`){super(s);n(this,"have");n(this,"want");this.have=o,this.want=r,Object.freeze(this)}toJSON(){return Xn.encode(this)}get code(){return Zt}}class ma{convert(e){return i(e,"code","have","want","message"),g(e,Zt),new Yn(u.decode(e.have),u.decode(e.want),u.decode(e.message))}}class Aa{convert(e){return f(e,Yn),{...J.convert(e),have:u.encode(e.have),want:u.encode(e.want)}}}class ga extends c{constructor(){super(...arguments);n(this,"encoder",new Aa);n(this,"decoder",new ma)}}const Xn=new ga;C(Zt,Xn);const eo="InvalidTaggedBase64EncodingError";class Kn extends y{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return Zn.encode(this)}get code(){return eo}}class Ca{convert(e){return i(e,"code","message"),g(e,eo),new Kn(u.decode(e.message))}}class ya extends L{}class ba extends c{constructor(){super(...arguments);n(this,"encoder",new ya);n(this,"decoder",new Ca)}}const Zn=new ba;C(eo,Zn);const to="MissingElementError";class Xe extends y{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return to}}class Ba{convert(e){return i(e,"code","message"),g(e,to),new Xe(u.decode(e.message))}}class Sa extends L{}class va extends c{constructor(){super(...arguments);n(this,"encoder",new Sa);n(this,"decoder",new Ba)}}const Ea=new va;C(to,Ea);const oo="NoCompleterFoundForRequestID";class er extends y{constructor(o,r=`no completer found for request id "${o}"`){super(r);n(this,"requestID");this.requestID=o,Object.freeze(this)}toJSON(){return tr.encode(this)}get code(){return oo}}class xa{convert(e){return i(e,"code","requestID","message"),g(e,oo),new er(qe.decode(e.requestID),u.decode(e.message))}}class ka{convert(e){return f(e,er),{...J.convert(e),requestID:qe.encode(e.requestID)}}}class Na extends c{constructor(){super(...arguments);n(this,"encoder",new ka);n(this,"decoder",new xa)}}const tr=new Na;C(oo,tr);const no="NotFoundError";class Ia extends y{constructor(o,r=`Not Found: ${o}`){super(r);n(this,"key");this.key=o,Object.freeze(this)}get code(){return no}}class or{constructor(e){n(this,"codec");this.codec=e}convert(e){return i(e,"code","key"),g(e,no),new Ia(this.codec.decode(e.key))}}class nr{constructor(e){n(this,"codec");this.codec=e}convert(e){return{...J.convert(e),key:this.codec.encode(e.key)}}}class rr extends c{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=o,this.decoder=r}}new rr(new nr(u),new or(u));const Ra=new rr(new nr(qe),new or(qe));C(no,Ra);const ro="NoURLProvidedError";class Da extends y{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return ro}}class Pa{convert(e){return i(e,"code","message"),g(e,ro),new Da(u.decode(e.message))}}class Oa extends L{}class La extends c{constructor(){super(...arguments);n(this,"encoder",new Oa);n(this,"decoder",new Pa)}}const Ta=new La;C(ro,Ta);const so="UnimplementedError";class V extends y{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return so}}class Ma{convert(e){return i(e,"code","message"),g(e,so),new V(u.decode(e.message))}}class Ha extends L{}class Va extends c{constructor(){super(...arguments);n(this,"encoder",new Ha);n(this,"decoder",new Ma)}}const Ua=new Va;C(so,Ua);const co="QUERY_ERROR";class Fa extends y{constructor(o,r="missing element"){super(r);n(this,"error");this.error=o,Object.freeze(this)}get code(){return co}}class Ja{convert(e){return i(e,"code","error","message"),g(e,co),new Fa(ir.decode(e.error),u.decode(e.message))}}class Ga{convert(e){return{code:e.code,error:ir.encode(e.error),message:u.encode(e.message)}}}class Wa extends c{constructor(){super(...arguments);n(this,"encoder",new Ga);n(this,"decoder",new Ja)}}const Qa=new Wa;class ao{}const io="NotFound";class sr extends ao{constructor(){super(),Object.freeze(this)}valueOf(){return io}toJSON(){return this.valueOf()}}const za=new sr,lo="Missing";class cr extends ao{constructor(){super(),Object.freeze(this)}valueOf(){return lo}toJSON(){return this.valueOf()}}const qa=new cr;class ar extends ao{constructor(o){super();n(this,"error");this.error=o,Object.freeze(this)}toJSON(){return ho.encode(this)}}class _a{constructor(e){n(this,"message");this.message=e,Object.freeze(this)}toJSON(){return uo.encode(this)}}class ja{convert(e){return i(e,"message"),new _a(u.decode(e.message))}}class $a{convert(e){return{message:u.encode(e.message)}}}class Ya extends c{constructor(){super(...arguments);n(this,"encoder",new $a);n(this,"decoder",new ja)}}const uo=new Ya;class Xa{convert(e){return i(e,"Error"),new ar(uo.decode(e.Error))}}class Ka{convert(e){return{Error:uo.encode(e.error)}}}class Za extends c{constructor(){super(...arguments);n(this,"encoder",new Ka);n(this,"decoder",new Xa)}}const ho=new Za;class ei{convert(e){return e===io?za:e===lo?qa:ho.decode(e)}}class ti{convert(e){if(e instanceof sr)return io;if(e instanceof cr)return lo;if(e instanceof ar)return ho.encode(e);throw new V}}class oi extends c{constructor(){super(...arguments);n(this,"encoder",new ti);n(this,"decoder",new ei)}}const ir=new oi;C(co,Qa);const dr="ResponseContentTypeIsNotApplicationJSONError";class Ke extends Ee{constructor(o,r,s,a="response content type is not application/json"){super(r,s,a);n(this,"haveHeaderType");this.haveHeaderType=o,Object.freeze(this)}static fromResponse(o,r){return new Ke(o.headers.get("content-type")??"undefined",o.status,o,r)}toJSON(){return lr.encode(this)}get code(){return dr}}class ni{convert(e){return i(e,"code","status","have","want","message"),g(e,dr),new Ke(u.decode(e.code),h.decode(e.status),null,u.decode(e.message))}}class ri{convert(e){return{...Wn.convert(e),have:u.encode(e.haveHeaderType),want:u.encode("application/json")}}}class si extends c{constructor(){super(...arguments);n(this,"encoder",new ri);n(this,"decoder",new ni)}}const lr=new si;C(Ke.name,lr);const wo="WebWorkerErrorResponse";class ci extends y{constructor(o,r="error in web worker"){super(r);n(this,"error");this.error=o,Object.freeze(this)}toJSON(){return ur.encode(this)}get code(){return wo}}class ai{convert(e){return i(e,"code","error","message"),g(e,wo),new ci(ze.decode(e.error),u.decode(e.message))}}class ii{convert(e){return{...J.convert(e),error:ze.encode(e.error)}}}class di extends c{constructor(){super(...arguments);n(this,"encoder",new ii);n(this,"decoder",new ai)}}const ur=new di;C(wo,ur);var fo=(t=>(t[t.success=0]="success",t[t.full=1]="full",t[t.failed=2]="failed",t))(fo||{});class li{getFromEmpty(){}}class ui{getFromEmpty(){return null}}class hi{getFromEmpty(){throw new Xe}}const hr={returnNull:new ui,returnUndefined:new li,throwMissingElement:new hi};class wi{constructor(e){n(this,"maxSize");I(!Number.isNaN(e),"maxSize must not be NaN"),I(Number.isInteger(e),"maxSize must be an integer"),I(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return I(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class fi{constructor(e){n(this,"preComputedSizeMinus1");I(!Number.isNaN(e),"maxSize must not be NaN"),I(Number.isInteger(e),"maxSize must be an integer"),I(e>0,"maxSize must be greater than 0"),I(wr(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return I(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function wr(t){return(t&t-1)===0}const po="BufferFullError";class fr extends y{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return po}}class pi{convert(e){return i(e,"code","message"),g(e,po),new fr(u.decode(e.message))}}class mi extends L{}class Ai extends c{constructor(){super(...arguments);n(this,"encoder",new mi);n(this,"decoder",new pi)}}const gi=new Ai;C(po,gi);class Ci{putToFull(e,o){return e.get(),e.put(o)}}class yi{putToFull(){return fo.full}}class bi{putToFull(){throw new fr}}const pr={overwriteOldest:new Ci,returnFull:new yi,throw:new bi};function Bi(t){return wr(t)?new fi(t):new wi(t)}class Si{constructor(e,o,r){n(this,"readIndex",0);n(this,"writeIndex",0);n(this,"buffer");n(this,"nextIndex");n(this,"getOnEmpty");n(this,"putOnFull");I(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=Bi(e),this.getOnEmpty=o,this.putOnFull=r}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const o=this.nextIndex.nextIndex(this.writeIndex);return o===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=o,fo.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new vi(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new Ei(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class vi{constructor(e){n(this,"buffer");this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class Ei{constructor(e,o,r,s){n(this,"readIndex");n(this,"writeIndex");n(this,"buffer");n(this,"nextIndex");this.readIndex=e,this.writeIndex=o,this.buffer=r,this.nextIndex=s}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function ae(t=32,e=hr.returnUndefined,o=pr.overwriteOldest){return new Si(t,e,o)}class xi{constructor(e){n(this,"publishQueue");n(this,"pollBlocked");n(this,"publishBlocked");n(this,"capacity");n(this,"closed",!1);this.publishQueue=ae(Math.max(2,e),hr.throwMissingElement,pr.throw);const o=$e();this.pollBlocked=o,this.publishBlocked=o,o.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new xe;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new xe;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const o=$e();this.publishBlocked=o,await o.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new xe;if(this.pollBlocked.isCompleted){const o=$e();this.pollBlocked=o}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new ki(this)}}class ki{constructor(e){n(this,"channel");this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof xe)return{done:!0,value:void 0};throw e}}}function ge(t){return new xi(t)}class Ni{constructor(e){n(this,"channel");this.channel=e}async send(e){await this.channel.publish(e)}}function ie(t){return new Ni(t)}class Ii{constructor(e,o){this.sink=e,this.converter=o,this.sink=e,this.converter=o}async send(e){await this.sink.send(this.converter.convert(e))}}function de(t,e){return new Ii(t,e)}async function mr(t){return new Promise(e=>{const o=setTimeout(()=>{clearTimeout(o),e()},t)})}function*Ri(t,e){for(let o=t.next();!o.done;o=t.next())e(o.value)&&(yield o.value)}function mo(t,e){return Ri(t[Symbol.iterator](),e)}function*Ar(t,e){for(let o=t.next();!o.done;o=t.next())yield e(o.value)}function ke(t,e){return Ar(t[Symbol.iterator](),e)}function*Di(t,e){for(let o=0;o<e;o++){const r=t.next();if(r.done)return;yield r.value}}function Pi(t,e){return Di(t[Symbol.iterator](),e)}function gr(t){const e=t.next();if(e.done)throw new Xe;return e.value}function Oi(t){let e;for(let o=t.next();!o.done;o=t.next())e=o.value;if(e===void 0)throw new Xe;return e}function Li(t){return Oi(t[Symbol.iterator]())}function*Ti(t,e){for(let o=t.next();!o.done;o=t.next())yield*e(o.value)}function Cr(t,e){return Ti(t[Symbol.iterator](),e)}function*Mi(){let t=0;for(;;)yield t++}function yr(t){return Pi(Mi(),Math.ceil(t))}function br(t,e,o){const r=o;let s=e;for(let a=r.next();!a.done;a=r.next())s=t(s,a.value);return s}function*Hi(t,e,o){for(let r=t.next(),s=e.next();!r.done&&!s.done;r=t.next(),s=e.next())yield o(r.value,s.value)}function Br(t,e,o){return Hi(t[Symbol.iterator](),e[Symbol.iterator](),o)}class _{constructor(e,o,r){n(this,"significantDigitsMultiplier");this.alpha3Code=e,this.code=o,this.significantDigits=r,this.alpha3Code=e,this.code=o,this.significantDigits=r,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}toJSON(){return Ze.encode(this)}}const Sr=new _("JPY",392,0),Vi=new _("GBP",826,2),vr=new _("USD",840,2),Ui=new _("EUR",978,2),Fi=new _("XXX",999,2),Er=new _("ETH",1001,18),Ao=new _("XBT",1002,8),xr=new _("ESP",10001,18),Ji=[Sr,Vi,vr,Ui,Fi,Er,Ao,xr],Gi=new Map(Ji.map(t=>[t.alpha3Code,t]));class Wi{convert(e){if(typeof e!="string")throw new ee("CurrencyCodeDecoder: expected string");if(e==="BTC")return Ao;const o=Gi.get(e);if(o===void 0)throw new ee(`CurrencyCodeDecoder: unknown currency: "${e}"`);return o}}class Qi{convert(e){return f(e,_),e.alpha3Code}}class zi extends c{constructor(){super(...arguments);n(this,"decoder",new Wi);n(this,"encoder",new Qi)}}const Ze=new zi;class G{constructor(e,o){this.currency=e,this.value=o,this.currency=e,this.value=o}static USD(e){return new G(vr,BigInt(e))}static ETH(e){return new G(Er,BigInt(e))}static ESP(e){return new G(xr,BigInt(e))}static JPY(e){return new G(Sr,BigInt(e))}static BTC(e){return new G(Ao,BigInt(e))}toString(){return et.encode(this)}toJSON(){return et.encode(this)}}function qi(t){return t==="."||t===","||t===" "}function _i(t,e){let o=-1;const r=t.length;for(let s=0;s<r;s++)e(t[s])&&(o=s);return o}class ji{parseCurrencyCode(e){return Ze.decode(e)}parseValue(e,o){let r=1n;o[0]==="-"&&(r=-1n,o=o.substring(1));const s=_i(o,qi);if(s===-1){const w=BigInt(o.replace(/\D/g,""))*e.significantDigitsMultiplier;return r*w}const a=o.substring(0,s).replace(/\D/g,""),d=o.substring(s+1).replace(/\D/g,""),l=BigInt(a)*e.significantDigitsMultiplier,p=BigInt(d)*10n**BigInt(e.significantDigits-d.length);return r*(l+p)}convert(e){if(typeof e!="string")throw new ee("MonetaryValueDecoder: expected string");const o=e.indexOf(" ");if(o<=-1)throw new ee("MonetaryValueDecoder: missing non-breaking space");const r=e.substring(0,o),s=e.substring(o+1);if(/^-?[\d .,]+$/.test(r)){const d=this.parseCurrencyCode(s);return new G(d,this.parseValue(d,r))}const a=this.parseCurrencyCode(r);return new G(a,this.parseValue(a,s))}}class $i{convert(e){f(e,G);const o=e.value<0n?"-":"",r=e.value<0n?-e.value:e.value,s=r%e.currency.significantDigitsMultiplier,a=r/e.currency.significantDigitsMultiplier,d=String(a),l=String(s);return/^0+$/.test(l)?`${Ze.encode(e.currency)} ${o}${d}`:`${Ze.encode(e.currency)} ${o}${a}.${String(s).padStart(e.currency.significantDigits,"0")}`}}class Yi extends c{constructor(){super(...arguments);n(this,"decoder",new ji);n(this,"encoder",new $i)}}const et=new Yi,kr=new E(new S(et),new v(et));class F{constructor(e,o,r,s){n(this,"namespace");n(this,"name");n(this,"site");n(this,"blockExplorer");this.namespace=e,this.name=o,this.site=r,this.blockExplorer=s}}const Xi=new F(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),Ki=new F(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),Zi=new F(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),ed=new F(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),td=new F(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),od=new F(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),nd=new F(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),rd=new F(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),sd=new F(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),cd=new F(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),ad=new F(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),id=new Map([Xi,Ki,Zi,sd,ed,td,od,nd,rd,cd,ad].map(t=>[t.namespace,t])),go="CorruptBase64InputError";class te extends y{constructor(o,r=`corrupt input error at ${o}`){super(r);n(this,"offset");this.offset=o,Object.freeze(this)}get code(){return go}toJSON(){return Nr.encode(this)}}class dd{convert(e){return i(e,"code","offset","message"),g(e,go),new te(h.decode(e.offset),u.decode(e.message))}}class ld{convert(e){return f(e,te),{...J.convert(e),offset:h.encode(e.offset),message:u.encode(e.message)}}}class ud extends c{constructor(){super(...arguments);n(this,"encoder",new ld);n(this,"decoder",new dd)}}const Nr=new ud;C(go,Nr);const hd=new TextEncoder;function Ir(t){return hd.encode(t)}const wd=new TextDecoder;function fd(t){return wd.decode(t)}function*Rr(t){yield*Ir(t)}function*pd(){for(let t=0;t<256;t++)yield 255}const Ne=-1,md=61;class Ie{constructor(e,o,r=md,s=!1){n(this,"encodeMap");n(this,"decodeMap");n(this,"padChar");n(this,"strict");this.encodeMap=e,this.decodeMap=o,this.padChar=r,this.strict=s}static withAlphabet(e){const o=e.length;if(o!==64)throw new jt(o);const r=Array.from(Rr(e)),s=Array.from(pd());for(let a=0;a<o;a++)s[r[a]]=a;return new Ie(r,s)}withPadding(e){return new Ie(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let o=0,r=0;const s=Math.floor(e.byteLength/3)*3,a=Math.ceil(e.byteLength/3)*4,d=new ArrayBuffer(a),l=new DataView(e),p=new DataView(d);for(;r<s;){const U=l.getUint8(r+0)<<16|l.getUint8(r+1)<<8|l.getUint8(r+2);p.setUint8(o+0,this.encodeMap[U>>18&63]),p.setUint8(o+1,this.encodeMap[U>>12&63]),p.setUint8(o+2,this.encodeMap[U>>6&63]),p.setUint8(o+3,this.encodeMap[U&63]),r+=3,o+=4}const w=e.byteLength-r;if(w===0)return d;let N=l.getUint8(r+0)<<16;switch(w===2&&(N|=l.getUint8(r+1)<<8),p.setUint8(o+0,this.encodeMap[N>>18&63]),p.setUint8(o+1,this.encodeMap[N>>12&63]),w){case 2:return p.setUint8(o+2,this.encodeMap[N>>6&63]),this.padChar!==Ne?(p.setUint8(o+3,this.padChar),d.slice(0,o+4)):d.slice(0,o+3);case 1:if(this.padChar!==Ne)return p.setUint8(o+2,this.padChar),p.setUint8(o+3,this.padChar),d.slice(0,o+4);break}return d.slice(0,o+2)}decode(e){const o=e.byteLength;if(o===0)return new ArrayBuffer(0);const r=new DataView(e),s=new ArrayBuffer(Math.floor(o/4*3)),a=new DataView(s),d=new ArrayBuffer(4),l=new DataView(d);let p=0,w=0,N=0,U=!1;for(;w<o&&!U;){let ne=3,$=4;for(let O=0;O<4;O++){if(w===o){if(O===0)return s;if(O===1||this.padChar!==Ne)throw new te(w-O);ne=O-1,$=O,U=!0;break}const z=r.getUint8(w);w++;const cc=this.decodeMap[z];if(cc!==255){l.setUint8(O,cc);continue}if(z===10||z===13){O--;continue}if(z===this.padChar){switch(O){case 0:case 1:throw new qn;case 2:for(;w<o&&(r.getUint8(w)===10||r.getUint8(w)===13);)w++;if(w===o)throw new te(o);w++}for(;w<o&&(r.getUint8(w)===10||r.getUint8(w)===13);)w++;if(w<o)throw new te(w);ne=3,$=O,U=!0;break}throw new te(w-1)}const P=l.getUint8(0)<<18|l.getUint8(1)<<12|l.getUint8(2)<<6|l.getUint8(3);switch(l.setUint8(2,P>>0&255),l.setUint8(1,P>>8&255),l.setUint8(0,P>>16&255),$){case 4:a.setUint8(N+2,l.getUint8(2)),l.setUint8(2,0);case 3:if(a.setUint8(N+1,l.getUint8(1)),this.strict&&l.getUint8(2)!==0)throw new te(w-1);case 2:if(a.setUint8(N+0,l.getUint8(0)),this.strict&&(l.getUint8(1)!==0||l.getUint8(2)!==0))throw new te(w-2)}N+=ne,p+=$-1}return s.slice(0,p)}decodeString(e){return this.decode(Ir(e).buffer)}encodeToString(e){return fd(this.encode(e))}}const Co=Ie.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Ad=Co.withPadding(Ne),Dr=Ie.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),yo=Dr.withPadding(Ne);class j{constructor(e,o){n(this,"tag");n(this,"data");this.tag=e,this.data=o}static fromString(e){const o=e.indexOf("~");if(o<0)throw new Kn;const r=e.substring(0,o),s=yo.decodeString(e.substring(o+1));return new j(r,s)}static inflate(e){return m.decode(e)}toString(){return`${this.tag}~${yo.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class gd{convert(e){if(typeof e!="string")throw new A(typeof e,"string");return j.fromString(e)}}class Cd{convert(e){return f(e,j),e.toString()}}class yd extends c{constructor(){super(...arguments);n(this,"encoder",new Cd);n(this,"decoder",new gd)}}const m=new yd,Pr=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],Or=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],Lr=["Linux","Unix","Windows","MacOS"],Tr=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],tt=2147483648,bd=1103515245,Bd=12345;class le{constructor(e){n(this,"state");this.state=e!==void 0?e:Math.floor(Math.random()*(tt-1))}nextInt(){return this.state=(bd*this.state+Bd)%tt,this.state}nextFloat(){return this.nextInt()/(tt-1)}nextRange(e,o){const r=o-e,s=this.nextInt()/tt;return e+Math.floor(s*r)}fillBytes(e){const o=new ArrayBuffer(e),r=new DataView(o);let s=0;for(;s<e-4;s+=4)r.setUint32(s,this.nextRange(0,4294967295));for(let a=s;a<e;a++)r.setUint8(a,this.nextRange(0,256));return o}}const Sd=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],Mr=[0,0,5,26,28,26,9,6],vd=Mr.reduce((t,e)=>t+e,0),Ed=Mr.reduce((t,e)=>{const o=t[t.length-1]??0;return t.push(o+e),t},[]),xd=Array.from(Br(Ed,Sd,(t,e)=>[t,e])),ot=new Date,nt=new Date(ot.getFullYear(),ot.getMonth(),ot.getDate()).valueOf();function kd(){return nt}async function*Nd(){}function Hr(){const t=new Uint8Array(new Array(20).map(()=>0)).buffer;return{hash:new j("BLOCK",t),height:0,time:new Date(0),genTime:0,transactions:Nd(),numTransactions:0,proposer:[],size:0,fees:[]}}async function*Id(t){let e=1,o=nt;for(;o<ot.valueOf();){const r=Math.floor(t.nextFloat()*14*1e3);yield Vr(new le(e+r),e,o,o+r),o+=r,e++}}async function*Rd(t=new le(nt)){yield Hr(),yield*Id(t)}async function*Dd(t,e,o){let r=e,s=o;for(;;){const a=Math.floor(t.nextFloat()*14*1e3),d=r+a-Date.now();await mr(d),yield Vr(new le(s+a),s,r,r+a),r+=a,s++}}function Vr(t,e,o,r){const s=Math.floor(t.nextRange(0,5)),a=t.nextRange(0,Re.length),d=Re[a];return{hash:new j("BLOCK",t.fillBytes(32)),height:e,genTime:r-o,time:new Date(r),numTransactions:s,transactions:Od(new le(e+o),e,o,r,s),proposer:[d.address],size:Math.floor(t.nextFloat()*1024*s)+8,fees:[G.ESP(BigInt(t.nextRange(0,1e9)*1e3))]}}const Ur=Array.from(id.keys());function Pd(t){return t.nextFloat()>.98?1:Ur[t.nextRange(0,Ur.length)]}async function*Od(t,e,o,r,s){const a=(r-o)/s;for(let d=0,l=o;l<r;l+=a,d++){const p=Pd(t),w=Math.floor(1024*t.nextFloat());yield{block:e,index:d,size:w,hash:new j("COMMIT",t.fillBytes(32)),time:new Date(l),sender:new j("PUBKEY",t.fillBytes(32)),tree:{namespace:p,data:t.fillBytes(w)}}}}function Ld(t){const e=t.nextRange(0,vd),o=mo(xd,([d])=>d<=e),[,r]=Li(o),s=t.nextRange(0,r.length);return r[s]}function Td(t){const e=t.nextRange(0,Tr.length);return Tr[e]}function Md(t){const e=t.nextRange(0,Lr.length);return Lr[e]}function Hd(t){const e=t.nextRange(0,Or.length);return Or[e]}function Vd(t){const e=t.nextRange(0,Pr.length);return Pr[e]}function Ud(t){const[e,o]=Td(t),[,r,s,a]=Ld(t),d=Md(t),l=Hd(t),p=Vd(t);return{pubkey:new j("PUBKEY",t.fillBytes(32)),name:`${e} Node ${a} ${t.nextRange(0,100)}`,address:t.fillBytes(32),company:{name:e,website:o},location:{coords:[r,s],country:a},operatingSystem:d,networkType:p,nodeType:l}}function*Fd(){const t=new le(nt),e=t.nextRange(50,150);for(let o=0;o<e;o++)yield Ud(t)}const Re=Array.from(Fd());class De{constructor(e){this.value=e,this.value=e}valueOf(){return Number(this.value)}toString(){return Number(this.value).toString()}}function bo(t,e){return t.valueOf()<e.valueOf()}function Jd(t,e){return t.valueOf()<=e.valueOf()}function rt(t,e){return t.valueOf()>e.valueOf()}function Fr(t,e){return Jd(t,e)?t:e}function Jr(t,e){return rt(t,e)?t:e}class Bo{constructor(e,o){n(this,"min");n(this,"max");this.min=e,this.max=o}contains(e){return!(bo(e.lat,this.min.lat)||rt(e.lat,this.max.lat)||bo(e.lng,this.min.lng)||rt(e.lng,this.max.lng))}}function Pe(t){const e=t[Symbol.iterator](),o=gr(e),[r,s]=br(([a,d],l)=>[a.min(l.bbox.min),d.max(l.bbox.max)],[o.bbox.min,o.bbox.max],e);return new Bo(r,s)}function Gd(t){const e=t[Symbol.iterator](),o=gr(e),[r,s]=br(([a,d],l)=>[a.min(l),d.max(l)],[o,o],e);return new Bo(r,s)}function Gr(t){if(t.startsWith("0x"))return Gr(t.substring(2));if(t.length&1)throw new Yt;const e=new ArrayBuffer(t.length/2);return Wd(Rr(t),e),e}function Wd(t,e){const o=new DataView(e);let r=0;for(;r<e.byteLength;){const s=t.next(),a=t.next();if(s.done||a.done)throw new Yt;const d=Wr(s.value),l=Wr(a.value),p=d<<4|l;o.setUint8(r,p),r++}}function Wr(t){if(t>=48&&t<=57)return t-48;if(t>=97&&t<=102)return t-97+10;if(t>=65&&t<=70)return t-65+10;throw new jn(t)}function Qd(t){return t.toString(16).padStart(2,"0")}function*zd(t){yield*Ar(t,Qd)}function qd(t){return zd(t[Symbol.iterator]())}class _d{convert(e){if(typeof e!="string")throw new A(typeof e,"string");return Gr(e)}}class jd{convert(e){return f(e,ArrayBuffer),["0x",...qd(new Uint8Array(e))].join("")}}class $d extends c{constructor(){super(...arguments);n(this,"encoder",new jd);n(this,"decoder",new _d)}}const T=new $d;new Z(new X(T),new K(T));const Qr=new E(new S(T),new v(T));class Yd{convert(e){return e instanceof Array?Qr.decode(e):[T.decode(e)]}}class Xd{convert(e){return Qr.encode(e)}}class Kd extends c{constructor(){super(...arguments);n(this,"encoder",new Xd);n(this,"decoder",new Yd)}}const oe=new Kd;class Zd{constructor(e){n(this,"encoding");this.encoding=e}convert(e){if(typeof e!="string")throw new A(typeof e,"string");return this.encoding.decodeString(e)}}class el{constructor(e){n(this,"encoding");this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class st extends c{constructor(o){super();n(this,"encoder");n(this,"decoder");this.encoder=new el(o),this.decoder=new Zd(o)}}new st(yo),new st(Ad);const zr=new st(Dr),qr=new st(Co);class tl{convert(e){if(!Y(e))throw new A(typeof e,"string");const o=new Date(e);if(Number.isNaN(o.valueOf()))throw new A("NaN","number");return o}}class ol{convert(e){return f(e,Date),e.toISOString()}}class nl extends c{constructor(){super(...arguments);n(this,"encoder",new ol);n(this,"decoder",new tl)}}const Ce=new nl;class rl{convert(e){if(!Y(e))throw new A(typeof e,"string");return new URL(e)}}class sl{convert(e){return e.toString()}}class cl extends c{constructor(){super(...arguments);n(this,"encoder",new sl);n(this,"decoder",new rl)}}const _r=new cl,jr=new Z(new X(_r),new K(_r));class ue{}const $r=new Map;function he(t,e){$r.set(t,e)}function Yr(t){const e=$r.get(t);if(!e)throw new ve(t);return e}class al{convert(e){return Yr(e.type).encode(e)}}class il{convert(e){if(i(e,"type","coordinates"),!Y(e.type))throw new A(typeof e.type,"string");return Yr(e.type).decode(e)}}class dl extends c{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new al,this.decoder=new il}}const Xr=new dl,Kr=new E(new S(Xr),new v(Xr)),So="GeometryCollection";class ll extends ue{constructor(o){super();n(this,"type",So);n(this,"geometries");n(this,"bbox");this.geometries=o,this.bbox=Pe(o)}toJSON(){return Zr.encode(this)}}class ul{constructor(e){n(this,"listGeometryCodec");this.listGeometryCodec=e}convert(e){return{type:e.type,geometries:this.listGeometryCodec.encode(e.geometries)}}}class hl{constructor(e){n(this,"listGeometryCodec");this.listGeometryCodec=e}convert(e){return i(e,"type","geometries"),ce(e,So),new ll(this.listGeometryCodec.decode(e.geometries))}}class wl extends c{constructor(){super(...arguments);n(this,"encoder",new ul(Kr));n(this,"decoder",new hl(Kr))}}const Zr=new wl;he(So,Zr);class D extends De{toString(){return`${Number(this)}°`}}class fl{convert(e){return Number(e)}}class pl{convert(e){if(!Mt(e))throw new A(typeof e,"number");return new D(e)}}class ml extends c{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new fl,this.decoder=new pl}}const Al=new ml;class x extends De{toString(){return`${String(this.value)} lat`}}class k extends De{toString(){return`${String(this.value)} lng`}}class W extends De{toString(){return`${Number(this)} rad`}}class gl{convert(e){return Number(e)}}class Cl{convert(e){if(!Mt(e))throw new A(typeof e,"number");return new W(e)}}class yl extends c{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new gl,this.decoder=new Cl}}const bl=new yl;class b{constructor(e,o){this.lat=e,this.lng=o,this.lat=e,this.lng=o}min(e){return new b(Fr(this.lat,e.lat),Fr(this.lng,e.lng))}max(e){return new b(Jr(this.lat,e.lat),Jr(this.lng,e.lng))}toString(){return`${this.lat}, ${this.lng}`}}class Bl{constructor(e){n(this,"unitCodec");this.unitCodec=e}convert(e){return[this.unitCodec.encode(e.lat.value),this.unitCodec.encode(e.lng.value)]}}class Sl{constructor(e){n(this,"unitCodec");this.unitCodec=e}convert(e){if(!(e instanceof Array))throw new A(typeof e,"Array");if(e.length!==2)throw new TypeError(`Expected array of length 2, got ${e.length}`);const[o,r]=e;return new b(new x(this.unitCodec.decode(o)),new k(this.unitCodec.decode(r)))}}class es extends c{constructor(o){super();n(this,"encoder");n(this,"decoder");this.encoder=new Bl(o),this.decoder=new Sl(o)}}const ts=new es(Al),os=new es(bl),ns=new Z(new X(ts),new K(ts));new Z(new X(os),new K(os));class vl{convert(e){return[Number(e.lng),Number(e.lat)]}}class El{convert(e){if(!(e instanceof Array))throw new A(typeof e,"Array");if(e.length!==2)throw new TypeError(`Expected array of length 2, got ${e.length}`);return new b(new x(new D(e[1])),new k(new D(e[0])))}}class xl extends c{constructor(){super(...arguments);n(this,"encoder",new vl);n(this,"decoder",new El)}}const ct=new xl,ye=new E(new S(ct),new v(ct)),be=new E(new S(ye),new v(ye)),rs=new E(new S(be),new v(be)),vo="LineString";class ss extends ue{constructor(o){super();n(this,"type",vo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=Gd(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return cs.encode(this)}}class kl{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates)}}}class Nl{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ce(e,vo);const o=this.codec.decode(e.coordinates);return new ss(o)}}class Il extends c{constructor(){super(...arguments);n(this,"encoder",new kl(ye));n(this,"decoder",new Nl(ye))}}const cs=new Il;he(vo,cs);const Eo="MultiLineString";class Rl extends ue{constructor(o){super();n(this,"type",Eo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=Pe(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return as.encode(this)}}class Dl{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates))}}}class Pl{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ce(e,Eo);const o=this.codec.decode(e.coordinates);return new Rl(o.map(r=>new ss(r)))}}class Ol extends c{constructor(){super(...arguments);n(this,"encoder",new Dl(be));n(this,"decoder",new Pl(be))}}const as=new Ol;he(Eo,as);const xo="Point";class at extends ue{constructor(o){super();n(this,"type",xo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=new Bo(this.coordinates,this.coordinates)}toJSON(){return is.encode(this)}}class Ll{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates)}}}class Tl{constructor(e){n(this,"codec");this.codec=e}convert(e){return i(e,"type","coordinates"),ce(e,xo),new at(this.codec.decode(e.coordinates))}}class Ml extends c{constructor(){super(...arguments);n(this,"encoder",new Ll(ct));n(this,"decoder",new Tl(ct))}}const is=new Ml;he(xo,is);const ko="MultiPoint";class No extends ue{constructor(o){super();n(this,"type",ko);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=Pe(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return ds.encode(this)}}class Hl{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates))}}}class Vl{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ce(e,ko);const o=this.codec.decode(e.coordinates);return new No(o.map(r=>new at(r)))}}class Ul extends c{constructor(){super(...arguments);n(this,"encoder",new Hl(ye));n(this,"decoder",new Vl(ye))}}const ds=new Ul;he(ko,ds);const Io="Polygon";class ls extends ue{constructor(o){super();n(this,"type",Io);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=Pe(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return us.encode(this)}}class Fl{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates.map(r=>r.coordinates)))}}}class Jl{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ce(e,Io);const o=this.codec.decode(e.coordinates);return new ls(o.map(r=>new No(r.map(s=>new at(s)))))}}class Gl extends c{constructor(){super(...arguments);n(this,"encoder",new Fl(be));n(this,"decoder",new Jl(be))}}const us=new Gl;he(Io,us);const Ro="MultiPolygon";class Wl extends ue{constructor(o){super();n(this,"type",Ro);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=Pe(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return hs.encode(this)}}class Ql{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates.map(r=>r.coordinates.map(s=>s.coordinates))))}}}class zl{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ce(e,Ro);const o=this.codec.decode(e.coordinates);return new Wl(o.map(r=>new ls(r.map(s=>new No(s.map(a=>new at(a)))))))}}class ql extends c{constructor(){super(...arguments);n(this,"encoder",new Ql(rs));n(this,"decoder",new zl(rs))}}const hs=new ql;he(Ro,hs);const Lt=class Lt{constructor(e,o,r,s){n(this,"inputMin");n(this,"inputMax");n(this,"outputMin");n(this,"outputMax");n(this,"inputRangeInv");n(this,"outputRange");this.inputMin=e,this.inputMax=o,this.outputMin=r,this.outputMax=s,this.inputRangeInv=1/(this.inputMax-this.inputMin),this.outputRange=this.outputMax-this.outputMin}transform(e){return(e-this.inputMin)*this.inputRangeInv*this.outputRange+this.outputMin}};n(Lt,"identity",new Lt(0,1,0,1));let Be=Lt;class Q extends De{toString(){return`${Number(this)} dp`}}class _l{constructor(e,o,r,s){n(this,"minInput");n(this,"maxInput");n(this,"minOutput");n(this,"maxOutput");n(this,"horizontalAffine");n(this,"inverseHorizontalAffine");n(this,"verticalAffine");n(this,"inverseVerticalAffine");this.minInput=e,this.maxInput=o,this.minOutput=r,this.maxOutput=s,this.horizontalAffine=new Be(Number(e.lat),Number(o.lat),Number(r.lat),Number(s.lat)),this.inverseHorizontalAffine=new Be(Number(r.lat),Number(s.lat),Number(e.lat),Number(o.lat)),this.verticalAffine=new Be(Number(e.lng),Number(o.lng),Number(r.lng),Number(s.lng)),this.inverseVerticalAffine=new Be(Number(r.lng),Number(s.lng),Number(e.lng),Number(o.lng))}project(e){return new b(new x(new Q(this.horizontalAffine.transform(Number(e.lat)))),new k(new Q(this.verticalAffine.transform(Number(e.lng)))))}inverseProject(e){const o=new W(this.inverseHorizontalAffine.transform(Number(e.lat))),r=new W(this.inverseVerticalAffine.transform(Number(e.lng)));return new b(new x(o),new k(r))}}class jl{constructor(){n(this,"minInput",new b(new x(new D(-90)),new k(new D(-180))));n(this,"maxInput",new b(new x(new D(90)),new k(new D(180))));n(this,"minOutput",new b(new x(new W(-Math.PI/2)),new k(new W(-Math.PI))));n(this,"maxOutput",new b(new x(new W(Math.PI/2)),new k(new W(Math.PI))))}projectLatitude(e){return new x(this.convertDegreesToRadians(e))}convertDegreesToRadians(e){return new W(Number(e)*(Math.PI/180))}convertRadiansToDegrees(e){return new D(Number(e)*(180/Math.PI))}projectLongitude(e){return new k(this.convertDegreesToRadians(e))}inverseProjectLatitude(e){return new x(this.convertRadiansToDegrees(e))}inverseProjectLongitude(e){return new k(this.convertRadiansToDegrees(e))}project(e){return new b(this.projectLatitude(e.lat),this.projectLongitude(e.lng))}inverseProject(e){return new b(this.inverseProjectLatitude(e.lat),this.inverseProjectLongitude(e.lng))}}const ws=new jl,fs=85.05133,B=class B{constructor(){n(this,"minInput",B.min);n(this,"maxInput",B.max);n(this,"minOutput",B.minProjection);n(this,"maxOutput",B.maxProjection)}static projectLongitude(e){return new k(Number(e))}static ensureLatitudeBounds(e){return rt(e,B.max.lat)?B.max.lat:bo(e,B.min.lat)?B.min.lat:e}static projectLatitude(e){return new x(Math.log(Math.tan(Math.PI/4+Number(this.ensureLatitudeBounds(e))/2)))}static inverseProjectLongitude(e){return new k(new W(Number(e)))}static inverseProjectLatitude(e){return new x(new W(2*Math.atan(Math.exp(Number(e)))-Math.PI/2))}static staticProject(e){return new b(this.projectLatitude(e.lat),this.projectLongitude(e.lng))}project(e){return B.staticProject(e)}static staticInverseProject(e){return new b(this.inverseProjectLatitude(e.lat),this.inverseProjectLongitude(e.lng))}inverseProject(e){return B.staticInverseProject(e)}};n(B,"min",ws.project(new b(new x(new D(-fs)),new k(new D(-180))))),n(B,"max",ws.project(new b(new x(new D(fs)),new k(new D(180))))),n(B,"minProjection",B.staticProject(B.min)),n(B,"maxProjection",B.staticProject(B.max));let it=B;const $l="AwABAQEcDQABDA0AAQYNAAEEDgABgAwAAQINAAEWAWEMAAF6AfgMAAH/AfIMAAH/AfwMAAH/AfgMAAH/AeAMAAF/AdAMAAF/AfAMAAF/AeAMAAF/AeAMAAE/AfAMAAEfAfAMAAEfAfwMAAE/AfwMAAF/Af4MAAF/Af8BgAsAAT8B/wHgCgABHwE/Av8BgAkAAZ8BPwL/AeAIAAEDAUwBPwL/AfAIAAEDAU8B3wL/AfgIAAEFAUMBzwL/AfoIAAEMAWMB7wL/Af0IAAEBAaMB7wP/CQABZwHPA/8BgAcAATgBoAHvA/8B4AcAARwBQAFvA/8B4AcAAYQB7gEPA/8B8AcAAQwBDgEvAv8B/gEwBgABAwGBAS8BzwHvAf8B/AEQBgABAwH4AYwBfwGDAf8B/AEYBgABCAHyAeMBHwEDAf8B/AE4BgABHgF9AS8BhgEBAf8B/AEIBgABKwHXAWwBvQGBAf8B/AEOBgABHgH/AW8B+QEBAf8B/gcAAe4B/wEHAYABQAE/AfABAAEYBQABfwH8AQcBwQHpAf8B8AHBAT4FAAH/AdgBAwHgAX8B/wHAAQMB/wGAAQABoAIAAf8BwAEBAfcBPwH/AQABAwH/AcABHQH8AgAB/gEIAQABfwGfAfYBAAEjAf8BxwH/AfgCAAH+AR8BgAFfAUcB7AEAAQMD/wHkAgABfQGfAYABDQGPAf4BAAEDAv8B/gMAATEB/wEAAQQBDwHkAQABAwL/AfgDAAEPAf8BgAEAAQEB4AEAAQEC/wHwAwABFwH/AYABAAEBAdACAAL/AfADAAEfAf8B8AIAAZACAAL/AcADAAEHAf8B/gFMBAAC/wHAAwABDwL/AV8EAAF/Af8BgAMAAT8D/wHAAwABHwH+BAABfwP/AeADAAEfAfgEAAFfA/8B8AMAAQ8B8AQABP8BgAMAAQ8B8AQAAX8C/wH8BAABDwHAAwABAwP/AfwEAAEGBAABAwF/Av8B+AkAAQMD/wHgCQABAwHvAv8B8AkAAQEC/wH+AeAKAAFnAf8B+wFACgABXwH+AbgBgAoAAQ8BogFQAQMKAAEGAQABIAEDCgABDgIAAQMDAAH8BgABDAUAAQEB/wwAAQMB/woAAQEBgQHPAf8BgAkAAQYBAQL/AYAJAAEFAdEB3wH/AYAKAALfAf8LAAI/Af8LAAF+AT8B/woAAXgB/gE/Af8BgAkAAXsB/QG/Af8BgAYAAWABAAEBAfkB/gEPAf8B+AYAATwBAAEXAf4B/QEPAv8B8AUAAXsBAAEfAfwB/gHHAv8B/gUAAZgBAAE/AZQB/gEHA/8BwAQAAZgBAAE/AQMB/wGPA/8BwAQAAeQBAAF8AesB/wFHA/8BwAQAAcABAAF/Ae8B/wFHA/8BwAYAAX8B7wH+AccD/wGABgABPwH/AfgBxwP/BwABPwH/Af0B5QL/AfwHAAE8Af8B+AHOAX8B/wHgBwABHQH/AfwB/wEfAf8BwAcAAQ8B/wH+Af8BzwHxAYAHAAEHA/8B9wHgCAABFwP/AfsBwAF8BQABgAEAAQcB/wH5Af8B+wGAAXgEAAEDAYABAAEvAf8B+AE8AfoBAAGABgABAQEfAf8B+wE+AfAIAAEPAY8C/wH+AfAGAAEGAQABOAGfA/8BYAYAAQEBAAFgAV8D/wkAAcABPwP/BwABAgEAAYABPwP/CAABAQGAAV8D/wkAAQME/wGACAABAwH7A/8BwAgAAQUBbwP/AfgIAAEBAd8D/wH+CAABBwT/Af4IAAEFBP8B8QgAAQcE/wHgCAABDwT/AcAIAAE/BP8BgAgAAX8E/wGABgABAwGAAX8E/wHABgABAwFgBf8B8AGABgABcAF/BP8B+AFABgABCAX/AfgBoAYAARsF/wH8AVgGAAEDBf8B/gEcBwAF/wHMAQQHAAHvBP8B4AEwBwABfwT/AcABcAcAAQcE/wGAAXABDwYAAQcE/wGAAeABHwHABQABAwP/Ab4BAAEYAR8BwAUAAQMD/wGAAQEBKAE/AcAFAAEPA/8BgAEFARIBfwGABQABBwP/AeACAAF/AYAGAAP/AwABfwGABgAC/wH+ARABAAEQAf8BgAYAAv8B/gMAAf8BgAYAAf8B/gH8ATABAAEIAf8BwAUAAWIB/wH8AfABIAEAAQwBPwHgBQABawH/AfABAgGAAQABDgH/AfAFAAFDAf8B8AECAgABDAF/AfAFAAEBAf8B8AMAAQQBHwH2BQABIQH/AfADAAECAQ8B8AYAAf8B8AQAAQcBwAYAAf8B8AwAAf8B4wGACwAB/wHHAYALAAE/Ae8DAAECCAABPwGQDAABPwHgDAABfwHgBQABAQYAAV8B4AUAAQMGAAE/AcAFAAEGBgABPwHABQABHAYAAT4BgAgA";function Yl(t){const e=new DataView(t),o=new Array(t.byteLength*8),r=t.byteLength;for(let s=0;s<r;s++){const a=e.getUint8(s);for(let d=0;d<8;d++){const l=7-d,p=s;o[p*8+d]=!!(a&1<<l)}}return o}function Xl(t){const e=new DataView(t),o=t.byteLength;let r=0;for(let d=0;d<o;d+=2)r+=e.getUint8(d);const s=new ArrayBuffer(r),a=new DataView(s);for(let d=0,l=0;d<o;d+=2){const p=e.getUint8(d),w=e.getUint8(d+1);for(let N=0;N<p;N++)a.setUint8(l++,w)}return s}const dt=new Q(12*7*16),Kl=new Q(Math.floor(Number(dt)*.75)),Oe=new Q(9),Zl=dt,eu=dt;new _l(it.minProjection,it.maxProjection,new b(new x(eu),new k(new Q(0))),new b(new x(new Q(0)),new k(Zl)));const tu=dt,ou=Kl,ps=new Q(Math.floor(Number(Oe)/2)),nu=Math.floor(Number(tu)/Number(Oe)),ru=Math.floor(Number(ou)/Number(Oe)),su=Array.from(ke(yr(ru),t=>new x(new Q(t*Number(Oe)+Number(ps))))),cu=Array.from(ke(yr(nu),t=>new k(new Q(t*Number(Oe)+Number(ps))))),ms=Array.from(Cr(cu,t=>ke(su,e=>new b(e,t))));Math.ceil(ms.length/8);const au=Co.decodeString($l),iu=Xl(au),du=Yl(iu),lu=Br(ms,du,(t,e)=>[t,e]),uu=mo(lu,([,t])=>t),hu=ke(uu,([t])=>t);Array.from(hu);class Do{constructor(e,o){n(this,"width");n(this,"index");this.width=e,this.index=o}toJSON(){return Po.encode(this)}}class wu{convert(e){return i(e,"width","index"),new Do(h.decode(e.width),h.decode(e.index))}}class fu{convert(e){return f(e,Do),{width:h.encode(e.width),index:h.encode(e.index)}}}class pu extends c{constructor(){super(...arguments);n(this,"encoder",new fu);n(this,"decoder",new wu)}}const Po=new pu;class Se{static get lsb0(){return Au}static get msb0(){return Cu}valueOf(){return this.toString()}toJSON(){return this.toString()}}const As="bitvec::order::Lsb0",gs="bitvec::order::Msb0";class mu extends Se{toString(){return As}}const Au=new mu;class gu extends Se{toString(){return gs}}const Cu=new gu;class yu{convert(e){if(typeof e!="string")throw new A(typeof e,"string");switch(e){case As:return Se.lsb0;case gs:return Se.msb0;default:throw new A(e,"CappuccinoAPIBitVecOrder")}}}class bu{convert(e){return e.toString()}}class Bu extends c{constructor(){super(...arguments);n(this,"encoder",new bu);n(this,"decoder",new yu)}}const Cs=new Bu;class Oo{constructor(e,o,r,s){n(this,"order");n(this,"head");n(this,"bits");n(this,"data");this.order=e,this.head=o,this.bits=r,this.data=s}getBitVecIndexIterable(){return this.order===Se.lsb0?new Nu(this.head.width,this.bits):new Ru(this.head.width,this.bits)}[Symbol.iterator](){const e=this.getBitVecIndexIterable();return ke(e,o=>xu(this.data,o))[Symbol.iterator]()}toJSON(){return we.encode(this)}}class Su{convert(e){return i(e,"order","head","bits","data"),new Oo(Cs.decode(e.order),Po.decode(e.head),h.decode(e.bits),R.decode(e.data))}}class vu{convert(e){return f(e,Oo),{order:Cs.encode(e.order),head:Po.encode(e.head),bits:h.encode(e.bits),data:R.encode(e.data)}}}class Eu extends c{constructor(){super(...arguments);n(this,"encoder",new vu);n(this,"decoder",new Su)}}const we=new Eu,ys=new E(new S(we),new v(we));function xu(t,e){return(t[e.bucket]>>e.bitOffset&1)===1}class bs{constructor(e,o){n(this,"bucket");n(this,"bitOffset");this.bucket=e,this.bitOffset=o}}function Bs(t){switch(I(t===8||t===16||t===32,"bit width should be a power of two that is supported"),t){case 8:return 3;case 16:return 4;case 32:return 5;default:throw new V}}class ku{constructor(e,o){n(this,"totalBits");n(this,"bitWidthMask");n(this,"bitWidthShift");n(this,"offset",0);this.totalBits=o;const r=Bs(e);this.bitWidthMask=e-1,this.bitWidthShift=r}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,o=this.offset&this.bitWidthMask;return this.offset+=1,{done:!1,value:new bs(e,o)}}}class Nu{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");this.bitWidth=e,this.totalBits=o}[Symbol.iterator](){return new ku(this.bitWidth,this.totalBits)}}class Iu{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");n(this,"bitWidthMask");n(this,"bitWidthShift");n(this,"offset",0);this.bitWidth=e,this.totalBits=o;const r=Bs(e);this.bitWidthMask=e-1,this.bitWidthShift=r}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,o=this.bitWidth-1-(this.offset&this.bitWidthMask);return this.offset+=1,{done:!1,value:new bs(e,o)}}}class Ru{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");this.bitWidth=e,this.totalBits=o}[Symbol.iterator](){return new Iu(this.bitWidth,this.totalBits)}}class Ss{constructor(e,o,r){n(this,"r");n(this,"s");n(this,"v");this.r=e,this.s=o,this.v=r}toJSON(){return Lo.encode(this)}}class Du{convert(e){return i(e,"r","s","v"),new Ss(T.decode(e.r),T.decode(e.s),h.decode(e.v))}}class Pu{convert(e){return f(e,Ss),{r:T.encode(e.r),s:T.encode(e.s),v:h.encode(e.v)}}}class Ou extends c{constructor(){super(...arguments);n(this,"encoder",new Pu);n(this,"decoder",new Du)}}const Lo=new Ou;class vs{constructor(e,o){n(this,"account");n(this,"amount");this.account=e,this.amount=o}toJSON(){return To.encode(this)}}class Lu{convert(e){return i(e,"account","amount"),new vs(T.decode(e.account),T.decode(e.amount))}}class Tu{convert(e){return f(e,vs),{account:T.encode(e.account),amount:T.encode(e.amount)}}}class Mu extends c{constructor(){super(...arguments);n(this,"encoder",new Tu);n(this,"decoder",new Lu)}}const To=new Mu;class Es{constructor(e,o,r){n(this,"number");n(this,"timestamp");n(this,"hash");this.number=e,this.timestamp=o,this.hash=r}toJSON(){return Mo.encode(this)}}class Hu{convert(e){return i(e,"number","timestamp","hash"),new Es(h.decode(e.number),u.decode(e.timestamp),u.decode(e.hash))}}class Vu{convert(e){return f(e,Es),{number:h.encode(e.number),timestamp:u.encode(e.timestamp),hash:u.encode(e.hash)}}}class Uu extends c{constructor(){super(...arguments);n(this,"encoder",new Vu);n(this,"decoder",new Hu)}}const Mo=new Uu,xs=new Z(new X(Mo),new K(Mo));class ks{constructor(e){n(this,"bytes");this.bytes=e}toJSON(){return Ho.encode(this)}}class Fu{convert(e){return i(e,"bytes"),new ks(zr.decode(e.bytes))}}class Ju{convert(e){return f(e,ks),{bytes:zr.encode(e.bytes)}}}class Gu extends c{constructor(){super(...arguments);n(this,"encoder",new Ju);n(this,"decoder",new Fu)}}const Ho=new Gu;class Ns{constructor(e,o,r,s,a,d,l,p,w,N){n(this,"height");n(this,"timestamp");n(this,"l1_head");n(this,"l1_finalized");n(this,"payload_commitment");n(this,"ns_table");n(this,"block_merkle_root");n(this,"fee_merkle_root");n(this,"builder_signature");n(this,"fee_info");this.height=e,this.timestamp=o,this.l1_head=r,this.l1_finalized=s,this.payload_commitment=a,this.ns_table=d,this.block_merkle_root=l,this.fee_merkle_root=p,this.builder_signature=w,this.fee_info=N}toJSON(){return Le.encode(this)}}class Wu{convert(e){return i(e,"height","timestamp","l1_head","l1_finalized","payload_commitment","ns_table","block_merkle_root","fee_merkle_root","builder_signature","fee_info"),new Ns(h.decode(e.height),h.decode(e.timestamp),h.decode(e.l1_head),xs.decode(e.l1_finalized),R.decode(e.payload_commitment),Ho.decode(e.ns_table),m.decode(e.block_merkle_root),m.decode(e.fee_merkle_root),Lo.decode(e.builder_signature),To.decode(e.fee_info))}}class Qu{convert(e){return f(e,Ns),{height:h.encode(e.height),timestamp:h.encode(e.timestamp),l1_head:h.encode(e.l1_head),l1_finalized:xs.encode(e.l1_finalized),payload_commitment:R.encode(e.payload_commitment),ns_table:Ho.encode(e.ns_table),block_merkle_root:m.encode(e.block_merkle_root),fee_merkle_root:m.encode(e.fee_merkle_root),builder_signature:Lo.encode(e.builder_signature),fee_info:To.encode(e.fee_info)}}}class zu extends c{constructor(){super(...arguments);n(this,"encoder",new Qu);n(this,"decoder",new Wu)}}const Le=new zu;class Is{constructor(e,o){n(this,"vm");n(this,"payload");this.vm=e,this.payload=o}toJSON(){return Te.encode(this)}}class qu{convert(e){return i(e,"vm","payload"),new Is(h.decode(e.vm),R.decode(e.payload))}}class _u{convert(e){return f(e,Is),{vm:h.encode(e.vm),payload:R.encode(e.payload)}}}class ju extends c{constructor(){super(...arguments);n(this,"encoder",new _u);n(this,"decoder",new qu)}}const Te=new ju;new E(new S(Te),new v(Te));class Rs{constructor(e,o,r,s,a){n(this,"header");n(this,"hash");n(this,"size");n(this,"num_transactions");n(this,"proposer_id");this.header=e,this.hash=o,this.size=r,this.num_transactions=s,this.proposer_id=a}toJSON(){return Vo.encode(this)}}class $u{convert(e){return i(e,"header","hash","size","num_transactions","proposer_id"),new Rs(Le.decode(e.header),m.decode(e.hash),h.decode(e.size),h.decode(e.num_transactions),oe.decode(e.proposer_id))}}class Yu{convert(e){return f(e,Rs),{header:Le.encode(e.header),hash:m.encode(e.hash),size:h.encode(e.size),num_transactions:h.encode(e.num_transactions),proposer_id:oe.encode(e.proposer_id)}}}class Xu extends c{constructor(){super(...arguments);n(this,"encoder",new Yu);n(this,"decoder",new $u)}}const Vo=new Xu;new E(new S(Vo),new v(Vo));class Ds{constructor(e,o,r,s){n(this,"hash");n(this,"header");n(this,"offset");n(this,"transaction");this.hash=e,this.header=o,this.offset=r,this.transaction=s}toJSON(){return Uo.encode(this)}}class Ku{convert(e){return i(e,"hash","header","offset","transaction"),new Ds(m.decode(e.hash),Le.decode(e.header),h.decode(e.offset),Te.decode(e.transaction))}}class Zu{convert(e){return f(e,Ds),{hash:m.encode(e.hash),header:Le.encode(e.header),offset:h.encode(e.offset),transaction:Te.encode(e.transaction)}}}class eh extends c{constructor(){super(...arguments);n(this,"encoder",new Zu);n(this,"decoder",new Ku)}}const Uo=new eh;new E(new S(Uo),new v(Uo));class Ps{constructor(e,o){n(this,"signature");n(this,"bitvec");this.signature=e,this.bitvec=o}toJSON(){return Fo.encode(this)}}class th{convert(e){if(!Fn(e)||e.length!==2)throw new A(typeof e,"Array");return new Ps(m.decode(e[0]),we.decode(e[1]))}}class oh{convert(e){return f(e,Ps),[m.encode(e.signature),we.encode(e.bitvec)]}}class nh extends c{constructor(){super(...arguments);n(this,"encoder",new oh);n(this,"decoder",new th)}}const Fo=new nh;new Z(new X(Fo),new K(Fo));class Me{}class Jo extends Me{toJSON(){return Go.encode(this)}}class rh{convert(e){if(!Y(e)||e!=="Empty")throw new ee;return new Jo}}class sh{convert(e){return f(e,Jo),"Empty"}}class ch extends c{constructor(){super(...arguments);n(this,"encoder",new sh);n(this,"decoder",new rh)}}const Go=new ch;class Wo extends Me{constructor(o,r,s){super();n(this,"value");n(this,"pos");n(this,"elem");this.value=o,this.pos=r,this.elem=s}toJSON(){return Qo.encode(this)}}class ah{convert(e){i(e,"Leaf");const o=e.Leaf;return i(o,"value","pos","elem"),new Wo(m.decode(o.value),m.decode(o.pos),m.decode(o.elem))}}class ih{convert(e){return f(e,Wo),{Leaf:{value:m.encode(e.value),pos:m.encode(e.pos),elem:m.encode(e.elem)}}}}class dh extends se{constructor(){super(...arguments);n(this,"encoder",new ih);n(this,"decoder",new ah)}}const Qo=new dh;class zo extends Me{constructor(o){super();n(this,"value");this.value=o}toJSON(){return qo.encode(this)}}class lh{convert(e){i(e,"ForgettenSubtree");const o=e.ForgettenSubtree;return i(o,"value"),new zo(m.decode(o.value))}}class uh{convert(e){return f(e,zo),{ForgettenSubtree:{value:m.encode(e.value)}}}}class hh extends se{constructor(){super(...arguments);n(this,"encoder",new uh);n(this,"decoder",new lh)}}const qo=new hh;class _o extends Me{constructor(o,r){super();n(this,"value");n(this,"children");this.value=o,this.children=r}toJSON(){return jo.encode(this)}}class wh{convert(e){i(e,"Branch");const o=e.Branch;return i(o,"value","children"),new _o(m.decode(o.value),Ls.decode(o.children))}}class fh{convert(e){return f(e,_o),{Branch:{value:m.encode(e.value),children:Ls.encode(e.children)}}}}class ph extends c{constructor(){super(...arguments);n(this,"encoder",new fh);n(this,"decoder",new wh)}}const jo=new ph;class mh{convert(e){if(Ht(e,"Leaf",Qe))return Qo.decoder.convert(e);if(Ht(e,"Branch",Qe))return jo.decoder.convert(e);if(Ht(e,"ForgettenSubtree",Qe))return qo.decoder.convert(e);if(Y(e))return Go.decoder.convert(e);throw new ee}}class Ah{convert(e){if(f(e,Me),e instanceof Wo)return Qo.encode(e);if(e instanceof _o)return jo.encode(e);if(e instanceof zo)return qo.encode(e);if(e instanceof Jo)return Go.encode(e);throw new ee}}class gh extends c{constructor(){super(...arguments);n(this,"encoder",new Ah);n(this,"decoder",new mh)}}const Os=new gh,Ls=new E(new S(Os),new v(Os));class $o{constructor(e,o,r,s,a,d,l,p){n(this,"hash");n(this,"height");n(this,"time");n(this,"numTransactions");n(this,"proposerID");n(this,"feeRecipient");n(this,"size");n(this,"blockReward");this.hash=e,this.height=o,this.time=r,this.numTransactions=s,this.proposerID=a,this.feeRecipient=d,this.size=l,this.blockReward=p}toJSON(){return He.encode(this)}}class Ch{convert(e){return i(e,"hash","height","time","num_transactions","proposer_id","fee_recipient","size","block_reward"),new $o(m.decode(e.hash),h.decode(e.height),Ce.decode(e.time),h.decode(e.num_transactions),oe.decode(e.proposer_id),oe.decode(e.fee_recipient),h.decode(e.size),kr.decode(e.block_reward))}}class yh{convert(e){return f(e,$o),{hash:m.encode(e.hash),height:h.encode(e.height),time:Ce.encode(e.time),num_transactions:h.encode(e.numTransactions),proposer_id:oe.encode(e.proposerID),fee_recipient:oe.encode(e.feeRecipient),size:h.encode(e.size),block_reward:kr.encode(e.blockReward)}}}class bh extends se{constructor(){super(...arguments);n(this,"encoder",new yh);n(this,"decoder",new Ch)}}const He=new bh,Ts=new E(new S(He),new v(He));class Ms{constructor(e,o,r,s,a,d){n(this,"hash");n(this,"height");n(this,"proposerID");n(this,"numTransactions");n(this,"size");n(this,"time");this.hash=e,this.height=o,this.proposerID=r,this.numTransactions=s,this.size=a,this.time=d}toJSON(){return Yo.encode(this)}}class Bh{convert(e){return i(e,"hash","height","proposer_id","num_transactions","size","time"),new Ms(m.decode(e.hash),h.decode(e.height),oe.decode(e.proposer_id),h.decode(e.num_transactions),h.decode(e.size),Ce.decode(e.time))}}class Sh{convert(e){return f(e,Ms),{hash:m.encode(e.hash),height:h.encode(e.height),proposer_id:oe.encode(e.proposerID),num_transactions:h.encode(e.numTransactions),size:h.encode(e.size),time:Ce.encode(e.time)}}}class vh extends se{constructor(){super(...arguments);n(this,"encoder",new Sh);n(this,"decoder",new Bh)}}const Yo=new vh;new E(new S(Yo),new v(Yo));function lt(t){return t!==null}function Eh(t,e){return t.blockHeights-e.blockHeights}class ut{constructor(e,o,r,s){n(this,"blockTime");n(this,"blockSize");n(this,"blockTransactions");n(this,"blockHeights");const a=[],d=s.length;for(let P=0;P<d;P++)a.push({blockTime:e[P],blockSize:o[P],blockTransactions:r[P],blockHeights:s[P]});a.sort(Eh);const l=a[0].blockHeights,p=a[d-1].blockHeights,w=[],N=[],U=[],ne=[];for(let P=l,O=0;P<=p;P++){const z=a[O];if(z.blockHeights!==P){w.push(null),N.push(null),U.push(null),ne.push(null);continue}w.push(z.blockTime),N.push(z.blockSize),U.push(z.blockTransactions),ne.push(z.blockHeights),O++}const $=Math.max(0,ne.length-50);this.blockTime=w.slice($),this.blockSize=N.slice($),this.blockTransactions=U.slice($),this.blockHeights=ne.slice($)}toJSON(){return Xo.encode(this)}}class xh{convert(e){return i(e,"block_time","block_size","block_transactions","block_heights"),new ut(R.decode(e.block_time),R.decode(e.block_size),R.decode(e.block_transactions),R.decode(e.block_heights))}}class kh{convert(e){return f(e,ut),{block_time:R.encode(e.blockTime.filter(lt)),block_size:R.encode(e.blockSize.filter(lt)),block_transactions:R.encode(e.blockTransactions.filter(lt)),block_heights:R.encode(e.blockHeights.filter(lt))}}}class Nh extends c{constructor(){super(...arguments);n(this,"encoder",new kh);n(this,"decoder",new xh)}}const Xo=new Nh,Hs=R;class Vs{constructor(e,o,r,s,a,d){n(this,"hash");n(this,"rollups");n(this,"height");n(this,"time");n(this,"offset");n(this,"numTransactions");this.hash=e,this.rollups=o,this.height=r,this.time=s,this.offset=a,this.numTransactions=d}toJSON(){return Ko.encode(this)}}class Ih{convert(e){return i(e,"hash","rollups","height","time","offset","num_transactions"),new Vs(m.decode(e.hash),Hs.decode(e.rollups),h.decode(e.height),Ce.decode(e.time),h.decode(e.offset),h.decode(e.num_transactions))}}class Rh{convert(e){return f(e,Vs),{hash:m.encode(e.hash),rollups:Hs.encode(e.rollups),height:h.encode(e.height),time:Ce.encode(e.time),offset:h.encode(e.offset),num_transactions:h.encode(e.numTransactions)}}}class Dh extends c{constructor(){super(...arguments);n(this,"encoder",new Rh);n(this,"decoder",new Ih)}}const Ko=new Dh;new E(new S(Ko),new v(Ko));const Us=h;class Fs{constructor(e,o){n(this,"namespace");n(this,"payload");this.namespace=e,this.payload=o}toJSON(){return Zo.encode(this)}}class Ph{convert(e){return i(e,"namespace","payload"),new Fs(Us.decode(e.namespace),qr.decode(e.payload))}}class Oh{convert(e){return f(e,Fs),{namespace:Us.encode(e.namespace),payload:qr.encode(e.payload)}}}class Lh extends c{constructor(){super(...arguments);n(this,"encoder",new Oh);n(this,"decoder",new Ph)}}const Zo=new Lh;new E(new S(Zo),new v(Zo));class Js{constructor(e,o){n(this,"coords");n(this,"country");this.coords=e,this.country=o}toJSON(){return en.encode(this)}}class Th{convert(e){return{coords:ns.encode(e.coords),country:H.encode(e.country)}}}class Mh{convert(e){return i(e,"coords","country"),new Js(ns.decode(e.coords),Ae(H.decode(e.country)))}}class Hh extends c{constructor(){super(...arguments);n(this,"encoder",new Th);n(this,"decoder",new Mh)}}const en=new Hh,Gs=new Z(new X(en),new K(en));class Ws{constructor(e,o,r,s,a,d,l,p){n(this,"publicKey");n(this,"name");n(this,"publicURL");n(this,"company");n(this,"location");n(this,"operatingSystem");n(this,"nodeType");n(this,"networkType");this.publicKey=e,this.name=o,this.publicURL=r,this.company=s,this.location=a,this.operatingSystem=d,this.nodeType=l,this.networkType=p}toJSON(){return Ve.encode(this)}}class Vh{convert(e){return{public_key:m.encode(e.publicKey),name:H.encode(e.name),public_url:jr.encode(e.publicURL),company:H.encode(e.company),location:Gs.encode(e.location),operating_system:H.encode(e.operatingSystem),node_type:H.encode(e.nodeType),network_type:H.encode(e.networkType)}}}class Uh{convert(e){return i(e,"public_key","name","public_url","company","location","operating_system","node_type","network_type"),new Ws(m.decode(e.public_key),Ae(H.decode(e.name)),jr.decode(e.public_url),Ae(H.decode(e.company)),Gs.decode(e.location),Ae(H.decode(e.operating_system)),Ae(H.decode(e.node_type)),Ae(H.decode(e.network_type)))}}class Fh extends c{constructor(){super(...arguments);n(this,"encoder",new Vh);n(this,"decoder",new Uh)}}const Ve=new Fh,Qs=new E(new S(Ve),new v(Ve));class fe{}const zs="SubscribeNodeIdentity";class tn extends fe{valueOf(){return zs}}const qs="SubscribeLatestBlock";class on extends fe{valueOf(){return qs}}const _s="SubscribeVoters";class nn extends fe{valueOf(){return _s}}const js="RequestNodeIdentitySnapshot";class rn extends fe{valueOf(){return js}}const $s="RequestBlocksSnapshot";class sn extends fe{valueOf(){return $s}}const Ys="RequestHistogramSnapshot";class cn extends fe{valueOf(){return Ys}}const Xs="RequestVotersSnapshot";class an extends fe{valueOf(){return Xs}}class Ks{}const Zs="Connect";class ht extends Ks{valueOf(){return Zs}}const ec="Close";class wt extends Ks{valueOf(){return ec}}class Jh{convert(e){return e.valueOf()}}class Gh{convert(e){if(typeof e!="string")throw new A(typeof e,"string");switch(e){case zs:return new tn;case qs:return new on;case _s:return new nn;case js:return new rn;case $s:return new sn;case Ys:return new cn;case Xs:return new an;default:throw new A(e,"CappuccinoNodeValidatorRequest")}}}class Wh extends c{constructor(){super(...arguments);n(this,"encoder",new Jh);n(this,"decoder",new Gh)}}const dn=new Wh;class Qh{convert(e){return e.valueOf()}}class zh{convert(e){if(typeof e!="string")throw new A(typeof e,"string");switch(e){case Zs:return new ht;case ec:return new wt;default:throw new A(e,"CappuccinoNodeValidatorRequest")}}}class qh extends c{constructor(){super(...arguments);n(this,"encoder",new Qh);n(this,"decoder",new zh)}}const tc=new qh;class oc{}const ft="LifeCycleRequest";class Ue extends oc{constructor(o){super();n(this,"request");this.request=o}toJson(){return ln.encode(this)}}class _h{convert(e){return{[ft]:tc.encode(e.request)}}}class jh{convert(e){return i(e,ft),new Ue(tc.decode(e[ft]))}}class $h extends c{constructor(){super(...arguments);n(this,"encoder",new _h);n(this,"decoder",new jh)}}const ln=new $h,pt="NodeValidatorRequest";class Fe extends oc{constructor(o){super();n(this,"request");this.request=o}toJson(){return un.encode(this)}}class Yh{convert(e){return{[pt]:dn.encode(e.request)}}}class Xh{convert(e){return i(e,pt),new Fe(dn.decode(e[pt]))}}class Kh extends c{constructor(){super(...arguments);n(this,"encoder",new Yh);n(this,"decoder",new Xh)}}const un=new Kh;class pe{}const mt="BlocksSnapshot";class hn extends pe{constructor(o){super();n(this,"blocks");this.blocks=o}toJSON(){return wn.encode(this)}}class Zh{convert(e){i(e,mt);const o=e[mt];return new hn(Ts.decode(o))}}class ew{convert(e){return{[mt]:Ts.encode(e.blocks)}}}class tw extends c{constructor(){super(...arguments);n(this,"encoder",new ew);n(this,"decoder",new Zh)}}const wn=new tw;class fn{}const At="ConnectionClosed";class Je extends fn{toJSON(){return pn.encode(this)}}class ow{convert(e){if(typeof e!="string")throw new A(typeof e,"string");if(e!==At)throw new A(e,At);return new Je}}class nw{convert(){return At}}class rw extends c{constructor(){super(...arguments);n(this,"encoder",new nw);n(this,"decoder",new ow)}}const pn=new rw,gt="ConnectionConnecting";class Ge extends fn{toJSON(){return mn.encode(this)}}class sw{convert(e){if(typeof e!="string")throw new A(typeof e,"string");if(e!==gt)throw new A(e,gt);return new Ge}}class cw{convert(){return gt}}class aw extends c{constructor(){super(...arguments);n(this,"encoder",new cw);n(this,"decoder",new sw)}}const mn=new aw,Ct="ConnectionOpened";class We extends fn{toJSON(){return An.encode(this)}}class iw{convert(e){if(typeof e!="string")throw new A(typeof e,"string");if(e!==Ct)throw new A(e,Ct);return new We}}class dw{convert(){return Ct}}class lw extends c{constructor(){super(...arguments);n(this,"encoder",new dw);n(this,"decoder",new iw)}}const An=new lw,yt="HistogramSnapshot";class bt extends pe{constructor(o){super();n(this,"histograms");this.histograms=o}toJSON(){return gn.encode(this)}}class uw{convert(e){return i(e,yt),new bt(Xo.decode(e[yt]))}}class hw{convert(e){return{[yt]:Xo.encode(e.histograms)}}}class ww extends c{constructor(){super(...arguments);n(this,"encoder",new hw);n(this,"decoder",new uw)}}const gn=new ww,Bt="LatestBlock";class St extends pe{constructor(o){super();n(this,"latestBlock");this.latestBlock=o}toJSON(){return Cn.encode(this)}}class fw{convert(e){return i(e,Bt),new St(He.decode(e[Bt]))}}class pw{convert(e){return{[Bt]:He.encode(e.latestBlock)}}}class mw extends c{constructor(){super(...arguments);n(this,"encoder",new pw);n(this,"decoder",new fw)}}const Cn=new mw,vt="LatestVoters";class yn extends pe{constructor(o){super();n(this,"latestVoter");this.latestVoter=o}toJSON(){return bn.encode(this)}}class Aw{convert(e){return i(e,vt),new yn(we.decode(e[vt]))}}class gw{convert(e){return{[vt]:we.encode(e.latestVoter)}}}class Cw extends c{constructor(){super(...arguments);n(this,"encoder",new gw);n(this,"decoder",new Aw)}}const bn=new Cw,Et="NodeIdentitySnapshot";class xt extends pe{constructor(o){super();n(this,"nodes");this.nodes=o}toJSON(){return Bn.encode(this)}}class yw{convert(e){i(e,Et);const o=e[Et];return new xt(Qs.decode(o))}}class bw{convert(e){return{[Et]:Qs.encode(e.nodes)}}}class Bw extends c{constructor(){super(...arguments);n(this,"encoder",new bw);n(this,"decoder",new yw)}}const Bn=new Bw,kt="VotersSnapshot";class Sn extends pe{constructor(o){super();n(this,"voters");this.voters=o}toJSON(){return vn.encode(this)}}class Sw{convert(e){i(e,kt);const o=e[kt];return new Sn(ys.decode(o))}}class vw{convert(e){return{[kt]:ys.encode(e.voters)}}}class Ew extends c{constructor(){super(...arguments);n(this,"encoder",new vw);n(this,"decoder",new Sw)}}const vn=new Ew,Nt="LatestNodeIdentity";class nc extends pe{constructor(o){super();n(this,"nodeIdentity");this.nodeIdentity=o}toJSON(){return En.encode(this)}}class xw{convert(e){return i(e,Nt),new nc(Ve.decode(e[Nt]))}}class kw{convert(e){return{[Nt]:Ve.encode(e.nodeIdentity)}}}class Nw extends c{constructor(){super(...arguments);n(this,"encoder",new kw);n(this,"decoder",new xw)}}const En=new Nw;class Iw{convert(e){if(M(e,mt))return wn.decode(e);if(M(e,yt))return gn.decode(e);if(M(e,Bt))return Cn.decode(e);if(M(e,Nt))return En.decode(e);if(M(e,vt))return bn.decode(e);if(M(e,Et))return Bn.decode(e);if(M(e,kt))return vn.decode(e);throw new V}}class Rw{convert(e){if(e instanceof hn)return wn.encode(e);if(e instanceof bt)return gn.encode(e);if(e instanceof St)return Cn.encode(e);if(e instanceof nc)return En.encode(e);if(e instanceof yn)return bn.encode(e);if(e instanceof xt)return Bn.encode(e);if(e instanceof Sn)return vn.encode(e);throw new V}}class Dw extends c{constructor(){super(...arguments);n(this,"encoder",new Rw);n(this,"decoder",new Iw)}}const It=new Dw;class Pw{convert(e){if(e===Ct)return An.decode(e);if(e===At)return pn.decode(e);if(e===gt)return mn.decode(e);throw new V}}class Ow{convert(e){if(e instanceof We)return An.encode(e);if(e instanceof Je)return pn.encode(e);if(e instanceof Ge)return mn.encode(e);throw new V}}class Lw extends c{constructor(){super(...arguments);n(this,"encoder",new Ow);n(this,"decoder",new Pw)}}const xn=new Lw;class kn{}const Rt="NodeValidatorResponse";class Nn extends kn{constructor(o){super();n(this,"response");this.response=o}toJson(){return In.encode(this)}}class Tw{convert(e){return{[Rt]:It.encode(e.response)}}}class Mw{convert(e){i(e,Rt);const o=e[Rt];return new Nn(It.decode(o))}}class Hw extends c{constructor(){super(...arguments);n(this,"encoder",new Tw);n(this,"decoder",new Mw)}}const In=new Hw;class Rn extends kn{constructor(o){super();n(this,"response");this.response=o}toJson(){return xn.encode(this)}}const Dt="LifeCycleResponse";class Vw{convert(e){return{[Dt]:xn.encode(e.response)}}}class Uw{convert(e){return i(e,Dt),new Rn(xn.decode(e[Dt]))}}class Fw extends c{constructor(){super(...arguments);n(this,"encoder",new Vw);n(this,"decoder",new Uw)}}const rc=new Fw,Pt="ErrorResponse";class Dn extends kn{constructor(o){super();n(this,"error");this.error=o}toJson(){return Pn.encode(this)}}class Jw{convert(e){return{[Pt]:ze.encode(e.error)}}}class Gw{convert(e){return i(e,Pt),new Dn(ze.decode(e[Pt]))}}class Ww extends c{constructor(){super(...arguments);n(this,"encoder",new Jw);n(this,"decoder",new Gw)}}const Pn=new Ww;class Qw{convert(e){return new Nn(e)}}const On=new Qw;class zw{convert(e){return new Rn(e)}}const Ln=new zw;class qw{convert(e){return new Dn(e)}}const _w=new qw;function Tn(t){return new $o(t.hash,t.height,t.time,t.numTransactions,t.proposer,t.proposer,t.size,t.fees)}function sc(t){return new Ws(t.pubkey,t.name,null,t.company.name,new Js(new b(new x(new D(t.location.coords[0])),new k(new D(t.location.coords[1]))),t.location.country),t.operatingSystem,t.nodeType,t.networkType)}class jw{constructor(e,o){n(this,"responseStream");n(this,"requestStream");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");n(this,"prng",new le(kd()));n(this,"latestBlock",Tn(Hr()));n(this,"latestBlocks",ae(50));n(this,"latestVoters",ae(50));n(this,"histogramBlockTimeData",ae(50));n(this,"histogramBlockSizeData",ae(50));n(this,"histogramBlockTransactionData",ae(50));n(this,"histogramBlockHeightData",ae(50));n(this,"isConnected",!1);n(this,"isSubscribedToLatestBlock",!1);n(this,"isSubscribedToVoters",!1);this.requestStream=e,this.responseStream=o,this.lifecycleResponseSink=de(ie(o),Ln),this.nodeValidatorResponseSink=de(ie(o),On)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}generateVotersFromBlockDetail(e){const o=new le(e.time.valueOf()),r=Re.length,s=Math.ceil(r/16),a=new Uint16Array(o.fillBytes(s*2));return new Oo(Se.lsb0,new Do(16,0),r,Array.from(a))}async updateBlockDetails(e){const o=this.latestBlock,r=(e.time.valueOf()-o.time.valueOf())/1e3,s=this.generateVotersFromBlockDetail(e);this.latestBlock=e,this.latestBlocks.put(e),this.latestVoters.put(s),this.histogramBlockTimeData.put(r),this.histogramBlockSizeData.put(e.size),this.histogramBlockTransactionData.put(e.numTransactions),this.histogramBlockHeightData.put(e.height),this.isConnected&&(this.isSubscribedToLatestBlock&&await this.nodeValidatorResponseSink.send(new St(e)),this.isSubscribedToVoters&&this.nodeValidatorResponseSink.send(new yn(s)))}async initializeState(){for await(const e of Rd(this.prng))this.updateBlockDetails(Tn(e));await this.nodeValidatorResponseSink.send(new St(this.latestBlock)),await this.nodeValidatorResponseSink.send(new bt(new ut(Array.from(this.histogramBlockTimeData.immutableIterable()),Array.from(this.histogramBlockSizeData.immutableIterable()),Array.from(this.histogramBlockTransactionData.immutableIterable()),Array.from(this.histogramBlockHeightData.immutableIterable())))),this.nodeValidatorResponseSink.send(new xt(Re.map(sc)))}async startProcessing(){await this.initializeState(),this.handleRequests(),this.streamBlocks()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async streamBlocks(){const e=this.latestBlock;for await(const o of Dd(this.prng,e.time.valueOf(),e.height)){const r=Tn(o);this.updateBlockDetails(r)}}async handleRequest(e){if(e instanceof Ue){try{await this.handleLifeCycleRequest(e.request)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof Fe){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unrecognized request type",e)}async handleLifeCycleRequest(e){if(e instanceof ht){await this.handleConnect();return}if(e instanceof wt){await this.handleClose();return}}async handleNodeValidatorRequest(e){if(e instanceof on){await this.handleSubscribeLatestBlock();return}if(e instanceof tn){await this.handleSubscribeNodeIdentity();return}if(e instanceof nn){await this.handleSubscribeVoters();return}if(e instanceof sn){await this.handleRequestBlocksSnapshot();return}if(e instanceof cn){await this.handleRequestHistogramSnapshot();return}if(e instanceof rn){await this.handleRequestNodeIdentitySnapshot();return}if(e instanceof an){await this.handleRequestVotersSnapshot();return}}async handleConnect(){if(this.isConnected)throw new Error("already connected to WebSocket");this.isConnected=!0,await this.lifecycleResponseSink.send(new Ge),await this.lifecycleResponseSink.send(new We)}async handleClose(){if(!this.isConnected)throw new Error("not connected to WebSocket");this.isConnected=!1,this.isSubscribedToLatestBlock=!1,this.isSubscribedToVoters=!1,await this.lifecycleResponseSink.send(new Je)}async assertIsConnected(){if(!this.isConnected)throw new Error("not connected to WebSocket")}async handleSubscribeLatestBlock(){await this.assertIsConnected(),this.isSubscribedToLatestBlock=!0}async handleSubscribeNodeIdentity(){await this.assertIsConnected()}async handleSubscribeVoters(){await this.assertIsConnected(),this.isSubscribedToVoters=!0}async handleRequestBlocksSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new hn(Array.from(this.latestBlocks.immutableIterable())))}async handleRequestHistogramSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new bt(new ut(Array.from(this.histogramBlockTimeData.immutableIterable()),Array.from(this.histogramBlockSizeData.immutableIterable()),Array.from(this.histogramBlockTransactionData.immutableIterable()),Array.from(this.histogramBlockHeightData.immutableIterable()))))}async handleRequestNodeIdentitySnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new xt(Re.map(sc)))}async handleRequestVotersSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Sn(Array.from(this.latestVoters.immutableIterable())))}}class $w{constructor(e,o,r){n(this,"responseStream");n(this,"requestStream");n(this,"capturedHAR");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");this.requestStream=e,this.responseStream=o,this.capturedHAR=r,this.lifecycleResponseSink=de(ie(o),Ln),this.nodeValidatorResponseSink=de(ie(o),On)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async startProcessing(){this.handleRequests()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async handleRequest(e){if(e instanceof Ue){try{await this.handleLifeCycleRequest(e.request)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof Fe){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unknown request type",e)}async handleLifeCycleRequest(e){if(e instanceof ht){await this.handleConnect();return}if(e instanceof wt){await this.handleClose();return}}async handleNodeValidatorRequest(e){if(e instanceof on){await this.handleSubscribeLatestBlock();return}if(e instanceof tn){await this.handleSubscribeNodeIdentity();return}if(e instanceof nn){await this.handleSubscribeVoters();return}if(e instanceof sn){await this.handleRequestBlocksSnapshot();return}if(e instanceof cn){await this.handleRequestHistogramSnapshot();return}if(e instanceof rn){await this.handleRequestNodeIdentitySnapshot();return}if(e instanceof an){await this.handleRequestVotersSnapshot();return}}async handleConnect(){await this.lifecycleResponseSink.send(new Ge),await this.lifecycleResponseSink.send(new We);const e=Cr(this.capturedHAR.log.entries,s=>"_webSocketMessages"in s?s._webSocketMessages:[]),o=mo(e,s=>s.type==="receive");let r=0;for(const s of o){if(r>0){const a=s.time*1e3-r*1e3;await mr(a)}r=s.time;try{const a=It.decode(JSON.parse(s.data));await this.nodeValidatorResponseSink.send(a)}catch{console.error(`Failed to decode message: ${s.data}`);continue}}await this.lifecycleResponseSink.send(new Je)}async handleClose(){}async handleSubscribeLatestBlock(){}async handleSubscribeNodeIdentity(){}async handleSubscribeVoters(){}async handleRequestBlocksSnapshot(){}async handleRequestHistogramSnapshot(){}async handleRequestNodeIdentitySnapshot(){}async handleRequestVotersSnapshot(){}}const Mn="WebSocketError";class Ot extends y{constructor(o,r=`websocket error: ${String(o)}`){super(r);n(this,"cause");this.cause=o,Object.freeze(this)}get code(){return Mn}}class Yw{convert(e){return i(e,"code","message"),g(e,Mn),new Ot({},u.decode(e.message))}}class Xw extends L{}class Kw extends c{constructor(){super(...arguments);n(this,"encoder",new Xw);n(this,"decoder",new Yw)}}const Zw=new Kw;C(Mn,Zw);class ef{constructor(e,o,r){n(this,"responseStream");n(this,"requestStream");n(this,"serviceBaseURL");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");n(this,"errorResponseSink");n(this,"webSocket",null);n(this,"webSocketCompleter",null);this.requestStream=e,this.responseStream=o,this.serviceBaseURL=r,this.lifecycleResponseSink=de(ie(o),Ln),this.nodeValidatorResponseSink=de(ie(o),On),this.errorResponseSink=de(ie(o),_w)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async startProcessing(){this.handleRequests()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async handleRequest(e){if(e instanceof Ue){try{await this.handleLifeCycleRequest(e.request)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof Fe){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unrecognized request",e)}async handleLifeCycleRequest(e){if(e instanceof ht){await this.handleConnect();return}if(e instanceof wt){await this.handleClose();return}}async handleNodeValidatorRequest(e){this.assertConnected(),await this.webSocketCompleter.promise,this.webSocket.send(JSON.stringify(dn.encode(e)))}assertNotConnected(){if(this.webSocket!==null)throw new Error("Already connected")}assertConnected(){if(this.webSocket===null)throw new Error("Not connected")}async handleConnect(){this.assertNotConnected(),await this.lifecycleResponseSink.send(new Ge);const e=new URL("node-validator/details",this.serviceBaseURL),o=$e();this.webSocketCompleter=o;try{const r=new tf(this.nodeValidatorResponseSink),s=new of(o,this.lifecycleResponseSink),a=new nf(this.lifecycleResponseSink),d=new rf(this.errorResponseSink),l=new WebSocket(e);l.onerror,l.addEventListener("open",s),l.addEventListener("message",r),l.addEventListener("close",a),l.addEventListener("error",d),l.addEventListener("close",()=>{l.removeEventListener("open",s),l.removeEventListener("message",r),l.removeEventListener("close",a),l.removeEventListener("error",d),this.webSocket=null}),this.webSocket=l}catch(r){const s=new Ot(r);this.errorResponseSink.send(s),o.completeError(s)}}async handleClose(){this.assertConnected(),this.webSocket.close(1e3,"done")}}class tf{constructor(e){n(this,"nodeValidatorResponseSink");this.nodeValidatorResponseSink=e}decodeMessage(e){return It.decode(JSON.parse(e.data))}async relayMessage(e){try{await this.nodeValidatorResponseSink.send(e)}catch(o){console.error("attempt to publish message to response stream failed",o)}}async handleEvent(e){try{const o=this.decodeMessage(e);this.relayMessage(o)}catch(o){console.error("Failed to decode server message from web socket",o);return}}}class of{constructor(e,o){n(this,"completer");n(this,"lifecycleResponseSink");this.completer=e,this.lifecycleResponseSink=o}handleEvent(e){this.completer.complete(e.target),this.lifecycleResponseSink.send(new We)}}class nf{constructor(e){n(this,"lifecycleResponseSink");this.lifecycleResponseSink=e}async handleEvent(){await this.lifecycleResponseSink.send(new Je)}}class rf{constructor(e){n(this,"errorResponseSink");this.errorResponseSink=e}errorFromEvent(e){return"error"in e?new Ot(e.error):new Ot(null,"web socket error: unknown error")}handleEvent(e){this.errorResponseSink.send(this.errorFromEvent(e))}}class sf{convert(e){if(e instanceof Fe)return un.encode(e);if(e instanceof Ue)return ln.encode(e);throw new V}}class cf{convert(e){if(M(e,pt))return un.decode(e);if(M(e,ft))return ln.decode(e);throw new V}}class af extends c{constructor(){super(...arguments);n(this,"encoder",new sf);n(this,"decoder",new cf)}}const df=new af;class lf{convert(e){if(e instanceof Nn)return In.encode(e);if(e instanceof Rn)return rc.encode(e);if(e instanceof Dn)return Pn.encode(e);throw new V}}class uf{convert(e){if(M(e,Rt))return In.decode(e);if(M(e,Dt))return rc.decode(e);if(M(e,Pt))return Pn.decode(e);throw new V}}class hf extends c{constructor(){super(...arguments);n(this,"encoder",new lf);n(this,"decoder",new uf)}}const wf=new hf;async function ff(t){const e=t.pathname,o=await fetch(e);if(!o.ok)throw new V;const r=await o.json(),s=ge(1024),a=ge(1024),d=new $w(s,a,r);return d.startProcessing(),d}async function pf(t){const e=new URL(t);if(e.protocol==="replay:")return ff(e);if(e.protocol==="ws:"||e.protocol==="wss:"){const o=ge(1024),r=ge(1024),s=new ef(o,r,e);return s.startProcessing(),s}return null}async function mf(){try{const s=await(await fetch("/config.json")).json();if(s.node_validator_service_url){const a=await pf(s.node_validator_service_url);if(a!==null)return a}}catch(r){console.warn("error determining service implementation, from configuration file",r)}const t=ge(1024),e=ge(1024),o=new jw(t,e);return o.startProcessing(),o}async function Af(){return new gf(await mf())}class gf{constructor(e){n(this,"service");this.service=e}get stream(){return this.service.stream}async send(e){return this.service.send(e)}}async function Cf(t,e){const o=await t;for await(const r of o.stream)e(wf.encode(r))}class yf{constructor(e){n(this,"service");const o=Af();this.service=o,Cf(o,e)}async handleEvent(e){const o=df.decode(e.data);try{(await this.service).send(o)}catch(r){console.warn("error processing message from event",r)}}}self.addEventListener("message",new yf(self.postMessage.bind(self)))})();
