import{F as l,G as y,H as w,I as k,J as O,K as b,M as L,O as E,Q as x,U as R,V as h,X as M}from"./en_US-RFN65H63-D9JI_Mip.js";import"./iframe-B8QM7YzT.js";import"./higher_order-Bes1iNRk.js";import"./typography-dF_xh9UT.js";import"./Text-BU7JBOLk.js";import"./CappuccinoHotShotQueryServiceAPIContext-DbJhP9BN.js";import"./UnimplementedError-N0odIfDD.js";import"./string-BI8AIx1I.js";import"./array_buffer-CitSjtn6.js";import"./base64-r9vyOGQT.js";import"./functional-C2YPzjZP.js";import"./MissingElementError-BiJAxgGE.js";import"./url-BLYalvQP.js";import"./monetary_value-Dof17hnG.js";import"./TaggedBase64-D-xwfkqv.js";import"./generateFakeData-D6-s9jhx.js";import"./sleep-CW-vxfof.js";import"./data-C7kS6cEI.js";import"./LoadingProvider-B39JWdAl.js";import"./FetchError-BkM_RKT_.js";import"./NotFoundError-D156Q_Lb.js";import"./index-BxKYC05K.js";import"./PromiseResolver-Do1jfIcc.js";import"./ProvideAsyncStates-DHPOIeMO.js";import"./PathResolverProvider-C88hU1oa.js";import"./DataTable-COIbZnYs.js";import"./ChevronUp-BF-GSfr1.js";import"./SVGIconBase-Bo3pZ3HU.js";import"./LabeledAnchorButton-D5k3SgM8.js";import"./AnchorButton-CST84wQK.js";import"./DateTimeFormattersProvider-BFTAYU1H.js";import"./LocaleProvider-COHzpDxl.js";import"./NavDrawerStateProvider-DH9oZpuO.js";import"./NowProvider-5nmAZ7lz.js";import"./NumberFormattersProvider-C3nNPFFr.js";import"./AsyncIterableResolver-CWgLSwJr.js";class S extends l{constructor({callbackSelector:o,cause:t,data:n,extraData:c,sender:m,urls:r}){var s;super(t.shortMessage||"An error occurred while fetching for an offchain result.",{cause:t,metaMessages:[...t.metaMessages||[],(s=t.metaMessages)!=null&&s.length?"":[],"Offchain Gateway Call:",r&&["  Gateway URL(s):",...r.map(p=>`    ${y(p)}`)],`  Sender: ${m}`,`  Data: ${n}`,`  Callback selector: ${o}`,`  Extra data: ${c}`].flat(),name:"OffchainLookupError"})}}class $ extends l{constructor({result:o,url:t}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${y(t)}`,`Response: ${w(o)}`],name:"OffchainLookupResponseMalformedError"})}}class q extends l{constructor({sender:o,to:t}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${t}`,`OffchainLookup sender address: ${o}`],name:"OffchainLookupSenderMismatchError"})}}const ue="0x556f1830",G={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function he(i,{blockNumber:o,blockTag:t,data:n,to:c}){const{args:m}=k({data:n,abi:[G]}),[r,s,p,d,a]=m,{ccipRead:e}=i,u=e&&typeof(e==null?void 0:e.request)=="function"?e.request:T;try{if(!O(c,r))throw new q({sender:r,to:c});const f=s.includes(b)?await L({data:p,ccipRequest:u}):await u({data:p,sender:r,urls:s}),{data:g}=await E(i,{blockNumber:o,blockTag:t,data:x([d,R([{type:"bytes"},{type:"bytes"}],[f,a])]),to:c});return g}catch(f){throw new S({callbackSelector:d,cause:f,data:n,extraData:a,sender:r,urls:s})}}async function T({data:i,sender:o,urls:t}){var c;let n=new Error("An unknown error occurred.");for(let m=0;m<t.length;m++){const r=t[m],s=r.includes("{data}")?"GET":"POST",p=s==="POST"?{data:i,sender:o}:void 0,d=s==="POST"?{"Content-Type":"application/json"}:{};try{const a=await fetch(r.replace("{sender}",o.toLowerCase()).replace("{data}",i),{body:JSON.stringify(p),headers:d,method:s});let e;if((c=a.headers.get("Content-Type"))!=null&&c.startsWith("application/json")?e=(await a.json()).data:e=await a.text(),!a.ok){n=new h({body:p,details:e!=null&&e.error?w(e.error):a.statusText,headers:a.headers,status:a.status,url:r});continue}if(!M(e)){n=new $({result:e,url:r});continue}return e}catch(a){n=new h({body:p,details:a.message,url:r})}}throw n}export{T as ccipRequest,he as offchainLookup,G as offchainLookupAbiItem,ue as offchainLookupSignature};
