import{B as u,h,s as y,i as k,j as b,k as O,l as E,n as L,H as l,o as x}from"./provider-Bivj5s9h.js";import"./jsx-runtime-BlAj40OV.js";import"./index-Cs7sjTYM.js";import"./_commonjsHelpers-BosuxZz1.js";import"./LoadingProvider-CI5XcxPx.js";import"./functional-BRpe52oq.js";import"./string-CcoL8872.js";import"./DateTimeFormattersProvider-UwNlAqY8.js";import"./LocaleProvider-B0_30C1H.js";import"./NavDrawerStateProvider-HpepdHmi.js";import"./NowProvider-D4xjbY-7.js";import"./NumberFormattersProvider-DANbX_lC.js";import"./PathResolverProvider-Xv58eOQd.js";import"./ByteSizeText-Dv1cMyzR.js";import"./TransactionsPerSecondText-C7pMj7u0.js";import"./base64-pX9cPfQ1.js";import"./CopyButton-BP2n2S2V.js";import"./higher_order-DnPEgWEz.js";import"./CheckCircle-CjHLze1Z.js";import"./SVGIconBase-BLfr-WpK.js";import"./Copy-BuMhWLDb.js";/* empty css               */import"./CopyHex-BYDmIsAM.js";import"./array_buffer-BDyIh9Vn.js";import"./DateTimeText-nfJttqAO.js";import"./FullHexText-BoJGKrEx.js";import"./HexText-Dw92hmJ-.js";import"./MoneyText-B78eRiA1.js";import"./NumberText-C4Z_0tU7.js";import"./RelativeTimeText-MUfD-2Qu.js";import"./TaggedBase64Text-0Q1D1i_-.js";import"./Text-BU7JBOLk.js";import"./TimeText-D4oQFb1K.js";import"./TwitterIcon-Dh1ClDTH.js";import"./ArrowRight-BpPdMFVT.js";import"./ExternalLink-DiyMX6Il.js";import"./ChevronUp-Qp9B62nF.js";import"./MediumIcon-kdAvEjBJ.js";import"./EspressoLogo-DwD84bVM.js";import"./EspressoLogoAndTitle-2fto-X4z.js";import"./Menu-CvkQcfaP.js";import"./SearchGlass-BTYiCYPh.js";import"./AsyncIterableResolver-8WJfBgMI.js";import"./ProvideAsyncStates-569m2cze.js";import"./url-D2X_Lhsq.js";import"./iframe-DDBgw1If.js";import"../sb-preview/runtime.js";import"./index-DJFdew98.js";class M extends u{constructor({callbackSelector:a,cause:e,data:s,extraData:p,sender:c,urls:r}){var n;super(e.shortMessage||"An error occurred while fetching for an offchain result.",{cause:e,metaMessages:[...e.metaMessages||[],(n=e.metaMessages)!=null&&n.length?"":[],"Offchain Gateway Call:",r&&["  Gateway URL(s):",...r.map(m=>`    ${h(m)}`)],`  Sender: ${c}`,`  Data: ${s}`,`  Callback selector: ${a}`,`  Extra data: ${p}`].flat(),name:"OffchainLookupError"})}}class R extends u{constructor({result:a,url:e}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${h(e)}`,`Response: ${y(a)}`],name:"OffchainLookupResponseMalformedError"})}}class S extends u{constructor({sender:a,to:e}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${e}`,`OffchainLookup sender address: ${a}`],name:"OffchainLookupSenderMismatchError"})}}const xt="0x556f1830",$={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function Mt(i,{blockNumber:a,blockTag:e,data:s,to:p}){const{args:c}=k({data:s,abi:[$]}),[r,n,m,d,o]=c,{ccipRead:t}=i,w=t&&typeof(t==null?void 0:t.request)=="function"?t.request:T;try{if(!b(p,r))throw new S({sender:r,to:p});const f=await w({data:m,sender:r,urls:n}),{data:g}=await O(i,{blockNumber:a,blockTag:e,data:E([d,L([{type:"bytes"},{type:"bytes"}],[f,o])]),to:p});return g}catch(f){throw new M({callbackSelector:d,cause:f,data:s,extraData:o,sender:r,urls:n})}}async function T({data:i,sender:a,urls:e}){var p;let s=new Error("An unknown error occurred.");for(let c=0;c<e.length;c++){const r=e[c],n=r.includes("{data}")?"GET":"POST",m=n==="POST"?{data:i,sender:a}:void 0,d=n==="POST"?{"Content-Type":"application/json"}:{};try{const o=await fetch(r.replace("{sender}",a).replace("{data}",i),{body:JSON.stringify(m),headers:d,method:n});let t;if((p=o.headers.get("Content-Type"))!=null&&p.startsWith("application/json")?t=(await o.json()).data:t=await o.text(),!o.ok){s=new l({body:m,details:t!=null&&t.error?y(t.error):o.statusText,headers:o.headers,status:o.status,url:r});continue}if(!x(t)){s=new R({result:t,url:r});continue}return t}catch(o){s=new l({body:m,details:o.message,url:r})}}throw s}export{T as ccipRequest,Mt as offchainLookup,$ as offchainLookupAbiItem,xt as offchainLookupSignature};
