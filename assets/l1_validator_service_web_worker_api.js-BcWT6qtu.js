(function(){"use strict";class ls{assert(){}}function hs(){return new ls}const us=hs();function x(t,e){us.assert(t,e)}function De(t,e){x(typeof t===e,`type assertion failed: expected "${e}", received "${typeof t}"`)}function ws(t){x(t!==null,"expected a non-null value, received null")}function y(t,e){x(t instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof t=="object"&&t!==null?t.constructor.name:typeof t}"`)}class Le extends Error{key;haveType;constructor(e,r,o=`expected object with key: "${r}", instead found ${e}`){super(o),this.haveType=e,this.key=r,Object.freeze(this)}toJSON(){return{code:Le.name,message:this.message,have:this.haveType,key:this.key}}}class Je{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class s extends Je{}function Lr(t){return typeof t=="number"}function he(t){return typeof t=="string"}function fs(t){return typeof t=="bigint"}function gs(t){return typeof t=="object"&&t!==null}function ps(t){return t!==void 0}function ms(t,e){return Array.isArray(t)&&t.every(e)}function vs(t){return e=>ms(e,t)}function X(t,...e){return gs(t)&&e.every(r=>r in t)}function a(t,...e){if(typeof t!="object")throw new Error("expected object");if(t===null)throw new Error("received null");for(const r of e)if(!(r in t))throw new Le("object",r)}function m(t,e){if(!he(t.code))throw new Error("code must be a string");if(t.code!==e)throw new Error(`expected code to be ${e}, got ${t.code}`)}class p extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return L.convert(this)}}class U{convert(e){return y(e,p),{code:e.code,message:e.message}}}const L=new U,ys="NoCodecFoundError";class ue extends Error{codec;constructor(e,r=`no codec found for: "${e}"`){super(r),this.codec=e,Object.freeze(this);debugger}toJSON(){return{code:c.encode(ue.name),message:c.encode(this.message),codec:c.encode(this.codec)}}get code(){return ys}}const Me=new Map;class Es{convert(e){a(e,"code");const r=c.decode(e.code),o=Me.get(r);if(!o)throw new ue(r);return o.decode(e)}}class Cs{convert(e){const r=Me.get(e.code);if(!r)throw new ue(e.code);return r.encode(e)}}class Ss extends Je{encoder=new Cs;decoder=new Es}const we=new Ss;function v(t,e){Me.set(t,e)}const Ve="InvalidTypeError";class C extends p{have;want;constructor(e,r,o=`invalid type: have "${e}", want "${r}"`){super(o),this.have=e,this.want=r,Object.freeze(this)}toJSON(){return Jr.encode(this)}get code(){return Ve}}class bs{convert(e){return a(e,"code","have","want","message"),m(e,Ve),new C(c.decode(e.have),c.decode(e.want),c.decode(e.message))}}class xs{convert(e){return y(e,C),{...L.convert(e),have:c.encode(e.have),want:c.encode(e.want)}}}class ks extends s{encoder=new xs;decoder=new bs}const Jr=new ks;v(Ve,Jr);const Ns=vs(ps);class Is{convert(e){return e}}const Mr=new Is;class Bs extends Je{encoder=Mr;decoder=Mr}const fe=new Bs;class k{itemCodec;constructor(e){this.itemCodec=e}convert(e){if(!Ns(e)){const r=typeof e=="object"&&e!==null?e.constructor.name:typeof e,o="array";throw new Error(`invalid array value: have "${r}", want "${o}"`)}return e.map(r=>this.itemCodec.decode(r))}}class N{itemCodec;constructor(e){this.itemCodec=e}convert(e){return y(e,Array),e.map(r=>this.itemCodec.encode(r))}}class I extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}}class J{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class M{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:(ws(e),this.itemCodec.encode(e))}}class V extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}}class Rs{convert(e){if(!he(e))throw new C(typeof e,"string");return e}}class Os{convert(e){return De(e,"string"),e}}class Us extends s{encoder=new Os;decoder=new Rs}const c=new Us;new I(new k(c),new N(c)),new V(new J(c),new M(c));class Pe extends p{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return Vr}}const Vr="CompleterAlreadyCompletedError";class As{convert(e){return a(e,"code","message"),m(e,Vr),new Pe(c.decode(e.message))}}class Ds extends U{}class Ls extends s{encoder=new Ds;decoder=new As}const Js=new Ls;v(Pe.name,Js);function ge(){return x(!1,"completer is not ready, this should never be reached")}function pe(){throw new Pe}class Ms{resolve=ge;reject=ge;completed=!1;promise;get isCompleted(){return this.completed}constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r}),x(this.resolve!==ge,"resolve should be set"),x(this.reject!==ge,"resolve should be set")}complete(e){const r=this.resolve,o=this.reject;if(this.completed=!0,this.resolve=pe,this.reject=pe,e instanceof Promise){e.then(r,o);return}r(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=pe,this.reject=pe}}function Te(){return new Ms}class Z extends p{response;status;constructor(e,r,o){super(o),this.status=e,this.response=r}toJSON(){return Pr.convert(this)}}class me{convert(e){return y(e,Z),{...L.convert(e),status:e.status}}}const Pr=new me,Fe="BadResponseClientError";class Tr extends Z{constructor(e,r,o="bad server response: client error"){super(e,r,o),Object.freeze(this)}get code(){return Fe}toJSON(){return Fr.encode(this)}}class Vs{convert(e){return a(e,"code","message","status"),m(e,Fe),new Tr(Number(e.status),null,c.decode(e.message))}}class Ps extends me{}class Ts extends s{encoder=new Ps;decoder=new Vs}const Fr=new Ts;v(Fe,Fr);const _e="BadResponseError";class _r extends Z{constructor(e,r,o="bad server response"){super(e,r,o),Object.freeze(this)}get code(){return _e}toJSON(){return zr.encode(this)}}class Fs{convert(e){return a(e,"code","message","status"),m(e,_e),new _r(Number(e.status),null,c.decode(e.message))}}class _s extends me{}class zs extends s{encoder=new _s;decoder=new Fs}const zr=new zs;v(_e,zr);class Wr extends Z{constructor(e,r,o="bad server response: server error"){super(e,r,o),Object.freeze(this)}get code(){return ze}}const ze="BadResponseServerError";class Ws{convert(e){return a(e,"code","message","status"),m(e,ze),new Wr(Number(e.status),null,c.decode(e.message))}}class js extends me{}class qs extends s{encoder=new js;decoder=new Ws}const Hs=new qs;v(ze,Hs);const We="ChannelClosedError";class Y extends p{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return We}}class $s{convert(e){return a(e,"code","message"),m(e,We),new Y(c.decode(e.message))}}class Ks extends U{}class Qs extends s{encoder=new Ks;decoder=new $s}const Gs=new Qs;v(We,Gs);const je="FetchError";class jr extends p{cause;constructor(e,r=`fetch failed: ${String(e)}`){super(r),this.cause=e,Object.freeze(this)}get code(){return je}}class Xs{convert(e){return a(e,"code","message"),m(e,je),new jr({},c.decode(e.message))}}class Zs extends U{}class Ys extends s{encoder=new Zs;decoder=new Xs}const ec=new Ys;v(je,ec);const qe="IncorrectBase64PaddingError";class qr extends p{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return qe}}class tc{convert(e){return a(e,"code","message"),m(e,qe),new qr(c.decode(e.message))}}class rc extends U{}class oc extends s{encoder=new rc;decoder=new tc}const nc=new oc;v(qe,nc);class sc{convert(e){if(!Lr(e))throw new C(typeof e,"number");return e}}class cc{convert(e){return De(e,"number"),e}}class ac extends s{encoder=new cc;decoder=new sc}const E=new ac,H=new V(new J(E),new M(E));new I(new k(E),new N(E)),new I(new k(H),new N(H));const He="InvalidBase64AlphabetLengthError";class $e extends p{length;constructor(e,r=`alphabet needs to be 64 characters, received ${e}`){super(r),this.length=e,Object.freeze(this)}toJSON(){return Hr.encode(this)}get code(){return He}}class dc{convert(e){return a(e,"code","length","message"),m(e,He),new $e(E.decode(e.length),c.decode(e.message))}}class ic{convert(e){return y(e,$e),{...L.convert(e),length:E.encode(e.length)}}}class lc extends s{encoder=new ic;decoder=new dc}const Hr=new lc;v(He,Hr);const Ke="InvalidHexStringError";class $r extends p{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return Ke}}class hc{convert(e){return a(e,"code","message"),m(e,Ke),new $r(c.decode(e.message))}}class uc extends U{}class wc extends s{encoder=new uc;decoder=new hc}const fc=new wc;v(Ke,fc);const Qe="InvalidHexValueError";class Kr extends p{value;constructor(e,r=`invalid hex value "${e}"`){super(r),this.value=e,Object.freeze(this)}toJSON(){return Qr.encode(this)}get code(){return Qe}}class gc{convert(e){return a(e,"code","value","message"),m(e,Qe),new Kr(E.decode(e.value),c.decode(e.message))}}class pc{convert(e){return{...L.convert(e),value:E.encode(e.value)}}}class mc extends s{encoder=new pc;decoder=new gc}const Qr=new mc;v(Qe,Qr);const Ge="InvalidInputError";class ee extends p{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return Ge}}class vc{convert(e){return a(e,"code","message"),m(e,Ge),new ee(c.decode(e.message))}}class yc extends U{}class Ec extends s{encoder=new yc;decoder=new vc}const Cc=new Ec;v(Ge,Cc);const Xe="InvalidStringValueError";class Gr extends p{have;want;constructor(e,r,o=`invalid string value: have "${e}", want "${r}"`){super(o),this.have=e,this.want=r,Object.freeze(this)}toJSON(){return Xr.encode(this)}get code(){return Xe}}class Sc{convert(e){return a(e,"code","have","want","message"),m(e,Xe),new Gr(c.decode(e.have),c.decode(e.want),c.decode(e.message))}}class bc{convert(e){return y(e,Gr),{...L.convert(e),have:c.encode(e.have),want:c.encode(e.want)}}}class xc extends s{encoder=new bc;decoder=new Sc}const Xr=new xc;v(Xe,Xr);const Ze="InvalidTaggedBase64EncodingError";class Zr extends p{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return Yr.encode(this)}get code(){return Ze}}class kc{convert(e){return a(e,"code","message"),m(e,Ze),new Zr(c.decode(e.message))}}class Nc extends U{}class Ic extends s{encoder=new Nc;decoder=new kc}const Yr=new Ic;v(Ze,Yr);const Ye="MissingElementError";class ve extends p{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return Ye}}class Bc{convert(e){return a(e,"code","message"),m(e,Ye),new ve(c.decode(e.message))}}class Rc extends U{}class Oc extends s{encoder=new Rc;decoder=new Bc}const Uc=new Oc;v(Ye,Uc);const et="NoCompleterFoundForRequestID";class eo extends p{requestID;constructor(e,r=`no completer found for request id "${e}"`){super(r),this.requestID=e,Object.freeze(this)}toJSON(){return to.encode(this)}get code(){return et}}class Ac{convert(e){return a(e,"code","requestID","message"),m(e,et),new eo(fe.decode(e.requestID),c.decode(e.message))}}class Dc{convert(e){return y(e,eo),{...L.convert(e),requestID:fe.encode(e.requestID)}}}class Lc extends s{encoder=new Dc;decoder=new Ac}const to=new Lc;v(et,to);const tt="NotFoundError";class Jc extends p{key;constructor(e,r=`Not Found: ${e}`){super(r),this.key=e,Object.freeze(this)}get code(){return tt}}class ro{codec;constructor(e){this.codec=e}convert(e){return a(e,"code","key"),m(e,tt),new Jc(this.codec.decode(e.key))}}class oo{codec;constructor(e){this.codec=e}convert(e){return{...L.convert(e),key:this.codec.encode(e.key)}}}class no extends s{encoder;decoder;constructor(e,r){super(),this.encoder=e,this.decoder=r}}new no(new oo(c),new ro(c));const Mc=new no(new oo(fe),new ro(fe));v(tt,Mc);const rt="NoURLProvidedError";class Vc extends p{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return rt}}class Pc{convert(e){return a(e,"code","message"),m(e,rt),new Vc(c.decode(e.message))}}class Tc extends U{}class Fc extends s{encoder=new Tc;decoder=new Pc}const _c=new Fc;v(rt,_c);const ot="UnimplementedError";class A extends p{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return ot}}class zc{convert(e){return a(e,"code","message"),m(e,ot),new A(c.decode(e.message))}}class Wc extends U{}class jc extends s{encoder=new Wc;decoder=new zc}const qc=new jc;v(ot,qc);const nt="QUERY_ERROR";class Hc extends p{error;constructor(e,r="missing element"){super(r),this.error=e,Object.freeze(this)}get code(){return nt}}class $c{convert(e){return a(e,"code","error","message"),m(e,nt),new Hc(io.decode(e.error),c.decode(e.message))}}class Kc{convert(e){return{code:e.code,error:io.encode(e.error),message:c.encode(e.message)}}}class Qc extends s{encoder=new Kc;decoder=new $c}const Gc=new Qc;class st{}const ct="NotFound";class so extends st{constructor(){super(),Object.freeze(this)}valueOf(){return ct}toJSON(){return this.valueOf()}}const Xc=new so,at="Missing";class co extends st{constructor(){super(),Object.freeze(this)}valueOf(){return at}toJSON(){return this.valueOf()}}const Zc=new co;class ao extends st{error;constructor(e){super(),this.error=e,Object.freeze(this)}toJSON(){return it.encode(this)}}class Yc{message;constructor(e){this.message=e,Object.freeze(this)}toJSON(){return dt.encode(this)}}class ea{convert(e){return a(e,"message"),new Yc(c.decode(e.message))}}class ta{convert(e){return{message:c.encode(e.message)}}}class ra extends s{encoder=new ta;decoder=new ea}const dt=new ra;class oa{convert(e){return a(e,"Error"),new ao(dt.decode(e.Error))}}class na{convert(e){return{Error:dt.encode(e.error)}}}class sa extends s{encoder=new na;decoder=new oa}const it=new sa;class ca{convert(e){return e===ct?Xc:e===at?Zc:it.decode(e)}}class aa{convert(e){if(e instanceof so)return ct;if(e instanceof co)return at;if(e instanceof ao)return it.encode(e);throw new A}}class da extends s{encoder=new aa;decoder=new ca}const io=new da;v(nt,Gc);const lo="ResponseContentTypeIsNotApplicationJSONError";class te extends Z{haveHeaderType;constructor(e,r,o,n="response content type is not application/json"){super(r,o,n),this.haveHeaderType=e,Object.freeze(this)}static fromResponse(e,r){return new te(e.headers.get("content-type")??"undefined",e.status,e,r)}toJSON(){return ho.encode(this)}get code(){return lo}}class ia{convert(e){return a(e,"code","status","have","want","message"),m(e,lo),new te(c.decode(e.code),E.decode(e.status),null,c.decode(e.message))}}class la{convert(e){return{...Pr.convert(e),have:c.encode(e.haveHeaderType),want:c.encode("application/json")}}}class ha extends s{encoder=new la;decoder=new ia}const ho=new ha;v(te.name,ho);const lt="WebWorkerErrorResponse";class ua extends p{error;constructor(e,r="error in web worker"){super(r),this.error=e,Object.freeze(this)}toJSON(){return uo.encode(this)}get code(){return lt}}class wa{convert(e){return a(e,"code","error","message"),m(e,lt),new ua(we.decode(e.error),c.decode(e.message))}}class fa{convert(e){return{...L.convert(e),error:we.encode(e.error)}}}class ga extends s{encoder=new fa;decoder=new wa}const uo=new ga;v(lt,uo);var wo=(t=>(t[t.success=0]="success",t[t.full=1]="full",t[t.failed=2]="failed",t))(wo||{});class pa{getFromEmpty(){}}class ma{getFromEmpty(){throw new ve}}const fo={returnUndefined:new pa,throwMissingElement:new ma};class va{maxSize;constructor(e){x(!Number.isNaN(e),"maxSize must not be NaN"),x(Number.isInteger(e),"maxSize must be an integer"),x(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return x(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class ya{preComputedSizeMinus1;constructor(e){x(!Number.isNaN(e),"maxSize must not be NaN"),x(Number.isInteger(e),"maxSize must be an integer"),x(e>0,"maxSize must be greater than 0"),x(go(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return x(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function go(t){return(t&t-1)===0}const ht="BufferFullError";class po extends p{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return ht}}class Ea{convert(e){return a(e,"code","message"),m(e,ht),new po(c.decode(e.message))}}class Ca extends U{}class Sa extends s{encoder=new Ca;decoder=new Ea}const ba=new Sa;v(ht,ba);class xa{putToFull(e,r){return e.get(),e.put(r)}}class ka{putToFull(){throw new po}}const mo={overwriteOldest:new xa,throw:new ka};function Na(t){return go(t)?new ya(t):new va(t)}class Ia{readIndex=0;writeIndex=0;buffer;nextIndex;getOnEmpty;putOnFull;constructor(e,r,o){x(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=Na(e),this.getOnEmpty=r,this.putOnFull=o}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const r=this.nextIndex.nextIndex(this.writeIndex);return r===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=r,wo.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new Ba(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new Ra(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class Ba{buffer;constructor(e){this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class Ra{readIndex;writeIndex;buffer;nextIndex;constructor(e,r,o,n){this.readIndex=e,this.writeIndex=r,this.buffer=o,this.nextIndex=n}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function Oa(t=32,e=fo.returnUndefined,r=mo.overwriteOldest){return new Ia(t,e,r)}class Ua{publishQueue;pollBlocked;publishBlocked;capacity;closed=!1;constructor(e){this.publishQueue=Oa(Math.max(2,e),fo.throwMissingElement,mo.throw);const r=Te();this.pollBlocked=r,this.publishBlocked=r,r.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new Y;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new Y;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const r=Te();this.publishBlocked=r,await r.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new Y;if(this.pollBlocked.isCompleted){const r=Te();this.pollBlocked=r}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new Aa(this)}}class Aa{channel;constructor(e){this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof Y)return{done:!0,value:void 0};throw e}}}function Da(t){return new Ua(t)}class La{async getBlockForHeight(){throw new A}}class F{constructor(e,r,o){this.alpha3Code=e,this.code=r,this.significantDigits=o,this.alpha3Code=e,this.code=r,this.significantDigits=o,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}significantDigitsMultiplier;toJSON(){return ye.encode(this)}}const vo=new F("JPY",392,0),Ja=new F("GBP",826,2),yo=new F("USD",840,2),Ma=new F("EUR",978,2),Va=new F("XXX",999,2),Eo=new F("ETH",1001,18),ut=new F("XBT",1002,8),Co=new F("ESP",10001,18),Pa=[vo,Ja,yo,Ma,Va,Eo,ut,Co],Ta=new Map(Pa.map(t=>[t.alpha3Code,t]));class Fa{convert(e){if(typeof e!="string")throw new ee("CurrencyCodeDecoder: expected string");if(e==="BTC")return ut;const r=Ta.get(e);if(r===void 0)throw new ee(`CurrencyCodeDecoder: unknown currency: "${e}"`);return r}}class _a{convert(e){return y(e,F),e.alpha3Code}}class za extends s{decoder=new Fa;encoder=new _a}const ye=new za;class P{constructor(e,r){this.currency=e,this.value=r,this.currency=e,this.value=r}static USD(e){return new P(yo,BigInt(e))}static ETH(e){return new P(Eo,BigInt(e))}static ESP(e){return new P(Co,BigInt(e))}static JPY(e){return new P(vo,BigInt(e))}static BTC(e){return new P(ut,BigInt(e))}toString(){return Ee.encode(this)}toJSON(){return Ee.encode(this)}}function Wa(t){return t==="."||t===","||t===" "}function ja(t,e){let r=-1;const o=t.length;for(let n=0;n<o;n++)e(t[n])&&(r=n);return r}class qa{parseCurrencyCode(e){return ye.decode(e)}parseValue(e,r){let o=1n;r[0]==="-"&&(o=-1n,r=r.substring(1));const n=ja(r,Wa);if(n===-1){const l=BigInt(r.replace(/\D/g,""))*e.significantDigitsMultiplier;return o*l}const d=r.substring(0,n).replace(/\D/g,""),i=r.substring(n+1).replace(/\D/g,""),h=BigInt(d)*e.significantDigitsMultiplier,f=BigInt(i)*10n**BigInt(e.significantDigits-i.length);return o*(h+f)}convert(e){if(typeof e!="string")throw new ee("MonetaryValueDecoder: expected string");const r=e.indexOf(" ");if(r<=-1)throw new ee("MonetaryValueDecoder: missing non-breaking space");const o=e.substring(0,r),n=e.substring(r+1);if(/^-?[\d .,]+$/.test(o)){const i=this.parseCurrencyCode(n);return new P(i,this.parseValue(i,o))}const d=this.parseCurrencyCode(o);return new P(d,this.parseValue(d,n))}}class Ha{convert(e){y(e,P);const r=e.value<0n?"-":"",o=e.value<0n?-e.value:e.value,n=o%e.currency.significantDigitsMultiplier,d=o/e.currency.significantDigitsMultiplier,i=String(d),h=String(n);return/^0+$/.test(h)?`${ye.encode(e.currency)} ${r}${i}`:`${ye.encode(e.currency)} ${r}${d}.${String(n).padStart(e.currency.significantDigits,"0")}`}}class $a extends s{decoder=new qa;encoder=new Ha}const Ee=new $a;new I(new k(Ee),new N(Ee));class g{namespace;name;site;blockExplorer;constructor(e,r,o,n){this.namespace=e,this.name=r,this.site=o,this.blockExplorer=n}}const Ka=new g(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),Qa=new g(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),Ga=new g(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),Xa=new g(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),Za=new g(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),Ya=new g(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),ed=new g(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),td=new g(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),rd=new g(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),od=new g(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),nd=new g(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),sd=1918988905,cd=new g(sd,"RARI",new URL("https://rarichain.org/"),new URL("https://explorer.rarichain.org/")),ad=1380012617,dd=new g(ad,"RARI",new URL("https://rarichain.org/"),new URL("https://mainnet.explorer.rarichain.org/")),id=9369,ld=new g(id,"LogX",new URL("https://logx.network/"),new URL("https://kartel-testnet-explorer.alt.technology/")),hd=936369,ud=new g(hd,"LogX",new URL("https://logx.network/"),new URL("https://vzjuxmhfn70kgnlds27h-explorer.alt.technology")),wd=466,fd=new g(wd,"AppChain",new URL("https://appchain.xyz/"),new URL("https://explorer.appchain.xyz/")),gd=4661,pd=new g(gd,"AppChain",new URL("https://appchain.xyz/"),new URL("https://appchaintestnet.explorer.caldera.xyz/")),md=360,vd=new g(md,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),yd=3609,Ed=new g(yd,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Cd=33139,Sd=new g(Cd,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apescan.io/")),bd=3313939,xd=new g(bd,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apechain-testnet.explorer.caldera.xyz/")),kd=13107,Nd=new g(kd,"t3rn",new URL("https://t3rn.io/"),new URL("https://brn-testnet.explorer.caldera.xyz/")),Id=819,Bd=new g(Id,"t3rn",new URL("https://t3rn.io/"),new URL("https://exporer.t3rn.io/")),So=21341,Rd=new g(So,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus-sepolia-testnet.explorer.caldera.xyz/")),Od=new g(So,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus.calderaexplorer.xyz/")),Ud=2524852,Ad=new g(Ud,"Huddle01",new URL("https://huddle01.com/"),new URL("https://hudlscan.com/txs")),Dd=1397311310,bo=new g(Dd,"Infinite Garden",new URL("https://infinitegarden.espressosys.com/"),new URL("https://explorer.main.net.espressosys.com/")),Ld=10101,Jd=new g(Ld,"Timeboost Decaf",new URL("https://espressosys.com/"),new URL("https://explorer.decaf.testnet.espresso.network/")),Md=[bo,dd,ud,vd,fd,Sd,Bd,Od],Vd=[bo,cd,ld,pd,Ed,xd,Nd,Rd,Ad,Jd],Pd=new Map([Ka,Qa,Ga,rd,Xa,Za,Ya,ed,td,od,nd,...Md,...Vd].map(t=>[t.namespace,t])),wt="CorruptBase64InputError";class _ extends p{offset;constructor(e,r=`corrupt input error at ${e}`){super(r),this.offset=e,Object.freeze(this)}get code(){return wt}toJSON(){return xo.encode(this)}}class Td{convert(e){return a(e,"code","offset","message"),m(e,wt),new _(E.decode(e.offset),c.decode(e.message))}}class Fd{convert(e){return y(e,_),{...L.convert(e),offset:E.encode(e.offset),message:c.encode(e.message)}}}class _d extends s{encoder=new Fd;decoder=new Td}const xo=new _d;v(wt,xo);class zd{convert(e){const r=new ArrayBuffer(e.byteLength);return new Uint8Array(r).set(e),r}}class Wd{convert(e){return new Uint8Array(e)}}class jd extends s{encoder=new zd;decoder=new Wd}const ft=new jd,qd=new TextEncoder;function ko(t){return qd.encode(t)}const Hd=new TextDecoder;function $d(t){return Hd.decode(t)}function*No(t){yield*ko(t)}function*Kd(){for(let t=0;t<256;t++)yield 255}const re=-1,Qd=61;class oe{encodeMap;decodeMap;padChar;strict;constructor(e,r,o=Qd,n=!1){this.encodeMap=e,this.decodeMap=r,this.padChar=o,this.strict=n}static withAlphabet(e){const r=e.length;if(r!==64)throw new $e(r);const o=Array.from(No(e)),n=Array.from(Kd());for(let d=0;d<r;d++)n[o[d]]=d;return new oe(o,n)}withPadding(e){return new oe(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let r=0,o=0;const n=Math.floor(e.byteLength/3)*3,d=Math.ceil(e.byteLength/3)*4,i=new ArrayBuffer(d),h=new DataView(e),f=new DataView(i);for(;o<n;){const B=h.getUint8(o+0)<<16|h.getUint8(o+1)<<8|h.getUint8(o+2);f.setUint8(r+0,this.encodeMap[B>>18&63]),f.setUint8(r+1,this.encodeMap[B>>12&63]),f.setUint8(r+2,this.encodeMap[B>>6&63]),f.setUint8(r+3,this.encodeMap[B&63]),o+=3,r+=4}const l=e.byteLength-o;if(l===0)return i;let b=h.getUint8(o+0)<<16;switch(l===2&&(b|=h.getUint8(o+1)<<8),f.setUint8(r+0,this.encodeMap[b>>18&63]),f.setUint8(r+1,this.encodeMap[b>>12&63]),l){case 2:return f.setUint8(r+2,this.encodeMap[b>>6&63]),this.padChar!==re?(f.setUint8(r+3,this.padChar),i.slice(0,r+4)):i.slice(0,r+3);case 1:if(this.padChar!==re)return f.setUint8(r+2,this.padChar),f.setUint8(r+3,this.padChar),i.slice(0,r+4);break}return i.slice(0,r+2)}decode(e){const r=e.byteLength;if(r===0)return new ArrayBuffer(0);const o=new DataView(e),n=new ArrayBuffer(Math.floor(r/4*3)),d=new DataView(n),i=new ArrayBuffer(4),h=new DataView(i);let f=0,l=0,b=0,B=!1;for(;l<r&&!B;){let w=3,u=4;for(let O=0;O<4;O++){if(l===r){if(O===0)return n;if(O===1||this.padChar!==re)throw new _(l-O);w=O-1,u=O,B=!0;break}const q=o.getUint8(l);l++;const le=this.decodeMap[q];if(le!==255){h.setUint8(O,le);continue}if(q===10||q===13){O--;continue}if(q===this.padChar){switch(O){case 0:case 1:throw new qr;case 2:for(;l<r&&(o.getUint8(l)===10||o.getUint8(l)===13);)l++;if(l===r)throw new _(r);l++}for(;l<r&&(o.getUint8(l)===10||o.getUint8(l)===13);)l++;if(l<r)throw new _(l);w=3,u=O,B=!0;break}throw new _(l-1)}const G=h.getUint8(0)<<18|h.getUint8(1)<<12|h.getUint8(2)<<6|h.getUint8(3);switch(h.setUint8(2,G>>0&255),h.setUint8(1,G>>8&255),h.setUint8(0,G>>16&255),u){case 4:d.setUint8(b+2,h.getUint8(2)),h.setUint8(2,0);case 3:if(d.setUint8(b+1,h.getUint8(1)),this.strict&&h.getUint8(2)!==0)throw new _(l-1);case 2:if(d.setUint8(b+0,h.getUint8(0)),this.strict&&(h.getUint8(1)!==0||h.getUint8(2)!==0))throw new _(l-2)}b+=w,f+=u-1}return n.slice(0,f)}decodeString(e){return this.decode(ft.encode(ko(e)))}encodeToString(e){return $d(this.encode(e))}}const Io=oe.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Gd=Io.withPadding(re),Bo=oe.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),gt=Bo.withPadding(re);class T{tag;data;constructor(e,r){this.tag=e,this.data=r}static fromString(e){const r=e.indexOf("~");if(r<0)throw new Zr;const o=e.substring(0,r),n=gt.decodeString(e.substring(r+1));return new T(o,n)}static inflate(e){return D.decode(e)}toString(){return`${this.tag}~${gt.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class Xd{convert(e){if(typeof e!="string")throw new C(typeof e,"string");return T.fromString(e)}}class Zd{convert(e){return y(e,T),e.toString()}}class Yd extends s{encoder=new Zd;decoder=new Xd}const D=new Yd,ne=2147483648,ei=1103515245,ti=12345;class Ce{state;constructor(e){this.state=e!==void 0?e:Math.floor(Math.random()*(ne-1))}nextInt(){return this.state=(ei*this.state+ti)%ne,this.state}nextFloat(){return this.nextInt()/(ne-1)}nextRange(e,r){const o=r-e,n=this.nextInt()/ne;return e+Math.floor(n*o)}nextRangeBigInt(e,r){const o=r-e,n=BigInt(this.nextInt())*1000000n/BigInt(ne);return e+n*o/1000000n}fillBytes(e){const r=new ArrayBuffer(e),o=new DataView(r);let n=0;for(;n<e-4;n+=4)o.setUint32(n,this.nextRange(0,4294967295));for(let d=n;d<e;d++)o.setUint8(d,this.nextRange(0,256));return r}}const Se=new Date,ri=new Date(Se.getFullYear(),Se.getMonth(),Se.getDate()).valueOf();function oi(){return Se.valueOf()}function pt(){return ri}function*ni(t,e){for(let r=t.next();!r.done;r=t.next())e(r.value)&&(yield r.value)}function si(t,e){return ni(t[Symbol.iterator](),e)}function*Ro(t,e){for(let r=t.next();!r.done;r=t.next())yield e(r.value)}function be(t,e){return Ro(t[Symbol.iterator](),e)}function*ci(t,e){for(let r=0;r<e;r++){const o=t.next();if(o.done)return;yield o.value}}function ai(t,e){return ci(t[Symbol.iterator](),e)}function di(t){let e;for(let r=t.next();!r.done;r=t.next())e=r.value;if(e===void 0)throw new ve;return e}function ii(t){return di(t[Symbol.iterator]())}function*li(t,e){for(let r=t.next();!r.done;r=t.next())yield*e(r.value)}function hi(t,e){return li(t[Symbol.iterator](),e)}function*ui(){let t=0;for(;;)yield t++}function wi(t){return ai(ui(),Math.ceil(t))}function*fi(t,e,r){for(let o=t.next(),n=e.next();!o.done&&!n.done;o=t.next(),n=e.next())yield r(o.value,n.value)}function Oo(t,e,r){return fi(t[Symbol.iterator](),e[Symbol.iterator](),r)}const Uo=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],Ao=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],Do=["Linux","Unix","Windows","MacOS"],Lo=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],gi=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],Jo=[0,0,5,26,28,26,9,6],pi=Jo.reduce((t,e)=>t+e,0),mi=Jo.reduce((t,e)=>{const r=t[t.length-1]??0;return t.push(r+e),t},[]),vi=Array.from(Oo(mi,gi,(t,e)=>[t,e]));function yi(t){const e=t.nextRange(0,pi),r=si(vi,([i])=>i<=e),[,o]=ii(r),n=t.nextRange(0,o.length);return o[n]}function Ei(t){const e=t.nextRange(0,Lo.length);return Lo[e]}function Ci(t){const e=t.nextRange(0,Do.length);return Do[e]}function Si(t){const e=t.nextRange(0,Ao.length);return Ao[e]}function bi(t){const e=t.nextRange(0,Uo.length);return Uo[e]}function xi(t){const[e,r]=Ei(t),[,o,n,d]=yi(t),i=Ci(t),h=Si(t),f=bi(t);return{pubkey:new T("PUBKEY",t.fillBytes(32)),stateVerKey:new T("STATE_VER_KEY",t.fillBytes(32)),stake:t.nextRangeBigInt(0n,1000n)*1000000000000000000n,commission:t.nextRange(0,5e3),name:`${e} Node ${d} ${t.nextRange(0,100)}`,address:t.fillBytes(32),company:{name:e,website:r},location:{coords:[o,n],country:d},operatingSystem:i,networkType:f,nodeType:h}}function*ki(t=new Ce(pt())){const e=t.nextRange(100,350);for(let r=0;r<e;r++)yield xi(t)}const se=Array.from(ki());async function*Ni(){}function Ii(){const t=new Uint8Array(new Array(20).map(()=>0)).buffer;return{hash:new T("BLOCK",t),height:0,time:new Date(0),genTime:0,transactions:Ni(),numTransactions:0,proposer:[],size:0,fees:[]}}async function*Bi(t){let e=1,r=pt();const o=oi();for(;r<o;){const n=Math.floor(t.nextFloat()*14*1e3);yield Oi(new Ce(e+n),e,r,r+n),r+=n,e++}}async function*Ri(t=new Ce(pt())){yield Ii(),yield*Bi(t)}function Oi(t,e,r,o){const n=Math.floor(t.nextRange(0,5)),d=t.nextRange(0,se.length),i=se[d];return{hash:new T("BLOCK",t.fillBytes(32)),height:e,genTime:o-r,time:new Date(o),numTransactions:n,transactions:Ai(new Ce(e+r),e,r,o,n),proposer:[i.address],size:Math.floor(t.nextFloat()*1024*n)+8,fees:[P.ESP(BigInt(t.nextRange(0,1e9)*1e3))]}}const Mo=Array.from(Pd.keys());function Ui(t){return t.nextFloat()>.98?1:Mo[t.nextRange(0,Mo.length)]}async function*Ai(t,e,r,o,n){const d=(o-r)/n;for(let i=0,h=r;h<o;h+=d,i++){const f=Ui(t),l=Math.floor(1024*t.nextFloat());yield{block:e,index:i,size:l,hash:new T("COMMIT",t.fillBytes(32)),time:new Date(h),sender:new T("PUBKEY",t.fillBytes(32)),tree:{namespace:f,data:t.fillBytes(l)}}}}async function Di(t){let e;for(let r=await t.next();!r.done;r=await t.next())e=r.value;if(e===void 0)throw new ve;return e}async function Li(t){return Di(t[Symbol.asyncIterator]())}function mt(t){if(t.startsWith("0x"))return mt(t.substring(2));if((t.length&1)!==0)return mt("0"+t);const e=new ArrayBuffer(t.length/2);return Ji(No(t),e),e}function Ji(t,e){const r=new DataView(e);let o=0;for(;o<e.byteLength;){const n=t.next(),d=t.next();if(n.done||d.done)throw new $r;const i=Vo(n.value),h=Vo(d.value),f=i<<4|h;r.setUint8(o,f),o++}}function Vo(t){if(t>=48&&t<=57)return t-48;if(t>=97&&t<=102)return t-97+10;if(t>=65&&t<=70)return t-65+10;throw new Kr(t)}function Mi(t){return t.toString(16).padStart(2,"0")}function*Vi(t){yield*Ro(t,Mi)}function Po(t){return Vi(t[Symbol.iterator]())}class Pi{convert(e){if(typeof e!="string")throw new C(typeof e,"string");return mt(e)}}class Ti{convert(e){return["0x",...Po(new Uint8Array(e))].join("")}}class Fi extends s{encoder=new Ti;decoder=new Pi}const W=new Fi;new V(new J(W),new M(W)),new I(new k(W),new N(W));class _i{encoding;constructor(e){this.encoding=e}convert(e){if(typeof e!="string")throw new C(typeof e,"string");return this.encoding.decodeString(e)}}class zi{encoding;constructor(e){this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class xe extends s{encoder;decoder;constructor(e){super(),this.encoder=new zi(e),this.decoder=new _i(e)}}new xe(gt),new xe(Gd),new xe(Bo);const R=new xe(Io);new V(new J(R),new M(R));class Wi{convert(e){if(fs(e))return e;if(Lr(e))return BigInt(e);if(!he(e))throw new C(typeof e,"string | bigint | number");return BigInt(e)}}class ji{convert(e){return De(e,"bigint"),`0x${e.toString(16)}`}}class qi extends s{encoder=new ji;decoder=new Wi}const S=new qi,To=new V(new J(S),new M(S));new I(new k(S),new N(S)),new I(new k(To),new N(To));const Fo=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];function ke(t){for(let e=0;e<24;++e){const r=t[0]^t[10]^t[20]^t[30]^t[40],o=t[1]^t[11]^t[21]^t[31]^t[41],n=t[2]^t[12]^t[22]^t[32]^t[42],d=t[3]^t[13]^t[23]^t[33]^t[43],i=t[4]^t[14]^t[24]^t[34]^t[44],h=t[5]^t[15]^t[25]^t[35]^t[45],f=t[6]^t[16]^t[26]^t[36]^t[46],l=t[7]^t[17]^t[27]^t[37]^t[47],b=t[8]^t[18]^t[28]^t[38]^t[48],B=t[9]^t[19]^t[29]^t[39]^t[49];let w=b^(n<<1|d>>>31),u=B^(d<<1|n>>>31);const G=t[0]^w,O=t[1]^u,q=t[10]^w,le=t[11]^u,vn=t[20]^w,yn=t[21]^u,En=t[30]^w,Cn=t[31]^u,Sn=t[40]^w,bn=t[41]^u;w=r^(i<<1|h>>>31),u=o^(h<<1|i>>>31);const xn=t[2]^w,kn=t[3]^u,Nn=t[12]^w,In=t[13]^u,Bn=t[22]^w,Rn=t[23]^u,On=t[32]^w,Un=t[33]^u,An=t[42]^w,Dn=t[43]^u;w=n^(f<<1|l>>>31),u=d^(l<<1|f>>>31);const Ln=t[4]^w,Jn=t[5]^u,Mn=t[14]^w,Vn=t[15]^u,Pn=t[24]^w,Tn=t[25]^u,Fn=t[34]^w,_n=t[35]^u,zn=t[44]^w,Wn=t[45]^u;w=i^(b<<1|B>>>31),u=h^(B<<1|b>>>31);const jn=t[6]^w,qn=t[7]^u,Hn=t[16]^w,$n=t[17]^u,Kn=t[26]^w,Qn=t[27]^u,Gn=t[36]^w,Xn=t[37]^u,Zn=t[46]^w,Yn=t[47]^u;w=f^(r<<1|o>>>31),u=l^(o<<1|r>>>31);const es=t[8]^w,ts=t[9]^u,rs=t[18]^w,os=t[19]^u,ns=t[28]^w,ss=t[29]^u,cs=t[38]^w,as=t[39]^u,ds=t[48]^w,is=t[49]^u,Pt=G,Tt=O,Ft=le<<4|q>>>28,_t=q<<4|le>>>28,zt=vn<<3|yn>>>29,Wt=yn<<3|vn>>>29,jt=Cn<<9|En>>>23,qt=En<<9|Cn>>>23,Ht=Sn<<18|bn>>>14,$t=bn<<18|Sn>>>14,Kt=xn<<1|kn>>>31,Qt=kn<<1|xn>>>31,Gt=In<<12|Nn>>>20,Xt=Nn<<12|In>>>20,Zt=Bn<<10|Rn>>>22,Yt=Rn<<10|Bn>>>22,er=Un<<13|On>>>19,tr=On<<13|Un>>>19,rr=An<<2|Dn>>>30,or=Dn<<2|An>>>30,nr=Jn<<30|Ln>>>2,sr=Ln<<30|Jn>>>2,cr=Mn<<6|Vn>>>26,ar=Vn<<6|Mn>>>26,dr=Tn<<11|Pn>>>21,ir=Pn<<11|Tn>>>21,lr=Fn<<15|_n>>>17,hr=_n<<15|Fn>>>17,ur=Wn<<29|zn>>>3,wr=zn<<29|Wn>>>3,fr=jn<<28|qn>>>4,gr=qn<<28|jn>>>4,pr=$n<<23|Hn>>>9,mr=Hn<<23|$n>>>9,vr=Kn<<25|Qn>>>7,yr=Qn<<25|Kn>>>7,Er=Gn<<21|Xn>>>11,Cr=Xn<<21|Gn>>>11,Sr=Yn<<24|Zn>>>8,br=Zn<<24|Yn>>>8,xr=es<<27|ts>>>5,kr=ts<<27|es>>>5,Nr=rs<<20|os>>>12,Ir=os<<20|rs>>>12,Br=ss<<7|ns>>>25,Rr=ns<<7|ss>>>25,Or=cs<<8|as>>>24,Ur=as<<8|cs>>>24,Ar=ds<<14|is>>>18,Dr=is<<14|ds>>>18;t[0]=Pt^~Gt&dr,t[1]=Tt^~Xt&ir,t[10]=fr^~Nr&zt,t[11]=gr^~Ir&Wt,t[20]=Kt^~cr&vr,t[21]=Qt^~ar&yr,t[30]=xr^~Ft&Zt,t[31]=kr^~_t&Yt,t[40]=nr^~pr&Br,t[41]=sr^~mr&Rr,t[2]=Gt^~dr&Er,t[3]=Xt^~ir&Cr,t[12]=Nr^~zt&er,t[13]=Ir^~Wt&tr,t[22]=cr^~vr&Or,t[23]=ar^~yr&Ur,t[32]=Ft^~Zt&lr,t[33]=_t^~Yt&hr,t[42]=pr^~Br&jt,t[43]=mr^~Rr&qt,t[4]=dr^~Er&Ar,t[5]=ir^~Cr&Dr,t[14]=zt^~er&ur,t[15]=Wt^~tr&wr,t[24]=vr^~Or&Ht,t[25]=yr^~Ur&$t,t[34]=Zt^~lr&Sr,t[35]=Yt^~hr&br,t[44]=Br^~jt&rr,t[45]=Rr^~qt&or,t[6]=Er^~Ar&Pt,t[7]=Cr^~Dr&Tt,t[16]=er^~ur&fr,t[17]=tr^~wr&gr,t[26]=Or^~Ht&Kt,t[27]=Ur^~$t&Qt,t[36]=lr^~Sr&xr,t[37]=hr^~br&kr,t[46]=jt^~rr&nr,t[47]=qt^~or&sr,t[8]=Ar^~Pt&Gt,t[9]=Dr^~Tt&Xt,t[18]=ur^~fr&Nr,t[19]=wr^~gr&Ir,t[28]=Ht^~Kt&cr,t[29]=$t^~Qt&ar,t[38]=Sr^~xr&Ft,t[39]=br^~kr&_t,t[48]=rr^~nr&pr,t[49]=or^~sr&mr,t[0]^=Fo[e*2],t[1]^=Fo[e*2+1]}}class Hi{state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];blockSize=0;count=0;squeezing=!1;initialize(e,r){for(let o=0;o<50;++o)this.state[o]=0;this.blockSize=e/8,this.count=0,this.squeezing=!1}absorb(e){for(let r=0;r<e.length;++r)this.state[~~(this.count/4)]^=e[r]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(ke(this.state),this.count=0)}absorbLastFewBits(e){this.state[~~(this.count/4)]^=e<<8*(this.count%4),(e&128)!==0&&this.count===this.blockSize-1&&ke(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),ke(this.state),this.count=0,this.squeezing=!0}squeeze(e){this.squeezing||this.absorbLastFewBits(1);const r=new Uint8Array(e);for(let o=0;o<e;++o)r[o]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(ke(this.state),this.count=0);return r}copy(e){for(let r=0;r<50;++r)e.state[r]=this.state[r];e.blockSize=this.blockSize,e.count=this.count,e.squeezing=this.squeezing}}class z{_rate;_capacity;_delimitedSuffix;_hashBitLength;_state;_finalized;constructor(e,r,o,n){this._rate=e,this._capacity=r,this._delimitedSuffix=o,this._hashBitLength=n,this._state=new Hi,this._state.initialize(e,r),this._finalized=!1}update(e){if(this._finalized)throw new Error("Digest already called");return this._state.absorb(new Uint8Array(e)),this}digest(){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);const e=this._state.squeeze(this._hashBitLength/8);return this._resetState(),ft.encode(e)}_resetState(){return this._state.initialize(this._rate,this._capacity),this}}function $i(t){switch(t.toLowerCase()){case"keccak224":return new z(1152,448,null,224);case"keccak256":return new z(1088,512,null,256);case"keccak384":return new z(832,768,null,384);case"keccak512":return new z(576,1024,null,512);case"sha3-224":return new z(1152,448,6,224);case"sha3-256":return new z(1088,512,6,256);case"sha3-384":return new z(832,768,6,384);case"sha3-512":return new z(576,1024,6,512);default:throw new Error("invalid algorithm: "+t)}}const Ki=48,Qi=57,Gi=97,Xi=102;class Zi{convert(e){if(y(e,ArrayBuffer),e.byteLength!==20)throw new C(typeof e,"20-byte ArrayBuffer");const o=[...hi(Po(new Uint8Array(e)),f=>f.split(""))],n=$i("keccak256"),d=new TextEncoder;n.update(ft.encode(d.encode(o.join(""))));const i=new Uint8Array(n.digest());return["0x",...be(Oo(wi(e.byteLength*2),o,(f,l)=>[f,l]),([f,l])=>{const b=l.charCodeAt(0);if(b>=Ki&&b<=Qi)return l;if(b>=Gi&&b<=Xi){const B=Math.floor(f/2),w=f&1,u=i[B];return(w===0?u>>4:u&15)>7?l.toUpperCase():l}throw new A})].join("")}}const Yi=new Zi;class el{keyCodec;valueCodec;constructor(e,r){this.keyCodec=e,this.valueCodec=r}convert(e){if(typeof e!="object"||e===null)throw new Error(`invalid map value: expected an object, got ${typeof e}`);const r=new Map;for(const[o,n]of Object.entries(e)){const d=this.keyCodec.decode(o),i=this.valueCodec.decode(n);r.set(d,i)}return r}}class tl{keyCodec;valueCodec;constructor(e,r){this.keyCodec=e,this.valueCodec=r}convert(e){y(e,Map);const r={};for(const[o,n]of e.entries()){const d=this.keyCodec.encode(o),i=this.valueCodec.encode(n);r[d]=i}return r}}class vt extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}static keyStringCodec(e){return new vt(new el(c,e),new tl(c,e))}}class rl{convert(e){if(!he(e))throw new C(typeof e,"string");return new URL(e)}}class ol{convert(e){return e.toString()}}class nl extends s{encoder=new ol;decoder=new rl}const _o=new nl;new V(new J(_o),new M(_o));class zo{address;constructor(e){this.address=e}toJSON(){return yt.encode(this)}}class sl{convert(e){return a(e,"address"),new zo(R.decode(e.address))}}class cl{convert(e){return{address:R.encode(e.address)}}}class al extends s{encoder=new cl;decoder=new sl}const yt=new al,Ne=new I(new k(yt),new N(yt));class Wo{epoch;block;timestamp;constructor(e,r,o){this.epoch=e,this.block=r,this.timestamp=o}toJSON(){return ce.encode(this)}}class dl{convert(e){return a(e,"epoch","block","timestamp"),new Wo(S.decode(e.epoch),S.decode(e.block),new Date(E.decode(e.timestamp)))}}class il{convert(e){return{epoch:S.encode(e.epoch),block:S.encode(e.block),timestamp:E.encode(e.timestamp.getTime())}}}class ll extends s{encoder=new il;decoder=new dl}const ce=new ll;class jo{espressoBlock;nodes;constructor(e,r){this.espressoBlock=e,this.nodes=r}toJSON(){return Et.encode(this)}}class hl{convert(e){return a(e,"espresso_block","nodes"),new jo(ce.decode(e.espresso_block),Ne.decode(e.nodes))}}class ul{convert(e){return{espresso_block:ce.encode(e.espressoBlock),nodes:Ne.encode(e.nodes)}}}class wl extends s{encoder=new ul;decoder=new hl}const Et=new wl;class fl{async active(){const e=await Li(Ri()),r=se.slice().sort((o,n)=>Number(n.stake-o.stake)).slice(0,100);return new jo(new Wo(BigInt(Math.floor(e.height/100)),BigInt(e.height),new Date(e.time)),Array.from(be(r,o=>new zo(o.address))))}async updatesSince(){throw new A}}const Ct=1e4,qo=0,gl="PercentageOutOfRange";class pl extends p{value;constructor(e,r=`the commission percentage is outside of the range [${qo}, ${Ct}], have ${e}`){super(r),this.value=e,Object.freeze(this)}get code(){return gl}}class St{value;constructor(e){if(e<qo||e>Ct)throw new pl(e);this.value=e}toString(){return`${this.value/100}%`}toJSON(){return this.value}valueOf(){return this.value/Ct}}class ml{convert(e){if(typeof e!="number")throw new C(typeof e,"number");return new St(e)}}class vl{convert(e){if(!(e instanceof St))throw new C(e,"CommissionPercent");return Math.floor(e.value)}}class yl extends s{encoder=new vl;decoder=new ml}const Ie=new yl;class Ho{stakeKey;stakeAmount;constructor(e,r){this.stakeKey=e,this.stakeAmount=r}}class El{convert(e){return a(e,"stake_key","stake_amount"),new Ho(D.decode(e.stake_key),S.decode(e.stake_amount))}}class Cl{convert(e){return y(e,Ho),{stake_key:D.encode(e.stakeKey),stake_amount:S.encode(e.stakeAmount)}}}class Sl extends s{encoder=new Cl;decoder=new El}const $=new Sl;new V(new J($),new M($)),new I(new k($),new N($));class $o{stakeTableEntry;stateVerKey;constructor(e,r){this.stakeTableEntry=e,this.stateVerKey=r}}class bl{convert(e){return a(e,"stake_table_entry","state_ver_key"),new $o($.decode(e.stake_table_entry),D.decode(e.state_ver_key))}}class xl{convert(e){return y(e,$o),{stake_table_entry:$.encode(e.stakeTableEntry),state_ver_key:D.encode(e.stateVerKey)}}}class kl extends s{encoder=new xl;decoder=new bl}const Be=new kl;new V(new J(Be),new M(Be)),new I(new k(Be),new N(Be));class Nl{address;constructor(e){this.address=e,Object.freeze(this)}toJSON(){return K.encode(this)}toString(){return K.encode(this)}}class Il{convert(e){return e.address.byteLength!==20?W.encode(e.address):Yi.convert(e.address)}}class Bl{convert(e){return new Nl(W.decode(e))}}class Rl extends s{encoder=new Il;decoder=new Bl}const K=new Rl;new V(new J(K),new M(K));const Ko=vt.keyStringCodec(S);class Qo{account;stakeTableKey;stateVerKey;stake;commission;delegators;constructor(e,r,o,n,d,i){this.account=e,this.stakeTableKey=r,this.stateVerKey=o,this.stake=n,this.commission=d,this.delegators=i}}class Ol{convert(e){return a(e,"account","stake_table_key","state_ver_key","stake","commission","delegators"),new Qo(K.decode(e.account),D.decode(e.stake_table_key),D.decode(e.state_ver_key),S.decode(e.stake),Ie.decode(e.commission),Ko.decode(e.delegators))}}class Ul{convert(e){return y(e,Qo),{account:K.encode(e.account),stake_table_key:D.encode(e.stakeTableKey),state_ver_key:D.encode(e.stateVerKey),stake:S.encode(e.stake),commission:Ie.encode(e.commission),delegators:Ko.encode(e.delegators)}}}class Al extends s{encoder=new Ul;decoder=new Ol}const Re=new Al;new V(new J(Re),new M(Re)),new I(new k(Re),new N(Re));class Go{number;blockHash;timestamp;constructor(e,r,o){this.number=e,this.blockHash=r,this.timestamp=o}toJSON(){return j.encode(this)}}class Dl{convert(e){return a(e,"number","hash","timestamp"),new Go(S.decode(e.number),R.decode(e.hash),new Date(E.decode(e.timestamp)))}}class Ll{convert(e){return{number:S.encode(e.number),hash:R.encode(e.blockHash),timestamp:E.encode(e.timestamp.valueOf())}}}class Jl extends s{encoder=new Ll;decoder=new Dl}const j=new Jl;class Xo{address;stakeTableKey;stake;commission;voterParticipation;leadershipParticipation;constructor(e,r,o,n,d,i){this.address=e,this.stakeTableKey=r,this.stake=o,this.commission=n,this.voterParticipation=d,this.leadershipParticipation=i}toJSON(){return ae.encode(this)}}class Ml{convert(e){return a(e,"address","stake_table_key","stake","commission","voter_participation","leadership_participation"),new Xo(R.decode(e.address),D.decode(e.stake_table_key),S.decode(e.stake),Ie.decode(e.commission),H.decode(e.voter_participation),H.decode(e.leadership_participation))}}class Vl{convert(e){return{address:R.encode(e.address),stake_table_key:D.encode(e.stakeTableKey),stake:S.encode(e.stake),commission:Ie.encode(e.commission),voter_participation:H.encode(e.voterParticipation),leadership_participation:H.encode(e.leadershipParticipation)}}}class Pl extends s{encoder=new Vl;decoder=new Ml}const ae=new Pl,Zo=new I(new k(ae),new N(ae));class Yo{l1Block;nodes;constructor(e,r=[]){this.l1Block=e,this.nodes=r}toJSON(){return bt.encode(this)}}class Tl{convert(e){return a(e,"l1_block","nodes"),new Yo(j.decode(e.l1_block),Zo.decode(e.nodes))}}class Fl{convert(e){return{l1_block:j.encode(e.l1Block),nodes:Zo.encode(e.nodes)}}}class _l extends s{encoder=new Fl;decoder=new Tl}const bt=new _l;class zl{async snapshot(){const e=se.slice().sort((o,n)=>Number(n.stake-o.stake)).slice(0,100),r=new Set(be(e,o=>o.address));return new Yo(new Go(BigInt(1),new ArrayBuffer(32),new Date),Array.from(be(se,o=>new Xo(o.address,o.stateVerKey,o.stake,new St(o.commission),r.has(o.address)?Math.random():null,r.has(o.address)?Math.random():null))))}async updatesSince(){throw new A}}class Wl{l1Block=new La;validatorsAll=new zl;validatorsActive=new fl;async setURL(){throw new A}}function de(t,e){return async r=>(await jl(r,e),xt(r),t.convert(await r.json()))}async function jl(t,e){if(!t.ok){if(t.status>=500&&t.status<600){try{xt(t)}catch(r){if(r instanceof p)throw r;console.error("encountered an error attempting to decode a server error from the server",r)}throw new Wr(t.status,t)}if(t.status>=400&&t.status<500){try{xt(t)}catch(r){if(r instanceof p)throw r;console.error("encountered an error attempting to decode a client error from the server",r)}throw new Tr(t.status,t)}throw new _r(t.status,t)}}function xt(t){const e=t.headers.get("content-type");if(!e||!e.startsWith("application/json"))throw te.fromResponse(t,e||"undefined")}class ql{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async getBlockForHeight(e){const r=new URL(`${e}`,this.baseURL);return this.fetcher(r).then(de(j.decoder))}}class Hl{address;percentage;constructor(e,r){this.address=e,this.percentage=r}toJSON(){return ie.encode(this)}}class $l{convert(e){return a(e,"address","percentage"),new Hl(R.decode(e.address),E.decode(e.percentage))}}class Kl{convert(e){return{address:R.encode(e.address),percentage:E.encode(e.percentage)}}}class Ql extends s{encoder=new Kl;decoder=new $l}const ie=new Ql;class kt{}class en extends kt{participationChange;constructor(e){super(),this.participationChange=e}toJSON(){return Nt.encode(this)}}class Gl{convert(e){return a(e,"participation_change"),new en(ie.decode(e.participation_change))}}class Xl{convert(e){return{participation_change:ie.encode(e.participationChange)}}}class Zl extends s{encoder=new Xl;decoder=new Gl}const Oe="LeaderParticipationChange",Nt=new Zl;class tn extends kt{entries;constructor(e){super(),this.entries=e}toJSON(){return It.encode(this)}}class Yl{convert(e){return new tn(Ne.decode(e))}}class eh{convert(e){return Ne.encode(e.entries)}}class th extends s{encoder=new eh;decoder=new Yl}const Ue="NewEpoch",It=new th;class rn extends kt{participationChange;constructor(e){super(),this.participationChange=e}toJSON(){return Bt.encode(this)}}class rh{convert(e){return a(e,"participation_change"),new rn(ie.decode(e.participation_change))}}class oh{convert(e){return{participation_change:ie.encode(e.participationChange)}}}class nh extends s{encoder=new oh;decoder=new rh}const Ae="VoterParticipationChange",Bt=new nh;class sh{convert(e){if(a(e),X(e,Ue))return It.decode(e[Ue]);if(X(e,Oe))return Nt.decode(e[Oe]);if(X(e,Ae))return Bt.decode(e[Ae]);const r=Object.keys(e);if(r.length<=0)throw new C("Empty EspressoMessage object","object");const[o]=r;throw new C(o,`${Ue} | ${Oe} | ${Ae}`)}}class ch{convert(e){if(e instanceof tn)return{[Ue]:It.encode(e)};if(e instanceof en)return{[Oe]:Nt.encode(e)};if(e instanceof rn)return{[Ae]:Bt.encode(e)};throw new C("Unrecognized EspressoMessage type","Valid EspressoMessage Type")}}class ah extends s{encoder=new ch;decoder=new sh}const on=new ah,nn=new I(new k(on),new N(on));class dh{espressoBlock;diff;constructor(e,r){this.espressoBlock=e,this.diff=r}toJSON(){return Rt.encode(this)}}class ih{convert(e){return a(e,"espresso_block","diff"),new dh(ce.decode(e.espresso_block),nn.decode(e.diff))}}class lh{convert(e){return{espresso_block:ce.encode(e.espressoBlock),diff:nn.encode(e.diff)}}}class hh extends s{encoder=new lh;decoder=new ih}const Rt=new hh;class uh{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async active(){return this.fetcher(this.baseURL).then(de(Et.decoder))}async updatesSince(e){const r=new URL(`active/updates/${e}`,this.baseURL);return this.fetcher(r).then(de(Rt.decoder))}}class wh{address;exitTime;constructor(e,r){this.address=e,this.exitTime=r}toJSON(){return Ot.encode(this)}}class fh{convert(e){return a(e,"address","exit_time"),new wh(R.decode(e.address),new Date(e.exit_time))}}class gh{convert(e){return{address:R.encode(e.address),exit_time:e.exitTime.toISOString()}}}class ph extends s{encoder=new gh;decoder=new fh}const Ot=new ph;class sn{}class cn extends sn{validatorExit;constructor(e){super(),this.validatorExit=e}toJSON(){return At.encode(this)}}class mh{convert(e){return a(e,"validator_exit"),new cn(Ot.decode(e.validator_exit))}}class vh{convert(e){return{validator_exit:Ot.encode(e.validatorExit)}}}class yh extends s{encoder=new vh;decoder=new mh}const Ut="ValidatorExit",At=new yh;class an extends sn{validatorInformation;constructor(e){super(),this.validatorInformation=e}toJSON(){return Lt.encode(this)}}class Eh{convert(e){return a(e,"validator_information"),new an(ae.decode(e.validator_information))}}class Ch{convert(e){return{validator_information:ae.encode(e.validatorInformation)}}}class Sh extends s{encoder=new Ch;decoder=new Eh}const Dt="ValidatorUpdate",Lt=new Sh;class bh{convert(e){if(a(e),X(e,Dt))return Lt.decode(e[Dt]);if(X(e,Ut))return At.decode(e[Ut]);throw Object.keys(e).length<=0?new C("Empty L1Message object","object"):new C("Unrecognized L1Message type","Valid L1 Type")}}class xh{convert(e){if(e instanceof an)return{[Dt]:Lt.encode(e)};if(e instanceof cn)return{[Ut]:At.encode(e)};throw new C("Unrecognized L1Message type","Valid L1 Type")}}class kh extends s{encoder=new xh;decoder=new bh}const dn=new kh,ln=new I(new k(dn),new N(dn));class Nh{l1Block;diff;constructor(e,r=[]){this.l1Block=e,this.diff=r}toJSON(){return Jt.encode(this)}}class Ih{convert(e){return a(e,"l1_block","diff"),new Nh(j.decode(e.l1_block),ln.decode(e.diff))}}class Bh{convert(e){return{l1_block:j.encode(e.l1Block),diff:ln.encode(e.diff)}}}class Rh extends s{encoder=new Bh;decoder=new Ih}const Jt=new Rh;class Oh{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async snapshot(){return this.fetcher(this.baseURL).then(de(bt.decoder))}async updatesSince(e){const r=new URL(`all/updates/${W.encode(e)}`,this.baseURL);return this.fetcher(r).then(de(Jt.decoder))}}class hn{l1Block;validatorsAll;validatorsActive;constructor(e,r){this.l1Block=new ql(e,new URL("l1/block/",r)),this.validatorsAll=new Oh(e,new URL("validators/all",r)),this.validatorsActive=new uh(e,new URL("validators/active",r))}async setURL(){throw new A}}class Uh{service;constructor(e){this.service=e}async getBlockForHeight(e){return this.service.getBlockForHeight(e)}async handleRequest(e){switch(e.method){case"getBlockForHeight":return j.encode(await this.getBlockForHeight(E.decode(e.param[0])));default:throw new A}}}class Ah{service;constructor(e){this.service=e}async active(){return this.service.active()}async updatesSince(e){return this.service.updatesSince(e)}async handleRequest(e){switch(e.method){case"active":return Et.encode(await this.active());case"updatesSince":return Rt.encode(await this.updatesSince(S.decode(e.param[0])))}}}class Dh{service;constructor(e){this.service=e}async snapshot(){return this.service.snapshot()}async updatesSince(e){return this.service.updatesSince(e)}async handleRequest(e){switch(e.method){case"snapshot":return bt.encode(await this.snapshot());case"updatesSince":return Jt.encode(await this.updatesSince(R.decode(e.param[0])))}}}class un{l1Block;validatorsActive;validatorsAll;constructor(e){this.l1Block=new Uh(e.l1Block),this.validatorsActive=new Ah(e.validatorsActive),this.validatorsAll=new Dh(e.validatorsAll)}async handleRequest(e){switch(e.api){case"l1Block":return this.l1Block.handleRequest(e);case"validatorsActive":return this.validatorsActive.handleRequest(e);case"validatorsAll":return this.validatorsAll.handleRequest(e);default:throw new A}}}const Q=E;class wn{requestID;api;method;param;constructor(e,r,o,n){this.requestID=e,this.api=r,this.method=o,this.param=n}toJSON(){return{requestID:this.requestID,api:this.api,method:this.method,param:this.param}}}class Lh{convert(e){return a(e,"requestID","api","method","param"),new wn(Q.decode(e.requestID),c.decode(e.api),c.decode(e.method),e.param)}}class Jh{convert(e){return y(e,wn),{requestID:Q.encode(e.requestID),api:c.encode(e.api),method:c.encode(e.method),param:e.param}}}class Mh extends s{encoder=new Jh;decoder=new Lh}const Vh=new Mh;class fn{requestID;constructor(e){this.requestID=e}}class Mt extends fn{response;constructor(e,r){super(e),this.response=r}toJSON(){return gn.encode(this)}}class Ph{convert(e){return a(e,"requestID","response"),new Mt(Q.decode(e.requestID),e.response)}}class Th{convert(e){return y(e,Mt),{requestID:Q.encode(e.requestID),response:e.response}}}class Fh extends s{encoder=new Th;decoder=new Ph}const gn=new Fh;class Vt extends fn{error;constructor(e,r){super(e),this.error=r}toJSON(){return pn.encode(this)}}class _h{convert(e){return a(e,"requestID","error"),new Vt(Q.decode(e.requestID),we.decode(e.error))}}class zh{convert(e){return y(e,Vt),{requestID:Q.encode(e.requestID),error:we.encode(e.error)}}}class Wh extends s{encoder=new zh;decoder=new _h}const pn=new Wh,mn=async(t,e)=>{try{return await fetch(t,e)}catch(r){throw new jr(r)}};async function jh(){try{const e=await(await fetch("/config.json")).json();if(e.l1_validators_service_url){const r=new URL(e.l1_validators_service_url);return new hn(mn,r)}}catch{}return new Wl}async function qh(){return new un(await jh())}class Hh{service;postMessage;requestChannel;constructor(e){this.postMessage=e,this.service=qh(),this.requestChannel=Da(10),this.processRequests()}async handleProxyRequest(e){if(e.method==="set-url"){const r=e.param[0];if(!r||typeof r!="string")throw new A("Invalid URL provided");return this.service=Promise.resolve(new un(new hn(mn,new URL(r)))),!0}else throw new A(`Unknown proxy method: ${e.method}`)}async processRequests(){for await(const e of this.requestChannel)try{const r=await this.service;let o;e.api==="proxy"?o=await this.handleProxyRequest(e):o=await r.handleRequest(e),this.postMessage(gn.encode(new Mt(e.requestID,o)))}catch(r){this.postMessage(pn.encode(new Vt(e.requestID,r)))}}async handleEvent(e){const r=Vh.decode(e.data);await this.requestChannel.publish(r)}}self.addEventListener("message",new Hh(self.postMessage.bind(self)))})();
