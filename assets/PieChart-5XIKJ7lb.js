import{j as e,F as S,a as N}from"./jsx-runtime-C8OW3RLV.js";import{D as F}from"./LoadingProvider-D-gSICWy.js";import{N as B}from"./NumberText-CEiknsW6.js";import{l as z}from"./typography-CBcnIq8a.js";import{R as m}from"./index-BwDkhjyp.js";import{T as D}from"./Text-BU7JBOLk.js";import{S as G}from"./SVGPathBuilder-CAxdfrWF.js";import{u as R,S as y,a as M,b as j,c as E,d as k,e as U,f as W}from"./SVGToolTip-DOfXbiYJ.js";const q=z("text"),H=14,oe=m.createContext(()=>e(S,{})),A=m.createContext(null),X=r=>{const a=r.values,[l,i]=R();if(!a)return e(S,{});if(a.length<=0)return e(S,{});const g=i??{x:0,y:0,width:100,height:100},{x:v,y:P,width:c,height:h}=g,t=Math.min(c,h)/2;if(a.length===1)return e("svg",{ref:l,viewBox:`${v} ${P} ${c} ${h}`,role:"graphics-datachart","aria-roledescription":"pie chart",children:e(y.Provider,{value:Number(c),children:N(M.Provider,{value:Number(h),children:[e("g",{className:"pie-chart-sections",role:"graphics-datagroup",children:e("circle",{cx:t,cy:t,r:t,"data-label":a[0].label,role:"graphics-datascale","aria-valuemax":1})}),e("g",{className:"pie-chart-tooltip-hitboxes",children:e(A.Provider,{value:{startX:t,startY:t,endX:t,endY:t,label:a[0].label,value:a[0].value,startAngle:0,endAngle:2*Math.PI,endPercentage:1},children:N("g",{className:"pie-chart-tooltip-hitbox",children:[e("circle",{className:"pie-chart-section-hitbox",cx:t,cy:t,r:t,"data-label":a[0].label}),e(I,{})]})})})]})})});const Y=a.reduce((n,o)=>n+o.value,0),w=a.reduce((n,o)=>{const s=(n[n.length-1]??0)+o.value/Y;return n.push(s),n},[]),V=a.map((n,o)=>{const d=w[o]??0,s=(w[o-1]??0)*2*Math.PI,p=d*2*Math.PI,x=t+Math.cos(s)*t,b=t+Math.sin(s)*t,T=t+Math.cos(p)*t,C=t+Math.sin(p)*t;return{startX:x,startY:b,endX:T,endY:C,startAngle:s,endAngle:p,endPercentage:d,label:n.label,value:n.value}});return e("svg",{ref:l,viewBox:`${v} ${P} ${c} ${h}`,role:"graphics-datachart","aria-roledescription":"pie chart",children:e(y.Provider,{value:Number(c),children:N(M.Provider,{value:Number(h),children:[e("g",{className:"pie-chart-sections",role:"graphics-datagroup",children:V.map((n,o)=>{const{startX:d,startY:s,endX:p,endY:x,label:b,value:T,startAngle:C,endAngle:_}=n,u=_-C>Math.PI?1:0,f=new G;return f.moveTo(t,t),f.lineTo(d,s),f.arcTo(t,t,0,u,1,p,x),f.close(),e("path",{d:f.instructionToString(),"data-label":b,role:"graphics-datascale","aria-valuemax":T/Y},o)})}),e("g",{className:"pie-chart-tooltip-hitboxes",children:V.map((n,o)=>{const{startX:d,startY:s,endX:p,endY:x,label:b,endAngle:T,startAngle:C}=n,_=T-C>Math.PI?1:0,u=new G;return u.moveTo(t,t),u.lineTo(d,s),u.arcTo(t,t,0,_,1,p,x),u.close(),e(A.Provider,{value:n,children:N("g",{className:"pie-chart-tooltip-hitbox",children:[e("path",{className:"pie-chart-section-hitbox",d:u.instructionToString(),"data-label":b},o),e(I,{})]})},o)})})]})})})};function L(r,a,l,i){const g=r*.5,v=a*.5;if(i.endAngle>=2*Math.PI&&i.startAngle<=0)return[g,v];const P=(i.endAngle+i.startAngle)/2,c=g+Math.cos(P)*l,h=v+Math.sin(P)*l;return[c,h]}const O=2/3,I=()=>{const r=m.useContext(M),a=m.useContext(y),l=m.useContext(A);if(!l)return e(S,{});const[i,g]=L(a,r,Math.min(a,r)*.5*O,l);return e(j.Provider,{value:J,children:e(E.Provider,{value:Number(i),children:e(k.Provider,{value:Number(g),children:e(U.Provider,{value:i/a,children:e(W,{})})})})})},J=()=>{const r=m.useContext(A);return r?N(q,{x:0,y:H,textAnchor:"center",children:[e(D,{text:r.label}),e(D,{text:" "}),e(B,{number:r.value})]}):e(S,{})},$=()=>{const r=m.useContext(F);return e(X,{values:r})};try{X.displayName="PieChart",X.__docgenInfo={description:"PieChart is a component that takes the given data and creates a pie chart",displayName:"PieChart",props:{values:{defaultValue:null,description:"",name:"values",required:!0,type:{name:"PieChartEntry[]"}}}}}catch{}try{$.displayName="PieChartFromData",$.__docgenInfo={description:"PieChartFromData is a convenience component that uses the DataContext,\ninterpreted as a list of entries of type `PieChartEntry`, to render a\nPieChart.",displayName:"PieChartFromData",props:{}}}catch{}export{$ as P,X as a,oe as b};
