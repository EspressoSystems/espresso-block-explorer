var fd=Object.defineProperty;var gd=(W,I,j)=>I in W?fd(W,I,{enumerable:!0,configurable:!0,writable:!0,value:j}):W[I]=j;var t=(W,I,j)=>gd(W,typeof I!="symbol"?I+"":I,j);(function(){"use strict";class W{assert(){}}function I(){return new W}const j=I();function v(n,e){j.assert(n,e)}function Kn(n,e){v(typeof n===e,`type assertion failed: expected "${e}", received "${typeof n}"`)}function xt(n){v(n!==null,"expected a non-null value, received null")}function S(n,e){v(n instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof n=="object"&&n!==null?n.constructor.name:typeof n}"`)}class Fe extends Error{constructor(r,s,o=`expected object with key: "${s}", instead found ${r}`){super(o);t(this,"key");t(this,"haveType");this.haveType=r,this.key=s,Object.freeze(this)}toJSON(){return{code:Fe.name,message:this.message,have:this.haveType,key:this.key}}}class Pe{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class c extends Pe{}function It(n){return typeof n=="number"}function z(n){return typeof n=="string"}function Rt(n){return typeof n=="object"&&n!==null}function Dt(n){return n!==void 0}function Bt(n,e){return Array.isArray(n)&&n.every(e)}function At(n){return e=>Bt(e,n)}function Le(n,...e){return Rt(n)&&e.every(r=>r in n)}function d(n,...e){if(typeof n!="object")throw new Error("expected object");if(n===null)throw new Error("received null");for(const r of e)if(!(r in n))throw new Fe("object",r)}function p(n,e){if(!z(n.code))throw new Error("code must be a string");if(n.code!==e)throw new Error(`expected code to be ${e}, got ${n.code}`)}function Yn(n,e){if(!z(n.type))throw new Error("type must be a string");if(n.type!==e)throw new Error(`expected type to be ${e}, got ${n.type}`)}class g extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return x.convert(this)}}class y{convert(e){return S(e,g),{code:e.code,message:e.message}}}const x=new y,Nt="NoCodecFoundError";class de extends Error{constructor(r,s=`no codec found for: "${r}"`){super(s);t(this,"codec");this.codec=r,Object.freeze(this);debugger}toJSON(){return{code:i.encode(de.name),message:i.encode(this.message),codec:i.encode(this.codec)}}get code(){return Nt}}const je=new Map;class Ut{convert(e){d(e,"code");const r=i.decode(e.code),s=je.get(r);if(!s)throw new de(r);return s.decode(e)}}class Ot{convert(e){const r=je.get(e.code);if(!r)throw new de(e.code);return r.encode(e)}}class Wt extends Pe{constructor(){super(...arguments);t(this,"encoder",new Ot);t(this,"decoder",new Ut)}}const le=new Wt;function f(n,e){je.set(n,e)}const ze="InvalidTypeError";class h extends g{constructor(r,s,o=`invalid type: have "${r}", want "${s}"`){super(o);t(this,"have");t(this,"want");this.have=r,this.want=s,Object.freeze(this)}toJSON(){return er.encode(this)}get code(){return ze}}class Mt{convert(e){return d(e,"code","have","want","message"),p(e,ze),new h(i.decode(e.have),i.decode(e.want),i.decode(e.message))}}class Tt{convert(e){return S(e,h),{...x.convert(e),have:i.encode(e.have),want:i.encode(e.want)}}}class Ft extends c{constructor(){super(...arguments);t(this,"encoder",new Tt);t(this,"decoder",new Mt)}}const er=new Ft;f(ze,er);const Pt=At(Dt);class Lt{convert(e){return e}}const nr=new Lt;class jt extends Pe{constructor(){super(...arguments);t(this,"encoder",nr);t(this,"decoder",nr)}}const ue=new jt;class M{constructor(e){t(this,"itemCodec");this.itemCodec=e}convert(e){if(!Pt(e)){const r=typeof e=="object"&&e!==null?e.constructor.name:typeof e,s="array";throw new Error(`invalid array value: have "${r}", want "${s}"`)}return e.map(r=>this.itemCodec.decode(r))}}class T{constructor(e){t(this,"itemCodec");this.itemCodec=e}convert(e){return S(e,Array),e.map(r=>this.itemCodec.encode(r))}}class F extends c{constructor(r,s){super();t(this,"encoder");t(this,"decoder");this.encoder=s,this.decoder=r}}class he{constructor(e){t(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class we{constructor(e){t(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:(xt(e),this.itemCodec.encode(e))}}class pe extends c{constructor(r,s){super();t(this,"encoder");t(this,"decoder");this.encoder=s,this.decoder=r}}class zt{convert(e){if(!z(e))throw new h(typeof e,"string");return e}}class qt{convert(e){return Kn(e,"string"),e}}class Jt extends c{constructor(){super(...arguments);t(this,"encoder",new qt);t(this,"decoder",new zt)}}const i=new Jt;new F(new M(i),new T(i)),new pe(new he(i),new we(i));class qe extends g{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return rr}}const rr="CompleterAlreadyCompletedError";class $t{convert(e){return d(e,"code","message"),p(e,rr),new qe(i.decode(e.message))}}class Ht extends y{}class Vt extends c{constructor(){super(...arguments);t(this,"encoder",new Ht);t(this,"decoder",new $t)}}const Qt=new Vt;f(qe.name,Qt);function fe(){return v(!1,"completer is not ready, this should never be reached")}function ge(){throw new qe}class Gt{constructor(){t(this,"resolve",fe);t(this,"reject",fe);t(this,"completed",!1);t(this,"promise");this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r}),v(this.resolve!==fe,"resolve should be set"),v(this.reject!==fe,"resolve should be set")}get isCompleted(){return this.completed}complete(e){const r=this.resolve,s=this.reject;if(this.completed=!0,this.resolve=ge,this.reject=ge,e instanceof Promise){e.then(r,s);return}r(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=ge,this.reject=ge}}function me(){return new Gt}class q extends g{constructor(r,s,o){super(o);t(this,"response");t(this,"status");this.status=r,this.response=s}toJSON(){return tr.convert(this)}}class Ce{convert(e){return S(e,q),{...x.convert(e),status:e.status}}}const tr=new Ce,Je="BadResponseClientError";class sr extends q{constructor(e,r,s="bad server response: client error"){super(e,r,s),Object.freeze(this)}get code(){return Je}toJSON(){return or.encode(this)}}class Xt{convert(e){return d(e,"code","message","status"),p(e,Je),new sr(Number(e.status),null,i.decode(e.message))}}class _t extends Ce{}class Zt extends c{constructor(){super(...arguments);t(this,"encoder",new _t);t(this,"decoder",new Xt)}}const or=new Zt;f(Je,or);const $e="BadResponseError";class cr extends q{constructor(e,r,s="bad server response"){super(e,r,s),Object.freeze(this)}get code(){return $e}toJSON(){return ir.encode(this)}}class Kt{convert(e){return d(e,"code","message","status"),p(e,$e),new cr(Number(e.status),null,i.decode(e.message))}}class Yt extends Ce{}class es extends c{constructor(){super(...arguments);t(this,"encoder",new Yt);t(this,"decoder",new Kt)}}const ir=new es;f($e,ir);class ar extends q{constructor(e,r,s="bad server response: server error"){super(e,r,s),Object.freeze(this)}get code(){return He}}const He="BadResponseServerError";class ns{convert(e){return d(e,"code","message","status"),p(e,He),new ar(Number(e.status),null,i.decode(e.message))}}class rs extends Ce{}class ts extends c{constructor(){super(...arguments);t(this,"encoder",new rs);t(this,"decoder",new ns)}}const ss=new ts;f(He,ss);const Ve="ChannelClosedError";class J extends g{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return Ve}}class os{convert(e){return d(e,"code","message"),p(e,Ve),new J(i.decode(e.message))}}class cs extends y{}class is extends c{constructor(){super(...arguments);t(this,"encoder",new cs);t(this,"decoder",new os)}}const as=new is;f(Ve,as);const Qe="FetchError";class Ge extends g{constructor(r,s=`fetch failed: ${String(r)}`){super(s);t(this,"cause");this.cause=r,Object.freeze(this)}get code(){return Qe}}class ds{convert(e){return d(e,"code","message"),p(e,Qe),new Ge({},i.decode(e.message))}}class ls extends y{}class us extends c{constructor(){super(...arguments);t(this,"encoder",new ls);t(this,"decoder",new ds)}}const hs=new us;f(Qe,hs);const Xe="IncorrectBase64PaddingError";class dr extends g{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return Xe}}class ws{convert(e){return d(e,"code","message"),p(e,Xe),new dr(i.decode(e.message))}}class ps extends y{}class fs extends c{constructor(){super(...arguments);t(this,"encoder",new ps);t(this,"decoder",new ws)}}const gs=new fs;f(Xe,gs);class ms{convert(e){if(!It(e))throw new h(typeof e,"number");return e}}class Cs{convert(e){return Kn(e,"number"),e}}class vs extends c{constructor(){super(...arguments);t(this,"encoder",new Cs);t(this,"decoder",new ms)}}const m=new vs,lr=new pe(new he(m),new we(m));new F(new M(m),new T(m)),new F(new M(lr),new T(lr));const _e="InvalidBase64AlphabetLengthError";class Ze extends g{constructor(r,s=`alphabet needs to be 64 characters, received ${r}`){super(s);t(this,"length");this.length=r,Object.freeze(this)}toJSON(){return ur.encode(this)}get code(){return _e}}class ys{convert(e){return d(e,"code","length","message"),p(e,_e),new Ze(m.decode(e.length),i.decode(e.message))}}class Ss{convert(e){return S(e,Ze),{...x.convert(e),length:m.encode(e.length)}}}class bs extends c{constructor(){super(...arguments);t(this,"encoder",new Ss);t(this,"decoder",new ys)}}const ur=new bs;f(_e,ur);const Ke="InvalidHexStringError";class Ye extends g{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return Ke}}class Es{convert(e){return d(e,"code","message"),p(e,Ke),new Ye(i.decode(e.message))}}class ks extends y{}class xs extends c{constructor(){super(...arguments);t(this,"encoder",new ks);t(this,"decoder",new Es)}}const Is=new xs;f(Ke,Is);const en="InvalidHexValueError";class hr extends g{constructor(r,s=`invalid hex value "${r}"`){super(s);t(this,"value");this.value=r,Object.freeze(this)}toJSON(){return wr.encode(this)}get code(){return en}}class Rs{convert(e){return d(e,"code","value","message"),p(e,en),new hr(m.decode(e.value),i.decode(e.message))}}class Ds{convert(e){return{...x.convert(e),value:m.encode(e.value)}}}class Bs extends c{constructor(){super(...arguments);t(this,"encoder",new Ds);t(this,"decoder",new Rs)}}const wr=new Bs;f(en,wr);const nn="InvalidInputError";class $ extends g{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return nn}}class As{convert(e){return d(e,"code","message"),p(e,nn),new $(i.decode(e.message))}}class Ns extends y{}class Us extends c{constructor(){super(...arguments);t(this,"encoder",new Ns);t(this,"decoder",new As)}}const Os=new Us;f(nn,Os);const rn="InvalidStringValueError";class pr extends g{constructor(r,s,o=`invalid string value: have "${r}", want "${s}"`){super(o);t(this,"have");t(this,"want");this.have=r,this.want=s,Object.freeze(this)}toJSON(){return fr.encode(this)}get code(){return rn}}class Ws{convert(e){return d(e,"code","have","want","message"),p(e,rn),new pr(i.decode(e.have),i.decode(e.want),i.decode(e.message))}}class Ms{convert(e){return S(e,pr),{...x.convert(e),have:i.encode(e.have),want:i.encode(e.want)}}}class Ts extends c{constructor(){super(...arguments);t(this,"encoder",new Ms);t(this,"decoder",new Ws)}}const fr=new Ts;f(rn,fr);const tn="InvalidTaggedBase64EncodingError";class gr extends g{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return mr.encode(this)}get code(){return tn}}class Fs{convert(e){return d(e,"code","message"),p(e,tn),new gr(i.decode(e.message))}}class Ps extends y{}class Ls extends c{constructor(){super(...arguments);t(this,"encoder",new Ps);t(this,"decoder",new Fs)}}const mr=new Ls;f(tn,mr);const sn="MissingElementError";class on extends g{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return sn}}class js{convert(e){return d(e,"code","message"),p(e,sn),new on(i.decode(e.message))}}class zs extends y{}class qs extends c{constructor(){super(...arguments);t(this,"encoder",new zs);t(this,"decoder",new js)}}const Js=new qs;f(sn,Js);const cn="NoCompleterFoundForRequestID";class Cr extends g{constructor(r,s=`no completer found for request id "${r}"`){super(s);t(this,"requestID");this.requestID=r,Object.freeze(this)}toJSON(){return vr.encode(this)}get code(){return cn}}class $s{convert(e){return d(e,"code","requestID","message"),p(e,cn),new Cr(ue.decode(e.requestID),i.decode(e.message))}}class Hs{convert(e){return S(e,Cr),{...x.convert(e),requestID:ue.encode(e.requestID)}}}class Vs extends c{constructor(){super(...arguments);t(this,"encoder",new Hs);t(this,"decoder",new $s)}}const vr=new Vs;f(cn,vr);const an="NotFoundError";class Qs extends g{constructor(r,s=`Not Found: ${r}`){super(s);t(this,"key");this.key=r,Object.freeze(this)}get code(){return an}}class yr{constructor(e){t(this,"codec");this.codec=e}convert(e){return d(e,"code","key"),p(e,an),new Qs(this.codec.decode(e.key))}}class Sr{constructor(e){t(this,"codec");this.codec=e}convert(e){return{...x.convert(e),key:this.codec.encode(e.key)}}}class br extends c{constructor(r,s){super();t(this,"encoder");t(this,"decoder");this.encoder=r,this.decoder=s}}new br(new Sr(i),new yr(i));const Gs=new br(new Sr(ue),new yr(ue));f(an,Gs);const dn="NoURLProvidedError";class Xs extends g{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return dn}}class _s{convert(e){return d(e,"code","message"),p(e,dn),new Xs(i.decode(e.message))}}class Zs extends y{}class Ks extends c{constructor(){super(...arguments);t(this,"encoder",new Zs);t(this,"decoder",new _s)}}const Ys=new Ks;f(dn,Ys);const ln="UnimplementedError";class b extends g{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return ln}}class eo{convert(e){return d(e,"code","message"),p(e,ln),new b(i.decode(e.message))}}class no extends y{}class ro extends c{constructor(){super(...arguments);t(this,"encoder",new no);t(this,"decoder",new eo)}}const to=new ro;f(ln,to);const un="QUERY_ERROR";class so extends g{constructor(r,s="missing element"){super(s);t(this,"error");this.error=r,Object.freeze(this)}get code(){return un}}class oo{convert(e){return d(e,"code","error","message"),p(e,un),new so(Ir.decode(e.error),i.decode(e.message))}}class co{convert(e){return{code:e.code,error:Ir.encode(e.error),message:i.encode(e.message)}}}class io extends c{constructor(){super(...arguments);t(this,"encoder",new co);t(this,"decoder",new oo)}}const ao=new io;class hn{}const wn="NotFound";class Er extends hn{constructor(){super(),Object.freeze(this)}valueOf(){return wn}toJSON(){return this.valueOf()}}const lo=new Er,pn="Missing";class kr extends hn{constructor(){super(),Object.freeze(this)}valueOf(){return pn}toJSON(){return this.valueOf()}}const uo=new kr;class xr extends hn{constructor(r){super();t(this,"error");this.error=r,Object.freeze(this)}toJSON(){return gn.encode(this)}}class ho{constructor(e){t(this,"message");this.message=e,Object.freeze(this)}toJSON(){return fn.encode(this)}}class wo{convert(e){return d(e,"message"),new ho(i.decode(e.message))}}class po{convert(e){return{message:i.encode(e.message)}}}class fo extends c{constructor(){super(...arguments);t(this,"encoder",new po);t(this,"decoder",new wo)}}const fn=new fo;class go{convert(e){return d(e,"Error"),new xr(fn.decode(e.Error))}}class mo{convert(e){return{Error:fn.encode(e.error)}}}class Co extends c{constructor(){super(...arguments);t(this,"encoder",new mo);t(this,"decoder",new go)}}const gn=new Co;class vo{convert(e){return e===wn?lo:e===pn?uo:gn.decode(e)}}class yo{convert(e){if(e instanceof Er)return wn;if(e instanceof kr)return pn;if(e instanceof xr)return gn.encode(e);throw new b}}class So extends c{constructor(){super(...arguments);t(this,"encoder",new yo);t(this,"decoder",new vo)}}const Ir=new So;f(un,ao);const Rr="ResponseContentTypeIsNotApplicationJSONError";class H extends q{constructor(r,s,o,a="response content type is not application/json"){super(s,o,a);t(this,"haveHeaderType");this.haveHeaderType=r,Object.freeze(this)}static fromResponse(r,s){return new H(r.headers.get("content-type")??"undefined",r.status,r,s)}toJSON(){return Dr.encode(this)}get code(){return Rr}}class bo{convert(e){return d(e,"code","status","have","want","message"),p(e,Rr),new H(i.decode(e.code),m.decode(e.status),null,i.decode(e.message))}}class Eo{convert(e){return{...tr.convert(e),have:i.encode(e.haveHeaderType),want:i.encode("application/json")}}}class ko extends c{constructor(){super(...arguments);t(this,"encoder",new Eo);t(this,"decoder",new bo)}}const Dr=new ko;f(H.name,Dr);const mn="WebWorkerErrorResponse";class xo extends g{constructor(r,s="error in web worker"){super(s);t(this,"error");this.error=r,Object.freeze(this)}toJSON(){return Br.encode(this)}get code(){return mn}}class Io{convert(e){return d(e,"code","error","message"),p(e,mn),new xo(le.decode(e.error),i.decode(e.message))}}class Ro{convert(e){return{...x.convert(e),error:le.encode(e.error)}}}class Do extends c{constructor(){super(...arguments);t(this,"encoder",new Ro);t(this,"decoder",new Io)}}const Br=new Do;f(mn,Br);var Cn=(n=>(n[n.success=0]="success",n[n.full=1]="full",n[n.failed=2]="failed",n))(Cn||{});class Bo{getFromEmpty(){}}class Ao{getFromEmpty(){return null}}class No{getFromEmpty(){throw new on}}const Ar={returnNull:new Ao,returnUndefined:new Bo,throwMissingElement:new No};class Uo{constructor(e){t(this,"maxSize");v(!Number.isNaN(e),"maxSize must not be NaN"),v(Number.isInteger(e),"maxSize must be an integer"),v(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return v(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class Oo{constructor(e){t(this,"preComputedSizeMinus1");v(!Number.isNaN(e),"maxSize must not be NaN"),v(Number.isInteger(e),"maxSize must be an integer"),v(e>0,"maxSize must be greater than 0"),v(Nr(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return v(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function Nr(n){return(n&n-1)===0}const vn="BufferFullError";class Ur extends g{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return vn}}class Wo{convert(e){return d(e,"code","message"),p(e,vn),new Ur(i.decode(e.message))}}class Mo extends y{}class To extends c{constructor(){super(...arguments);t(this,"encoder",new Mo);t(this,"decoder",new Wo)}}const Fo=new To;f(vn,Fo);class Po{putToFull(e,r){return e.get(),e.put(r)}}class Lo{putToFull(){return Cn.full}}class jo{putToFull(){throw new Ur}}const Or={overwriteOldest:new Po,returnFull:new Lo,throw:new jo};function zo(n){return Nr(n)?new Oo(n):new Uo(n)}class qo{constructor(e,r,s){t(this,"readIndex",0);t(this,"writeIndex",0);t(this,"buffer");t(this,"nextIndex");t(this,"getOnEmpty");t(this,"putOnFull");v(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=zo(e),this.getOnEmpty=r,this.putOnFull=s}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const r=this.nextIndex.nextIndex(this.writeIndex);return r===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=r,Cn.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new Jo(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new $o(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class Jo{constructor(e){t(this,"buffer");this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class $o{constructor(e,r,s,o){t(this,"readIndex");t(this,"writeIndex");t(this,"buffer");t(this,"nextIndex");this.readIndex=e,this.writeIndex=r,this.buffer=s,this.nextIndex=o}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function Wr(n=32,e=Ar.returnUndefined,r=Or.overwriteOldest){return new qo(n,e,r)}class Ho{constructor(e){t(this,"publishQueue");t(this,"pollBlocked");t(this,"publishBlocked");t(this,"capacity");t(this,"closed",!1);this.publishQueue=Wr(Math.max(2,e),Ar.throwMissingElement,Or.throw);const r=me();this.pollBlocked=r,this.publishBlocked=r,r.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new J;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new J;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const r=me();this.publishBlocked=r,await r.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new J;if(this.pollBlocked.isCompleted){const r=me();this.pollBlocked=r}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new Vo(this)}}class Vo{constructor(e){t(this,"channel");this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof J)return{done:!0,value:void 0};throw e}}}function ve(n){return new Ho(n)}class Qo{constructor(e){t(this,"channel");this.channel=e}async send(e){await this.channel.publish(e)}}function V(n){return new Qo(n)}const yn="CorruptBase64InputError";class A extends g{constructor(r,s=`corrupt input error at ${r}`){super(s);t(this,"offset");this.offset=r,Object.freeze(this)}get code(){return yn}toJSON(){return Mr.encode(this)}}class Go{convert(e){return d(e,"code","offset","message"),p(e,yn),new A(m.decode(e.offset),i.decode(e.message))}}class Xo{convert(e){return S(e,A),{...x.convert(e),offset:m.encode(e.offset),message:i.encode(e.message)}}}class _o extends c{constructor(){super(...arguments);t(this,"encoder",new Xo);t(this,"decoder",new Go)}}const Mr=new _o;f(yn,Mr);const Zo=new TextEncoder;function Tr(n){return Zo.encode(n)}const Ko=new TextDecoder;function Yo(n){return Ko.decode(n)}function*Fr(n){yield*Tr(n)}function*ec(){for(let n=0;n<256;n++)yield 255}const Q=-1,nc=61;class G{constructor(e,r,s=nc,o=!1){t(this,"encodeMap");t(this,"decodeMap");t(this,"padChar");t(this,"strict");this.encodeMap=e,this.decodeMap=r,this.padChar=s,this.strict=o}static withAlphabet(e){const r=e.length;if(r!==64)throw new Ze(r);const s=Array.from(Fr(e)),o=Array.from(ec());for(let a=0;a<r;a++)o[s[a]]=a;return new G(s,o)}withPadding(e){return new G(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let r=0,s=0;const o=Math.floor(e.byteLength/3)*3,a=Math.ceil(e.byteLength/3)*4,u=new ArrayBuffer(a),l=new DataView(e),C=new DataView(u);for(;s<o;){const O=l.getUint8(s+0)<<16|l.getUint8(s+1)<<8|l.getUint8(s+2);C.setUint8(r+0,this.encodeMap[O>>18&63]),C.setUint8(r+1,this.encodeMap[O>>12&63]),C.setUint8(r+2,this.encodeMap[O>>6&63]),C.setUint8(r+3,this.encodeMap[O&63]),s+=3,r+=4}const w=e.byteLength-s;if(w===0)return u;let B=l.getUint8(s+0)<<16;switch(w===2&&(B|=l.getUint8(s+1)<<8),C.setUint8(r+0,this.encodeMap[B>>18&63]),C.setUint8(r+1,this.encodeMap[B>>12&63]),w){case 2:return C.setUint8(r+2,this.encodeMap[B>>6&63]),this.padChar!==Q?(C.setUint8(r+3,this.padChar),u.slice(0,r+4)):u.slice(0,r+3);case 1:if(this.padChar!==Q)return C.setUint8(r+2,this.padChar),C.setUint8(r+3,this.padChar),u.slice(0,r+4);break}return u.slice(0,r+2)}decode(e){const r=e.byteLength;if(r===0)return new ArrayBuffer(0);const s=new DataView(e),o=new ArrayBuffer(Math.floor(r/4*3)),a=new DataView(o),u=new ArrayBuffer(4),l=new DataView(u);let C=0,w=0,B=0,O=!1;for(;w<r&&!O;){let _n=3,Me=4;for(let k=0;k<4;k++){if(w===r){if(k===0)return o;if(k===1||this.padChar!==Q)throw new A(w-k);_n=k-1,Me=k,O=!0;break}const Te=s.getUint8(w);w++;const kt=this.decodeMap[Te];if(kt!==255){l.setUint8(k,kt);continue}if(Te===10||Te===13){k--;continue}if(Te===this.padChar){switch(k){case 0:case 1:throw new dr;case 2:for(;w<r&&(s.getUint8(w)===10||s.getUint8(w)===13);)w++;if(w===r)throw new A(r);w++}for(;w<r&&(s.getUint8(w)===10||s.getUint8(w)===13);)w++;if(w<r)throw new A(w);_n=3,Me=k,O=!0;break}throw new A(w-1)}const Zn=l.getUint8(0)<<18|l.getUint8(1)<<12|l.getUint8(2)<<6|l.getUint8(3);switch(l.setUint8(2,Zn>>0&255),l.setUint8(1,Zn>>8&255),l.setUint8(0,Zn>>16&255),Me){case 4:a.setUint8(B+2,l.getUint8(2)),l.setUint8(2,0);case 3:if(a.setUint8(B+1,l.getUint8(1)),this.strict&&l.getUint8(2)!==0)throw new A(w-1);case 2:if(a.setUint8(B+0,l.getUint8(0)),this.strict&&(l.getUint8(1)!==0||l.getUint8(2)!==0))throw new A(w-2)}B+=_n,C+=Me-1}return o.slice(0,C)}decodeString(e){return this.decode(Tr(e).buffer)}encodeToString(e){return Yo(this.encode(e))}}const Pr=G.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),rc=Pr.withPadding(Q),Lr=G.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Sn=Lr.withPadding(Q);function*tc(n,e){for(let r=n.next();!r.done;r=n.next())e(r.value)&&(yield r.value)}function sc(n,e){return tc(n[Symbol.iterator](),e)}function*jr(n,e){for(let r=n.next();!r.done;r=n.next())yield e(r.value)}function ye(n,e){return jr(n[Symbol.iterator](),e)}function oc(n){let e;for(let r=n.next();!r.done;r=n.next())e=r.value;if(e===void 0)throw new on;return e}function zr(n){return oc(n[Symbol.iterator]())}function*cc(n,e,r){for(let s=n.next(),o=e.next();!s.done&&!o.done;s=n.next(),o=e.next())yield r(s.value,o.value)}function ic(n,e,r){return cc(n[Symbol.iterator](),e[Symbol.iterator](),r)}function qr(n){if(n.startsWith("0x"))return qr(n.substring(2));if(n.length&1)throw new Ye;const e=new ArrayBuffer(n.length/2);return ac(Fr(n),e),e}function ac(n,e){const r=new DataView(e);let s=0;for(;s<e.byteLength;){const o=n.next(),a=n.next();if(o.done||a.done)throw new Ye;const u=Jr(o.value),l=Jr(a.value),C=u<<4|l;r.setUint8(s,C),s++}}function Jr(n){if(n>=48&&n<=57)return n-48;if(n>=97&&n<=102)return n-97+10;if(n>=65&&n<=70)return n-65+10;throw new hr(n)}function dc(n){return n.toString(16).padStart(2,"0")}function*lc(n){yield*jr(n,dc)}function uc(n){return lc(n[Symbol.iterator]())}class hc{convert(e){if(typeof e!="string")throw new h(typeof e,"string");return qr(e)}}class wc{convert(e){return S(e,ArrayBuffer),["0x",...uc(new Uint8Array(e))].join("")}}class pc extends c{constructor(){super(...arguments);t(this,"encoder",new wc);t(this,"decoder",new hc)}}const N=new pc;new pe(new he(N),new we(N)),new F(new M(N),new T(N));class fc{constructor(e){t(this,"encoding");this.encoding=e}convert(e){if(typeof e!="string")throw new h(typeof e,"string");return this.encoding.decodeString(e)}}class gc{constructor(e){t(this,"encoding");this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class Se extends c{constructor(r){super();t(this,"encoder");t(this,"decoder");this.encoder=new gc(r),this.decoder=new fc(r)}}new Se(Sn),new Se(rc),new Se(Lr),new Se(Pr);class mc{convert(e){if(!z(e))throw new h(typeof e,"string");return new URL(e)}}class Cc{convert(e){return e.toString()}}class vc extends c{constructor(){super(...arguments);t(this,"encoder",new Cc);t(this,"decoder",new mc)}}const $r=new vc;new pe(new he($r),new we($r));class Hr{}class Vr{}const X="Close";class be extends Vr{valueOf(){return X}}class yc{convert(){return X}}class Sc{convert(e){if(typeof e!="string")throw new h(typeof e,"string");if(e!==X)throw new h(e,X);return new be}}class bc extends c{constructor(){super(...arguments);t(this,"encoder",new yc);t(this,"decoder",new Sc)}}const Qr=new bc,_="Connect";class Ee extends Vr{valueOf(){return _}toJSON(){return bn.encode(this)}}class Ec{convert(){return _}}class kc{convert(e){if(typeof e!="string")throw new h(typeof e,"string");if(e!==_)throw new h(e,_);return new Ee}}class xc extends c{constructor(){super(...arguments);t(this,"encoder",new Ec);t(this,"decoder",new kc)}}const bn=new xc;class Ic{convert(e){if(e===_)return bn.decode(e);if(e===X)return Qr.decode(e);throw new b}}class Rc{convert(e){if(e instanceof Ee)return bn.encode(e);if(e instanceof be)return Qr.encode(e);throw new b}}class Dc extends c{constructor(){super(...arguments);t(this,"encoder",new Rc);t(this,"decoder",new Ic)}}const Gr=new Dc;class En extends Hr{constructor(r){super();t(this,"command");this.command=r}get type(){return Z}toJson(){return Xr.encode(this)}}const Z="WebSocket";class Bc{convert(e){return{[Z]:Gr.encode(e.command)}}}class Ac{convert(e){return d(e,Z),new En(Gr.decode(e[Z]))}}class Nc extends c{constructor(){super(...arguments);t(this,"encoder",new Bc);t(this,"decoder",new Ac)}}const Xr=new Nc,P=new Map;P.set(Z,Xr);class Uc{convert(e){const r=P.get(e.type);if(!r)throw new h(e.type,`one of ${Array.from(ye(P.keys(),s=>`"${s}"`)).join(", ")}`);return{[e.type]:r.encode(e)}}}class Oc{convert(e){if(typeof e!="object"||e===null)throw new h(typeof e,"object");const r=Object.keys(e);if(r.length!==1)throw new b("multiple values contained within the Request object, unexpected");const[s]=r,o=P.get(s);if(d(e,s),!o)throw new h(s,`one of ${Array.from(ye(P.keys(),a=>`"${a}"`)).join(", ")}`);return o.decode(e[s])}}class Wc extends c{constructor(){super(...arguments);t(this,"encoder",new Uc);t(this,"decoder",new Oc)}}function Mc(n,e){P.has(n)||P.set(n,e)}const Tc=new Wc;class kn{}const K="Error";class _r extends kn{constructor(r){super();t(this,"error");this.error=r}get type(){return K}toJson(){return Zr.encode(this)}}class Fc{convert(e){return{[K]:le.encode(e.error)}}}class Pc{convert(e){return d(e,K),new _r(le.decode(e[K]))}}class Lc extends c{constructor(){super(...arguments);t(this,"encoder",new Fc);t(this,"decoder",new Pc)}}const Zr=new Lc;class xn{}const Y="Closed";class ke extends xn{valueOf(){return Y}toJSON(){return In.encode(this)}}class jc{convert(e){if(typeof e!="string")throw new h(typeof e,"string");if(e!==Y)throw new h(e,Y);return new ke}}class zc{convert(){return Y}}class qc extends c{constructor(){super(...arguments);t(this,"encoder",new zc);t(this,"decoder",new jc)}}const In=new qc,ee="Connecting";class xe extends xn{valueOf(){return ee}toJSON(){return Rn.encode(this)}}class Jc{convert(e){if(typeof e!="string")throw new h(typeof e,"string");if(e!==ee)throw new h(e,ee);return new xe}}class $c{convert(){return ee}}class Hc extends c{constructor(){super(...arguments);t(this,"encoder",new $c);t(this,"decoder",new Jc)}}const Rn=new Hc,ne="Opened";class Ie extends xn{valueOf(){return ne}toJSON(){return Dn.encode(this)}}class Vc{convert(e){if(typeof e!="string")throw new h(typeof e,"string");if(e!==ne)throw new h(e,ne);return new Ie}}class Qc{convert(){return ne}}class Gc extends c{constructor(){super(...arguments);t(this,"encoder",new Qc);t(this,"decoder",new Vc)}}const Dn=new Gc;class Xc{convert(e){if(e===ne)return Dn.decode(e);if(e===Y)return In.decode(e);if(e===ee)return Rn.decode(e);throw new b}}class _c{convert(e){if(e instanceof Ie)return Dn.encode(e);if(e instanceof ke)return In.encode(e);if(e instanceof xe)return Rn.encode(e);throw new b}}class Zc extends c{constructor(){super(...arguments);t(this,"encoder",new _c);t(this,"decoder",new Xc)}}const Kr=new Zc;class Yr extends kn{constructor(r){super();t(this,"status");this.status=r}get type(){return re}toJson(){return et.encode(this)}}const re="WebSocket";class Kc{convert(e){return{[re]:Kr.encode(e.status)}}}class Yc{convert(e){return d(e,re),new Yr(Kr.decode(e[re]))}}class ei extends c{constructor(){super(...arguments);t(this,"encoder",new Kc);t(this,"decoder",new Yc)}}const et=new ei,U=new Map;U.set(K,Zr),U.set(re,et);class ni{convert(e){const r=U.get(e.type);if(!r)throw new h(e.type,`one of ${Array.from(ye(U.keys(),s=>`"${s}"`)).join(", ")}`);return{[e.type]:r.encode(e)}}}class ri{convert(e){if(typeof e!="object"||e===null)throw new h(typeof e,"object");const r=Object.keys(e);if(r.length!==1)throw new b("multiple values contained within the response object, unexpected");const[s]=r,o=U.get(s);if(d(e,s),!o)throw new h(s,`one of ${Array.from(ye(U.keys(),a=>`"${a}"`)).join(", ")}`);return o.decode(e[s])}}class ti extends c{constructor(){super(...arguments);t(this,"encoder",new ni);t(this,"decoder",new ri)}}function si(n,e){U.has(n)||U.set(n,e)}const oi=new ti;class ci{convert(e){return new _r(e)}}const ii=new ci;class ai{convert(e){return new Yr(e)}}const nt=new ai;class di{constructor(e,r){this.sink=e,this.converter=r,this.sink=e,this.converter=r}async send(e){await this.sink.send(this.converter.convert(e))}}function te(n,e){return new di(n,e)}async function rt(n){return new Promise(e=>{const r=setTimeout(()=>{clearTimeout(r),e()},n)})}class R{constructor(e,r,s){t(this,"significantDigitsMultiplier");this.alpha3Code=e,this.code=r,this.significantDigits=s,this.alpha3Code=e,this.code=r,this.significantDigits=s,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}toJSON(){return Re.encode(this)}}const tt=new R("JPY",392,0),li=new R("GBP",826,2),st=new R("USD",840,2),ui=new R("EUR",978,2),hi=new R("XXX",999,2),ot=new R("ETH",1001,18),Bn=new R("XBT",1002,8),ct=new R("ESP",10001,18),wi=[tt,li,st,ui,hi,ot,Bn,ct],pi=new Map(wi.map(n=>[n.alpha3Code,n]));class fi{convert(e){if(typeof e!="string")throw new $("CurrencyCodeDecoder: expected string");if(e==="BTC")return Bn;const r=pi.get(e);if(r===void 0)throw new $(`CurrencyCodeDecoder: unknown currency: "${e}"`);return r}}class gi{convert(e){return S(e,R),e.alpha3Code}}class mi extends c{constructor(){super(...arguments);t(this,"decoder",new fi);t(this,"encoder",new gi)}}const Re=new mi;class D{constructor(e,r){this.currency=e,this.value=r,this.currency=e,this.value=r}static USD(e){return new D(st,BigInt(e))}static ETH(e){return new D(ot,BigInt(e))}static ESP(e){return new D(ct,BigInt(e))}static JPY(e){return new D(tt,BigInt(e))}static BTC(e){return new D(Bn,BigInt(e))}toString(){return De.encode(this)}toJSON(){return De.encode(this)}}function Ci(n){return n==="."||n===","||n===" "}function vi(n,e){let r=-1;const s=n.length;for(let o=0;o<s;o++)e(n[o])&&(r=o);return r}class yi{parseCurrencyCode(e){return Re.decode(e)}parseValue(e,r){let s=1n;r[0]==="-"&&(s=-1n,r=r.substring(1));const o=vi(r,Ci);if(o===-1){const w=BigInt(r.replace(/\D/g,""))*e.significantDigitsMultiplier;return s*w}const a=r.substring(0,o).replace(/\D/g,""),u=r.substring(o+1).replace(/\D/g,""),l=BigInt(a)*e.significantDigitsMultiplier,C=BigInt(u)*10n**BigInt(e.significantDigits-u.length);return s*(l+C)}convert(e){if(typeof e!="string")throw new $("MonetaryValueDecoder: expected string");const r=e.indexOf(" ");if(r<=-1)throw new $("MonetaryValueDecoder: missing non-breaking space");const s=e.substring(0,r),o=e.substring(r+1);if(/^-?[\d .,]+$/.test(s)){const u=this.parseCurrencyCode(o);return new D(u,this.parseValue(u,s))}const a=this.parseCurrencyCode(s);return new D(a,this.parseValue(a,o))}}class Si{convert(e){S(e,D);const r=e.value<0n?"-":"",s=e.value<0n?-e.value:e.value,o=s%e.currency.significantDigitsMultiplier,a=s/e.currency.significantDigitsMultiplier,u=String(a),l=String(o);return/^0+$/.test(l)?`${Re.encode(e.currency)} ${r}${u}`:`${Re.encode(e.currency)} ${r}${a}.${String(o).padStart(e.currency.significantDigits,"0")}`}}class bi extends c{constructor(){super(...arguments);t(this,"decoder",new yi);t(this,"encoder",new Si)}}const De=new bi;new F(new M(De),new T(De));class E{constructor(e,r,s,o){t(this,"namespace");t(this,"name");t(this,"site");t(this,"blockExplorer");this.namespace=e,this.name=r,this.site=s,this.blockExplorer=o}}const Ei=new E(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),ki=new E(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),xi=new E(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),Ii=new E(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),Ri=new E(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),Di=new E(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),Bi=new E(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),Ai=new E(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),Ni=new E(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),Ui=new E(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),Oi=new E(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),Wi=new Map([Ei,ki,xi,Ni,Ii,Ri,Di,Bi,Ai,Ui,Oi].map(n=>[n.namespace,n]));class se{constructor(e,r){t(this,"tag");t(this,"data");this.tag=e,this.data=r}static fromString(e){const r=e.indexOf("~");if(r<0)throw new gr;const s=e.substring(0,r),o=Sn.decodeString(e.substring(r+1));return new se(s,o)}static inflate(e){return Pi.decode(e)}toString(){return`${this.tag}~${Sn.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class Mi{convert(e){if(typeof e!="string")throw new h(typeof e,"string");return se.fromString(e)}}class Ti{convert(e){return S(e,se),e.toString()}}class Fi extends c{constructor(){super(...arguments);t(this,"encoder",new Ti);t(this,"decoder",new Mi)}}const Pi=new Fi,it=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],at=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],dt=["Linux","Unix","Windows","MacOS"],lt=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],Be=2147483648,Li=1103515245,ji=12345;class ut{constructor(e){t(this,"state");this.state=e!==void 0?e:Math.floor(Math.random()*(Be-1))}nextInt(){return this.state=(Li*this.state+ji)%Be,this.state}nextFloat(){return this.nextInt()/(Be-1)}nextRange(e,r){const s=r-e,o=this.nextInt()/Be;return e+Math.floor(o*s)}fillBytes(e){const r=new ArrayBuffer(e),s=new DataView(r);let o=0;for(;o<e-4;o+=4)s.setUint32(o,this.nextRange(0,4294967295));for(let a=o;a<e;a++)s.setUint8(a,this.nextRange(0,256));return r}}const zi=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],ht=[0,0,5,26,28,26,9,6],qi=ht.reduce((n,e)=>n+e,0),Ji=ht.reduce((n,e)=>{const r=n[n.length-1]??0;return n.push(r+e),n},[]),$i=Array.from(ic(Ji,zi,(n,e)=>[n,e])),An=new Date,wt=new Date(An.getFullYear(),An.getMonth(),An.getDate()).valueOf();function Hi(){return wt}Array.from(Wi.keys());function Vi(n){const e=n.nextRange(0,qi),r=sc($i,([u])=>u<=e),[,s]=zr(r),o=n.nextRange(0,s.length);return s[o]}function Qi(n){const e=n.nextRange(0,lt.length);return lt[e]}function Gi(n){const e=n.nextRange(0,dt.length);return dt[e]}function Xi(n){const e=n.nextRange(0,at.length);return at[e]}function _i(n){const e=n.nextRange(0,it.length);return it[e]}function Zi(n){const[e,r]=Qi(n),[,s,o,a]=Vi(n),u=Gi(n),l=Xi(n),C=_i(n);return{pubkey:new se("PUBKEY",n.fillBytes(32)),name:`${e} Node ${a} ${n.nextRange(0,100)}`,address:n.fillBytes(32),company:{name:e,website:r},location:{coords:[s,o],country:a},operatingSystem:u,networkType:C,nodeType:l}}function*Ki(){const n=new ut(wt),e=n.nextRange(50,150);for(let r=0;r<e;r++)yield Zi(n)}Array.from(Ki());class Nn{constructor(e,r){t(this,"block");t(this,"offset");this.block=e,this.offset=r,Object.freeze(this)}toJSON(){return Un.encode(this)}}class Yi{convert(e){return{block:m.encode(e.block),offset:m.encode(e.offset)}}}class ea{convert(e){return d(e,"block","offset"),new Nn(m.decode(e.block),m.decode(e.offset))}}class na extends c{constructor(){super(...arguments);t(this,"encoder",new Yi);t(this,"decoder",new ea)}}const Un=new na;class pt{constructor(e){t(this,"address");this.address=e,Object.freeze(this)}toJSON(){return On.encode(this)}}class ra{convert(e){return N.encode(e.address)}}class ta{convert(e){return new pt(N.decode(e))}}class sa extends c{constructor(){super(...arguments);t(this,"encoder",new ra);t(this,"decoder",new ta)}}const On=new sa;class ft{constructor(e,r,s){t(this,"address");t(this,"time");t(this,"message");this.address=e,this.time=r,this.message=s,Object.freeze(this)}toJSON(){return L.encode(this)}}class oa{convert(e){return{address:On.encode(e.address),time:m.encode(Math.floor(e.time.valueOf()/1e3)),message:i.encode(e.message)}}}class ca{convert(e){return d(e,"address","time","message"),new ft(On.decode(e.address),new Date(m.decode(e.time)*1e3),i.decode(e.message))}}class ia extends c{constructor(){super(...arguments);t(this,"encoder",new oa);t(this,"decoder",new ca)}}const L=new ia;new F(new M(L),new T(L));class Wn{constructor(e,r){t(this,"inscription");t(this,"chainDetails");this.inscription=e,this.chainDetails=r,Object.freeze(this)}toJSON(){return oe.encode(this)}}class aa{convert(e){return{inscription:L.encode(e.inscription),chain_details:Un.encode(e.chainDetails)}}}class da{convert(e){return d(e,"inscription","chain_details"),new Wn(L.decode(e.inscription),Un.decode(e.chain_details))}}class la extends c{constructor(){super(...arguments);t(this,"encoder",new aa);t(this,"decoder",new da)}}const oe=new la,Mn=new F(new M(oe),new T(oe));class ua{constructor(e,r){t(this,"inscription");t(this,"signature");this.inscription=e,this.signature=r,Object.freeze(this)}toJSON(){return Tn.encode(this)}}class ha{convert(e){return{inscription:L.encode(e.inscription),signature:N.encode(e.signature)}}}class wa{convert(e){return d(e,"inscription","signature"),new ua(L.decode(e.inscription),N.decode(e.signature))}}class pa extends c{constructor(){super(...arguments);t(this,"encoder",new ha);t(this,"decoder",new wa)}}const Tn=new pa;class gt{}const Fn="PutInscription";class Ae extends gt{constructor(r){super();t(this,"inscriptionAndSignature");this.inscriptionAndSignature=r,Object.freeze(this)}toJSON(){return Pn.encode(this)}}class fa{convert(e){return{type:i.encode(Fn),inscription_and_signature:Tn.encode(e.inscriptionAndSignature)}}}class ga{convert(e){return d(e,"type","inscription_and_signature"),Yn(e,Fn),new Ae(Tn.decode(e.inscription_and_signature))}}class ma extends c{constructor(){super(...arguments);t(this,"encoder",new fa);t(this,"decoder",new ga)}}const Pn=new ma,Ln="RetrieveInscriptionsForAddress";class jn extends gt{constructor(r){super();t(this,"address");this.address=r,Object.freeze(this)}toJSON(){return zn.encode(this)}}class Ca{convert(e){return{type:i.encode(Ln),address:i.encode(e.address)}}}class va{convert(e){return d(e,"type","address"),Yn(e,Ln),new jn(i.decode(e.address))}}class ya extends c{constructor(){super(...arguments);t(this,"encoder",new Ca);t(this,"decoder",new va)}}const zn=new ya;class Sa{convert(e){return e instanceof Ae?Pn.encode(e):e instanceof jn?zn.encode(e):e.toJSON()}}class ba{convert(e){if(d(e,"type"),!z(e.type))throw new h(typeof e.type,"string");switch(e.type){case Fn:return Pn.decode(e);case Ln:return zn.decode(e);default:throw new h(e.type,"CappuccinoInscriptionRequest")}}}class Ea extends c{constructor(){super(...arguments);t(this,"encoder",new Sa);t(this,"decoder",new ba)}}const mt=new Ea,ce="Inscription";class qn extends Hr{constructor(r){super();t(this,"request");this.request=r}get type(){return ce}toJson(){return Ct.encode(this)}}class ka{convert(e){return{[ce]:mt.encode(e.request)}}}class xa{convert(e){d(e,ce);const r=e[ce];return new qn(mt.decode(r))}}class Ia extends c{constructor(){super(...arguments);t(this,"encoder",new ka);t(this,"decoder",new xa)}}const Ct=new Ia;class Jn{}const Ne="LatestInscription";class ie extends Jn{constructor(r){super();t(this,"inscriptionAndChainDetails");this.inscriptionAndChainDetails=r}toJSON(){return $n.encode(this)}}class Ra{convert(e){d(e,Ne);const r=e[Ne];return new ie(oe.decode(r))}}class Da{convert(e){return{[Ne]:oe.encode(e.inscriptionAndChainDetails)}}}class Ba extends c{constructor(){super(...arguments);t(this,"encoder",new Da);t(this,"decoder",new Ra)}}const $n=new Ba,Ue="RetrievedInscriptionsForWalletAddress";class Hn extends Jn{constructor(r){super();t(this,"inscriptionAndChainDetails");this.inscriptionAndChainDetails=r}toJSON(){return Vn.encode(this)}}class Aa{convert(e){d(e,Ue);const r=e[Ue];return new Hn(Mn.decode(r))}}class Na{convert(e){return{[Ue]:Mn.encode(e.inscriptionAndChainDetails)}}}class Ua extends c{constructor(){super(...arguments);t(this,"encoder",new Na);t(this,"decoder",new Aa)}}const Vn=new Ua;class Oa{constructor(e,r,s){t(this,"numBlocks");t(this,"numTransactions");t(this,"numInscriptions");this.numBlocks=e,this.numTransactions=r,this.numInscriptions=s}}class Wa{convert(e){return{num_blocks:m.encode(e.numBlocks),num_transactions:m.encode(e.numTransactions),num_inscriptions:m.encode(e.numInscriptions)}}}class Ma{convert(e){return d(e,"num_blocks","num_transactions","num_inscriptions"),new Oa(m.decode(e.num_blocks),m.decode(e.num_transactions),m.decode(e.num_inscriptions))}}class Ta extends c{constructor(){super(...arguments);t(this,"encoder",new Wa);t(this,"decoder",new Ma)}}const vt=new Ta,Oe="Stats";class yt extends Jn{constructor(r){super();t(this,"stats");this.stats=r}toJSON(){return Qn.encode(this)}}class Fa{convert(e){d(e,Oe);const r=e[Oe];return new yt(vt.decode(r))}}class Pa{convert(e){return{[Oe]:vt.encode(e.stats)}}}class La extends c{constructor(){super(...arguments);t(this,"encoder",new Pa);t(this,"decoder",new Fa)}}const Qn=new La;class ja{convert(e){if(Le(e,Ne))return $n.decode(e);if(Le(e,Oe))return Qn.decode(e);if(Le(e,Ue))return Vn.decode(e);throw new b}}class za{convert(e){if(e instanceof ie)return $n.encode(e);if(e instanceof yt)return Qn.encode(e);if(e instanceof Hn)return Vn.encode(e);throw new b}}class qa extends c{constructor(){super(...arguments);t(this,"encoder",new za);t(this,"decoder",new ja)}}const Gn=new qa,ae="InscriptionResponse";class St extends kn{constructor(r){super();t(this,"response");this.response=r}get type(){return ae}toJson(){return bt.encode(this)}}class Ja{convert(e){return{[ae]:Gn.encode(e.response)}}}class $a{convert(e){d(e,ae);const r=e[ae];return new St(Gn.decode(r))}}class Ha extends c{constructor(){super(...arguments);t(this,"encoder",new Ja);t(this,"decoder",new $a)}}const bt=new Ha;class Va{convert(e){return new St(e)}}const Et=new Va,Qa="An Infinite Garden has no walls";function*Ga(n){const e=new Date;let s=new Date(e.getFullYear(),e.getMonth(),e.getDate()),o=0;for(;;){const a=Za(s,o,n);yield a,s=a.inscription.time,o=a.chainDetails.block}}function*Xa(n){const e=new Date,r=n[Symbol.iterator]();for(let s=r.next();!s.done&&s.value.inscription.time.valueOf()<e.valueOf();s=r.next())yield s.value}async function*_a(n){for(const e of n){const r=new Date,o=e.inscription.time.valueOf()-r.valueOf();o>0&&await rt(o),yield e}}function Za(n,e,r){const s=r.nextRange(5,10)*1e3,o=r.nextRange(1,20),a=r.nextRange(0,5),u=new ft(Ka(r),new Date(n.valueOf()+s),Qa),l=new Nn(e+o,a);return new Wn(u,l)}function Ka(n){return new pt(n.fillBytes(20))}class Ya{constructor(e,r){t(this,"responseStream");t(this,"requestStream");t(this,"webSocketStatusSink");t(this,"inscriptionResponseSink");t(this,"prng",new ut(Hi()));t(this,"latestInscriptions",Wr(100));t(this,"allInscriptions",Ga(this.prng));t(this,"isConnected",!1);this.requestStream=e,this.responseStream=r,this.webSocketStatusSink=te(V(r),nt),this.inscriptionResponseSink=te(V(r),Et)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async initializeState(){for(const e of Xa(this.allInscriptions))this.latestInscriptions.put(e)}async startProcessing(){await this.initializeState(),this.handleRequests(),this.streamInscriptions()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async streamInscriptions(){for await(const e of _a(this.allInscriptions))this.latestInscriptions.put(e),this.isConnected&&this.inscriptionResponseSink.send(new ie(e))}async handleRequest(e){if(e instanceof En){try{await this.handleWebSocketCommand(e.command)}catch(r){console.error("failed to handle life cycle request",e,r)}return}if(e instanceof qn){try{await this.handleInscriptionsRequest(e.request)}catch(r){console.error("failed to handle node validator request",e,r)}return}console.error("unrecognized request type",e)}async handleWebSocketCommand(e){if(e instanceof Ee){await this.handleConnect();return}if(e instanceof be){await this.handleClose();return}}async handleInscriptionsRequest(e){if(e instanceof Ae){await this.handlePutInscription(e);return}throw new b}async handleConnect(){if(this.isConnected)throw new Error("already connected to WebSocket");this.isConnected=!0,await this.webSocketStatusSink.send(new xe),await this.webSocketStatusSink.send(new Ie);for(const e of this.latestInscriptions.immutableIterable())this.inscriptionResponseSink.send(new ie(e))}async handleClose(){if(!this.isConnected)throw new Error("not connected to WebSocket");this.isConnected=!1,await this.webSocketStatusSink.send(new ke)}async handlePutInscription(e){const r=zr(this.latestInscriptions.immutableIterable()),s=new Nn(r.chainDetails.block+1,0),o=new Wn(e.inscriptionAndSignature.inscription,s);this.latestInscriptions.put(o),await rt(1e3*20),await this.inscriptionResponseSink.send(new ie(o))}}const Xn="WebSocketError";class We extends g{constructor(r,s=`websocket error: ${String(r)}`){super(s);t(this,"cause");this.cause=r,Object.freeze(this)}get code(){return Xn}}class ed{convert(e){return d(e,"code","message"),p(e,Xn),new We({},i.decode(e.message))}}class nd extends y{}class rd extends c{constructor(){super(...arguments);t(this,"encoder",new nd);t(this,"decoder",new ed)}}const td=new rd;f(Xn,td);class sd{constructor(e,r,s,o){t(this,"responseStream");t(this,"requestStream");t(this,"serviceBaseWebSocketURL");t(this,"serviceBaseURL");t(this,"lifecycleResponseSink");t(this,"inscriptionResponseSink");t(this,"errorResponseSink");t(this,"webSocket",null);t(this,"webSocketCompleter",null);t(this,"retrieveInscriptionsForAddressCache",new Map);this.requestStream=e,this.responseStream=r,this.serviceBaseWebSocketURL=s,this.serviceBaseURL=o,this.lifecycleResponseSink=te(V(r),nt),this.inscriptionResponseSink=te(V(r),Et),this.errorResponseSink=te(V(r),ii)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async startProcessing(){this.handleRequests()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async handleRequest(e){if(e instanceof En){try{await this.handleWebSocketRequest(e.command)}catch(r){console.error("failed to handle life cycle request",e,r)}return}if(e instanceof qn){try{const r=await this.handleInscriptionsRequest(e.request);r&&await this.inscriptionResponseSink.send(r)}catch(r){if(!(r instanceof g)){console.error("unhandled error from put inscription request",e,r);return}await this.errorResponseSink.send(r)}return}console.error("unrecognized request type",e)}async handleWebSocketRequest(e){if(e instanceof Ee){await this.handleConnect();return}if(e instanceof be){await this.handleClose();return}}async handleInscriptionsRequest(e){if(e instanceof Ae){await this.webSocketCompleter.promise,await this.handlePutInscription(e);return}if(e instanceof jn)return await this.handleRetrieveInscriptionsForAddressMemoized(e);throw new b}assertNotConnected(){if(this.webSocket!==null)throw new Error("Already connected")}assertConnected(){if(this.webSocket===null)throw new Error("Not connected")}async handleConnect(){this.assertNotConnected(),await this.lifecycleResponseSink.send(new xe);const e=new URL("inscriptions/inscriptions",this.serviceBaseWebSocketURL),r=me();this.webSocketCompleter=r;try{const s=new od(this.inscriptionResponseSink),o=new cd(r,this.lifecycleResponseSink),a=new id(this.lifecycleResponseSink),u=new ad(this.errorResponseSink),l=new WebSocket(e);l.onerror,l.addEventListener("open",o),l.addEventListener("message",s),l.addEventListener("close",a),l.addEventListener("error",u),l.addEventListener("close",()=>{l.removeEventListener("open",o),l.removeEventListener("message",s),l.removeEventListener("close",a),l.removeEventListener("error",u),this.webSocket=null}),this.webSocket=l}catch(s){const o=new We(s);this.errorResponseSink.send(o),r.completeError(o)}}async handleClose(){this.assertConnected(),this.webSocket.close(1e3,"done")}async handlePutInscriptionFetch(e){try{return await fetch(new URL("inscriptions/put_inscription",this.serviceBaseURL),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.inscriptionAndSignature)})}catch(r){throw new Ge(r)}}validateResponse(e){if(!e.ok)throw e.status>=400&&e.status<500?new sr(e.status,e):e.status>=500&&e.status<600?new ar(e.status,e):new cr(e.status,e);if(e.headers.get("content-type")!=="application/json")throw new H(e.headers.get("content-type")??"undefined",e.status,e)}async handlePutInscription(e){const r=await this.handlePutInscriptionFetch(e);return this.validateResponse(r),null}async handleRetrieveInscriptionsForAddressFetch(e){try{return await fetch(new URL(`inscriptions/inscriptions_for_wallet_address/${e.address}`,this.serviceBaseURL),{method:"GET",headers:{Accept:"application/json"}})}catch(r){throw new Ge(r)}}async handleRetrieveInscriptionsForAddress(e){const r=await this.handleRetrieveInscriptionsForAddressFetch(e);return this.validateResponse(r),new Hn(Mn.decode(await r.json()))}async handleRetrieveInscriptionsForAddressMemoized(e){if(this.retrieveInscriptionsForAddressCache.has(e.address))return this.retrieveInscriptionsForAddressCache.get(e.address);const r=await this.handleRetrieveInscriptionsForAddress(e);return this.retrieveInscriptionsForAddressCache.set(e.address,r),r}}class od{constructor(e){t(this,"inscriptionResponseSink");this.inscriptionResponseSink=e}decodeMessage(e){return Gn.decode(JSON.parse(e.data))}async relayMessage(e){try{await this.inscriptionResponseSink.send(e)}catch(r){console.error("attempt to publish message to response stream failed",r)}}async handleEvent(e){try{const r=this.decodeMessage(e);this.relayMessage(r)}catch(r){console.error("Failed to decode server message from web socket",r);return}}}class cd{constructor(e,r){t(this,"completer");t(this,"lifecycleResponseSink");this.completer=e,this.lifecycleResponseSink=r}handleEvent(e){this.completer.complete(e.target),this.lifecycleResponseSink.send(new Ie)}}class id{constructor(e){t(this,"lifecycleResponseSink");this.lifecycleResponseSink=e}async handleEvent(){await this.lifecycleResponseSink.send(new ke)}}class ad{constructor(e){t(this,"errorResponseSink");this.errorResponseSink=e}errorFromEvent(e){return"error"in e?new We(e.error):new We(null,"web socket error: unknown error")}handleEvent(e){this.errorResponseSink.send(this.errorFromEvent(e))}}si(ae,bt),Mc(ce,Ct);async function dd(n){const e=new URL(n),r=new URL(`${e.protocol.replace(/^http?/,"ws")}//${e.host}${e.pathname}`),s=ve(1024),o=ve(1024),a=new sd(s,o,r,e);return a.startProcessing(),a}async function ld(){try{const o=await(await fetch("/config.json")).json();if(o.inscription_service_url){const a=await dd(o.inscription_service_url);if(a!==null)return a}}catch(s){console.warn("error determining service implementation, from configuration file",s)}const n=ve(1024),e=ve(1024),r=new Ya(n,e);return r.startProcessing(),r}async function ud(){return new hd(await ld())}class hd{constructor(e){t(this,"service");this.service=e}get stream(){return this.service.stream}async send(e){return this.service.send(e)}}async function wd(n,e){const r=await n;for await(const s of r.stream)e(oi.encode(s))}class pd{constructor(e){t(this,"service");const r=ud();this.service=r,wd(r,e)}async handleEvent(e){const r=Tc.decode(e.data);try{(await this.service).send(r)}catch(s){console.warn("error processing message from event",s)}}}self.addEventListener("message",new pd(self.postMessage.bind(self)))})();
