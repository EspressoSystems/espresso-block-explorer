var gt=Object.defineProperty;var xt=(r,e,o)=>e in r?gt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o;var t=(r,e,o)=>(xt(r,typeof e!="symbol"?e+"":e,o),o);import{j as bt}from"./jsx-runtime-Cd6u8K_H.js";import{M as kt,I as L,m as No}from"./monetary_value-DDtKFr-C.js";import{c as Et}from"./data-BqGnzjPf.js";import{t as h,T as v}from"./TaggedBase64-CWozzVDS.js";import{M as dr,i as St}from"./functional-D1RzZCNy.js";import{T as u,j as lr,I as ne,e as l,A as H,f as W,g as J,C as x,a as d,s as p,k as Rt,l as Tt,h as It,m as _t,n as R,o as T,B as G,c as De,r as I,b as _,d as Ae,u as Oo,p as Be,q as S,i as Dt}from"./string-BgQ3tcOU.js";import{n as c,b as g}from"./base64-ByugtSst.js";import{h as y,u as Fo,s as qo}from"./array_buffer-EBg4rlG_.js";import{N as At}from"./NotFoundError-BY595sC3.js";import{R as Bt}from"./index-UfW7PFvU.js";class Pt{constructor(e,o){t(this,"value");t(this,"next");this.value=e,this.next=o}[Symbol.iterator](){return Lo(this)}}function Nt(r,e){return new Pt(e,r)}function*Lo(r){if(r!==null)for(let e=r;e!==null;e=e.next)yield e.value}class Ot{convert(e){if(!lr(e))throw new ne(typeof e,"string");const o=new Date(e);if(Number.isNaN(o.valueOf()))throw new ne("NaN","number");return o}}class Ft{convert(e){return l(e,Date),e.toISOString()}}class qt extends u{constructor(){super(...arguments);t(this,"encoder",new Ft);t(this,"decoder",new Ot)}}const U=new qt;class ur{constructor(e,o,n,s,a,i){t(this,"hash");t(this,"height");t(this,"proposerID");t(this,"numTransactions");t(this,"size");t(this,"time");this.hash=e,this.height=o,this.proposerID=n,this.numTransactions=s,this.size=a,this.time=i}toJSON(){return er.encode(this)}}class Lt{convert(e){return d(e,"hash","height","proposer_id","num_transactions","size","time"),new ur(h.decode(e.hash),c.decode(e.height),y.decode(e.proposer_id),c.decode(e.num_transactions),c.decode(e.size),U.decode(e.time))}}class Gt{convert(e){return l(e,ur),{hash:h.encode(e.hash),height:c.encode(e.height),proposer_id:y.encode(e.proposerID),num_transactions:c.encode(e.numTransactions),size:c.encode(e.size),time:U.encode(e.time)}}}class Ut extends x{constructor(){super(...arguments);t(this,"encoder",new Gt);t(this,"decoder",new Lt)}}const er=new Ut,Z=new H(new W(er),new J(er));class Go{constructor(e){t(this,"query");this.query=e}toJSON(){return Uo.encode(this)}}class zt{convert(e){return l(e,Go),p.encode(e.query)}}class Mt{convert(e){return new Go(p.decode(e))}}class Ht extends x{constructor(){super(...arguments);t(this,"encoder",new zt);t(this,"decoder",new Mt)}}const Uo=new Ht,zo=g;class Pe{constructor(e,o,n,s,a,i){t(this,"hash");t(this,"rollups");t(this,"height");t(this,"time");t(this,"offset");t(this,"numTransactions");this.hash=e,this.rollups=o,this.height=n,this.time=s,this.offset=a,this.numTransactions=i}toJSON(){return rr.encode(this)}}class Wt{convert(e){return d(e,"hash","rollups","height","time","offset","num_transactions"),new Pe(h.decode(e.hash),zo.decode(e.rollups),c.decode(e.height),U.decode(e.time),c.decode(e.offset),c.decode(e.num_transactions))}}class Jt{convert(e){return l(e,Pe),{hash:h.encode(e.hash),rollups:zo.encode(e.rollups),height:c.encode(e.height),time:U.encode(e.time),offset:c.encode(e.offset),num_transactions:c.encode(e.numTransactions)}}}class jt extends u{constructor(){super(...arguments);t(this,"encoder",new Jt);t(this,"decoder",new Wt)}}const rr=new jt,X=new H(new W(rr),new J(rr));class hr{constructor(e,o){t(this,"blocks");t(this,"transactions");this.blocks=e,this.transactions=o}toJSON(){return mr.encode(this)}}class Qt{convert(e){return d(e,"blocks","transactions"),new hr(Z.decode(e.blocks),X.decode(e.transactions))}}class $t{convert(e){return l(e,hr),{blocks:Z.encode(e.blocks),transactions:X.encode(e.transactions)}}}class Vt extends x{constructor(){super(...arguments);t(this,"encoder",new $t);t(this,"decoder",new Qt)}}const mr=new Vt;class pr{constructor(e){t(this,"searchResults");this.searchResults=e}toJSON(){return wr.encode(this)}}class Kt{convert(e){return d(e,"search_results"),new pr(mr.decode(e.search_results))}}class Yt{convert(e){return l(e,pr),{search_results:mr.encode(e.searchResults)}}}class Zt extends x{constructor(){super(...arguments);t(this,"encoder",new Yt);t(this,"decoder",new Kt)}}const wr=new Zt,pe=2147483648,Xt=1103515245,en=12345;class or{constructor(e){t(this,"state");this.state=e!==void 0?e:Math.floor(Math.random()*(pe-1))}nextInt(){return this.state=(Xt*this.state+en)%pe,this.state}nextFloat(){return this.nextInt()/(pe-1)}nextRange(e,o){const n=o-e,s=this.nextInt()/pe;return e+Math.floor(s*n)}fillBytes(e){const o=new ArrayBuffer(e),n=new DataView(o);let s=0;for(;s<e-4;s+=4)n.setUint32(s,this.nextRange(0,4294967295));for(let a=s;a<e;a++)n.setUint8(a,this.nextRange(0,256));return o}}async function*rn(){}async function*E(){const r=new Date,e=new Date(r.getFullYear(),r.getMonth(),r.getDate()).valueOf(),o=new or(e),n=new Uint8Array(new Array(20).map(()=>0)).buffer;yield{hash:new v("BLOCK",n),height:0,time:new Date(0),genTime:0,transactions:rn(),numTransactions:0,proposer:n,size:0,fees:[]};let s=1,a=e;for(;a<r.valueOf();){const i=Math.floor(o.nextFloat()*14*1e3);yield on(new or(s+i),s,a,a+i),a+=i,s++}}function on(r,e,o,n){const s=Math.floor(r.nextRange(0,5));return{hash:new v("BLOCK",r.fillBytes(32)),height:e,genTime:n-o,time:new Date(n),numTransactions:s,transactions:nn(new or(e+o),e,o,n,s),proposer:r.fillBytes(30),size:Math.floor(r.nextFloat()*1024*s)+8,fees:[kt.ESP(BigInt(r.nextRange(0,1e9)*1e3))]}}const Ro=Array.from(Et.keys());function tn(r){return r.nextFloat()>.98?1:Ro[r.nextRange(0,Ro.length)]}async function*nn(r,e,o,n,s){const a=(n-o)/s;for(let i=0,m=o;m<n;m+=a,i++){const w=tn(r),C=Math.floor(1024*r.nextFloat());yield{block:e,index:i,size:C,hash:new v("COMMIT",r.fillBytes(32)),time:new Date(m),sender:new v("PUBKEY",r.fillBytes(32)),tree:{namespace:w,data:r.fillBytes(C)}}}}async function*sn(r){for(let e=r.next();!e.done;e=r.next())yield e.value}function cn(r){return sn(r[Symbol.iterator]())}async function*an(r){for(let e=await r.next();!e.done;e=await r.next())yield e.value}async function*fr(r,e){for(let o=await r.next();!o.done;o=await r.next())e(o.value)&&(yield o.value)}function To(r,e){return fr(r[Symbol.asyncIterator](),e)}async function*z(r,e){for(let o=await r.next();!o.done;o=await r.next())yield await e(o.value)}function P(r,e){return z(r[Symbol.asyncIterator](),e)}async function*q(r,e){for(let o=0;o<e;o++){const n=await r.next();if(n.done)return;yield n.value}}function Ve(r,e){return q(r[Symbol.asyncIterator](),e)}async function*Cr(r,e){for(let o=await r.next();!o.done&&e(o.value);o=await r.next())yield o.value}function Ke(r,e){return Cr(r[Symbol.asyncIterator](),e)}async function*F(r,e){for(let o=0;o<e;o++)if((await r.next()).done)return;yield*an(r)}function ve(r,e){return F(r[Symbol.asyncIterator](),e)}async function se(r){const e=await r.next();if(e.done)throw new dr;return e.value}async function dn(r){return se(r[Symbol.asyncIterator]())}async function ln(r,e){for(let o=await r.next();!o.done;o=await r.next())if(e(o.value))return o.value}async function un(r,e){return ln(r[Symbol.asyncIterator](),e)}async function Mo(r){let e;for(let o=await r.next();!o.done;o=await r.next())e=o.value;if(e===void 0)throw new dr;return e}async function hn(r){return Mo(r[Symbol.asyncIterator]())}async function*Ho(r,e){for(let o=await r.next();!o.done;o=await r.next())yield*e(o.value)}function Q(r,e){return Ho(r[Symbol.asyncIterator](),e)}async function*Ye(r){yield*St(r)}async function mn(r,e,o){const n=o;let s=e;for(let a=await n.next();!a.done;a=await n.next())s=r(await s,a.value);return s}async function*Ne(r){let e=null;for(let o=await r.next();!o.done;o=await r.next())e=Nt(e,o.value);yield*Lo(e)}function oe(r){return Ne(r[Symbol.asyncIterator]())}function N(r){return mn(async(e,o)=>(e.push(o),e),Promise.resolve([]),r)}async function Ze(r){return N(r[Symbol.asyncIterator]())}class yr{constructor(e,o,n){t(this,"r");t(this,"s");t(this,"v");this.r=e,this.s=o,this.v=n}toJSON(){return vr.encode(this)}}class pn{convert(e){return d(e,"r","s","v"),new yr(y.decode(e.r),y.decode(e.s),c.decode(e.v))}}class wn{convert(e){return l(e,yr),{r:y.encode(e.r),s:y.encode(e.s),v:c.encode(e.v)}}}class fn extends u{constructor(){super(...arguments);t(this,"encoder",new wn);t(this,"decoder",new pn)}}const vr=new fn;class gr{constructor(e,o){t(this,"account");t(this,"amount");this.account=e,this.amount=o}toJSON(){return xr.encode(this)}}class Cn{convert(e){return d(e,"account","amount"),new gr(y.decode(e.account),y.decode(e.amount))}}class yn{convert(e){return l(e,gr),{account:y.encode(e.account),amount:y.encode(e.amount)}}}class vn extends u{constructor(){super(...arguments);t(this,"encoder",new yn);t(this,"decoder",new Cn)}}const xr=new vn;class Wo{constructor(e){t(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class Jo{constructor(e){t(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:(Rt(e),this.itemCodec.encode(e))}}class jo extends u{constructor(o,n){super();t(this,"encoder");t(this,"decoder");this.encoder=n,this.decoder=o}}class br{constructor(e,o,n){t(this,"number");t(this,"timestamp");t(this,"hash");this.number=e,this.timestamp=o,this.hash=n}toJSON(){return tr.encode(this)}}class gn{convert(e){return d(e,"number","timestamp","hash"),new br(c.decode(e.number),p.decode(e.timestamp),p.decode(e.hash))}}class xn{convert(e){return l(e,br),{number:c.encode(e.number),timestamp:p.encode(e.timestamp),hash:p.encode(e.hash)}}}class bn extends u{constructor(){super(...arguments);t(this,"encoder",new xn);t(this,"decoder",new gn)}}const tr=new bn,Qo=new jo(new Wo(tr),new Jo(tr));class kr{constructor(e){t(this,"bytes");this.bytes=e}toJSON(){return Er.encode(this)}}class kn{convert(e){return d(e,"bytes"),new kr(Fo.decode(e.bytes))}}class En{convert(e){return l(e,kr),{bytes:Fo.encode(e.bytes)}}}class Sn extends u{constructor(){super(...arguments);t(this,"encoder",new En);t(this,"decoder",new kn)}}const Er=new Sn;class Sr{constructor(e,o,n,s,a,i,m,w,C,b){t(this,"height");t(this,"timestamp");t(this,"l1_head");t(this,"l1_finalized");t(this,"payload_commitment");t(this,"ns_table");t(this,"block_merkle_root");t(this,"fee_merkle_root");t(this,"builder_signature");t(this,"fee_info");this.height=e,this.timestamp=o,this.l1_head=n,this.l1_finalized=s,this.payload_commitment=a,this.ns_table=i,this.block_merkle_root=m,this.fee_merkle_root=w,this.builder_signature=C,this.fee_info=b}toJSON(){return O.encode(this)}}class Rn{convert(e){return d(e,"height","timestamp","l1_head","l1_finalized","payload_commitment","ns_table","block_merkle_root","fee_merkle_root","builder_signature","fee_info"),new Sr(c.decode(e.height),c.decode(e.timestamp),c.decode(e.l1_head),Qo.decode(e.l1_finalized),g.decode(e.payload_commitment),Er.decode(e.ns_table),h.decode(e.block_merkle_root),h.decode(e.fee_merkle_root),vr.decode(e.builder_signature),xr.decode(e.fee_info))}}class Tn{convert(e){return l(e,Sr),{height:c.encode(e.height),timestamp:c.encode(e.timestamp),l1_head:c.encode(e.l1_head),l1_finalized:Qo.encode(e.l1_finalized),payload_commitment:g.encode(e.payload_commitment),ns_table:Er.encode(e.ns_table),block_merkle_root:h.encode(e.block_merkle_root),fee_merkle_root:h.encode(e.fee_merkle_root),builder_signature:vr.encode(e.builder_signature),fee_info:xr.encode(e.fee_info)}}}class In extends u{constructor(){super(...arguments);t(this,"encoder",new Tn);t(this,"decoder",new Rn)}}const O=new In;class ce{constructor(e,o){t(this,"vm");t(this,"payload");this.vm=e,this.payload=o}toJSON(){return M.encode(this)}}class _n{convert(e){return d(e,"vm","payload"),new ce(c.decode(e.vm),g.decode(e.payload))}}class Dn{convert(e){return l(e,ce),{vm:c.encode(e.vm),payload:g.encode(e.payload)}}}class An extends u{constructor(){super(...arguments);t(this,"encoder",new Dn);t(this,"decoder",new _n)}}const M=new An,$o=new H(new W(M),new J(M));class Rr{constructor(e){t(this,"transaction_nmt");this.transaction_nmt=e}toJSON(){return ae.encode(this)}}class Bn{convert(e){return d(e,"transaction_nmt"),new Rr($o.decode(e.transaction_nmt))}}class Pn{convert(e){return l(e,Rr),{transaction_nmt:$o.encode(e.transaction_nmt)}}}class Nn extends u{constructor(){super(...arguments);t(this,"encoder",new Pn);t(this,"decoder",new Bn)}}const ae=new Nn;class Tr{constructor(e,o,n,s,a){t(this,"header");t(this,"payload");t(this,"hash");t(this,"size");t(this,"numTransactions");this.header=e,this.payload=o,this.hash=n,this.size=s,this.numTransactions=a}toJSON(){return Ir.encode(this)}}class On{convert(e){return d(e,"header","payload","hash","size","num_transactions"),new Tr(O.decode(e.header),ae.decode(e.payload),h.decode(e.hash),c.decode(e.size),c.decode(e.num_transactions))}}class Fn{convert(e){return l(e,Tr),{header:O.encode(e.header),payload:ae.encode(e.payload),hash:h.encode(e.hash),size:c.encode(e.size),num_transactions:c.encode(e.numTransactions)}}}class qn extends x{constructor(){super(...arguments);t(this,"encoder",new Fn);t(this,"decoder",new On)}}const Ir=new qn;class Oe{constructor(e,o,n,s,a){t(this,"header");t(this,"hash");t(this,"size");t(this,"num_transactions");t(this,"proposer_id");this.header=e,this.hash=o,this.size=n,this.num_transactions=s,this.proposer_id=a}toJSON(){return nr.encode(this)}}class Ln{convert(e){return d(e,"header","hash","size","num_transactions","proposer_id"),new Oe(O.decode(e.header),h.decode(e.hash),c.decode(e.size),c.decode(e.num_transactions),y.decode(e.proposer_id))}}class Gn{convert(e){return l(e,Oe),{header:O.encode(e.header),hash:h.encode(e.hash),size:c.encode(e.size),num_transactions:c.encode(e.num_transactions),proposer_id:y.encode(e.proposer_id)}}}class Un extends u{constructor(){super(...arguments);t(this,"encoder",new Gn);t(this,"decoder",new Ln)}}const nr=new Un,zn=new H(new W(nr),new J(nr));class Fe{constructor(e,o,n,s){t(this,"hash");t(this,"header");t(this,"offset");t(this,"transaction");this.hash=e,this.header=o,this.offset=n,this.transaction=s}toJSON(){return sr.encode(this)}}class Mn{convert(e){return d(e,"hash","header","offset","transaction"),new Fe(h.decode(e.hash),O.decode(e.header),c.decode(e.offset),M.decode(e.transaction))}}class Hn{convert(e){return l(e,Fe),{hash:h.encode(e.hash),header:O.encode(e.header),offset:c.encode(e.offset),transaction:M.encode(e.transaction)}}}class Wn extends u{constructor(){super(...arguments);t(this,"encoder",new Hn);t(this,"decoder",new Mn)}}const sr=new Wn,Io=new H(new W(sr),new J(sr));class Jn{convert(e){if(!Tt(e))throw new ne(typeof e,"boolean");return e}}class jn{convert(e){return It(e,"boolean"),e}}class Qn extends u{constructor(){super(...arguments);t(this,"encoder",new jn);t(this,"decoder",new Jn)}}const qe=new Qn;class ge{constructor(e){t(this,"leaf_commit");this.leaf_commit=e}toJSON(){return _r.encode(this)}}class $n{convert(e){return d(e,"leaf_commit"),new ge(h.decode(e.leaf_commit))}}class Vn{convert(e){return l(e,ge),{leaf_commit:h.encode(e.leaf_commit)}}}class Kn extends u{constructor(){super(...arguments);t(this,"encoder",new Vn);t(this,"decoder",new $n)}}const _r=new Kn;class Vo{constructor(e,o){t(this,"width");t(this,"index");this.width=e,this.index=o}toJSON(){return Dr.encode(this)}}class Yn{convert(e){return d(e,"width","index"),new Vo(c.decode(e.width),c.decode(e.index))}}class Zn{convert(e){return l(e,Vo),{width:c.encode(e.width),index:c.encode(e.index)}}}class Xn extends u{constructor(){super(...arguments);t(this,"encoder",new Zn);t(this,"decoder",new Yn)}}const Dr=new Xn;class Ko{constructor(e,o,n,s){t(this,"order");t(this,"head");t(this,"bits");t(this,"data");this.order=e,this.head=o,this.bits=n,this.data=s}toJSON(){return Ar.encode(this)}}class es{convert(e){return d(e,"order","head","bits","data"),new Ko(p.decode(e.order),Dr.decode(e.head),c.decode(e.bits),g.decode(e.data))}}class rs{convert(e){return l(e,Ko),{order:p.encode(e.order),head:Dr.encode(e.head),bits:c.encode(e.bits),data:g.encode(e.data)}}}class os extends u{constructor(){super(...arguments);t(this,"encoder",new rs);t(this,"decoder",new es)}}const Ar=new os;class Yo{constructor(e,o){t(this,"signature");t(this,"bitvec");this.signature=e,this.bitvec=o}toJSON(){return cr.encode(this)}}class ts{convert(e){if(!_t(e)||e.length!==2)throw new ne(typeof e,"Array");return new Yo(h.decode(e[0]),Ar.decode(e[1]))}}class ns{convert(e){return l(e,Yo),[h.encode(e.signature),Ar.encode(e.bitvec)]}}class ss extends u{constructor(){super(...arguments);t(this,"encoder",new ns);t(this,"decoder",new ts)}}const cr=new ss,Zo=new jo(new Wo(cr),new Jo(cr));class xe{constructor(e,o,n,s,a,i){t(this,"data");t(this,"vote_commitment");t(this,"view_number");t(this,"signatures");t(this,"is_genesis");t(this,"_pd");this.data=e,this.vote_commitment=o,this.view_number=n,this.signatures=s,this.is_genesis=a,this._pd=i}toJSON(){return ie.encode(this)}}class cs{convert(e){return d(e,"data","vote_commitment","view_number","signatures","is_genesis","_pd"),new xe(_r.decode(e.data),h.decode(e.vote_commitment),c.decode(e.view_number),Zo.decode(e.signatures),qe.decode(e.is_genesis),null)}}class as{convert(e){return l(e,xe),{data:_r.encode(e.data),vote_commitment:h.encode(e.vote_commitment),view_number:c.encode(e.view_number),signatures:Zo.encode(e.signatures),is_genesis:qe.encode(e.is_genesis),_pd:null}}}class is extends u{constructor(){super(...arguments);t(this,"encoder",new as);t(this,"decoder",new cs)}}const ie=new is;class Br{constructor(e,o,n,s,a,i,m,w){t(this,"view_number");t(this,"justify_qc");t(this,"parent_commitment");t(this,"block_header");t(this,"block_payload");t(this,"rejected");t(this,"timestamp");t(this,"proposer_id");this.view_number=e,this.justify_qc=o,this.parent_commitment=n,this.block_header=s,this.block_payload=a,this.rejected=i,this.timestamp=m,this.proposer_id=w}toJSON(){return Pr.encode(this)}}class ds{convert(e){return d(e,"view_number","justify_qc","parent_commitment","block_header","block_payload","rejected","timestamp","proposer_id"),new Br(c.decode(e.view_number),ie.decode(e.justify_qc),h.decode(e.parent_commitment),O.decode(e.block_header),ae.decode(e.block_payload),g.decode(e.rejected),c.decode(e.timestamp),y.decode(e.proposer_id))}}class ls{convert(e){return l(e,Br),{view_number:c.encode(e.view_number),justify_qc:ie.encode(e.justify_qc),parent_commitment:h.encode(e.parent_commitment),block_header:O.encode(e.block_header),block_payload:ae.encode(e.block_payload),rejected:g.encode(e.rejected),timestamp:c.encode(e.timestamp),proposer_id:y.encode(e.proposer_id)}}}class us extends u{constructor(){super(...arguments);t(this,"encoder",new ls);t(this,"decoder",new ds)}}const Pr=new us;class Nr{constructor(e,o){t(this,"leaf");t(this,"qc");this.leaf=e,this.qc=o}toJSON(){return Or.encode(this)}}class hs{convert(e){return d(e,"leaf","qc"),new Nr(Pr.decode(e.leaf),ie.decode(e.qc))}}class ms{convert(e){return l(e,Nr),{leaf:Pr.encode(e.leaf),qc:ie.encode(e.qc)}}}class ps extends u{constructor(){super(...arguments);t(this,"encoder",new ms);t(this,"decoder",new hs)}}const Or=new ps;class de{}class Fr extends de{toJSON(){return qr.encode(this)}}class ws{convert(e){if(!lr(e)||e!=="Empty")throw new L;return new Fr}}class fs{convert(e){return l(e,Fr),"Empty"}}class Cs extends u{constructor(){super(...arguments);t(this,"encoder",new fs);t(this,"decoder",new ws)}}const qr=new Cs;class Lr extends de{constructor(o,n,s){super();t(this,"value");t(this,"pos");t(this,"elem");this.value=o,this.pos=n,this.elem=s}toJSON(){return Gr.encode(this)}}class ys{convert(e){d(e,"Leaf");const o=e.Leaf;return d(o,"value","pos","elem"),new Lr(h.decode(o.value),h.decode(o.pos),h.decode(o.elem))}}class vs{convert(e){return l(e,Lr),{Leaf:{value:h.encode(e.value),pos:h.encode(e.pos),elem:h.encode(e.elem)}}}}class gs extends x{constructor(){super(...arguments);t(this,"encoder",new vs);t(this,"decoder",new ys)}}const Gr=new gs;class Ur extends de{constructor(o){super();t(this,"value");this.value=o}toJSON(){return zr.encode(this)}}class xs{convert(e){d(e,"ForgettenSubtree");const o=e.ForgettenSubtree;return d(o,"value"),new Ur(h.decode(o.value))}}class bs{convert(e){return l(e,Ur),{ForgettenSubtree:{value:h.encode(e.value)}}}}class ks extends x{constructor(){super(...arguments);t(this,"encoder",new bs);t(this,"decoder",new xs)}}const zr=new ks;class Le extends de{constructor(o,n){super();t(this,"value");t(this,"children");this.value=o,this.children=n}toJSON(){return Mr.encode(this)}}class Es{convert(e){d(e,"Branch");const o=e.Branch;return d(o,"value","children"),new Le(h.decode(o.value),Ge.decode(o.children))}}class Ss{convert(e){return l(e,Le),{Branch:{value:h.encode(e.value),children:Ge.encode(e.children)}}}}class Rs extends u{constructor(){super(...arguments);t(this,"encoder",new Ss);t(this,"decoder",new Es)}}const Mr=new Rs;class Ts{convert(e){if(R(e,"Leaf",T))return Gr.decoder.convert(e);if(R(e,"Branch",T))return Mr.decoder.convert(e);if(R(e,"ForgettenSubtree",T))return zr.decoder.convert(e);if(lr(e))return qr.decoder.convert(e);throw new L}}class Is{convert(e){if(l(e,de),e instanceof Lr)return Gr.encode(e);if(e instanceof Le)return Mr.encode(e);if(e instanceof Ur)return zr.encode(e);if(e instanceof Fr)return qr.encode(e);throw new L}}class _s extends u{constructor(){super(...arguments);t(this,"encoder",new Is);t(this,"decoder",new Ts)}}const _o=new _s,Ge=new H(new W(_o),new J(_o));class Hr{constructor(e,o){t(this,"pos");t(this,"proof");this.pos=e,this.proof=o}toJSON(){return Wr.encode(this)}}class Ds{convert(e){return d(e,"pos","proof"),new Hr(h.decode(e.pos),Ge.decode(e.proof))}}class As{convert(e){return l(e,Hr),{pos:h.encode(e.pos),proof:Ge.encode(e.proof)}}}class Bs extends u{constructor(){super(...arguments);t(this,"encoder",new As);t(this,"decoder",new Ds)}}const Wr=new Bs;class Jr{constructor(e,o,n,s,a){t(this,"transaction");t(this,"block_hash");t(this,"proof");t(this,"height");t(this,"hash");this.transaction=e,this.block_hash=o,this.proof=n,this.height=s,this.hash=a}toJSON(){return jr.encode(this)}}class Ps{convert(e){return d(e,"transaction","block_hash","proof","height","hash"),new Jr(M.decoder.convert(e.transaction),h.decode(e.block_hash),Wr.decoder.convert(e.proof),c.decode(e.height),h.decode(e.hash))}}class Ns{convert(e){return l(e,Jr),{transaction:M.encode(e.transaction),block_hash:h.encode(e.block_hash),proof:Wr.encode(e.proof),height:c.encode(e.height),hash:h.encode(e.hash)}}}class Os extends u{constructor(){super(...arguments);t(this,"encoder",new Ns);t(this,"decoder",new Ps)}}const jr=new Os;function Ue(r){return new Sr(r.height,r.time.valueOf()/1e3,0,new br(0,"00","00"),[],new kr(new ArrayBuffer(0)),new v("MERKLE_COMM",new Uint8Array([0,0,0,0]).buffer),new v("MERKLE_COMM",new Uint8Array([0,0,0,0]).buffer),new yr(new ArrayBuffer(0),new ArrayBuffer(0),0),new gr(new ArrayBuffer(0),new ArrayBuffer(0)))}async function Fs(r){return new Tr(Ue(r),new Rr(await N(P(r.transactions,async e=>new ce(e.tree.namespace,Array.from(new Uint8Array(e.tree.data)))))),new v("BLOCK",new Uint8Array([0,0,0,0]).buffer),r.size,r.numTransactions)}function qs(r){return new Oe(Ue(r),new v("BLOCK",new Uint8Array([0,0,0,0]).buffer),r.size,r.numTransactions,r.proposer)}function Ls(r){const e=r.transactions,o=Ue(r);return P(e,async n=>new Fe(n.hash,o,n.index,new ce(n.tree.namespace,Array.from(new Uint8Array(n.tree.data)))))}async function*Gs(r){const e=Ue(r),o=r.transactions;yield*P(o,async n=>new Jr(new ce(n.tree.namespace,Array.from(new Uint8Array(n.tree.data))),new v("BLOCK",new Uint8Array([0,0,0,0]).buffer),new Hr(new v("POS",new Uint8Array([0,0,0,0]).buffer),[new Le(new v("EMPTY",new Uint8Array([0,0,0,0]).buffer),[])]),e.height,new v("COMMIT",n.tree.data.slice(0,32))))}class Us{async getLeafFromHeight(e){const o=await this.getBlockFromHeight(e);return new Nr(new Br(e,new xe(new ge(new v("EMPTY",new Uint8Array([0,0,0,0]).buffer)),new v("EMPTY",new Uint8Array([0,0,0,0]).buffer),e,null,!1,null),new v("LEAF",new Uint8Array([0,0,0,0]).buffer),o.header,o.payload,[],o.header.timestamp,o.header.fee_info.account),new xe(new ge(new v("EMPTY",new Uint8Array([0,0,0,0]).buffer)),new v("EMPTY",new Uint8Array([0,0,0,0]).buffer),e,null,!1,null))}async getTransactionFromHeightAndOffset(e,o){const n=await se(F(E(),e)),s=Gs(n);return await dn(ve(s,o))}async getBlockSummaries(e,o){const n=F(E(),e),s=q(n,o-e),a=z(s,async i=>qs(i));return await N(a)}async getBlockFromHeight(e){const o=F(E(),e),n=await se(o);return Fs(n)}async*streamTransactionSummaries(e){const o=Cr(E(),a=>a.height<=e),n=Ne(o);yield*Q(n,a=>oe(Ls(a)))}async getTransactionSummaryRange(e,o,n){const s=this.streamTransactionSummaries(e),a=F(s,o),i=q(a,n);return await N(i)}async getTransactionSummaryRangeForRollup(e,o,n,s){const a=this.streamTransactionSummaries(o),i=fr(a,C=>C.transaction.vm===e),m=F(i,n),w=q(m,s);return await N(w)}}class le extends G{constructor(o,n,s){super(s);t(this,"response");t(this,"status");this.status=o,this.response=n}toJSON(){return Xo.convert(this)}}class ze{convert(e){return l(e,le),{...De.convert(e),status:e.status}}}const Xo=new ze;class be extends le{constructor(e,o,n="bad server response: client error"){super(e,o,n),Object.freeze(this)}toJSON(){return et.encode(this)}}class zs{convert(e){return d(e,"code","message","status"),_(e,be.name),new be(Number(e.status),null,p.decode(e.message))}}class Ms extends ze{}class Hs extends u{constructor(){super(...arguments);t(this,"encoder",new Ms);t(this,"decoder",new zs)}}const et=new Hs;I(be.name,et);class ke extends le{constructor(e,o,n="bad server response"){super(e,o,n),Object.freeze(this)}toJSON(){return rt.encode(this)}}class Ws{convert(e){return d(e,"code","message","status"),_(e,ke.name),new ke(Number(e.status),null,p.decode(e.message))}}class Js extends ze{}class js extends u{constructor(){super(...arguments);t(this,"encoder",new Js);t(this,"decoder",new Ws)}}const rt=new js;I(ke.name,rt);class Ee extends le{constructor(e,o,n="bad server response: server error"){super(e,o,n),Object.freeze(this)}}class Qs{convert(e){return d(e,"code","message","status"),_(e,Ee.name),new Ee(Number(e.status),null,p.decode(e.message))}}class $s extends ze{}class Vs extends u{constructor(){super(...arguments);t(this,"encoder",new $s);t(this,"decoder",new Qs)}}const Ks=new Vs;I(Ee.name,Ks);class Se extends G{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}}class Ys{convert(e){return d(e,"code","message"),_(e,Se.name),new Se(p.decode(e.message))}}class Zs extends Ae{}class Xs extends u{constructor(){super(...arguments);t(this,"encoder",new Zs);t(this,"decoder",new Ys)}}const ec=new Xs;I(Se.name,ec);class Re extends G{constructor(o,n,s=`invalid string value: have "${o}", want "${n}"`){super(s);t(this,"have");t(this,"want");this.have=o,this.want=n,Object.freeze(this)}toJSON(){return ot.encode(this)}}class rc{convert(e){return d(e,"code","have","want","message"),_(e,Re.name),new Re(p.decode(e.have),p.decode(e.want),p.decode(e.message))}}class oc{convert(e){return l(e,Re),{...De.convert(e),have:p.encode(e.have),want:p.encode(e.want)}}}class tc extends u{constructor(){super(...arguments);t(this,"encoder",new oc);t(this,"decoder",new rc)}}const ot=new tc;I(Re.name,ot);class $ extends G{constructor(o,n=`no completer found for request id "${o}"`){super(n);t(this,"requestID");this.requestID=o,Object.freeze(this)}toJSON(){return tt.encode(this)}}class nc{convert(e){return d(e,"code","requestID","message"),_(e,$.name),new $(Oo.decode(e.requestID),p.decode(e.message))}}class sc{convert(e){return l(e,$),{...De.convert(e),requestID:Oo.encode(e.requestID)}}}class cc extends u{constructor(){super(...arguments);t(this,"encoder",new sc);t(this,"decoder",new nc)}}const tt=new cc;I($.name,tt);class ar extends G{constructor(e="no url provided"){super(e),Object.freeze(this)}}class ac{convert(e){return d(e,"code","message"),_(e,ar.name),new ar(p.decode(e.message))}}class ic extends Ae{}class dc extends u{constructor(){super(...arguments);t(this,"encoder",new ic);t(this,"decoder",new ac)}}const lc=new dc;I(ar.name,lc);class V extends le{constructor(o,n,s,a="response content type is not application/json"){super(n,s,a);t(this,"haveHeaderType");this.haveHeaderType=o,Object.freeze(this)}static fromResponse(o,n){return new V(o.headers.get("content-type")??"undefined",o.status,o,n)}toJSON(){return nt.encode(this)}}class uc{convert(e){return d(e,"code","status","have","want","message"),_(e,V.name),new V(p.decode(e.code),c.decode(e.status),null,p.decode(e.message))}}class hc{convert(e){return{...Xo.convert(e),have:p.encode(e.haveHeaderType),want:p.encode("application/json")}}}class mc extends u{constructor(){super(...arguments);t(this,"encoder",new hc);t(this,"decoder",new uc)}}const nt=new mc;I(V.name,nt);class K extends G{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}}class pc{convert(e){return d(e,"code","message"),_(e,K.name),new K(p.decode(e.message))}}class wc extends Ae{}class fc extends u{constructor(){super(...arguments);t(this,"encoder",new wc);t(this,"decoder",new pc)}}const Cc=new fc;I(K.name,Cc);class Te extends G{constructor(o,n="error in web worker"){super(n);t(this,"error");this.error=o,Object.freeze(this)}toJSON(){return st.encode(this)}}class yc{convert(e){return d(e,"code","error","message"),_(e,Te.name),new Te(Be.decode(e.error),p.decode(e.message))}}class vc{convert(e){return{...De.convert(e),error:Be.encode(e.error)}}}class gc extends u{constructor(){super(...arguments);t(this,"encoder",new vc);t(this,"decoder",new yc)}}const st=new gc;I(Te.name,st);var Qr=(r=>(r[r.success=0]="success",r[r.full=1]="full",r[r.failed=2]="failed",r))(Qr||{});class xc{getFromEmpty(){}}class bc{getFromEmpty(){return null}}class kc{getFromEmpty(){throw new dr}}const Ec={returnNull:new bc,returnUndefined:new xc,throwMissingElement:new kc};class Sc{constructor(e){t(this,"maxSize");S(!Number.isNaN(e),"maxSize must not be NaN"),S(Number.isInteger(e),"maxSize must be an integer"),S(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return S(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class Rc{constructor(e){t(this,"preComputedSizeMinus1");S(!Number.isNaN(e),"maxSize must not be NaN"),S(Number.isInteger(e),"maxSize must be an integer"),S(e>0,"maxSize must be greater than 0"),S(ct(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return S(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function ct(r){return(r&r-1)===0}class Ie extends G{constructor(e="buffer full"){super(e),Object.freeze(this)}}class Tc{convert(e){return d(e,"code","message"),_(e,Ie.name),new Ie(p.decode(e.message))}}class Ic extends Ae{}class _c extends u{constructor(){super(...arguments);t(this,"encoder",new Ic);t(this,"decoder",new Tc)}}const Dc=new _c;I(Ie.name,Dc);class Ac{putToFull(e,o){return e.get(),e.put(o)}}class Bc{putToFull(){return Qr.full}}class Pc{putToFull(){throw new Ie}}const Nc={overwriteOldest:new Ac,returnFull:new Bc,throw:new Pc};function Oc(r){return ct(r)?new Rc(r):new Sc(r)}class Fc{constructor(e,o,n){t(this,"readIndex",0);t(this,"writeIndex",0);t(this,"buffer");t(this,"nextIndex");t(this,"getOnEmpty");t(this,"putOnFull");S(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=Oc(e),this.getOnEmpty=o,this.putOnFull=n}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const o=this.nextIndex.nextIndex(this.writeIndex);return o===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=o,Qr.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return{next:()=>{const e=this.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}}}function B(r=32,e=Ec.returnUndefined,o=Nc.overwriteOldest){return new Fc(r,e,o)}class $r{constructor(e,o,n,s,a,i,m,w){t(this,"hash");t(this,"height");t(this,"time");t(this,"numTransactions");t(this,"proposerID");t(this,"feeRecipient");t(this,"size");t(this,"blockReward");this.hash=e,this.height=o,this.time=n,this.numTransactions=s,this.proposerID=a,this.feeRecipient=i,this.size=m,this.blockReward=w}toJSON(){return ue.encode(this)}}class qc{convert(e){return d(e,"hash","height","time","num_transactions","proposer_id","fee_recipient","size","block_reward"),new $r(h.decode(e.hash),c.decode(e.height),U.decode(e.time),c.decode(e.num_transactions),y.decode(e.proposer_id),y.decode(e.fee_recipient),c.decode(e.size),No.decode(e.block_reward))}}class Lc{convert(e){return l(e,$r),{hash:h.encode(e.hash),height:c.encode(e.height),time:U.encode(e.time),num_transactions:c.encode(e.numTransactions),proposer_id:y.encode(e.proposerID),fee_recipient:y.encode(e.feeRecipient),size:c.encode(e.size),block_reward:No.encode(e.blockReward)}}}class Gc extends x{constructor(){super(...arguments);t(this,"encoder",new Lc);t(this,"decoder",new qc)}}const ue=new Gc,Y="latest";class Vr{constructor(e,o,n){t(this,"rollups");t(this,"transactions");t(this,"blocks");this.rollups=e,this.transactions=o,this.blocks=n}toJSON(){return Kr.encode(this)}}class Uc{convert(e){return d(e,"rollups","transactions","blocks"),new Vr(c.decode(e.rollups),c.decode(e.transactions),c.decode(e.blocks))}}class zc{convert(e){return l(e,Vr),{rollups:c.encode(e.rollups),transactions:c.encode(e.transactions),blocks:c.encode(e.blocks)}}}class Mc extends u{constructor(){super(...arguments);t(this,"encoder",new zc);t(this,"decoder",new Uc)}}const Kr=new Mc;function we(r){return r!==null}function Hc(r,e){return r.blockHeights-e.blockHeights}class Yr{constructor(e,o,n,s){t(this,"blockTime");t(this,"blockSize");t(this,"blockTransactions");t(this,"blockHeights");const a=[],i=s.length;for(let D=0;D<i;D++)a.push({blockTime:e[D],blockSize:o[D],blockTransactions:n[D],blockHeights:s[D]});a.sort(Hc);const m=a[0].blockHeights,w=a[i-1].blockHeights,C=[],b=[],f=[],k=[];for(let D=m,So=0;D<=w;D++){const re=a[So];if(re.blockHeights!==D){C.push(null),b.push(null),f.push(null),k.push(null);continue}C.push(re.blockTime),b.push(re.blockSize),f.push(re.blockTransactions),k.push(re.blockHeights),So++}const j=Math.max(0,k.length-50);this.blockTime=C.slice(j),this.blockSize=b.slice(j),this.blockTransactions=f.slice(j),this.blockHeights=k.slice(j)}toJSON(){return Zr.encode(this)}}class Wc{convert(e){return d(e,"block_time","block_size","block_transactions","block_heights"),new Yr(g.decode(e.block_time),g.decode(e.block_size),g.decode(e.block_transactions),g.decode(e.block_heights))}}class Jc{convert(e){return l(e,Yr),{block_time:g.encode(e.blockTime.filter(we)),block_size:g.encode(e.blockSize.filter(we)),block_transactions:g.encode(e.blockTransactions.filter(we)),block_heights:g.encode(e.blockHeights.filter(we))}}}class jc extends u{constructor(){super(...arguments);t(this,"encoder",new Jc);t(this,"decoder",new Wc)}}const Zr=new jc;class Xr{constructor(e,o,n,s,a){t(this,"latestBlock");t(this,"genesisOverview");t(this,"latestBlocks");t(this,"latestTransactions");t(this,"histograms");this.latestBlock=e,this.genesisOverview=o,this.latestBlocks=n,this.latestTransactions=s,this.histograms=a}toJSON(){return eo.encode(this)}}class Qc{convert(e){return d(e,"latest_block","genesis_overview","latest_blocks","latest_transactions","histograms"),new Xr(ue.decode(e.latest_block),Kr.decode(e.genesis_overview),Z.decode(e.latest_blocks),X.decode(e.latest_transactions),Zr.decode(e.histograms))}}class $c{convert(e){return l(e,Xr),{latest_block:ue.encode(e.latestBlock),genesis_overview:Kr.encode(e.genesisOverview),latest_blocks:Z.encode(e.latestBlocks),latest_transactions:X.encode(e.latestTransactions),histograms:Zr.encode(e.histograms)}}}class Vc extends u{constructor(){super(...arguments);t(this,"encoder",new $c);t(this,"decoder",new Qc)}}const eo=new Vc;class ro{constructor(e){t(this,"blockDetail");this.blockDetail=e}toJSON(){return oo.encode(this)}}class Kc{convert(e){return d(e,"block_detail"),new ro(ue.decode(e.block_detail))}}class Yc{convert(e){return l(e,ro),{block_detail:ue.encode(e.blockDetail)}}}class Zc extends x{constructor(){super(...arguments);t(this,"encoder",new Yc);t(this,"decoder",new Kc)}}const oo=new Zc;class to{constructor(e){t(this,"blockSummaries");this.blockSummaries=e}toJSON(){return no.encode(this)}}class Xc{convert(e){return d(e,"block_summaries"),new to(Z.decode(e.block_summaries))}}class ea{convert(e){return l(e,to),{block_summaries:Z.encode(e.blockSummaries)}}}class ra extends x{constructor(){super(...arguments);t(this,"encoder",new ea);t(this,"decoder",new Xc)}}const no=new ra;class so{constructor(e){t(this,"explorerSummary");this.explorerSummary=e}toJSON(){return co.encode(this)}}class oa{convert(e){return d(e,"explorer_summary"),new so(eo.decode(e.explorer_summary))}}class ta{convert(e){return l(e,so),{explorer_summary:eo.encode(e.explorerSummary)}}}class na extends u{constructor(){super(...arguments);t(this,"encoder",new ta);t(this,"decoder",new oa)}}const co=new na;class ao{static heightAndOffset(e,o){return new he(e,o)}static hash(e){return new me(e)}toJSON(){return at.encode(this)}}class sa{convert(e){if(l(e,ao),e instanceof he)return{height:c.encode(e.height),offset:c.encode(e.offset)};if(e instanceof me)return{hash:h.encode(e.hash)};throw new L}}class ca{convert(e){if(R(e,"height",T)&&R(e,"offset",T))return new he(c.decode(e.height),c.decode(e.offset));if(R(e,"hash",T))return new me(h.decode(e.hash));throw new L}}class aa extends u{constructor(){super(...arguments);t(this,"encoder",new sa);t(this,"decoder",new ca)}}const at=new aa;class he extends ao{constructor(o,n){super();t(this,"height");t(this,"offset");this.height=o,this.offset=n}}class me extends ao{constructor(o){super();t(this,"hash");this.hash=o}}const it=c;class io{constructor(e,o){t(this,"namespace");t(this,"payload");this.namespace=e,this.payload=o}toJSON(){return ir.encode(this)}}class ia{convert(e){return d(e,"namespace","payload"),new io(it.decode(e.namespace),qo.decode(e.payload))}}class da{convert(e){return l(e,io),{namespace:it.encode(e.namespace),payload:qo.encode(e.payload)}}}class la extends u{constructor(){super(...arguments);t(this,"encoder",new da);t(this,"decoder",new ia)}}const ir=new la,dt=new H(new W(ir),new J(ir));class lo{constructor(e,o,n,s,a,i,m,w,C){t(this,"hash");t(this,"height");t(this,"blockConfirmed");t(this,"offset");t(this,"numTransactions");t(this,"size");t(this,"time");t(this,"sequencingFees");t(this,"feeDetails");this.hash=e,this.height=o,this.blockConfirmed=n,this.offset=s,this.numTransactions=a,this.size=i,this.time=m,this.sequencingFees=w,this.feeDetails=C}toJSON(){return uo.encode(this)}}class ua{convert(e){return d(e,"hash","height","block_confirmed","offset","num_transactions","size","time","sequencing_fees","fee_details"),new lo(h.decode(e.hash),c.decode(e.height),qe.decode(e.block_confirmed),c.decode(e.offset),c.decode(e.num_transactions),c.decode(e.size),U.decode(e.time),[],[])}}class ha{convert(e){return l(e,lo),{hash:h.encode(e.hash),height:c.encode(e.height),block_confirmed:qe.encode(e.blockConfirmed),offset:c.encode(e.offset),num_transactions:c.encode(e.numTransactions),size:c.encode(e.size),time:U.encode(e.time),sequencing_fees:[],fee_details:[]}}}class ma extends u{constructor(){super(...arguments);t(this,"encoder",new ha);t(this,"decoder",new ua)}}const uo=new ma;class ho{constructor(e,o){t(this,"details");t(this,"data");this.details=e,this.data=o}toJSON(){return mo.encode(this)}}class pa{convert(e){return d(e,"details","data"),new ho(uo.decode(e.details),dt.decode(e.data))}}class wa{convert(e){return l(e,ho),{details:uo.encode(e.details),data:dt.encode(e.data)}}}class fa extends u{constructor(){super(...arguments);t(this,"encoder",new wa);t(this,"decoder",new pa)}}const mo=new fa;class _e{constructor(e){t(this,"transactionDetail");this.transactionDetail=e}toJSON(){return po.encode(this)}}class Ca{convert(e){return d(e,"transaction_detail"),new _e(mo.decode(e.transaction_detail))}}class ya{convert(e){return l(e,_e),{transaction_detail:mo.encode(e.transactionDetail)}}}class va extends x{constructor(){super(...arguments);t(this,"encoder",new ya);t(this,"decoder",new Ca)}}const po=new va;class Me{constructor(){}static block(e){return new He(e)}static namespace(e){return new We(e)}static none(){return new fo}toJSON(){return wo.encode(this)}}class ga{convert(e){return R(e,"block",T)?new He(c.decode(e.block)):R(e,"namespace",T)?new We(c.decode(e.namespace)):new fo}}class xa{convert(e){if(l(e,Me),e instanceof fo)return{};if(e instanceof He)return{block:c.encode(e.block)};if(e instanceof We)return{namespace:c.encode(e.namespace)};throw new L}}class ba extends x{constructor(){super(...arguments);t(this,"encoder",new xa);t(this,"decoder",new ga)}}const wo=new ba;class fo extends Me{constructor(){super()}convertURL(e){return e}}class He extends Me{constructor(o){super();t(this,"block");this.block=o}convertURL(o){return new URL(`${o.pathname}/block/${this.block}`,o)}}class We extends Me{constructor(o){super();t(this,"namespace");this.namespace=o}convertURL(o){return new URL(`${o.pathname}/namespace/${this.namespace}`,o)}}class te{constructor(e){t(this,"transactionSummaries");this.transactionSummaries=e}toJSON(){return Co.encode(this)}}class ka{convert(e){return d(e,"transaction_summaries"),new te(X.decode(e.transaction_summaries))}}class Ea{convert(e){return l(e,te),{transaction_summaries:X.encode(e.transactionSummaries)}}}class Sa extends x{constructor(){super(...arguments);t(this,"encoder",new Ea);t(this,"decoder",new ka)}}const Co=new Sa;class Je{constructor(e){t(this,"limit");this.limit=e}static latest(e){return new je(e)}static heightAndOffset(e,o,n){return new Qe(e,o,n)}static hash(e,o){return new $e(e,o)}toJSON(){return yo.encode(this)}}class Ra{convert(e){return d(e,"limit"),R(e,"height",T)&&R(e,"offset",T)?new Qe(c.decode(e.height),c.decode(e.offset),c.decode(e.limit)):R(e,"hash",T)?new $e(h.decode(e.hash),c.decode(e.limit)):new je(c.decode(e.limit))}}class Ta{convert(e){if(l(e,Je),e instanceof je)return{limit:c.encode(e.limit)};if(e instanceof Qe)return{height:c.encode(e.height),offset:c.encode(e.offset),limit:c.encode(e.limit)};if(e instanceof $e)return{hash:h.encode(e.hash),limit:c.encode(e.limit)};throw new L}}class Ia extends x{constructor(){super(...arguments);t(this,"encoder",new Ta);t(this,"decoder",new Ra)}}const yo=new Ia;class je extends Je{constructor(e){super(e)}convertURL(e){return new URL(`transactions/latest/${this.limit}`,e)}}class Qe extends Je{constructor(o,n,s){super(s);t(this,"height");t(this,"offset");this.height=o,this.offset=n}convertURL(o){return new URL(`transactions/from/${this.height}/${this.offset}/${this.limit}`,o)}}class $e extends Je{constructor(o,n){super(n);t(this,"hash");this.hash=o}convertURL(o){return new URL(`transactions/hash/${this.hash}/${this.limit}`,o)}}function Do(r){return new $r(r.hash,r.height,r.time,r.numTransactions,r.proposer,r.proposer,r.size,r.fees)}function Xe(r){return new ur(r.hash,r.height,r.proposer,r.numTransactions,r.size,r.time)}function Ao(r,e){return new ho(new lo(e.hash,e.block,!0,e.index,r.numTransactions,e.size,e.time,[],[]),[new io(e.tree.namespace,e.tree.data)])}function fe(r,e){return new Pe(e.hash,[e.tree.namespace],e.block,e.time,e.index,r.numTransactions)}class _a{async getBlockDetail(e){const o=e.target,n=await(o===Y?hn(E()):se(ve(E(),o)));return new ro(Do(n))}async getBlockSummaries(e){const o=Cr(E(),m=>e.from===Y||m.height<=e.from),n=Ne(o),s=q(n,e.limit),a=z(s,async m=>Xe(m)),i=await N(a);return new to(i)}async getTransactionDetail(e){const o=E();if(e instanceof he){const n=Ke(o,m=>m.height<=e.height),s=Q(n,m=>P(m.transactions,async w=>Ao(m,w))),a=ve(oe(s),e.offset),i=await se(a);return new _e(i)}if(e instanceof me){const n=Q(o,a=>P(a.transactions,async i=>Ao(a,i))),s=await un(n,a=>a.details.hash===e.hash);if(!s)throw new At(e.hash);return new _e(s)}throw new K}applyFilter(e,o){return o instanceof He?To(e,n=>n.height==o.block):o instanceof We?To(e,n=>n.rollups.indexOf(o.namespace)>=0):e}async getTransactionSummaries(e){const o=E(),{target:n,filter:s}=e;if(n instanceof je){const i=Q(o,b=>P(b.transactions,async f=>fe(b,f))),m=oe(i),w=this.applyFilter(m,s),C=await Ze(Ve(w,n.limit));return new te(C)}if(n instanceof Qe){const a=Ke(o,f=>f.height<=n.height),i=Q(a,f=>P(f.transactions,async k=>fe(f,k))),m=oe(i),w=ve(m,n.offset),C=this.applyFilter(w,s),b=await Ze(Ve(C,n.limit));return new te(b)}if(n instanceof $e){const a=E(),i=Q(a,f=>P(f.transactions,async k=>new Pe(k.hash,[k.tree.namespace],k.block,k.time,k.index,f.numTransactions))),m=Ke(i,f=>f.hash!==n.hash),w=oe(m),C=this.applyFilter(w,s),b=await Ze(Ve(C,n.limit));return new te(b)}throw new K}async getExplorerOverview(){let e;const o=B(11),n=B(51),s=B(51),a=B(51),i=B(51),m=B(11);let w=0,C=0;const b=new Map;for await(const f of E()){e=Do(f),o.put(Xe(f)),n.put(f.size),s.put(Math.round(f.genTime/1e3)),a.put(f.numTransactions),i.put(f.height),w++,C+=f.numTransactions;for await(const k of f.transactions){m.put(fe(f,k));const j=b.get(k.tree.namespace)||0;b.set(k.tree.namespace,j+1)}}return new so(new Xr(e,new Vr(Array.from(b.keys()).length,C,w),Array.from(o),Array.from(m),new Yr(Array.from(s),Array.from(n),Array.from(a),Array.from(i))))}async getSearchResult(e){const o=B(101),n=B(10),s=B(10);for await(const a of E())o.put(a);for(const a of o){a.hash.toString().startsWith(e.query)&&n.put(Xe(a));for await(const i of a.transactions)i.hash.toString().startsWith(e.query)&&s.put(fe(a,i))}return new pr(new hr(Array.from(n),Array.from(s)))}}class Da{async blockHeight(){return(await Mo(E())).height}}class Aa{constructor(){t(this,"availability",new Us);t(this,"status",new Da);t(this,"explorer",new _a)}}function A(r){return async e=>(Ba(e),Pa(e),r.convert(await e.json()))}function Ba(r){if(!r.ok)throw r.status>=500&&r.status<600?new Ee(r.status,r):r.status>=400&&r.status<500?new be(r.status,r):new ke(r.status,r)}function Pa(r){const e=r.headers.get("content-type");if(!e||!e.startsWith("application/json"))throw V.fromResponse(r,e||"undefined")}async function Na(r,e){return new Oe(r.header,r.hash,r.size,r.payload.transaction_nmt.length,e.leaf.proposer_id)}async function*Oa(r,e){const o=e[Symbol.asyncIterator]();yield*P(cn(r.leaf.block_payload.transaction_nmt),async n=>{const s=r.leaf.block_payload.transaction_nmt.indexOf(n),a=await o.next();if(a.done)throw new Error("Not enough transactions");return new Fe(a.value.hash,r.leaf.block_header,s,n)})}class Fa{constructor(e,o){t(this,"fetcher");t(this,"baseURL");this.fetcher=e,this.baseURL=o}getLeafFromHeight(e){const o=new URL(`leaf/${e}`,this.baseURL);return this.fetcher(o.toString()).then(A(Or.decoder))}getTransactionFromHeightAndOffset(e,o){const n=new URL(`transaction/${e}/${o}`,this.baseURL);return this.fetcher(n.toString()).then(A(jr.decoder))}async getBlockSummaries(e,o){const n=Ye(o-e),s=z(n,i=>Promise.all([this.getBlockFromHeight(e+i),this.getLeafFromHeight(e+i)])),a=z(s,([i,m])=>Na(i,m));return await N(a)}getBlockFromHeight(e){const o=new URL(`block/${e}`,this.baseURL);return this.fetcher(o.toString()).then(A(Ir.decoder))}async*streamBlocksFromHeightRange(e,o){const n=Ye(e),s=z(n,i=>this.getLeafFromHeight(e-i)),a=Ho(s,i=>Ne(Oa(i,z(Ye(i.leaf.block_payload.transaction_nmt.length),m=>this.getTransactionFromHeightAndOffset(i.leaf.block_header.height,m)))));if(o===void 0){yield*a;return}yield*q(a,o)}async getTransactionSummaryRange(e,o,n){const s=this.streamBlocksFromHeightRange(e,50),a=F(s,o),i=q(a,n);return await N(i)}async getTransactionSummaryRangeForRollup(e,o,n,s){const a=this.streamBlocksFromHeightRange(o,50),i=fr(a,C=>C.transaction.vm===e),m=F(i,n),w=q(m,s);return await N(w)}}class qa{constructor(e,o){t(this,"fetcher");t(this,"baseURL");this.fetcher=e,this.baseURL=o}async getBlockDetail(e){const o=new URL(`block/${e.target}`,this.baseURL);return this.fetcher(o.toString()).then(A(oo.decoder))}async getBlockSummaries(e){const o=new URL(`blocks/${e.from}/${e.limit}`,this.baseURL);return this.fetcher(o.toString()).then(A(no.decoder))}async getTransactionDetail(e){let o=null;if(e instanceof me?o=new URL(`transaction/hash/${e.hash}`,this.baseURL):e instanceof he&&(o=new URL(`transaction/${e.height}/${e.offset}`,this.baseURL)),!o)throw new K;return this.fetcher(o.toString()).then(A(po.decoder))}async getTransactionSummaries(e){const{target:o,filter:n}=e;let s=o.convertURL(this.baseURL);return s=n.convertURL(s),this.fetcher(s.toString()).then(A(Co.decoder))}async getExplorerOverview(){const e=new URL("explorer-summary",this.baseURL);return this.fetcher(e.toString()).then(A(co.decoder))}async getSearchResult(e){const o=new URL(`search/${encodeURIComponent(e.query)}`,this.baseURL);return this.fetcher(o.toString()).then(A(wr.decoder))}}class La{constructor(e,o){t(this,"fetcher");t(this,"baseURL");t(this,"blockHeightURL");t(this,"blockHeightResponseValidator",A(c.decoder));this.fetcher=e,this.baseURL=o,this.blockHeightURL=new URL("block-height",this.baseURL)}blockHeight(){return this.fetcher(this.blockHeightURL).then(this.blockHeightResponseValidator)}}class Ga{constructor(e,o){t(this,"availability");t(this,"status");t(this,"explorer");this.availability=new Fa(e,new URL("availability/",o)),this.status=new La(e,new URL("status/",o)),this.explorer=new qa(e,new URL("explorer/",o))}}function Ce(){return S(!1,"completer is not ready, this should never be reached")}function ye(){throw new Se}class Ua{constructor(){t(this,"resolve",Ce);t(this,"reject",Ce);t(this,"completed",!1);t(this,"promise");this.promise=new Promise((e,o)=>{this.resolve=e,this.reject=o}),S(this.resolve!==Ce,"resolve should be set"),S(this.reject!==Ce,"resolve should be set")}get isCompleted(){return this.completed}complete(e){const o=this.resolve,n=this.reject;if(this.completed=!0,this.resolve=ye,this.reject=ye,e instanceof Promise){e.then(o,n);return}o(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=ye,this.reject=ye}}function za(){return new Ua}const ee=c;class vo{constructor(e,o,n,s){t(this,"requestID");t(this,"api");t(this,"method");t(this,"param");this.requestID=e,this.api=o,this.method=n,this.param=s}toJSON(){return{requestID:this.requestID,api:this.api,method:this.method,param:this.param}}}class Ma{convert(e){return d(e,"requestID","api","method","param"),new vo(ee.decode(e.requestID),p.decode(e.api),p.decode(e.method),e.param)}}class Ha{convert(e){return l(e,vo),{requestID:ee.encode(e.requestID),api:p.encode(e.api),method:p.encode(e.method),param:e.param}}}class Wa extends u{constructor(){super(...arguments);t(this,"encoder",new Ha);t(this,"decoder",new Ma)}}const Ja=new Wa;class go{constructor(e){t(this,"requestID");this.requestID=e}}class xo extends go{constructor(o,n){super(o);t(this,"response");this.response=n}toJSON(){return lt.encode(this)}}class ja{convert(e){return d(e,"requestID","response"),new xo(ee.decode(e.requestID),e.response)}}class Qa{convert(e){return l(e,xo),{requestID:ee.encode(e.requestID),response:e.response}}}class $a extends u{constructor(){super(...arguments);t(this,"encoder",new Qa);t(this,"decoder",new ja)}}const lt=new $a;class bo extends go{constructor(o,n){super(o);t(this,"error");this.error=n}toJSON(){return ut.encode(this)}}class Va{convert(e){return d(e,"requestID","error"),new bo(ee.decode(e.requestID),Be.decode(e.error))}}class Ka{convert(e){return l(e,bo),{requestID:ee.encode(e.requestID),error:Be.encode(e.error)}}}class Ya extends u{constructor(){super(...arguments);t(this,"encoder",new Ka);t(this,"decoder",new Va)}}const ut=new Ya;class Za{convert(e){if(R(e,"response",T))return lt.decode(e);if(R(e,"error",T))return ut.decode(e);throw new L}}class Xa{convert(e){return l(e,go),e.toJSON()}}class ei extends u{constructor(){super(...arguments);t(this,"encoder",new Xa);t(this,"decoder",new Za)}}const Bo=new ei;class ko{constructor(e){t(this,"target");this.target=e}static latest(){return new mt}static height(e){return new pt(e)}toJSON(){return ht.encode(this)}}class ri{convert(e){return l(e,ko),typeof e.target=="number"?c.encode(e.target):p.encode(e.target)}}class oi{convert(e){return e===Y?new mt:new pt(c.decode(e))}}class ti extends x{constructor(){super(...arguments);t(this,"encoder",new ri);t(this,"decoder",new oi)}}const ht=new ti;class mt extends ko{constructor(){super(Y)}}class pt extends ko{constructor(e){super(e)}}class Eo{constructor(e){t(this,"limit");this.limit=e}static latest(e){return new ft(e)}static from(e,o){return new Ct(e,o)}toJSON(){return wt.encode(this)}}class ni{convert(e){return l(e,Eo),Dt(e.from)?{from:c.encode(e.from),limit:c.encode(e.limit)}:{from:p.encode(e.from),limit:c.encode(e.limit)}}}class si{convert(e){return d(e,"from","limit"),e.from===Y?new ft(c.decode(e.limit)):new Ct(c.decode(e.from),c.decode(e.limit))}}class ci extends x{constructor(){super(...arguments);t(this,"encoder",new ni);t(this,"decoder",new si)}}const wt=new ci;class ft extends Eo{constructor(e){super(e)}get from(){return Y}}class Ct extends Eo{constructor(o,n){super(n);t(this,"from");this.from=o}}class yt{constructor(e,o){t(this,"target");t(this,"filter");this.target=e,this.filter=o}toJSON(){return vt.encode(this)}}class ai{convert(e){return d(e,"filter","target"),new yt(yo.decode(e.target),wo.decode(e.filter))}}class ii{convert(e){return l(e,yt),{filter:wo.encode(e.filter),target:yo.encode(e.target)}}}class di extends x{constructor(){super(...arguments);t(this,"encoder",new ii);t(this,"decoder",new ai)}}const vt=new di;function li(r){return new Worker(""+new URL("web_worker_api.js-DgLUPg8A.js",import.meta.url).href,{name:r==null?void 0:r.name})}class ui{constructor(e){t(this,"worker");t(this,"nextRequestID",0);t(this,"requestCompleters",new Map);this.worker=e,e.onmessageerror,e.addEventListener("message",this.handleMessage.bind(this)),e.addEventListener("messageerror",this.handleMessageError.bind(this)),e.addEventListener("error",this.handleError.bind(this))}async submitRequest(e,o,n,s){const[a,i]=this.nextRequest();try{return this.worker.postMessage(Ja.encode(new vo(a,o,n,s))),await i.promise.then(m=>{if(m instanceof bo)throw new Te(m.error);if(m instanceof xo){const{response:w}=m;return e.decode(w)}throw new ne(typeof m,"WebWorkerResponse")})}finally{this.requestCompleters.delete(a)}}nextRequest(){const e=this.nextRequestID++,o=za();return this.requestCompleters.set(e,o),[e,o]}handleMessage(e){const o=Bo.decode(e.data),n=this.requestCompleters.get(o.requestID);if(n===void 0)throw new $(o.requestID);n.complete(o)}handleMessageError(e){const o=Bo.decode(e.data),n=this.requestCompleters.get(o.requestID);if(n===void 0)throw new $(o.requestID);n.completeError(o)}handleError(e){debugger;console.error("encountered error setting up Web worker",e)}}class hi{constructor(e){t(this,"helper");this.helper=e}async sendRequest(e,o,...n){return this.helper.submitRequest(e,"availability",o,n)}async getLeafFromHeight(e){return await this.sendRequest(Or,"getLeafFromHeight",e)}async getTransactionFromHeightAndOffset(e,o){return await this.sendRequest(jr,"getTransactionFromHeightAndOffset",e,o)}async getBlockSummaries(e,o){return await this.sendRequest(zn,"getBlockSummaries",e,o)}async getBlockFromHeight(e){return await this.sendRequest(Ir,"getBlockFromHeight",e)}async getTransactionSummaryRange(e,o,n){return await this.sendRequest(Io,"getTransactionSummaryRange",e,o,n)}async getTransactionSummaryRangeForRollup(e,o,n,s){return await this.sendRequest(Io,"getTransactionSummaryRangeForRollup",e,o,n,s)}}class mi{constructor(e){t(this,"helper");this.helper=e}async sendRequest(e,o,...n){return this.helper.submitRequest(e,"status",o,n)}async blockHeight(){return await this.sendRequest(c,"blockHeight")}}class pi{constructor(e){t(this,"helper");this.helper=e}async sendRequest(e,o,...n){return this.helper.submitRequest(e,"explorer",o,n)}async getBlockDetail(e){return await this.sendRequest(oo,"getBlockDetail",ht.encode(e))}async getBlockSummaries(e){return await this.sendRequest(no,"getBlockSummaries",wt.encode(e))}async getTransactionDetail(e){return await this.sendRequest(po,"getTransactionDetail",at.encode(e))}async getTransactionSummaries(e){return await this.sendRequest(Co,"getTransactionSummaries",vt.encode(e))}async getExplorerOverview(){return await this.sendRequest(co,"getExplorerOverview",null)}async getSearchResult(e){return await this.sendRequest(wr,"getSearchResult",Uo.encode(e))}}class wi{constructor(){t(this,"availability");t(this,"status");t(this,"explorer");const e=new li,o=new ui(e);this.availability=new hi(o),this.status=new mi(o),this.explorer=new pi(o)}}const fi=Bt.createContext(Ci());function Ci(){return typeof window<"u"&&"Worker"in window||typeof self<"u"&&"Worker"in self?new wi:new Aa}function yi(){return typeof window>"u"?fetch:fetch.bind(window)}const Po=({url:r,children:e})=>bt(fi.Provider,{value:new Ga(yi(),r),children:e});try{Po.displayName="ProvideCappuccinoLiveService",Po.__docgenInfo={description:`ProvideCappuccinoLiveService is a component that provides a Cappuccino
HotShot Query Service API targeting the given URL.`,displayName:"ProvideCappuccinoLiveService",props:{url:{defaultValue:null,description:"",name:"url",required:!0,type:{name:"URL"}}}}}catch{}export{pr as C,or as P,K as U,hr as a,ur as b,Pe as c,Go as d,fi as e,ko as f,Eo as g,yt as h,Je as i,Me as j,ao as k};
