var zf=Object.defineProperty;var jf=(se,Q,Ce)=>Q in se?zf(se,Q,{enumerable:!0,configurable:!0,writable:!0,value:Ce}):se[Q]=Ce;var n=(se,Q,Ce)=>jf(se,typeof Q!="symbol"?Q+"":Q,Ce);(function(){"use strict";class se{assert(){}}function Q(){return new se}const Ce=Q();function R(t,e){Ce.assert(t,e)}function Mn(t,e){R(typeof t===e,`type assertion failed: expected "${e}", received "${typeof t}"`)}function wc(t){R(t!==null,"expected a non-null value, received null")}function p(t,e){R(t instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof t=="object"&&t!==null?t.constructor.name:typeof t}"`)}class Wt extends Error{constructor(o,r,s=`expected object with key: "${r}", instead found ${o}`){super(s);n(this,"key");n(this,"haveType");this.haveType=o,this.key=r,Object.freeze(this)}toJSON(){return{code:Wt.name,message:this.message,have:this.haveType,key:this.key}}}class ce{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class c extends ce{}function Ft(t){return typeof t=="number"}function K(t){return typeof t=="string"}function Ln(t){return typeof t=="object"&&t!==null}function rt(t){return t!==void 0}function fc(t,e){return Array.isArray(t)&&t.every(e)}function mc(t){return e=>fc(e,t)}function Jt(t,e,o){return Ln(t)&&e in t&&o(t[e])}function ae(t,...e){return Ln(t)&&e.every(o=>o in t)}function i(t,...e){if(typeof t!="object")throw new Error("expected object");if(t===null)throw new Error("received null");for(const o of e)if(!(o in t))throw new Wt("object",o)}function A(t,e){if(!K(t.code))throw new Error("code must be a string");if(t.code!==e)throw new Error(`expected code to be ${e}, got ${t.code}`)}function ie(t,e){if(!K(t.type))throw new Error("type must be a string");if(t.type!==e)throw new Error(`expected type to be ${e}, got ${t.type}`)}class C extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return U.convert(this)}}class T{convert(e){return p(e,C),{code:e.code,message:e.message}}}const U=new T,pc="NoCodecFoundError";class Ne extends Error{constructor(o,r=`no codec found for: "${o}"`){super(r);n(this,"codec");this.codec=o,Object.freeze(this);debugger}toJSON(){return{code:h.encode(Ne.name),message:h.encode(this.message),codec:h.encode(this.codec)}}get code(){return pc}}const Gt=new Map;class gc{convert(e){i(e,"code");const o=h.decode(e.code),r=Gt.get(o);if(!r)throw new Ne(o);return r.decode(e)}}class Ac{convert(e){const o=Gt.get(e.code);if(!o)throw new Ne(e.code);return o.encode(e)}}class yc extends ce{constructor(){super(...arguments);n(this,"encoder",new Ac);n(this,"decoder",new gc)}}const st=new yc;function y(t,e){Gt.set(t,e)}const Qt="InvalidTypeError";class f extends C{constructor(o,r,s=`invalid type: have "${o}", want "${r}"`){super(s);n(this,"have");n(this,"want");this.have=o,this.want=r,Object.freeze(this)}toJSON(){return Hn.encode(this)}get code(){return Qt}}class Cc{convert(e){return i(e,"code","have","want","message"),A(e,Qt),new f(h.decode(e.have),h.decode(e.want),h.decode(e.message))}}class bc{convert(e){return p(e,f),{...U.convert(e),have:h.encode(e.have),want:h.encode(e.want)}}}class Sc extends c{constructor(){super(...arguments);n(this,"encoder",new bc);n(this,"decoder",new Cc)}}const Hn=new Sc;y(Qt,Hn);const Vn=mc(rt);class vc{convert(e){return e}}const Un=new vc;class Bc extends ce{constructor(){super(...arguments);n(this,"encoder",Un);n(this,"decoder",Un)}}const ct=new Bc;class v{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){if(!Vn(e)){const o=typeof e=="object"&&e!==null?e.constructor.name:typeof e,r="array";throw new Error(`invalid array value: have "${o}", want "${r}"`)}return e.map(o=>this.itemCodec.decode(o))}}class B{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return p(e,Array),e.map(o=>this.itemCodec.encode(o))}}class E extends c{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=r,this.decoder=o}}class z{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class j{constructor(e){n(this,"itemCodec");this.itemCodec=e}convert(e){return e===null?null:(wc(e),this.itemCodec.encode(e))}}class q extends c{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=r,this.decoder=o}}class Ec{convert(e){if(!K(e))throw new f(typeof e,"string");return e}}class kc{convert(e){return Mn(e,"string"),e}}class xc extends c{constructor(){super(...arguments);n(this,"encoder",new kc);n(this,"decoder",new Ec)}}const h=new xc;new E(new v(h),new B(h));const L=new q(new z(h),new j(h));function be(t){return!t||!t.trim()?null:t}class zt extends C{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return Wn}}const Wn="CompleterAlreadyCompletedError";class Ic{convert(e){return i(e,"code","message"),A(e,Wn),new zt(h.decode(e.message))}}class Nc extends T{}class Rc extends c{constructor(){super(...arguments);n(this,"encoder",new Nc);n(this,"decoder",new Ic)}}const Dc=new Rc;y(zt.name,Dc);function at(){return R(!1,"completer is not ready, this should never be reached")}function it(){throw new zt}class Pc{constructor(){n(this,"resolve",at);n(this,"reject",at);n(this,"completed",!1);n(this,"promise");this.promise=new Promise((e,o)=>{this.resolve=e,this.reject=o}),R(this.resolve!==at,"resolve should be set"),R(this.reject!==at,"resolve should be set")}get isCompleted(){return this.completed}complete(e){const o=this.resolve,r=this.reject;if(this.completed=!0,this.resolve=it,this.reject=it,e instanceof Promise){e.then(o,r);return}o(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=it,this.reject=it}}function dt(){return new Pc}class Re extends C{constructor(o,r,s){super(s);n(this,"response");n(this,"status");this.status=o,this.response=r}toJSON(){return Fn.convert(this)}}class lt{convert(e){return p(e,Re),{...U.convert(e),status:e.status}}}const Fn=new lt,jt="BadResponseClientError";class Oc extends Re{constructor(e,o,r="bad server response: client error"){super(e,o,r),Object.freeze(this)}get code(){return jt}toJSON(){return Jn.encode(this)}}class Tc{convert(e){return i(e,"code","message","status"),A(e,jt),new Oc(Number(e.status),null,h.decode(e.message))}}class Mc extends lt{}class Lc extends c{constructor(){super(...arguments);n(this,"encoder",new Mc);n(this,"decoder",new Tc)}}const Jn=new Lc;y(jt,Jn);const qt="BadResponseError";class Hc extends Re{constructor(e,o,r="bad server response"){super(e,o,r),Object.freeze(this)}get code(){return qt}toJSON(){return Gn.encode(this)}}class Vc{convert(e){return i(e,"code","message","status"),A(e,qt),new Hc(Number(e.status),null,h.decode(e.message))}}class Uc extends lt{}class Wc extends c{constructor(){super(...arguments);n(this,"encoder",new Uc);n(this,"decoder",new Vc)}}const Gn=new Wc;y(qt,Gn);class Fc extends Re{constructor(e,o,r="bad server response: server error"){super(e,o,r),Object.freeze(this)}get code(){return _t}}const _t="BadResponseServerError";class Jc{convert(e){return i(e,"code","message","status"),A(e,_t),new Fc(Number(e.status),null,h.decode(e.message))}}class Gc extends lt{}class Qc extends c{constructor(){super(...arguments);n(this,"encoder",new Gc);n(this,"decoder",new Jc)}}const zc=new Qc;y(_t,zc);const $t="ChannelClosedError";class De extends C{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return $t}}class jc{convert(e){return i(e,"code","message"),A(e,$t),new De(h.decode(e.message))}}class qc extends T{}class _c extends c{constructor(){super(...arguments);n(this,"encoder",new qc);n(this,"decoder",new jc)}}const $c=new _c;y($t,$c);const Xt="FetchError";class Xc extends C{constructor(o,r=`fetch failed: ${String(o)}`){super(r);n(this,"cause");this.cause=o,Object.freeze(this)}get code(){return Xt}}class Yc{convert(e){return i(e,"code","message"),A(e,Xt),new Xc({},h.decode(e.message))}}class Kc extends T{}class Zc extends c{constructor(){super(...arguments);n(this,"encoder",new Kc);n(this,"decoder",new Yc)}}const ea=new Zc;y(Xt,ea);const Yt="IncorrectBase64PaddingError";class Qn extends C{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return Yt}}class ta{convert(e){return i(e,"code","message"),A(e,Yt),new Qn(h.decode(e.message))}}class oa extends T{}class na extends c{constructor(){super(...arguments);n(this,"encoder",new oa);n(this,"decoder",new ta)}}const ra=new na;y(Yt,ra);class sa{convert(e){if(!Ft(e))throw new f(typeof e,"number");return e}}class ca{convert(e){return Mn(e,"number"),e}}class aa extends c{constructor(){super(...arguments);n(this,"encoder",new ca);n(this,"decoder",new sa)}}const u=new aa,zn=new q(new z(u),new j(u)),de=new E(new v(u),new B(u)),Z=new E(new v(zn),new B(zn)),Kt="InvalidBase64AlphabetLengthError";class Zt extends C{constructor(o,r=`alphabet needs to be 64 characters, received ${o}`){super(r);n(this,"length");this.length=o,Object.freeze(this)}toJSON(){return jn.encode(this)}get code(){return Kt}}class ia{convert(e){return i(e,"code","length","message"),A(e,Kt),new Zt(u.decode(e.length),h.decode(e.message))}}class da{convert(e){return p(e,Zt),{...U.convert(e),length:u.encode(e.length)}}}class la extends c{constructor(){super(...arguments);n(this,"encoder",new da);n(this,"decoder",new ia)}}const jn=new la;y(Kt,jn);const eo="InvalidHexStringError";class to extends C{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return eo}}class ua{convert(e){return i(e,"code","message"),A(e,eo),new to(h.decode(e.message))}}class ha extends T{}class wa extends c{constructor(){super(...arguments);n(this,"encoder",new ha);n(this,"decoder",new ua)}}const fa=new wa;y(eo,fa);const oo="InvalidHexValueError";class qn extends C{constructor(o,r=`invalid hex value "${o}"`){super(r);n(this,"value");this.value=o,Object.freeze(this)}toJSON(){return _n.encode(this)}get code(){return oo}}class ma{convert(e){return i(e,"code","value","message"),A(e,oo),new qn(u.decode(e.value),h.decode(e.message))}}class pa{convert(e){return{...U.convert(e),value:u.encode(e.value)}}}class ga extends c{constructor(){super(...arguments);n(this,"encoder",new pa);n(this,"decoder",new ma)}}const _n=new ga;y(oo,_n);const no="InvalidInputError";class ee extends C{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return no}}class Aa{convert(e){return i(e,"code","message"),A(e,no),new ee(h.decode(e.message))}}class ya extends T{}class Ca extends c{constructor(){super(...arguments);n(this,"encoder",new ya);n(this,"decoder",new Aa)}}const ba=new Ca;y(no,ba);const ro="InvalidStringValueError";class $n extends C{constructor(o,r,s=`invalid string value: have "${o}", want "${r}"`){super(s);n(this,"have");n(this,"want");this.have=o,this.want=r,Object.freeze(this)}toJSON(){return Xn.encode(this)}get code(){return ro}}class Sa{convert(e){return i(e,"code","have","want","message"),A(e,ro),new $n(h.decode(e.have),h.decode(e.want),h.decode(e.message))}}class va{convert(e){return p(e,$n),{...U.convert(e),have:h.encode(e.have),want:h.encode(e.want)}}}class Ba extends c{constructor(){super(...arguments);n(this,"encoder",new va);n(this,"decoder",new Sa)}}const Xn=new Ba;y(ro,Xn);const so="InvalidTaggedBase64EncodingError";class Yn extends C{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return Kn.encode(this)}get code(){return so}}class Ea{convert(e){return i(e,"code","message"),A(e,so),new Yn(h.decode(e.message))}}class ka extends T{}class xa extends c{constructor(){super(...arguments);n(this,"encoder",new ka);n(this,"decoder",new Ea)}}const Kn=new xa;y(so,Kn);const co="MissingElementError";class ut extends C{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return co}}class Ia{convert(e){return i(e,"code","message"),A(e,co),new ut(h.decode(e.message))}}class Na extends T{}class Ra extends c{constructor(){super(...arguments);n(this,"encoder",new Na);n(this,"decoder",new Ia)}}const Da=new Ra;y(co,Da);const ao="NoCompleterFoundForRequestID";class Zn extends C{constructor(o,r=`no completer found for request id "${o}"`){super(r);n(this,"requestID");this.requestID=o,Object.freeze(this)}toJSON(){return er.encode(this)}get code(){return ao}}class Pa{convert(e){return i(e,"code","requestID","message"),A(e,ao),new Zn(ct.decode(e.requestID),h.decode(e.message))}}class Oa{convert(e){return p(e,Zn),{...U.convert(e),requestID:ct.encode(e.requestID)}}}class Ta extends c{constructor(){super(...arguments);n(this,"encoder",new Oa);n(this,"decoder",new Pa)}}const er=new Ta;y(ao,er);const io="NotFoundError";class Ma extends C{constructor(o,r=`Not Found: ${o}`){super(r);n(this,"key");this.key=o,Object.freeze(this)}get code(){return io}}class tr{constructor(e){n(this,"codec");this.codec=e}convert(e){return i(e,"code","key"),A(e,io),new Ma(this.codec.decode(e.key))}}class or{constructor(e){n(this,"codec");this.codec=e}convert(e){return{...U.convert(e),key:this.codec.encode(e.key)}}}class nr extends c{constructor(o,r){super();n(this,"encoder");n(this,"decoder");this.encoder=o,this.decoder=r}}new nr(new or(h),new tr(h));const La=new nr(new or(ct),new tr(ct));y(io,La);const lo="NoURLProvidedError";class Ha extends C{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return lo}}class Va{convert(e){return i(e,"code","message"),A(e,lo),new Ha(h.decode(e.message))}}class Ua extends T{}class Wa extends c{constructor(){super(...arguments);n(this,"encoder",new Ua);n(this,"decoder",new Va)}}const Fa=new Wa;y(lo,Fa);const uo="UnimplementedError";class H extends C{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return uo}}class Ja{convert(e){return i(e,"code","message"),A(e,uo),new H(h.decode(e.message))}}class Ga extends T{}class Qa extends c{constructor(){super(...arguments);n(this,"encoder",new Ga);n(this,"decoder",new Ja)}}const za=new Qa;y(uo,za);const ho="QUERY_ERROR";class ja extends C{constructor(o,r="missing element"){super(r);n(this,"error");this.error=o,Object.freeze(this)}get code(){return ho}}class qa{convert(e){return i(e,"code","error","message"),A(e,ho),new ja(ar.decode(e.error),h.decode(e.message))}}class _a{convert(e){return{code:e.code,error:ar.encode(e.error),message:h.encode(e.message)}}}class $a extends c{constructor(){super(...arguments);n(this,"encoder",new _a);n(this,"decoder",new qa)}}const Xa=new $a;class wo{}const fo="NotFound";class rr extends wo{constructor(){super(),Object.freeze(this)}valueOf(){return fo}toJSON(){return this.valueOf()}}const Ya=new rr,mo="Missing";class sr extends wo{constructor(){super(),Object.freeze(this)}valueOf(){return mo}toJSON(){return this.valueOf()}}const Ka=new sr;class cr extends wo{constructor(o){super();n(this,"error");this.error=o,Object.freeze(this)}toJSON(){return go.encode(this)}}class Za{constructor(e){n(this,"message");this.message=e,Object.freeze(this)}toJSON(){return po.encode(this)}}class ei{convert(e){return i(e,"message"),new Za(h.decode(e.message))}}class ti{convert(e){return{message:h.encode(e.message)}}}class oi extends c{constructor(){super(...arguments);n(this,"encoder",new ti);n(this,"decoder",new ei)}}const po=new oi;class ni{convert(e){return i(e,"Error"),new cr(po.decode(e.Error))}}class ri{convert(e){return{Error:po.encode(e.error)}}}class si extends c{constructor(){super(...arguments);n(this,"encoder",new ri);n(this,"decoder",new ni)}}const go=new si;class ci{convert(e){return e===fo?Ya:e===mo?Ka:go.decode(e)}}class ai{convert(e){if(e instanceof rr)return fo;if(e instanceof sr)return mo;if(e instanceof cr)return go.encode(e);throw new H}}class ii extends c{constructor(){super(...arguments);n(this,"encoder",new ai);n(this,"decoder",new ci)}}const ar=new ii;y(ho,Xa);const ir="ResponseContentTypeIsNotApplicationJSONError";class ht extends Re{constructor(o,r,s,a="response content type is not application/json"){super(r,s,a);n(this,"haveHeaderType");this.haveHeaderType=o,Object.freeze(this)}static fromResponse(o,r){return new ht(o.headers.get("content-type")??"undefined",o.status,o,r)}toJSON(){return dr.encode(this)}get code(){return ir}}class di{convert(e){return i(e,"code","status","have","want","message"),A(e,ir),new ht(h.decode(e.code),u.decode(e.status),null,h.decode(e.message))}}class li{convert(e){return{...Fn.convert(e),have:h.encode(e.haveHeaderType),want:h.encode("application/json")}}}class ui extends c{constructor(){super(...arguments);n(this,"encoder",new li);n(this,"decoder",new di)}}const dr=new ui;y(ht.name,dr);const Ao="WebWorkerErrorResponse";class hi extends C{constructor(o,r="error in web worker"){super(r);n(this,"error");this.error=o,Object.freeze(this)}toJSON(){return lr.encode(this)}get code(){return Ao}}class wi{convert(e){return i(e,"code","error","message"),A(e,Ao),new hi(st.decode(e.error),h.decode(e.message))}}class fi{convert(e){return{...U.convert(e),error:st.encode(e.error)}}}class mi extends c{constructor(){super(...arguments);n(this,"encoder",new fi);n(this,"decoder",new wi)}}const lr=new mi;y(Ao,lr);var yo=(t=>(t[t.success=0]="success",t[t.full=1]="full",t[t.failed=2]="failed",t))(yo||{});class pi{getFromEmpty(){}}class gi{getFromEmpty(){return null}}class Ai{getFromEmpty(){throw new ut}}const ur={returnNull:new gi,returnUndefined:new pi,throwMissingElement:new Ai};class yi{constructor(e){n(this,"maxSize");R(!Number.isNaN(e),"maxSize must not be NaN"),R(Number.isInteger(e),"maxSize must be an integer"),R(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return R(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class Ci{constructor(e){n(this,"preComputedSizeMinus1");R(!Number.isNaN(e),"maxSize must not be NaN"),R(Number.isInteger(e),"maxSize must be an integer"),R(e>0,"maxSize must be greater than 0"),R(hr(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return R(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function hr(t){return(t&t-1)===0}const Co="BufferFullError";class wr extends C{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return Co}}class bi{convert(e){return i(e,"code","message"),A(e,Co),new wr(h.decode(e.message))}}class Si extends T{}class vi extends c{constructor(){super(...arguments);n(this,"encoder",new Si);n(this,"decoder",new bi)}}const Bi=new vi;y(Co,Bi);class Ei{putToFull(e,o){return e.get(),e.put(o)}}class ki{putToFull(){return yo.full}}class xi{putToFull(){throw new wr}}const fr={overwriteOldest:new Ei,returnFull:new ki,throw:new xi};function Ii(t){return hr(t)?new Ci(t):new yi(t)}class Ni{constructor(e,o,r){n(this,"readIndex",0);n(this,"writeIndex",0);n(this,"buffer");n(this,"nextIndex");n(this,"getOnEmpty");n(this,"putOnFull");R(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=Ii(e),this.getOnEmpty=o,this.putOnFull=r}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const o=this.nextIndex.nextIndex(this.writeIndex);return o===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=o,yo.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new Ri(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new Di(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class Ri{constructor(e){n(this,"buffer");this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class Di{constructor(e,o,r,s){n(this,"readIndex");n(this,"writeIndex");n(this,"buffer");n(this,"nextIndex");this.readIndex=e,this.writeIndex=o,this.buffer=r,this.nextIndex=s}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function le(t=32,e=ur.returnUndefined,o=fr.overwriteOldest){return new Ni(t,e,o)}class Pi{constructor(e){n(this,"publishQueue");n(this,"pollBlocked");n(this,"publishBlocked");n(this,"capacity");n(this,"closed",!1);this.publishQueue=le(Math.max(2,e),ur.throwMissingElement,fr.throw);const o=dt();this.pollBlocked=o,this.publishBlocked=o,o.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new De;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new De;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const o=dt();this.publishBlocked=o,await o.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new De;if(this.pollBlocked.isCompleted){const o=dt();this.pollBlocked=o}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new Oi(this)}}class Oi{constructor(e){n(this,"channel");this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof De)return{done:!0,value:void 0};throw e}}}function Se(t){return new Pi(t)}class Ti{constructor(e){n(this,"channel");this.channel=e}async send(e){await this.channel.publish(e)}}function ue(t){return new Ti(t)}const bo="CorruptBase64InputError";class te extends C{constructor(o,r=`corrupt input error at ${o}`){super(r);n(this,"offset");this.offset=o,Object.freeze(this)}get code(){return bo}toJSON(){return mr.encode(this)}}class Mi{convert(e){return i(e,"code","offset","message"),A(e,bo),new te(u.decode(e.offset),h.decode(e.message))}}class Li{convert(e){return p(e,te),{...U.convert(e),offset:u.encode(e.offset),message:h.encode(e.message)}}}class Hi extends c{constructor(){super(...arguments);n(this,"encoder",new Li);n(this,"decoder",new Mi)}}const mr=new Hi;y(bo,mr);const Vi=new TextEncoder;function pr(t){return Vi.encode(t)}const Ui=new TextDecoder;function Wi(t){return Ui.decode(t)}function*gr(t){yield*pr(t)}function*Fi(){for(let t=0;t<256;t++)yield 255}const Pe=-1,Ji=61;class Oe{constructor(e,o,r=Ji,s=!1){n(this,"encodeMap");n(this,"decodeMap");n(this,"padChar");n(this,"strict");this.encodeMap=e,this.decodeMap=o,this.padChar=r,this.strict=s}static withAlphabet(e){const o=e.length;if(o!==64)throw new Zt(o);const r=Array.from(gr(e)),s=Array.from(Fi());for(let a=0;a<o;a++)s[r[a]]=a;return new Oe(r,s)}withPadding(e){return new Oe(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let o=0,r=0;const s=Math.floor(e.byteLength/3)*3,a=Math.ceil(e.byteLength/3)*4,d=new ArrayBuffer(a),l=new DataView(e),m=new DataView(d);for(;r<s;){const V=l.getUint8(r+0)<<16|l.getUint8(r+1)<<8|l.getUint8(r+2);m.setUint8(o+0,this.encodeMap[V>>18&63]),m.setUint8(o+1,this.encodeMap[V>>12&63]),m.setUint8(o+2,this.encodeMap[V>>6&63]),m.setUint8(o+3,this.encodeMap[V&63]),r+=3,o+=4}const w=e.byteLength-r;if(w===0)return d;let N=l.getUint8(r+0)<<16;switch(w===2&&(N|=l.getUint8(r+1)<<8),m.setUint8(o+0,this.encodeMap[N>>18&63]),m.setUint8(o+1,this.encodeMap[N>>12&63]),w){case 2:return m.setUint8(o+2,this.encodeMap[N>>6&63]),this.padChar!==Pe?(m.setUint8(o+3,this.padChar),d.slice(0,o+4)):d.slice(0,o+3);case 1:if(this.padChar!==Pe)return m.setUint8(o+2,this.padChar),m.setUint8(o+3,this.padChar),d.slice(0,o+4);break}return d.slice(0,o+2)}decode(e){const o=e.byteLength;if(o===0)return new ArrayBuffer(0);const r=new DataView(e),s=new ArrayBuffer(Math.floor(o/4*3)),a=new DataView(s),d=new ArrayBuffer(4),l=new DataView(d);let m=0,w=0,N=0,V=!1;for(;w<o&&!V;){let re=3,Y=4;for(let D=0;D<4;D++){if(w===o){if(D===0)return s;if(D===1||this.padChar!==Pe)throw new te(w-D);re=D-1,Y=D,V=!0;break}const G=r.getUint8(w);w++;const hc=this.decodeMap[G];if(hc!==255){l.setUint8(D,hc);continue}if(G===10||G===13){D--;continue}if(G===this.padChar){switch(D){case 0:case 1:throw new Qn;case 2:for(;w<o&&(r.getUint8(w)===10||r.getUint8(w)===13);)w++;if(w===o)throw new te(o);w++}for(;w<o&&(r.getUint8(w)===10||r.getUint8(w)===13);)w++;if(w<o)throw new te(w);re=3,Y=D,V=!0;break}throw new te(w-1)}const O=l.getUint8(0)<<18|l.getUint8(1)<<12|l.getUint8(2)<<6|l.getUint8(3);switch(l.setUint8(2,O>>0&255),l.setUint8(1,O>>8&255),l.setUint8(0,O>>16&255),Y){case 4:a.setUint8(N+2,l.getUint8(2)),l.setUint8(2,0);case 3:if(a.setUint8(N+1,l.getUint8(1)),this.strict&&l.getUint8(2)!==0)throw new te(w-1);case 2:if(a.setUint8(N+0,l.getUint8(0)),this.strict&&(l.getUint8(1)!==0||l.getUint8(2)!==0))throw new te(w-2)}N+=re,m+=Y-1}return s.slice(0,m)}decodeString(e){return this.decode(pr(e).buffer)}encodeToString(e){return Wi(this.encode(e))}}const So=Oe.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Gi=So.withPadding(Pe),Ar=Oe.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),vo=Ar.withPadding(Pe);function*Qi(t,e){for(let o=t.next();!o.done;o=t.next())e(o.value)&&(yield o.value)}function Bo(t,e){return Qi(t[Symbol.iterator](),e)}function*yr(t,e){for(let o=t.next();!o.done;o=t.next())yield e(o.value)}function _(t,e){return yr(t[Symbol.iterator](),e)}function*zi(t,e){for(let o=0;o<e;o++){const r=t.next();if(r.done)return;yield r.value}}function ji(t,e){return zi(t[Symbol.iterator](),e)}function Cr(t){const e=t.next();if(e.done)throw new ut;return e.value}function qi(t){let e;for(let o=t.next();!o.done;o=t.next())e=o.value;if(e===void 0)throw new ut;return e}function _i(t){return qi(t[Symbol.iterator]())}function*$i(t,e){for(let o=t.next();!o.done;o=t.next())yield*e(o.value)}function br(t,e){return $i(t[Symbol.iterator](),e)}function*Xi(){let t=0;for(;;)yield t++}function Sr(t){return ji(Xi(),Math.ceil(t))}function vr(t,e,o){const r=o;let s=e;for(let a=r.next();!a.done;a=r.next())s=t(s,a.value);return s}function*Yi(t,e,o){for(let r=t.next(),s=e.next();!r.done&&!s.done;r=t.next(),s=e.next())yield o(r.value,s.value)}function Br(t,e,o){return Yi(t[Symbol.iterator](),e[Symbol.iterator](),o)}function Er(t){if(t.startsWith("0x"))return Er(t.substring(2));if(t.length&1)throw new to;const e=new ArrayBuffer(t.length/2);return Ki(gr(t),e),e}function Ki(t,e){const o=new DataView(e);let r=0;for(;r<e.byteLength;){const s=t.next(),a=t.next();if(s.done||a.done)throw new to;const d=kr(s.value),l=kr(a.value),m=d<<4|l;o.setUint8(r,m),r++}}function kr(t){if(t>=48&&t<=57)return t-48;if(t>=97&&t<=102)return t-97+10;if(t>=65&&t<=70)return t-65+10;throw new qn(t)}function Zi(t){return t.toString(16).padStart(2,"0")}function*ed(t){yield*yr(t,Zi)}function td(t){return ed(t[Symbol.iterator]())}class od{convert(e){if(typeof e!="string")throw new f(typeof e,"string");return Er(e)}}class nd{convert(e){return p(e,ArrayBuffer),["0x",...td(new Uint8Array(e))].join("")}}class rd extends c{constructor(){super(...arguments);n(this,"encoder",new nd);n(this,"decoder",new od)}}const M=new rd;new q(new z(M),new j(M));const xr=new E(new v(M),new B(M));class sd{convert(e){return e instanceof Array?xr.decode(e):[M.decode(e)]}}class cd{convert(e){return xr.encode(e)}}class ad extends c{constructor(){super(...arguments);n(this,"encoder",new cd);n(this,"decoder",new sd)}}const oe=new ad;class id{constructor(e){n(this,"encoding");this.encoding=e}convert(e){if(typeof e!="string")throw new f(typeof e,"string");return this.encoding.decodeString(e)}}class dd{constructor(e){n(this,"encoding");this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class wt extends c{constructor(o){super();n(this,"encoder");n(this,"decoder");this.encoder=new dd(o),this.decoder=new id(o)}}new wt(vo),new wt(Gi);const Ir=new wt(Ar),Nr=new wt(So);class ld{convert(e){if(!K(e))throw new f(typeof e,"string");const o=new Date(e);if(Number.isNaN(o.valueOf()))throw new f("NaN","number");return o}}class ud{convert(e){return p(e,Date),e.toISOString()}}class hd extends c{constructor(){super(...arguments);n(this,"encoder",new ud);n(this,"decoder",new ld)}}const ve=new hd;class wd{convert(e){if(!K(e))throw new f(typeof e,"string");return new URL(e)}}class fd{convert(e){return e.toString()}}class md extends c{constructor(){super(...arguments);n(this,"encoder",new fd);n(this,"decoder",new wd)}}const Rr=new md,ft=new q(new z(Rr),new j(Rr));class Dr{}class Pr{}const Te="Close";class Me extends Pr{valueOf(){return Te}}class pd{convert(){return Te}}class gd{convert(e){if(typeof e!="string")throw new f(typeof e,"string");if(e!==Te)throw new f(e,Te);return new Me}}class Ad extends c{constructor(){super(...arguments);n(this,"encoder",new pd);n(this,"decoder",new gd)}}const Or=new Ad,Le="Connect";class He extends Pr{valueOf(){return Le}toJSON(){return Eo.encode(this)}}class yd{convert(){return Le}}class Cd{convert(e){if(typeof e!="string")throw new f(typeof e,"string");if(e!==Le)throw new f(e,Le);return new He}}class bd extends c{constructor(){super(...arguments);n(this,"encoder",new yd);n(this,"decoder",new Cd)}}const Eo=new bd;class Sd{convert(e){if(e===Le)return Eo.decode(e);if(e===Te)return Or.decode(e);throw new H}}class vd{convert(e){if(e instanceof He)return Eo.encode(e);if(e instanceof Me)return Or.encode(e);throw new H}}class Bd extends c{constructor(){super(...arguments);n(this,"encoder",new vd);n(this,"decoder",new Sd)}}const Tr=new Bd;class mt extends Dr{constructor(o){super();n(this,"command");this.command=o}get type(){return Ve}toJson(){return Mr.encode(this)}}const Ve="WebSocket";class Ed{convert(e){return{[Ve]:Tr.encode(e.command)}}}class kd{convert(e){return i(e,Ve),new mt(Tr.decode(e[Ve]))}}class xd extends c{constructor(){super(...arguments);n(this,"encoder",new Ed);n(this,"decoder",new kd)}}const Mr=new xd,he=new Map;he.set(Ve,Mr);class Id{convert(e){const o=he.get(e.type);if(!o)throw new f(e.type,`one of ${Array.from(_(he.keys(),r=>`"${r}"`)).join(", ")}`);return{[e.type]:o.encode(e)}}}class Nd{convert(e){if(typeof e!="object"||e===null)throw new f(typeof e,"object");const o=Object.keys(e);if(o.length!==1)throw new H("multiple values contained within the Request object, unexpected");const[r]=o,s=he.get(r);if(i(e,r),!s)throw new f(r,`one of ${Array.from(_(he.keys(),a=>`"${a}"`)).join(", ")}`);return s.decode(e[r])}}class Rd extends c{constructor(){super(...arguments);n(this,"encoder",new Id);n(this,"decoder",new Nd)}}function Dd(t,e){he.has(t)||he.set(t,e)}const Pd=new Rd;class ko{}const Ue="Error";class Lr extends ko{constructor(o){super();n(this,"error");this.error=o}get type(){return Ue}toJson(){return Hr.encode(this)}}class Od{convert(e){return{[Ue]:st.encode(e.error)}}}class Td{convert(e){return i(e,Ue),new Lr(st.decode(e[Ue]))}}class Md extends c{constructor(){super(...arguments);n(this,"encoder",new Od);n(this,"decoder",new Td)}}const Hr=new Md;class xo{}const We="Closed";class Be extends xo{valueOf(){return We}toJSON(){return Io.encode(this)}}class Ld{convert(e){if(typeof e!="string")throw new f(typeof e,"string");if(e!==We)throw new f(e,We);return new Be}}class Hd{convert(){return We}}class Vd extends c{constructor(){super(...arguments);n(this,"encoder",new Hd);n(this,"decoder",new Ld)}}const Io=new Vd,Fe="Connecting";class Je extends xo{valueOf(){return Fe}toJSON(){return No.encode(this)}}class Ud{convert(e){if(typeof e!="string")throw new f(typeof e,"string");if(e!==Fe)throw new f(e,Fe);return new Je}}class Wd{convert(){return Fe}}class Fd extends c{constructor(){super(...arguments);n(this,"encoder",new Wd);n(this,"decoder",new Ud)}}const No=new Fd,Ge="Opened";class Qe extends xo{valueOf(){return Ge}toJSON(){return Ro.encode(this)}}class Jd{convert(e){if(typeof e!="string")throw new f(typeof e,"string");if(e!==Ge)throw new f(e,Ge);return new Qe}}class Gd{convert(){return Ge}}class Qd extends c{constructor(){super(...arguments);n(this,"encoder",new Gd);n(this,"decoder",new Jd)}}const Ro=new Qd;class zd{convert(e){if(e===Ge)return Ro.decode(e);if(e===We)return Io.decode(e);if(e===Fe)return No.decode(e);throw new H}}class jd{convert(e){if(e instanceof Qe)return Ro.encode(e);if(e instanceof Be)return Io.encode(e);if(e instanceof Je)return No.encode(e);throw new H}}class qd extends c{constructor(){super(...arguments);n(this,"encoder",new jd);n(this,"decoder",new zd)}}const Vr=new qd;class Ur extends ko{constructor(o){super();n(this,"status");this.status=o}get type(){return ze}toJson(){return Wr.encode(this)}}const ze="WebSocket";class _d{convert(e){return{[ze]:Vr.encode(e.status)}}}class $d{convert(e){return i(e,ze),new Ur(Vr.decode(e[ze]))}}class Xd extends c{constructor(){super(...arguments);n(this,"encoder",new _d);n(this,"decoder",new $d)}}const Wr=new Xd,ne=new Map;ne.set(Ue,Hr),ne.set(ze,Wr);class Yd{convert(e){const o=ne.get(e.type);if(!o)throw new f(e.type,`one of ${Array.from(_(ne.keys(),r=>`"${r}"`)).join(", ")}`);return{[e.type]:o.encode(e)}}}class Kd{convert(e){if(typeof e!="object"||e===null)throw new f(typeof e,"object");const o=Object.keys(e);if(o.length!==1)throw new H("multiple values contained within the response object, unexpected");const[r]=o,s=ne.get(r);if(i(e,r),!s)throw new f(r,`one of ${Array.from(_(ne.keys(),a=>`"${a}"`)).join(", ")}`);return s.decode(e[r])}}class Zd extends c{constructor(){super(...arguments);n(this,"encoder",new Yd);n(this,"decoder",new Kd)}}function el(t,e){ne.has(t)||ne.set(t,e)}const tl=new Zd;class ol{convert(e){return new Lr(e)}}const nl=new ol;class rl{convert(e){return new Ur(e)}}const Do=new rl;class sl{constructor(e,o){this.sink=e,this.converter=o,this.sink=e,this.converter=o}async send(e){await this.sink.send(this.converter.convert(e))}}function we(t,e){return new sl(t,e)}async function Fr(t){return new Promise(e=>{const o=setTimeout(()=>{clearTimeout(o),e()},t)})}class ${constructor(e,o,r){n(this,"significantDigitsMultiplier");this.alpha3Code=e,this.code=o,this.significantDigits=r,this.alpha3Code=e,this.code=o,this.significantDigits=r,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}toJSON(){return pt.encode(this)}}const Jr=new $("JPY",392,0),cl=new $("GBP",826,2),Gr=new $("USD",840,2),al=new $("EUR",978,2),il=new $("XXX",999,2),Qr=new $("ETH",1001,18),Po=new $("XBT",1002,8),zr=new $("ESP",10001,18),dl=[Jr,cl,Gr,al,il,Qr,Po,zr],ll=new Map(dl.map(t=>[t.alpha3Code,t]));class ul{convert(e){if(typeof e!="string")throw new ee("CurrencyCodeDecoder: expected string");if(e==="BTC")return Po;const o=ll.get(e);if(o===void 0)throw new ee(`CurrencyCodeDecoder: unknown currency: "${e}"`);return o}}class hl{convert(e){return p(e,$),e.alpha3Code}}class wl extends c{constructor(){super(...arguments);n(this,"decoder",new ul);n(this,"encoder",new hl)}}const pt=new wl;class W{constructor(e,o){this.currency=e,this.value=o,this.currency=e,this.value=o}static USD(e){return new W(Gr,BigInt(e))}static ETH(e){return new W(Qr,BigInt(e))}static ESP(e){return new W(zr,BigInt(e))}static JPY(e){return new W(Jr,BigInt(e))}static BTC(e){return new W(Po,BigInt(e))}toString(){return gt.encode(this)}toJSON(){return gt.encode(this)}}function fl(t){return t==="."||t===","||t===" "}function ml(t,e){let o=-1;const r=t.length;for(let s=0;s<r;s++)e(t[s])&&(o=s);return o}class pl{parseCurrencyCode(e){return pt.decode(e)}parseValue(e,o){let r=1n;o[0]==="-"&&(r=-1n,o=o.substring(1));const s=ml(o,fl);if(s===-1){const w=BigInt(o.replace(/\D/g,""))*e.significantDigitsMultiplier;return r*w}const a=o.substring(0,s).replace(/\D/g,""),d=o.substring(s+1).replace(/\D/g,""),l=BigInt(a)*e.significantDigitsMultiplier,m=BigInt(d)*10n**BigInt(e.significantDigits-d.length);return r*(l+m)}convert(e){if(typeof e!="string")throw new ee("MonetaryValueDecoder: expected string");const o=e.indexOf(" ");if(o<=-1)throw new ee("MonetaryValueDecoder: missing non-breaking space");const r=e.substring(0,o),s=e.substring(o+1);if(/^-?[\d .,]+$/.test(r)){const d=this.parseCurrencyCode(s);return new W(d,this.parseValue(d,r))}const a=this.parseCurrencyCode(r);return new W(a,this.parseValue(a,s))}}class gl{convert(e){p(e,W);const o=e.value<0n?"-":"",r=e.value<0n?-e.value:e.value,s=r%e.currency.significantDigitsMultiplier,a=r/e.currency.significantDigitsMultiplier,d=String(a),l=String(s);return/^0+$/.test(l)?`${pt.encode(e.currency)} ${o}${d}`:`${pt.encode(e.currency)} ${o}${a}.${String(s).padStart(e.currency.significantDigits,"0")}`}}class Al extends c{constructor(){super(...arguments);n(this,"decoder",new pl);n(this,"encoder",new gl)}}const gt=new Al,jr=new E(new v(gt),new B(gt));class k{constructor(e,o,r,s){n(this,"namespace");n(this,"name");n(this,"site");n(this,"blockExplorer");this.namespace=e,this.name=o,this.site=r,this.blockExplorer=s}}const yl=new k(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),Cl=new k(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),bl=new k(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),Sl=new k(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),vl=new k(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),Bl=new k(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),El=new k(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),kl=new k(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),xl=new k(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),Il=new k(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),Nl=new k(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),Rl=new k(1918988905,"RARI",new URL("https://rarichain.org/"),new URL("https://explorer.rarichain.org/")),Dl=new k(1380012617,"RARI",new URL("https://rarichain.org/"),new URL("https://mainnet.explorer.rarichain.org/")),Pl=new k(9369,"LogX",new URL("https://logx.network/"),new URL("https://kartel-testnet-explorer.alt.technology/")),Ol=new k(936369,"LogX",new URL("https://logx.network/"),new URL("https://vzjuxmhfn70kgnlds27h-explorer.alt.technology")),Tl=new k(4661,"AppChain",new URL("https://appchain.xyz/"),new URL("https://appchaintestnet.explorer.caldera.xyz/")),Ml=new k(360,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Ll=new k(3609,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Hl=1397311310,qr=new k(Hl,"Infinite Garden",new URL("https://infinitegarden.espressosys.com/"),new URL("https://explorer.main.net.espressosys.com/")),Vl=[qr,Dl,Ol,Ml],Ul=[qr,Rl,Pl,Tl,Ll],Wl=new Map([yl,Cl,bl,xl,Sl,vl,Bl,El,kl,Il,Nl,...Vl,...Ul].map(t=>[t.namespace,t]));class X{constructor(e,o){n(this,"tag");n(this,"data");this.tag=e,this.data=o}static fromString(e){const o=e.indexOf("~");if(o<0)throw new Yn;const r=e.substring(0,o),s=vo.decodeString(e.substring(o+1));return new X(r,s)}static inflate(e){return g.decode(e)}toString(){return`${this.tag}~${vo.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class Fl{convert(e){if(typeof e!="string")throw new f(typeof e,"string");return X.fromString(e)}}class Jl{convert(e){return p(e,X),e.toString()}}class Gl extends c{constructor(){super(...arguments);n(this,"encoder",new Jl);n(this,"decoder",new Fl)}}const g=new Gl,_r=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],$r=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],Xr=["Linux","Unix","Windows","MacOS"],Yr=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],At=2147483648,Ql=1103515245,zl=12345;class fe{constructor(e){n(this,"state");this.state=e!==void 0?e:Math.floor(Math.random()*(At-1))}nextInt(){return this.state=(Ql*this.state+zl)%At,this.state}nextFloat(){return this.nextInt()/(At-1)}nextRange(e,o){const r=o-e,s=this.nextInt()/At;return e+Math.floor(s*r)}fillBytes(e){const o=new ArrayBuffer(e),r=new DataView(o);let s=0;for(;s<e-4;s+=4)r.setUint32(s,this.nextRange(0,4294967295));for(let a=s;a<e;a++)r.setUint8(a,this.nextRange(0,256));return o}}const jl=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],Kr=[0,0,5,26,28,26,9,6],ql=Kr.reduce((t,e)=>t+e,0),_l=Kr.reduce((t,e)=>{const o=t[t.length-1]??0;return t.push(o+e),t},[]),$l=Array.from(Br(_l,jl,(t,e)=>[t,e])),yt=new Date,Ct=new Date(yt.getFullYear(),yt.getMonth(),yt.getDate()).valueOf();function Xl(){return Ct}async function*Yl(){}function Zr(){const t=new Uint8Array(new Array(20).map(()=>0)).buffer;return{hash:new X("BLOCK",t),height:0,time:new Date(0),genTime:0,transactions:Yl(),numTransactions:0,proposer:[],size:0,fees:[]}}async function*Kl(t){let e=1,o=Ct;for(;o<yt.valueOf();){const r=Math.floor(t.nextFloat()*14*1e3);yield es(new fe(e+r),e,o,o+r),o+=r,e++}}async function*Zl(t=new fe(Ct)){yield Zr(),yield*Kl(t)}async function*eu(t,e,o){let r=e,s=o;for(;;){const a=Math.floor(t.nextFloat()*14*1e3),d=r+a-Date.now();await Fr(d),yield es(new fe(s+a),s,r,r+a),r+=a,s++}}function es(t,e,o,r){const s=Math.floor(t.nextRange(0,5)),a=t.nextRange(0,je.length),d=je[a];return{hash:new X("BLOCK",t.fillBytes(32)),height:e,genTime:r-o,time:new Date(r),numTransactions:s,transactions:ou(new fe(e+o),e,o,r,s),proposer:[d.address],size:Math.floor(t.nextFloat()*1024*s)+8,fees:[W.ESP(BigInt(t.nextRange(0,1e9)*1e3))]}}const ts=Array.from(Wl.keys());function tu(t){return t.nextFloat()>.98?1:ts[t.nextRange(0,ts.length)]}async function*ou(t,e,o,r,s){const a=(r-o)/s;for(let d=0,l=o;l<r;l+=a,d++){const m=tu(t),w=Math.floor(1024*t.nextFloat());yield{block:e,index:d,size:w,hash:new X("COMMIT",t.fillBytes(32)),time:new Date(l),sender:new X("PUBKEY",t.fillBytes(32)),tree:{namespace:m,data:t.fillBytes(w)}}}}function nu(t){const e=t.nextRange(0,ql),o=Bo($l,([d])=>d<=e),[,r]=_i(o),s=t.nextRange(0,r.length);return r[s]}function ru(t){const e=t.nextRange(0,Yr.length);return Yr[e]}function su(t){const e=t.nextRange(0,Xr.length);return Xr[e]}function cu(t){const e=t.nextRange(0,$r.length);return $r[e]}function au(t){const e=t.nextRange(0,_r.length);return _r[e]}function iu(t){const[e,o]=ru(t),[,r,s,a]=nu(t),d=su(t),l=cu(t),m=au(t);return{pubkey:new X("PUBKEY",t.fillBytes(32)),name:`${e} Node ${a} ${t.nextRange(0,100)}`,address:t.fillBytes(32),company:{name:e,website:o},location:{coords:[r,s],country:a},operatingSystem:d,networkType:m,nodeType:l}}function*du(){const t=new fe(Ct),e=t.nextRange(50,150);for(let o=0;o<e;o++)yield iu(t)}const je=Array.from(du());class qe{constructor(e){this.value=e,this.value=e}valueOf(){return Number(this.value)}toString(){return Number(this.value).toString()}}function Oo(t,e){return t.valueOf()<e.valueOf()}function lu(t,e){return t.valueOf()<=e.valueOf()}function bt(t,e){return t.valueOf()>e.valueOf()}function os(t,e){return lu(t,e)?t:e}function ns(t,e){return bt(t,e)?t:e}class To{constructor(e,o){n(this,"min");n(this,"max");this.min=e,this.max=o}contains(e){return!(Oo(e.lat,this.min.lat)||bt(e.lat,this.max.lat)||Oo(e.lng,this.min.lng)||bt(e.lng,this.max.lng))}}function _e(t){const e=t[Symbol.iterator](),o=Cr(e),[r,s]=vr(([a,d],l)=>[a.min(l.bbox.min),d.max(l.bbox.max)],[o.bbox.min,o.bbox.max],e);return new To(r,s)}function uu(t){const e=t[Symbol.iterator](),o=Cr(e),[r,s]=vr(([a,d],l)=>[a.min(l),d.max(l)],[o,o],e);return new To(r,s)}class me{}const rs=new Map;function pe(t,e){rs.set(t,e)}function ss(t){const e=rs.get(t);if(!e)throw new Ne(t);return e}class hu{convert(e){return ss(e.type).encode(e)}}class wu{convert(e){if(i(e,"type","coordinates"),!K(e.type))throw new f(typeof e.type,"string");return ss(e.type).decode(e)}}class fu extends c{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new hu,this.decoder=new wu}}const cs=new fu,as=new E(new v(cs),new B(cs)),Mo="GeometryCollection";class mu extends me{constructor(o){super();n(this,"type",Mo);n(this,"geometries");n(this,"bbox");this.geometries=o,this.bbox=_e(o)}toJSON(){return is.encode(this)}}class pu{constructor(e){n(this,"listGeometryCodec");this.listGeometryCodec=e}convert(e){return{type:e.type,geometries:this.listGeometryCodec.encode(e.geometries)}}}class gu{constructor(e){n(this,"listGeometryCodec");this.listGeometryCodec=e}convert(e){return i(e,"type","geometries"),ie(e,Mo),new mu(this.listGeometryCodec.decode(e.geometries))}}class Au extends c{constructor(){super(...arguments);n(this,"encoder",new pu(as));n(this,"decoder",new gu(as))}}const is=new Au;pe(Mo,is);class P extends qe{toString(){return`${Number(this)}°`}}class yu{convert(e){return Number(e)}}class Cu{convert(e){if(!Ft(e))throw new f(typeof e,"number");return new P(e)}}class bu extends c{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new yu,this.decoder=new Cu}}const Su=new bu;class x extends qe{toString(){return`${String(this.value)} lat`}}class I extends qe{toString(){return`${String(this.value)} lng`}}class F extends qe{toString(){return`${Number(this)} rad`}}class vu{convert(e){return Number(e)}}class Bu{convert(e){if(!Ft(e))throw new f(typeof e,"number");return new F(e)}}class Eu extends c{constructor(){super();n(this,"encoder");n(this,"decoder");this.encoder=new vu,this.decoder=new Bu}}const ku=new Eu;class b{constructor(e,o){this.lat=e,this.lng=o,this.lat=e,this.lng=o}min(e){return new b(os(this.lat,e.lat),os(this.lng,e.lng))}max(e){return new b(ns(this.lat,e.lat),ns(this.lng,e.lng))}toString(){return`${this.lat}, ${this.lng}`}}class xu{constructor(e){n(this,"unitCodec");this.unitCodec=e}convert(e){return[this.unitCodec.encode(e.lat.value),this.unitCodec.encode(e.lng.value)]}}class Iu{constructor(e){n(this,"unitCodec");this.unitCodec=e}convert(e){if(!(e instanceof Array))throw new f(typeof e,"Array");if(e.length!==2)throw new TypeError(`Expected array of length 2, got ${e.length}`);const[o,r]=e;return new b(new x(this.unitCodec.decode(o)),new I(this.unitCodec.decode(r)))}}class ds extends c{constructor(o){super();n(this,"encoder");n(this,"decoder");this.encoder=new xu(o),this.decoder=new Iu(o)}}const ls=new ds(Su),us=new ds(ku),hs=new q(new z(ls),new j(ls));new q(new z(us),new j(us));class Nu{convert(e){return[Number(e.lng),Number(e.lat)]}}class Ru{convert(e){if(!(e instanceof Array))throw new f(typeof e,"Array");if(e.length!==2)throw new TypeError(`Expected array of length 2, got ${e.length}`);return new b(new x(new P(e[1])),new I(new P(e[0])))}}class Du extends c{constructor(){super(...arguments);n(this,"encoder",new Nu);n(this,"decoder",new Ru)}}const St=new Du,Ee=new E(new v(St),new B(St)),ke=new E(new v(Ee),new B(Ee)),ws=new E(new v(ke),new B(ke)),Lo="LineString";class fs extends me{constructor(o){super();n(this,"type",Lo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=uu(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return ms.encode(this)}}class Pu{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates)}}}class Ou{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ie(e,Lo);const o=this.codec.decode(e.coordinates);return new fs(o)}}class Tu extends c{constructor(){super(...arguments);n(this,"encoder",new Pu(Ee));n(this,"decoder",new Ou(Ee))}}const ms=new Tu;pe(Lo,ms);const Ho="MultiLineString";class Mu extends me{constructor(o){super();n(this,"type",Ho);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=_e(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return ps.encode(this)}}class Lu{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates))}}}class Hu{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ie(e,Ho);const o=this.codec.decode(e.coordinates);return new Mu(o.map(r=>new fs(r)))}}class Vu extends c{constructor(){super(...arguments);n(this,"encoder",new Lu(ke));n(this,"decoder",new Hu(ke))}}const ps=new Vu;pe(Ho,ps);const Vo="Point";class vt extends me{constructor(o){super();n(this,"type",Vo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=new To(this.coordinates,this.coordinates)}toJSON(){return gs.encode(this)}}class Uu{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates)}}}class Wu{constructor(e){n(this,"codec");this.codec=e}convert(e){return i(e,"type","coordinates"),ie(e,Vo),new vt(this.codec.decode(e.coordinates))}}class Fu extends c{constructor(){super(...arguments);n(this,"encoder",new Uu(St));n(this,"decoder",new Wu(St))}}const gs=new Fu;pe(Vo,gs);const Uo="MultiPoint";class Wo extends me{constructor(o){super();n(this,"type",Uo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=_e(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return As.encode(this)}}class Ju{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates))}}}class Gu{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ie(e,Uo);const o=this.codec.decode(e.coordinates);return new Wo(o.map(r=>new vt(r)))}}class Qu extends c{constructor(){super(...arguments);n(this,"encoder",new Ju(Ee));n(this,"decoder",new Gu(Ee))}}const As=new Qu;pe(Uo,As);const Fo="Polygon";class ys extends me{constructor(o){super();n(this,"type",Fo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=_e(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return Cs.encode(this)}}class zu{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates.map(r=>r.coordinates)))}}}class ju{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ie(e,Fo);const o=this.codec.decode(e.coordinates);return new ys(o.map(r=>new Wo(r.map(s=>new vt(s)))))}}class qu extends c{constructor(){super(...arguments);n(this,"encoder",new zu(ke));n(this,"decoder",new ju(ke))}}const Cs=new qu;pe(Fo,Cs);const Jo="MultiPolygon";class _u extends me{constructor(o){super();n(this,"type",Jo);n(this,"coordinates");n(this,"bbox");this.coordinates=o,this.bbox=_e(o)}[Symbol.iterator](){return this.coordinates[Symbol.iterator]()}toJSON(){return bs.encode(this)}}class $u{constructor(e){n(this,"codec");this.codec=e}convert(e){return{type:e.type,coordinates:this.codec.encode(e.coordinates.map(o=>o.coordinates.map(r=>r.coordinates.map(s=>s.coordinates))))}}}class Xu{constructor(e){n(this,"codec");this.codec=e}convert(e){i(e,"type","coordinates"),ie(e,Jo);const o=this.codec.decode(e.coordinates);return new _u(o.map(r=>new ys(r.map(s=>new Wo(s.map(a=>new vt(a)))))))}}class Yu extends c{constructor(){super(...arguments);n(this,"encoder",new $u(ws));n(this,"decoder",new Xu(ws))}}const bs=new Yu;pe(Jo,bs);const Ut=class Ut{constructor(e,o,r,s){n(this,"inputMin");n(this,"inputMax");n(this,"outputMin");n(this,"outputMax");n(this,"inputRangeInv");n(this,"outputRange");this.inputMin=e,this.inputMax=o,this.outputMin=r,this.outputMax=s,this.inputRangeInv=1/(this.inputMax-this.inputMin),this.outputRange=this.outputMax-this.outputMin}transform(e){return(e-this.inputMin)*this.inputRangeInv*this.outputRange+this.outputMin}};n(Ut,"identity",new Ut(0,1,0,1));let xe=Ut;class J extends qe{toString(){return`${Number(this)} dp`}}class Ku{constructor(e,o,r,s){n(this,"minInput");n(this,"maxInput");n(this,"minOutput");n(this,"maxOutput");n(this,"horizontalAffine");n(this,"inverseHorizontalAffine");n(this,"verticalAffine");n(this,"inverseVerticalAffine");this.minInput=e,this.maxInput=o,this.minOutput=r,this.maxOutput=s,this.horizontalAffine=new xe(Number(e.lat),Number(o.lat),Number(r.lat),Number(s.lat)),this.inverseHorizontalAffine=new xe(Number(r.lat),Number(s.lat),Number(e.lat),Number(o.lat)),this.verticalAffine=new xe(Number(e.lng),Number(o.lng),Number(r.lng),Number(s.lng)),this.inverseVerticalAffine=new xe(Number(r.lng),Number(s.lng),Number(e.lng),Number(o.lng))}project(e){return new b(new x(new J(this.horizontalAffine.transform(Number(e.lat)))),new I(new J(this.verticalAffine.transform(Number(e.lng)))))}inverseProject(e){const o=new F(this.inverseHorizontalAffine.transform(Number(e.lat))),r=new F(this.inverseVerticalAffine.transform(Number(e.lng)));return new b(new x(o),new I(r))}}class Zu{constructor(){n(this,"minInput",new b(new x(new P(-90)),new I(new P(-180))));n(this,"maxInput",new b(new x(new P(90)),new I(new P(180))));n(this,"minOutput",new b(new x(new F(-Math.PI/2)),new I(new F(-Math.PI))));n(this,"maxOutput",new b(new x(new F(Math.PI/2)),new I(new F(Math.PI))))}projectLatitude(e){return new x(this.convertDegreesToRadians(e))}convertDegreesToRadians(e){return new F(Number(e)*(Math.PI/180))}convertRadiansToDegrees(e){return new P(Number(e)*(180/Math.PI))}projectLongitude(e){return new I(this.convertDegreesToRadians(e))}inverseProjectLatitude(e){return new x(this.convertRadiansToDegrees(e))}inverseProjectLongitude(e){return new I(this.convertRadiansToDegrees(e))}project(e){return new b(this.projectLatitude(e.lat),this.projectLongitude(e.lng))}inverseProject(e){return new b(this.inverseProjectLatitude(e.lat),this.inverseProjectLongitude(e.lng))}}const Ss=new Zu,vs=85.05133,S=class S{constructor(){n(this,"minInput",S.min);n(this,"maxInput",S.max);n(this,"minOutput",S.minProjection);n(this,"maxOutput",S.maxProjection)}static projectLongitude(e){return new I(Number(e))}static ensureLatitudeBounds(e){return bt(e,S.max.lat)?S.max.lat:Oo(e,S.min.lat)?S.min.lat:e}static projectLatitude(e){return new x(Math.log(Math.tan(Math.PI/4+Number(this.ensureLatitudeBounds(e))/2)))}static inverseProjectLongitude(e){return new I(new F(Number(e)))}static inverseProjectLatitude(e){return new x(new F(2*Math.atan(Math.exp(Number(e)))-Math.PI/2))}static staticProject(e){return new b(this.projectLatitude(e.lat),this.projectLongitude(e.lng))}project(e){return S.staticProject(e)}static staticInverseProject(e){return new b(this.inverseProjectLatitude(e.lat),this.inverseProjectLongitude(e.lng))}inverseProject(e){return S.staticInverseProject(e)}};n(S,"min",Ss.project(new b(new x(new P(-vs)),new I(new P(-180))))),n(S,"max",Ss.project(new b(new x(new P(vs)),new I(new P(180))))),n(S,"minProjection",S.staticProject(S.min)),n(S,"maxProjection",S.staticProject(S.max));let Bt=S;const eh="AwABAQEcDQABDA0AAQYNAAEEDgABgAwAAQINAAEWAWEMAAF6AfgMAAH/AfIMAAH/AfwMAAH/AfgMAAH/AeAMAAF/AdAMAAF/AfAMAAF/AeAMAAF/AeAMAAE/AfAMAAEfAfAMAAEfAfwMAAE/AfwMAAF/Af4MAAF/Af8BgAsAAT8B/wHgCgABHwE/Av8BgAkAAZ8BPwL/AeAIAAEDAUwBPwL/AfAIAAEDAU8B3wL/AfgIAAEFAUMBzwL/AfoIAAEMAWMB7wL/Af0IAAEBAaMB7wP/CQABZwHPA/8BgAcAATgBoAHvA/8B4AcAARwBQAFvA/8B4AcAAYQB7gEPA/8B8AcAAQwBDgEvAv8B/gEwBgABAwGBAS8BzwHvAf8B/AEQBgABAwH4AYwBfwGDAf8B/AEYBgABCAHyAeMBHwEDAf8B/AE4BgABHgF9AS8BhgEBAf8B/AEIBgABKwHXAWwBvQGBAf8B/AEOBgABHgH/AW8B+QEBAf8B/gcAAe4B/wEHAYABQAE/AfABAAEYBQABfwH8AQcBwQHpAf8B8AHBAT4FAAH/AdgBAwHgAX8B/wHAAQMB/wGAAQABoAIAAf8BwAEBAfcBPwH/AQABAwH/AcABHQH8AgAB/gEIAQABfwGfAfYBAAEjAf8BxwH/AfgCAAH+AR8BgAFfAUcB7AEAAQMD/wHkAgABfQGfAYABDQGPAf4BAAEDAv8B/gMAATEB/wEAAQQBDwHkAQABAwL/AfgDAAEPAf8BgAEAAQEB4AEAAQEC/wHwAwABFwH/AYABAAEBAdACAAL/AfADAAEfAf8B8AIAAZACAAL/AcADAAEHAf8B/gFMBAAC/wHAAwABDwL/AV8EAAF/Af8BgAMAAT8D/wHAAwABHwH+BAABfwP/AeADAAEfAfgEAAFfA/8B8AMAAQ8B8AQABP8BgAMAAQ8B8AQAAX8C/wH8BAABDwHAAwABAwP/AfwEAAEGBAABAwF/Av8B+AkAAQMD/wHgCQABAwHvAv8B8AkAAQEC/wH+AeAKAAFnAf8B+wFACgABXwH+AbgBgAoAAQ8BogFQAQMKAAEGAQABIAEDCgABDgIAAQMDAAH8BgABDAUAAQEB/wwAAQMB/woAAQEBgQHPAf8BgAkAAQYBAQL/AYAJAAEFAdEB3wH/AYAKAALfAf8LAAI/Af8LAAF+AT8B/woAAXgB/gE/Af8BgAkAAXsB/QG/Af8BgAYAAWABAAEBAfkB/gEPAf8B+AYAATwBAAEXAf4B/QEPAv8B8AUAAXsBAAEfAfwB/gHHAv8B/gUAAZgBAAE/AZQB/gEHA/8BwAQAAZgBAAE/AQMB/wGPA/8BwAQAAeQBAAF8AesB/wFHA/8BwAQAAcABAAF/Ae8B/wFHA/8BwAYAAX8B7wH+AccD/wGABgABPwH/AfgBxwP/BwABPwH/Af0B5QL/AfwHAAE8Af8B+AHOAX8B/wHgBwABHQH/AfwB/wEfAf8BwAcAAQ8B/wH+Af8BzwHxAYAHAAEHA/8B9wHgCAABFwP/AfsBwAF8BQABgAEAAQcB/wH5Af8B+wGAAXgEAAEDAYABAAEvAf8B+AE8AfoBAAGABgABAQEfAf8B+wE+AfAIAAEPAY8C/wH+AfAGAAEGAQABOAGfA/8BYAYAAQEBAAFgAV8D/wkAAcABPwP/BwABAgEAAYABPwP/CAABAQGAAV8D/wkAAQME/wGACAABAwH7A/8BwAgAAQUBbwP/AfgIAAEBAd8D/wH+CAABBwT/Af4IAAEFBP8B8QgAAQcE/wHgCAABDwT/AcAIAAE/BP8BgAgAAX8E/wGABgABAwGAAX8E/wHABgABAwFgBf8B8AGABgABcAF/BP8B+AFABgABCAX/AfgBoAYAARsF/wH8AVgGAAEDBf8B/gEcBwAF/wHMAQQHAAHvBP8B4AEwBwABfwT/AcABcAcAAQcE/wGAAXABDwYAAQcE/wGAAeABHwHABQABAwP/Ab4BAAEYAR8BwAUAAQMD/wGAAQEBKAE/AcAFAAEPA/8BgAEFARIBfwGABQABBwP/AeACAAF/AYAGAAP/AwABfwGABgAC/wH+ARABAAEQAf8BgAYAAv8B/gMAAf8BgAYAAf8B/gH8ATABAAEIAf8BwAUAAWIB/wH8AfABIAEAAQwBPwHgBQABawH/AfABAgGAAQABDgH/AfAFAAFDAf8B8AECAgABDAF/AfAFAAEBAf8B8AMAAQQBHwH2BQABIQH/AfADAAECAQ8B8AYAAf8B8AQAAQcBwAYAAf8B8AwAAf8B4wGACwAB/wHHAYALAAE/Ae8DAAECCAABPwGQDAABPwHgDAABfwHgBQABAQYAAV8B4AUAAQMGAAE/AcAFAAEGBgABPwHABQABHAYAAT4BgAgA";function th(t){const e=new DataView(t),o=new Array(t.byteLength*8),r=t.byteLength;for(let s=0;s<r;s++){const a=e.getUint8(s);for(let d=0;d<8;d++){const l=7-d,m=s;o[m*8+d]=!!(a&1<<l)}}return o}function oh(t){const e=new DataView(t),o=t.byteLength;let r=0;for(let d=0;d<o;d+=2)r+=e.getUint8(d);const s=new ArrayBuffer(r),a=new DataView(s);for(let d=0,l=0;d<o;d+=2){const m=e.getUint8(d),w=e.getUint8(d+1);for(let N=0;N<m;N++)a.setUint8(l++,w)}return s}const Et=new J(12*7*16),nh=new J(Math.floor(Number(Et)*.75)),$e=new J(9),rh=Et,sh=Et;new Ku(Bt.minProjection,Bt.maxProjection,new b(new x(sh),new I(new J(0))),new b(new x(new J(0)),new I(rh)));const ch=Et,ah=nh,Bs=new J(Math.floor(Number($e)/2)),ih=Math.floor(Number(ch)/Number($e)),dh=Math.floor(Number(ah)/Number($e)),lh=Array.from(_(Sr(dh),t=>new x(new J(t*Number($e)+Number(Bs))))),uh=Array.from(_(Sr(ih),t=>new I(new J(t*Number($e)+Number(Bs))))),Es=Array.from(br(uh,t=>_(lh,e=>new b(e,t))));Math.ceil(Es.length/8);const hh=So.decodeString(eh),wh=oh(hh),fh=th(wh),mh=Br(Es,fh,(t,e)=>[t,e]),ph=Bo(mh,([,t])=>t),gh=_(ph,([t])=>t);Array.from(gh);class Go{constructor(e,o){n(this,"width");n(this,"index");this.width=e,this.index=o}toJSON(){return Qo.encode(this)}}class Ah{convert(e){return i(e,"width","index"),new Go(u.decode(e.width),u.decode(e.index))}}class yh{convert(e){return p(e,Go),{width:u.encode(e.width),index:u.encode(e.index)}}}class Ch extends c{constructor(){super(...arguments);n(this,"encoder",new yh);n(this,"decoder",new Ah)}}const Qo=new Ch;class Ie{static get lsb0(){return Sh}static get msb0(){return Bh}valueOf(){return this.toString()}toJSON(){return this.toString()}}const ks="bitvec::order::Lsb0",xs="bitvec::order::Msb0";class bh extends Ie{toString(){return ks}}const Sh=new bh;class vh extends Ie{toString(){return xs}}const Bh=new vh;class Eh{convert(e){if(typeof e!="string")throw new f(typeof e,"string");switch(e){case ks:return Ie.lsb0;case xs:return Ie.msb0;default:throw new f(e,"CappuccinoAPIBitVecOrder")}}}class kh{convert(e){return e.toString()}}class xh extends c{constructor(){super(...arguments);n(this,"encoder",new kh);n(this,"decoder",new Eh)}}const Is=new xh;class zo{constructor(e,o,r,s){n(this,"order");n(this,"head");n(this,"bits");n(this,"data");this.order=e,this.head=o,this.bits=r,this.data=s}getBitVecIndexIterable(){return this.order===Ie.lsb0?new Oh(this.head.width,this.bits):new Mh(this.head.width,this.bits)}[Symbol.iterator](){const e=this.getBitVecIndexIterable();return _(e,o=>Dh(this.data,o))[Symbol.iterator]()}toJSON(){return ge.encode(this)}}class Ih{convert(e){return i(e,"order","head","bits","data"),new zo(Is.decode(e.order),Qo.decode(e.head),u.decode(e.bits),de.decode(e.data))}}class Nh{convert(e){return p(e,zo),{order:Is.encode(e.order),head:Qo.encode(e.head),bits:u.encode(e.bits),data:de.encode(e.data)}}}class Rh extends c{constructor(){super(...arguments);n(this,"encoder",new Nh);n(this,"decoder",new Ih)}}const ge=new Rh,Ns=new E(new v(ge),new B(ge));function Dh(t,e){return(t[e.bucket]>>e.bitOffset&1)===1}class Rs{constructor(e,o){n(this,"bucket");n(this,"bitOffset");this.bucket=e,this.bitOffset=o}}function Ds(t){switch(R(t===8||t===16||t===32,"bit width should be a power of two that is supported"),t){case 8:return 3;case 16:return 4;case 32:return 5;default:throw new H}}class Ph{constructor(e,o){n(this,"totalBits");n(this,"bitWidthMask");n(this,"bitWidthShift");n(this,"offset",0);this.totalBits=o;const r=Ds(e);this.bitWidthMask=e-1,this.bitWidthShift=r}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,o=this.offset&this.bitWidthMask;return this.offset+=1,{done:!1,value:new Rs(e,o)}}}class Oh{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");this.bitWidth=e,this.totalBits=o}[Symbol.iterator](){return new Ph(this.bitWidth,this.totalBits)}}class Th{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");n(this,"bitWidthMask");n(this,"bitWidthShift");n(this,"offset",0);this.bitWidth=e,this.totalBits=o;const r=Ds(e);this.bitWidthMask=e-1,this.bitWidthShift=r}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,o=this.bitWidth-1-(this.offset&this.bitWidthMask);return this.offset+=1,{done:!1,value:new Rs(e,o)}}}class Mh{constructor(e,o){n(this,"bitWidth");n(this,"totalBits");this.bitWidth=e,this.totalBits=o}[Symbol.iterator](){return new Th(this.bitWidth,this.totalBits)}}class Ps{constructor(e,o,r){n(this,"r");n(this,"s");n(this,"v");this.r=e,this.s=o,this.v=r}toJSON(){return jo.encode(this)}}class Lh{convert(e){return i(e,"r","s","v"),new Ps(M.decode(e.r),M.decode(e.s),u.decode(e.v))}}class Hh{convert(e){return p(e,Ps),{r:M.encode(e.r),s:M.encode(e.s),v:u.encode(e.v)}}}class Vh extends c{constructor(){super(...arguments);n(this,"encoder",new Hh);n(this,"decoder",new Lh)}}const jo=new Vh;class Os{constructor(e,o){n(this,"account");n(this,"amount");this.account=e,this.amount=o}toJSON(){return qo.encode(this)}}class Uh{convert(e){return i(e,"account","amount"),new Os(M.decode(e.account),M.decode(e.amount))}}class Wh{convert(e){return p(e,Os),{account:M.encode(e.account),amount:M.encode(e.amount)}}}class Fh extends c{constructor(){super(...arguments);n(this,"encoder",new Wh);n(this,"decoder",new Uh)}}const qo=new Fh;class Ts{constructor(e,o,r){n(this,"number");n(this,"timestamp");n(this,"hash");this.number=e,this.timestamp=o,this.hash=r}toJSON(){return _o.encode(this)}}class Jh{convert(e){return i(e,"number","timestamp","hash"),new Ts(u.decode(e.number),h.decode(e.timestamp),h.decode(e.hash))}}class Gh{convert(e){return p(e,Ts),{number:u.encode(e.number),timestamp:h.encode(e.timestamp),hash:h.encode(e.hash)}}}class Qh extends c{constructor(){super(...arguments);n(this,"encoder",new Gh);n(this,"decoder",new Jh)}}const _o=new Qh,Ms=new q(new z(_o),new j(_o));class Ls{constructor(e){n(this,"bytes");this.bytes=e}toJSON(){return $o.encode(this)}}class zh{convert(e){return i(e,"bytes"),new Ls(Ir.decode(e.bytes))}}class jh{convert(e){return p(e,Ls),{bytes:Ir.encode(e.bytes)}}}class qh extends c{constructor(){super(...arguments);n(this,"encoder",new jh);n(this,"decoder",new zh)}}const $o=new qh;class Hs{constructor(e,o,r,s,a,d,l,m,w,N){n(this,"height");n(this,"timestamp");n(this,"l1_head");n(this,"l1_finalized");n(this,"payload_commitment");n(this,"ns_table");n(this,"block_merkle_root");n(this,"fee_merkle_root");n(this,"builder_signature");n(this,"fee_info");this.height=e,this.timestamp=o,this.l1_head=r,this.l1_finalized=s,this.payload_commitment=a,this.ns_table=d,this.block_merkle_root=l,this.fee_merkle_root=m,this.builder_signature=w,this.fee_info=N}toJSON(){return Xe.encode(this)}}class _h{convert(e){return i(e,"height","timestamp","l1_head","l1_finalized","payload_commitment","ns_table","block_merkle_root","fee_merkle_root","builder_signature","fee_info"),new Hs(u.decode(e.height),u.decode(e.timestamp),u.decode(e.l1_head),Ms.decode(e.l1_finalized),de.decode(e.payload_commitment),$o.decode(e.ns_table),g.decode(e.block_merkle_root),g.decode(e.fee_merkle_root),jo.decode(e.builder_signature),qo.decode(e.fee_info))}}class $h{convert(e){return p(e,Hs),{height:u.encode(e.height),timestamp:u.encode(e.timestamp),l1_head:u.encode(e.l1_head),l1_finalized:Ms.encode(e.l1_finalized),payload_commitment:de.encode(e.payload_commitment),ns_table:$o.encode(e.ns_table),block_merkle_root:g.encode(e.block_merkle_root),fee_merkle_root:g.encode(e.fee_merkle_root),builder_signature:jo.encode(e.builder_signature),fee_info:qo.encode(e.fee_info)}}}class Xh extends c{constructor(){super(...arguments);n(this,"encoder",new $h);n(this,"decoder",new _h)}}const Xe=new Xh;class Vs{constructor(e,o){n(this,"vm");n(this,"payload");this.vm=e,this.payload=o}toJSON(){return Ye.encode(this)}}class Yh{convert(e){return i(e,"vm","payload"),new Vs(u.decode(e.vm),de.decode(e.payload))}}class Kh{convert(e){return p(e,Vs),{vm:u.encode(e.vm),payload:de.encode(e.payload)}}}class Zh extends c{constructor(){super(...arguments);n(this,"encoder",new Kh);n(this,"decoder",new Yh)}}const Ye=new Zh;new E(new v(Ye),new B(Ye));class Us{constructor(e,o,r,s,a){n(this,"header");n(this,"hash");n(this,"size");n(this,"num_transactions");n(this,"proposer_id");this.header=e,this.hash=o,this.size=r,this.num_transactions=s,this.proposer_id=a}toJSON(){return Xo.encode(this)}}class ew{convert(e){return i(e,"header","hash","size","num_transactions","proposer_id"),new Us(Xe.decode(e.header),g.decode(e.hash),u.decode(e.size),u.decode(e.num_transactions),oe.decode(e.proposer_id))}}class tw{convert(e){return p(e,Us),{header:Xe.encode(e.header),hash:g.encode(e.hash),size:u.encode(e.size),num_transactions:u.encode(e.num_transactions),proposer_id:oe.encode(e.proposer_id)}}}class ow extends c{constructor(){super(...arguments);n(this,"encoder",new tw);n(this,"decoder",new ew)}}const Xo=new ow;new E(new v(Xo),new B(Xo));class Ws{constructor(e,o,r,s){n(this,"hash");n(this,"header");n(this,"offset");n(this,"transaction");this.hash=e,this.header=o,this.offset=r,this.transaction=s}toJSON(){return Yo.encode(this)}}class nw{convert(e){return i(e,"hash","header","offset","transaction"),new Ws(g.decode(e.hash),Xe.decode(e.header),u.decode(e.offset),Ye.decode(e.transaction))}}class rw{convert(e){return p(e,Ws),{hash:g.encode(e.hash),header:Xe.encode(e.header),offset:u.encode(e.offset),transaction:Ye.encode(e.transaction)}}}class sw extends c{constructor(){super(...arguments);n(this,"encoder",new rw);n(this,"decoder",new nw)}}const Yo=new sw;new E(new v(Yo),new B(Yo));class Fs{constructor(e,o){n(this,"signature");n(this,"bitvec");this.signature=e,this.bitvec=o}toJSON(){return Ko.encode(this)}}class cw{convert(e){if(!Vn(e)||e.length!==2)throw new f(typeof e,"Array");return new Fs(g.decode(e[0]),ge.decode(e[1]))}}class aw{convert(e){return p(e,Fs),[g.encode(e.signature),ge.encode(e.bitvec)]}}class iw extends c{constructor(){super(...arguments);n(this,"encoder",new aw);n(this,"decoder",new cw)}}const Ko=new iw;new q(new z(Ko),new j(Ko));class Ke{}class Zo extends Ke{toJSON(){return en.encode(this)}}class dw{convert(e){if(!K(e)||e!=="Empty")throw new ee;return new Zo}}class lw{convert(e){return p(e,Zo),"Empty"}}class uw extends c{constructor(){super(...arguments);n(this,"encoder",new lw);n(this,"decoder",new dw)}}const en=new uw;class tn extends Ke{constructor(o,r,s){super();n(this,"value");n(this,"pos");n(this,"elem");this.value=o,this.pos=r,this.elem=s}toJSON(){return on.encode(this)}}class hw{convert(e){i(e,"Leaf");const o=e.Leaf;return i(o,"value","pos","elem"),new tn(g.decode(o.value),g.decode(o.pos),g.decode(o.elem))}}class ww{convert(e){return p(e,tn),{Leaf:{value:g.encode(e.value),pos:g.encode(e.pos),elem:g.encode(e.elem)}}}}class fw extends ce{constructor(){super(...arguments);n(this,"encoder",new ww);n(this,"decoder",new hw)}}const on=new fw;class nn extends Ke{constructor(o){super();n(this,"value");this.value=o}toJSON(){return rn.encode(this)}}class mw{convert(e){i(e,"ForgettenSubtree");const o=e.ForgettenSubtree;return i(o,"value"),new nn(g.decode(o.value))}}class pw{convert(e){return p(e,nn),{ForgettenSubtree:{value:g.encode(e.value)}}}}class gw extends ce{constructor(){super(...arguments);n(this,"encoder",new pw);n(this,"decoder",new mw)}}const rn=new gw;class sn extends Ke{constructor(o,r){super();n(this,"value");n(this,"children");this.value=o,this.children=r}toJSON(){return cn.encode(this)}}class Aw{convert(e){i(e,"Branch");const o=e.Branch;return i(o,"value","children"),new sn(g.decode(o.value),Gs.decode(o.children))}}class yw{convert(e){return p(e,sn),{Branch:{value:g.encode(e.value),children:Gs.encode(e.children)}}}}class Cw extends c{constructor(){super(...arguments);n(this,"encoder",new yw);n(this,"decoder",new Aw)}}const cn=new Cw;class bw{convert(e){if(Jt(e,"Leaf",rt))return on.decoder.convert(e);if(Jt(e,"Branch",rt))return cn.decoder.convert(e);if(Jt(e,"ForgettenSubtree",rt))return rn.decoder.convert(e);if(K(e))return en.decoder.convert(e);throw new ee}}class Sw{convert(e){if(p(e,Ke),e instanceof tn)return on.encode(e);if(e instanceof sn)return cn.encode(e);if(e instanceof nn)return rn.encode(e);if(e instanceof Zo)return en.encode(e);throw new ee}}class vw extends c{constructor(){super(...arguments);n(this,"encoder",new Sw);n(this,"decoder",new bw)}}const Js=new vw,Gs=new E(new v(Js),new B(Js));class an{constructor(e,o,r,s,a,d,l,m){n(this,"hash");n(this,"height");n(this,"time");n(this,"numTransactions");n(this,"proposerID");n(this,"feeRecipient");n(this,"size");n(this,"blockReward");this.hash=e,this.height=o,this.time=r,this.numTransactions=s,this.proposerID=a,this.feeRecipient=d,this.size=l,this.blockReward=m}toJSON(){return Ze.encode(this)}}class Bw{convert(e){return i(e,"hash","height","time","num_transactions","proposer_id","fee_recipient","size","block_reward"),new an(g.decode(e.hash),u.decode(e.height),ve.decode(e.time),u.decode(e.num_transactions),oe.decode(e.proposer_id),oe.decode(e.fee_recipient),u.decode(e.size),jr.decode(e.block_reward))}}class Ew{convert(e){return p(e,an),{hash:g.encode(e.hash),height:u.encode(e.height),time:ve.encode(e.time),num_transactions:u.encode(e.numTransactions),proposer_id:oe.encode(e.proposerID),fee_recipient:oe.encode(e.feeRecipient),size:u.encode(e.size),block_reward:jr.encode(e.blockReward)}}}class kw extends ce{constructor(){super(...arguments);n(this,"encoder",new Ew);n(this,"decoder",new Bw)}}const Ze=new kw,Qs=new E(new v(Ze),new B(Ze));class zs{constructor(e,o,r,s,a,d){n(this,"hash");n(this,"height");n(this,"proposerID");n(this,"numTransactions");n(this,"size");n(this,"time");this.hash=e,this.height=o,this.proposerID=r,this.numTransactions=s,this.size=a,this.time=d}toJSON(){return dn.encode(this)}}class xw{convert(e){return i(e,"hash","height","proposer_id","num_transactions","size","time"),new zs(g.decode(e.hash),u.decode(e.height),oe.decode(e.proposer_id),u.decode(e.num_transactions),u.decode(e.size),ve.decode(e.time))}}class Iw{convert(e){return p(e,zs),{hash:g.encode(e.hash),height:u.encode(e.height),proposer_id:oe.encode(e.proposerID),num_transactions:u.encode(e.numTransactions),size:u.encode(e.size),time:ve.encode(e.time)}}}class Nw extends ce{constructor(){super(...arguments);n(this,"encoder",new Iw);n(this,"decoder",new xw)}}const dn=new Nw;new E(new v(dn),new B(dn));function Rw(t,e){return t.blockHeights-e.blockHeights}class kt{constructor(e,o,r,s){n(this,"blockTime");n(this,"blockSize");n(this,"blockTransactions");n(this,"blockHeights");const a=[],d=Math.min(e.length,o.length,r.length,s.length);for(let O=0;O<d;O++){const D=s[O];D!==null&&a.push({blockTime:e[O],blockSize:o[O],blockTransactions:r[O],blockHeights:D})}a.sort(Rw);const l=a[0].blockHeights,m=a[a.length-1].blockHeights,w=[],N=[],V=[],re=[];for(let O=l,D=0;O<=m;O++){const G=a[D];if(G.blockHeights!==O){w.push(null),N.push(null),V.push(null),re.push(null);continue}w.push(G.blockTime),N.push(G.blockSize),V.push(G.blockTransactions),re.push(G.blockHeights),D++}const Y=Math.max(0,re.length-50);this.blockTime=w.slice(Y),this.blockSize=N.slice(Y),this.blockTransactions=V.slice(Y),this.blockHeights=re.slice(Y)}toJSON(){return ln.encode(this)}}class Dw{convert(e){return i(e,"block_time","block_size","block_transactions","block_heights"),new kt(Z.decode(e.block_time),Z.decode(e.block_size),Z.decode(e.block_transactions),Z.decode(e.block_heights))}}class Pw{convert(e){return p(e,kt),{block_time:Z.encode(e.blockTime),block_size:Z.encode(e.blockSize),block_transactions:Z.encode(e.blockTransactions),block_heights:Z.encode(e.blockHeights)}}}class Ow extends c{constructor(){super(...arguments);n(this,"encoder",new Pw);n(this,"decoder",new Dw)}}const ln=new Ow,js=de;class qs{constructor(e,o,r,s,a,d){n(this,"hash");n(this,"rollups");n(this,"height");n(this,"time");n(this,"offset");n(this,"numTransactions");this.hash=e,this.rollups=o,this.height=r,this.time=s,this.offset=a,this.numTransactions=d}toJSON(){return un.encode(this)}}class Tw{convert(e){return i(e,"hash","rollups","height","time","offset","num_transactions"),new qs(g.decode(e.hash),js.decode(e.rollups),u.decode(e.height),ve.decode(e.time),u.decode(e.offset),u.decode(e.num_transactions))}}class Mw{convert(e){return p(e,qs),{hash:g.encode(e.hash),rollups:js.encode(e.rollups),height:u.encode(e.height),time:ve.encode(e.time),offset:u.encode(e.offset),num_transactions:u.encode(e.numTransactions)}}}class Lw extends c{constructor(){super(...arguments);n(this,"encoder",new Mw);n(this,"decoder",new Tw)}}const un=new Lw;new E(new v(un),new B(un));const _s=u;class $s{constructor(e,o){n(this,"namespace");n(this,"payload");this.namespace=e,this.payload=o}toJSON(){return hn.encode(this)}}class Hw{convert(e){return i(e,"namespace","payload"),new $s(_s.decode(e.namespace),Nr.decode(e.payload))}}class Vw{convert(e){return p(e,$s),{namespace:_s.encode(e.namespace),payload:Nr.encode(e.payload)}}}class Uw extends c{constructor(){super(...arguments);n(this,"encoder",new Vw);n(this,"decoder",new Hw)}}const hn=new Uw;new E(new v(hn),new B(hn));class Xs{constructor(e,o){n(this,"coords");n(this,"country");this.coords=e,this.country=o}toJSON(){return wn.encode(this)}}class Ww{convert(e){return{coords:hs.encode(e.coords),country:L.encode(e.country)}}}class Fw{convert(e){return i(e,"coords","country"),new Xs(hs.decode(e.coords),be(L.decode(e.country)))}}class Jw extends c{constructor(){super(...arguments);n(this,"encoder",new Ww);n(this,"decoder",new Fw)}}const wn=new Jw,Ys=new q(new z(wn),new j(wn));class Ks{constructor(e,o,r,s,a,d,l,m,w){n(this,"publicKey");n(this,"name");n(this,"publicURL");n(this,"company");n(this,"companyWebsite");n(this,"location");n(this,"operatingSystem");n(this,"nodeType");n(this,"networkType");this.publicKey=e,this.name=o,this.publicURL=r,this.company=s,this.companyWebsite=a,this.location=d,this.operatingSystem=l,this.nodeType=m,this.networkType=w}toJSON(){return et.encode(this)}}class Gw{convert(e){return{public_key:g.encode(e.publicKey),name:L.encode(e.name),public_url:ft.encode(e.publicURL),company:L.encode(e.company),company_website:ft.encode(e.companyWebsite),location:Ys.encode(e.location),operating_system:L.encode(e.operatingSystem),node_type:L.encode(e.nodeType),network_type:L.encode(e.networkType)}}}class Qw{convert(e){return i(e,"public_key","name","public_url","company","company_website","location","operating_system","node_type","network_type"),new Ks(g.decode(e.public_key),be(L.decode(e.name)),ft.decode(e.public_url),be(L.decode(e.company)),ft.decode(e.company_website),Ys.decode(e.location),be(L.decode(e.operating_system)),be(L.decode(e.node_type)),be(L.decode(e.network_type)))}}class zw extends c{constructor(){super(...arguments);n(this,"encoder",new Gw);n(this,"decoder",new Qw)}}const et=new zw,Zs=new E(new v(et),new B(et));class Ae{}const ec="SubscribeNodeIdentity";class fn extends Ae{valueOf(){return ec}}const tc="SubscribeLatestBlock";class mn extends Ae{valueOf(){return tc}}const oc="SubscribeVoters";class pn extends Ae{valueOf(){return oc}}const nc="RequestNodeIdentitySnapshot";class gn extends Ae{valueOf(){return nc}}const rc="RequestBlocksSnapshot";class An extends Ae{valueOf(){return rc}}const sc="RequestHistogramSnapshot";class yn extends Ae{valueOf(){return sc}}const cc="RequestVotersSnapshot";class Cn extends Ae{valueOf(){return cc}}class jw{convert(e){return e.valueOf()}}class qw{convert(e){if(typeof e!="string")throw new f(typeof e,"string");switch(e){case ec:return new fn;case tc:return new mn;case oc:return new pn;case nc:return new gn;case rc:return new An;case sc:return new yn;case cc:return new Cn;default:throw new f(e,"CappuccinoNodeValidatorRequest")}}}class _w extends c{constructor(){super(...arguments);n(this,"encoder",new jw);n(this,"decoder",new qw)}}const bn=new _w,tt="NodeValidatorRequest";class xt extends Dr{constructor(o){super();n(this,"request");this.request=o}get type(){return tt}toJson(){return ac.encode(this)}}class $w{convert(e){return{[tt]:bn.encode(e.request)}}}class Xw{convert(e){return i(e,tt),new xt(bn.decode(e[tt]))}}class Yw extends c{constructor(){super(...arguments);n(this,"encoder",new $w);n(this,"decoder",new Xw)}}const ac=new Yw;class ye{}const It="BlocksSnapshot";class Sn extends ye{constructor(o){super();n(this,"blocks");this.blocks=o}toJSON(){return vn.encode(this)}}class Kw{convert(e){i(e,It);const o=e[It];return new Sn(Qs.decode(o))}}class Zw{convert(e){return{[It]:Qs.encode(e.blocks)}}}class ef extends c{constructor(){super(...arguments);n(this,"encoder",new Zw);n(this,"decoder",new Kw)}}const vn=new ef,Nt="HistogramSnapshot";class Rt extends ye{constructor(o){super();n(this,"histograms");this.histograms=o}toJSON(){return Bn.encode(this)}}class tf{convert(e){return i(e,Nt),new Rt(ln.decode(e[Nt]))}}class of{convert(e){return{[Nt]:ln.encode(e.histograms)}}}class nf extends c{constructor(){super(...arguments);n(this,"encoder",new of);n(this,"decoder",new tf)}}const Bn=new nf,Dt="LatestBlock";class Pt extends ye{constructor(o){super();n(this,"latestBlock");this.latestBlock=o}toJSON(){return En.encode(this)}}class rf{convert(e){return i(e,Dt),new Pt(Ze.decode(e[Dt]))}}class sf{convert(e){return{[Dt]:Ze.encode(e.latestBlock)}}}class cf extends c{constructor(){super(...arguments);n(this,"encoder",new sf);n(this,"decoder",new rf)}}const En=new cf,Ot="LatestVoters";class kn extends ye{constructor(o){super();n(this,"latestVoter");this.latestVoter=o}toJSON(){return xn.encode(this)}}class af{convert(e){return i(e,Ot),new kn(ge.decode(e[Ot]))}}class df{convert(e){return{[Ot]:ge.encode(e.latestVoter)}}}class lf extends c{constructor(){super(...arguments);n(this,"encoder",new df);n(this,"decoder",new af)}}const xn=new lf,Tt="NodeIdentitySnapshot";class Mt extends ye{constructor(o){super();n(this,"nodes");this.nodes=o}toJSON(){return In.encode(this)}}class uf{convert(e){i(e,Tt);const o=e[Tt];return new Mt(Zs.decode(o))}}class hf{convert(e){return{[Tt]:Zs.encode(e.nodes)}}}class wf extends c{constructor(){super(...arguments);n(this,"encoder",new hf);n(this,"decoder",new uf)}}const In=new wf,Lt="LatestNodeIdentity";class ic extends ye{constructor(o){super();n(this,"nodeIdentity");this.nodeIdentity=o}toJSON(){return Nn.encode(this)}}class ff{convert(e){return i(e,Lt),new ic(et.decode(e[Lt]))}}class mf{convert(e){return{[Lt]:et.encode(e.nodeIdentity)}}}class pf extends c{constructor(){super(...arguments);n(this,"encoder",new mf);n(this,"decoder",new ff)}}const Nn=new pf,Ht="VotersSnapshot";class Rn extends ye{constructor(o){super();n(this,"voters");this.voters=o}toJSON(){return Dn.encode(this)}}class gf{convert(e){i(e,Ht);const o=e[Ht];return new Rn(Ns.decode(o))}}class Af{convert(e){return{[Ht]:Ns.encode(e.voters)}}}class yf extends c{constructor(){super(...arguments);n(this,"encoder",new Af);n(this,"decoder",new gf)}}const Dn=new yf;class Cf{convert(e){if(ae(e,It))return vn.decode(e);if(ae(e,Nt))return Bn.decode(e);if(ae(e,Dt))return En.decode(e);if(ae(e,Lt))return Nn.decode(e);if(ae(e,Ot))return xn.decode(e);if(ae(e,Tt))return In.decode(e);if(ae(e,Ht))return Dn.decode(e);throw new H}}class bf{convert(e){if(e instanceof Sn)return vn.encode(e);if(e instanceof Rt)return Bn.encode(e);if(e instanceof Pt)return En.encode(e);if(e instanceof ic)return Nn.encode(e);if(e instanceof kn)return xn.encode(e);if(e instanceof Mt)return In.encode(e);if(e instanceof Rn)return Dn.encode(e);throw new H}}class Sf extends c{constructor(){super(...arguments);n(this,"encoder",new bf);n(this,"decoder",new Cf)}}const Vt=new Sf,ot="NodeValidatorResponse";class dc extends ko{constructor(o){super();n(this,"response");this.response=o}get type(){return ot}toJson(){return lc.encode(this)}}class vf{convert(e){return{[ot]:Vt.encode(e.response)}}}class Bf{convert(e){i(e,ot);const o=e[ot];return new dc(Vt.decode(o))}}class Ef extends c{constructor(){super(...arguments);n(this,"encoder",new vf);n(this,"decoder",new Bf)}}const lc=new Ef;class kf{convert(e){return new dc(e)}}const Pn=new kf;function On(t){return new an(t.hash,t.height,t.time,t.numTransactions,t.proposer,t.proposer,t.size,t.fees)}function uc(t){return new Ks(t.pubkey,t.name,null,t.company.name,new URL(t.company.website),new Xs(new b(new x(new P(t.location.coords[0])),new I(new P(t.location.coords[1]))),t.location.country),t.operatingSystem,t.nodeType,t.networkType)}class xf{constructor(e,o){n(this,"responseStream");n(this,"requestStream");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");n(this,"prng",new fe(Xl()));n(this,"latestBlock",On(Zr()));n(this,"latestBlocks",le(50));n(this,"latestVoters",le(50));n(this,"histogramBlockTimeData",le(50));n(this,"histogramBlockSizeData",le(50));n(this,"histogramBlockTransactionData",le(50));n(this,"histogramBlockHeightData",le(50));n(this,"isConnected",!1);n(this,"isSubscribedToLatestBlock",!1);n(this,"isSubscribedToVoters",!1);this.requestStream=e,this.responseStream=o,this.lifecycleResponseSink=we(ue(o),Do),this.nodeValidatorResponseSink=we(ue(o),Pn)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}generateVotersFromBlockDetail(e){const o=new fe(e.time.valueOf()),r=je.length,s=Math.ceil(r/16),a=new Uint16Array(o.fillBytes(s*2));return new zo(Ie.lsb0,new Go(16,0),r,Array.from(a))}async updateBlockDetails(e){const o=this.latestBlock,r=(e.time.valueOf()-o.time.valueOf())/1e3,s=this.generateVotersFromBlockDetail(e);this.latestBlock=e,this.latestBlocks.put(e),this.latestVoters.put(s),this.histogramBlockTimeData.put(r),this.histogramBlockSizeData.put(e.size),this.histogramBlockTransactionData.put(e.numTransactions),this.histogramBlockHeightData.put(e.height),this.isConnected&&(this.isSubscribedToLatestBlock&&await this.nodeValidatorResponseSink.send(new Pt(e)),this.isSubscribedToVoters&&this.nodeValidatorResponseSink.send(new kn(s)))}async initializeState(){for await(const e of Zl(this.prng))this.updateBlockDetails(On(e));await this.nodeValidatorResponseSink.send(new Pt(this.latestBlock)),await this.nodeValidatorResponseSink.send(new Rt(new kt(Array.from(this.histogramBlockTimeData.immutableIterable()),Array.from(this.histogramBlockSizeData.immutableIterable()),Array.from(this.histogramBlockTransactionData.immutableIterable()),Array.from(this.histogramBlockHeightData.immutableIterable())))),this.nodeValidatorResponseSink.send(new Mt(je.map(uc)))}async startProcessing(){await this.initializeState(),this.handleRequests(),this.streamBlocks()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async streamBlocks(){const e=this.latestBlock;for await(const o of eu(this.prng,e.time.valueOf(),e.height)){const r=On(o);this.updateBlockDetails(r)}}async handleRequest(e){if(e instanceof mt){try{await this.handleWebSocketCommand(e.command)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof xt){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unrecognized request type",e)}async handleWebSocketCommand(e){if(e instanceof He){await this.handleConnect();return}if(e instanceof Me){await this.handleClose();return}}async handleNodeValidatorRequest(e){if(e instanceof mn){await this.handleSubscribeLatestBlock();return}if(e instanceof fn){await this.handleSubscribeNodeIdentity();return}if(e instanceof pn){await this.handleSubscribeVoters();return}if(e instanceof An){await this.handleRequestBlocksSnapshot();return}if(e instanceof yn){await this.handleRequestHistogramSnapshot();return}if(e instanceof gn){await this.handleRequestNodeIdentitySnapshot();return}if(e instanceof Cn){await this.handleRequestVotersSnapshot();return}}async handleConnect(){if(this.isConnected)throw new Error("already connected to WebSocket");this.isConnected=!0,await this.lifecycleResponseSink.send(new Je),await this.lifecycleResponseSink.send(new Qe)}async handleClose(){if(!this.isConnected)throw new Error("not connected to WebSocket");this.isConnected=!1,this.isSubscribedToLatestBlock=!1,this.isSubscribedToVoters=!1,await this.lifecycleResponseSink.send(new Be)}async assertIsConnected(){if(!this.isConnected)throw new Error("not connected to WebSocket")}async handleSubscribeLatestBlock(){await this.assertIsConnected(),this.isSubscribedToLatestBlock=!0}async handleSubscribeNodeIdentity(){await this.assertIsConnected()}async handleSubscribeVoters(){await this.assertIsConnected(),this.isSubscribedToVoters=!0}async handleRequestBlocksSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Sn(Array.from(this.latestBlocks.immutableIterable())))}async handleRequestHistogramSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Rt(new kt(Array.from(this.histogramBlockTimeData.immutableIterable()),Array.from(this.histogramBlockSizeData.immutableIterable()),Array.from(this.histogramBlockTransactionData.immutableIterable()),Array.from(this.histogramBlockHeightData.immutableIterable()))))}async handleRequestNodeIdentitySnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Mt(je.map(uc)))}async handleRequestVotersSnapshot(){await this.assertIsConnected(),await this.nodeValidatorResponseSink.send(new Rn(Array.from(this.latestVoters.immutableIterable())))}}class If{constructor(e,o,r){n(this,"responseStream");n(this,"requestStream");n(this,"capturedHAR");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");this.requestStream=e,this.responseStream=o,this.capturedHAR=r,this.lifecycleResponseSink=we(ue(o),Do),this.nodeValidatorResponseSink=we(ue(o),Pn)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async startProcessing(){this.handleRequests()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async handleRequest(e){if(e instanceof mt){try{await this.handleWebSocketCommand(e.command)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof xt){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unknown request type",e)}async handleWebSocketCommand(e){if(e instanceof He){await this.handleConnect();return}if(e instanceof Me){await this.handleClose();return}}async handleNodeValidatorRequest(e){if(e instanceof mn){await this.handleSubscribeLatestBlock();return}if(e instanceof fn){await this.handleSubscribeNodeIdentity();return}if(e instanceof pn){await this.handleSubscribeVoters();return}if(e instanceof An){await this.handleRequestBlocksSnapshot();return}if(e instanceof yn){await this.handleRequestHistogramSnapshot();return}if(e instanceof gn){await this.handleRequestNodeIdentitySnapshot();return}if(e instanceof Cn){await this.handleRequestVotersSnapshot();return}}async handleConnect(){await this.lifecycleResponseSink.send(new Je),await this.lifecycleResponseSink.send(new Qe);const e=br(this.capturedHAR.log.entries,s=>"_webSocketMessages"in s?s._webSocketMessages:[]),o=Bo(e,s=>s.type==="receive");let r=0;for(const s of o){if(r>0){const a=s.time*1e3-r*1e3;await Fr(a)}r=s.time;try{const a=Vt.decode(JSON.parse(s.data));await this.nodeValidatorResponseSink.send(a)}catch{console.error(`Failed to decode message: ${s.data}`);continue}}await this.lifecycleResponseSink.send(new Be)}async handleClose(){}async handleSubscribeLatestBlock(){}async handleSubscribeNodeIdentity(){}async handleSubscribeVoters(){}async handleRequestBlocksSnapshot(){}async handleRequestHistogramSnapshot(){}async handleRequestNodeIdentitySnapshot(){}async handleRequestVotersSnapshot(){}}const Tn="WebSocketError";class nt extends C{constructor(o,r=`websocket error: ${String(o)}`){super(r);n(this,"cause");this.cause=o,Object.freeze(this)}get code(){return Tn}}class Nf{convert(e){return i(e,"code","message"),A(e,Tn),new nt({},h.decode(e.message))}}class Rf extends T{}class Df extends c{constructor(){super(...arguments);n(this,"encoder",new Rf);n(this,"decoder",new Nf)}}const Pf=new Df;y(Tn,Pf);class Of{constructor(e,o,r){n(this,"responseStream");n(this,"requestStream");n(this,"serviceBaseURL");n(this,"lifecycleResponseSink");n(this,"nodeValidatorResponseSink");n(this,"errorResponseSink");n(this,"webSocket",null);this.requestStream=e,this.responseStream=o,this.serviceBaseURL=r,this.lifecycleResponseSink=we(ue(o),Do),this.nodeValidatorResponseSink=we(ue(o),Pn),this.errorResponseSink=we(ue(o),nl)}get stream(){return this.responseStream}async send(e){await this.requestStream.publish(e)}async startProcessing(){this.handleRequests()}async handleRequests(){for await(const e of this.requestStream)await this.handleRequest(e)}async handleRequest(e){if(e instanceof mt){try{await this.handleWebSocketCommand(e.command)}catch(o){console.error("failed to handle life cycle request",e,o)}return}if(e instanceof xt){try{await this.handleNodeValidatorRequest(e.request)}catch(o){console.error("failed to handle node validator request",e,o)}return}console.error("unrecognized request",e)}async handleWebSocketCommand(e){if(e instanceof He){await this.handleConnect();return}if(e instanceof Me){await this.handleClose();return}}async handleNodeValidatorRequest(e){this.assertConnected(),this.webSocket.send(JSON.stringify(bn.encode(e)))}assertConnected(){if(this.webSocket===null)throw new Error("Not connected")}async handleConnect(){if(this.webSocket!==null)return;const e=new URL("node-validator/details",this.serviceBaseURL),o=dt();try{const r=new Tf(this.nodeValidatorResponseSink),s=new Mf(o,this.lifecycleResponseSink),a=new Lf(o,this.lifecycleResponseSink),d=new Hf(o,this.errorResponseSink),l=new WebSocket(e);l.onerror,l.addEventListener("open",s),l.addEventListener("message",r),l.addEventListener("close",a),l.addEventListener("error",d),l.addEventListener("close",()=>{l.removeEventListener("open",s),l.removeEventListener("message",r),l.removeEventListener("close",a),l.removeEventListener("error",d),this.webSocket=null}),this.webSocket=l;const m=new Je;await this.lifecycleResponseSink.send(m)}catch(r){const s=new nt(r);this.errorResponseSink.send(s),o.completeError(s)}await o.promise}async handleClose(){const e=this.webSocket;if(e===null){this.lifecycleResponseSink.send(new Be);return}return e.close(1e3,"done"),new Promise(o=>{e.addEventListener("close",()=>{o()})})}}class Tf{constructor(e){n(this,"nodeValidatorResponseSink");this.nodeValidatorResponseSink=e}decodeMessage(e){return Vt.decode(JSON.parse(e.data))}async relayMessage(e){try{await this.nodeValidatorResponseSink.send(e)}catch(o){console.error("attempt to publish message to response stream failed",o)}}async handleEvent(e){try{const o=this.decodeMessage(e);this.relayMessage(o)}catch(o){console.error("Failed to decode server message from web socket",o);return}}}class Mf{constructor(e,o){n(this,"completer");n(this,"lifecycleResponseSink");this.completer=e,this.lifecycleResponseSink=o}handleEvent(e){this.completer.complete(e.target),this.lifecycleResponseSink.send(new Qe)}}class Lf{constructor(e,o){n(this,"completer");n(this,"lifecycleResponseSink");this.completer=e,this.lifecycleResponseSink=o}async handleEvent(){await this.lifecycleResponseSink.send(new Be),this.completer.isCompleted||this.completer.completeError(new nt(null,"web socket error: unknown error"))}}class Hf{constructor(e,o){n(this,"completer");n(this,"errorResponseSink");this.completer=e,this.errorResponseSink=o}errorFromEvent(e){return"error"in e?new nt(e.error):new nt(null,"web socket error: unknown error")}handleEvent(e){const o=this.errorFromEvent(e);this.errorResponseSink.send(o),this.completer.isCompleted||this.completer.completeError(o)}}Dd(tt,ac),el(ot,lc);async function Vf(t){const e=t.pathname,o=await fetch(e);if(!o.ok)throw new H;const r=await o.json(),s=Se(1024),a=Se(1024),d=new If(s,a,r);return d.startProcessing(),d}async function Uf(t){const e=new URL(t);if(e.protocol==="replay:")return Vf(e);if(e.protocol==="ws:"||e.protocol==="wss:"){const o=Se(1024),r=Se(1024),s=new Of(o,r,e);return s.startProcessing(),s}return null}async function Wf(){try{const s=await(await fetch("/config.json")).json();if(s.node_validator_service_url){const a=await Uf(s.node_validator_service_url);if(a!==null)return a}}catch(r){console.warn("error determining service implementation, from configuration file",r)}const t=Se(1024),e=Se(1024),o=new xf(t,e);return o.startProcessing(),o}async function Ff(){return new Jf(await Wf())}class Jf{constructor(e){n(this,"service");this.service=e}get stream(){return this.service.stream}async send(e){return this.service.send(e)}}async function Gf(t,e){const o=await t;for await(const r of o.stream)e(tl.encode(r))}class Qf{constructor(e){n(this,"service");const o=Ff();this.service=o,Gf(o,e)}async handleEvent(e){const o=Pd.decode(e.data);try{(await this.service).send(o)}catch(r){console.warn("error processing message from event",r)}}}self.addEventListener("message",new Qf(self.postMessage.bind(self)))})();
