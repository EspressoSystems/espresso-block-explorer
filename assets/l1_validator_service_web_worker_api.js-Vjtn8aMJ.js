(function(){"use strict";class xs{assert(){}}function ks(){return new xs}const Ns=ks();function x(t,e){Ns.assert(t,e)}function Le(t,e){x(typeof t===e,`type assertion failed: expected "${e}", received "${typeof t}"`)}function Bs(t){x(t!==null,"expected a non-null value, received null")}function b(t,e){x(t instanceof e,`given value is not an instance of "${e.name}", specific type is "${typeof t=="object"&&t!==null?t.constructor.name:typeof t}"`)}class Je extends Error{key;haveType;constructor(e,r,o=`expected object with key: "${r}", instead found ${e}`){super(o),this.haveType=e,this.key=r,Object.freeze(this)}toJSON(){return{code:Je.name,message:this.message,have:this.haveType,key:this.key}}}class Me{encode(e){return this.encoder.convert(e)}decode(e){return this.decoder.convert(e)}}class s extends Me{}function Lr(t){return typeof t=="number"}function ue(t){return typeof t=="string"}function Is(t){return typeof t=="bigint"}function Os(t){return typeof t=="object"&&t!==null}function As(t){return t!==void 0}function Rs(t,e){return Array.isArray(t)&&t.every(e)}function Ds(t){return e=>Rs(e,t)}function we(t,...e){return Os(t)&&e.every(r=>r in t)}function a(t,...e){if(typeof t!="object")throw new Error("expected object");if(t===null)throw new Error("received null");for(const r of e)if(!(r in t))throw new Je("object",r)}function p(t,e){if(!ue(t.code))throw new Error("code must be a string");if(t.code!==e)throw new Error(`expected code to be ${e}, got ${t.code}`)}class m extends Error{constructor(e){super(e)}get code(){return this.constructor.name}toJSON(){return L.convert(this)}}class R{convert(e){return b(e,m),{code:e.code,message:e.message}}}const L=new R,Us="NoCodecFoundError";class fe extends Error{codec;constructor(e,r=`no codec found for: "${e}"`){super(r),this.codec=e,Object.freeze(this);debugger}toJSON(){return{code:c.encode(fe.name),message:c.encode(this.message),codec:c.encode(this.codec)}}get code(){return Us}}const Pe=new Map;class Ls{convert(e){a(e,"code");const r=c.decode(e.code),o=Pe.get(r);if(!o)throw new fe(r);return o.decode(e)}}class Js{convert(e){const r=Pe.get(e.code);if(!r)throw new fe(e.code);return r.encode(e)}}class Ms extends Me{encoder=new Js;decoder=new Ls}const ge=new Ms;function v(t,e){Pe.set(t,e)}const Te="InvalidTypeError";class E extends m{have;want;constructor(e,r,o=`invalid type: have "${e}", want "${r}"`){super(o),this.have=e,this.want=r,Object.freeze(this)}toJSON(){return Jr.encode(this)}get code(){return Te}}class Ps{convert(e){return a(e,"code","have","want","message"),p(e,Te),new E(c.decode(e.have),c.decode(e.want),c.decode(e.message))}}class Ts{convert(e){return b(e,E),{...L.convert(e),have:c.encode(e.have),want:c.encode(e.want)}}}class Fs extends s{encoder=new Ts;decoder=new Ps}const Jr=new Fs;v(Te,Jr);const zs=Ds(As);class Vs{convert(e){return e}}const Mr=new Vs;class Ws extends Me{encoder=Mr;decoder=Mr}const me=new Ws;class N{itemCodec;constructor(e){this.itemCodec=e}convert(e){if(!zs(e)){const r=typeof e=="object"&&e!==null?e.constructor.name:typeof e,o="array";throw new Error(`invalid array value: have "${r}", want "${o}"`)}return e.map(r=>this.itemCodec.decode(r))}}class B{itemCodec;constructor(e){this.itemCodec=e}convert(e){return b(e,Array),e.map(r=>this.itemCodec.encode(r))}}class I extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}}class J{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:this.itemCodec.decode(e)}}class M{itemCodec;constructor(e){this.itemCodec=e}convert(e){return e===null?null:(Bs(e),this.itemCodec.encode(e))}}class P extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}}class _s{convert(e){if(!ue(e))throw new E(typeof e,"string");return e}}class js{convert(e){return Le(e,"string"),e}}class Hs extends s{encoder=new js;decoder=new _s}const c=new Hs;new I(new N(c),new B(c)),new P(new J(c),new M(c));class Fe extends m{constructor(e="completer has already been completed"){super(e),Object.freeze(this)}get code(){return Pr}}const Pr="CompleterAlreadyCompletedError";class qs{convert(e){return a(e,"code","message"),p(e,Pr),new Fe(c.decode(e.message))}}class $s extends R{}class Ks extends s{encoder=new $s;decoder=new qs}const Gs=new Ks;v(Fe.name,Gs);function pe(){return x(!1,"completer is not ready, this should never be reached")}function ve(){throw new Fe}class Qs{resolve=pe;reject=pe;completed=!1;promise;get isCompleted(){return this.completed}constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r}),x(this.resolve!==pe,"resolve should be set"),x(this.reject!==pe,"resolve should be set")}complete(e){const r=this.resolve,o=this.reject;if(this.completed=!0,this.resolve=ve,this.reject=ve,e instanceof Promise){e.then(r,o);return}r(e)}completeError(e){this.reject(e),this.completed=!0,this.resolve=ve,this.reject=ve}}function ze(){return new Qs}class X extends m{response;status;constructor(e,r,o){super(o),this.status=e,this.response=r}toJSON(){return Tr.convert(this)}}class ye{convert(e){return b(e,X),{...L.convert(e),status:e.status}}}const Tr=new ye,Ve="BadResponseClientError";class Fr extends X{constructor(e,r,o="bad server response: client error"){super(e,r,o),Object.freeze(this)}get code(){return Ve}toJSON(){return zr.encode(this)}}class Xs{convert(e){return a(e,"code","message","status"),p(e,Ve),new Fr(Number(e.status),null,c.decode(e.message))}}class Zs extends ye{}class Ys extends s{encoder=new Zs;decoder=new Xs}const zr=new Ys;v(Ve,zr);const We="BadResponseError";class Vr extends X{constructor(e,r,o="bad server response"){super(e,r,o),Object.freeze(this)}get code(){return We}toJSON(){return Wr.encode(this)}}class ec{convert(e){return a(e,"code","message","status"),p(e,We),new Vr(Number(e.status),null,c.decode(e.message))}}class tc extends ye{}class rc extends s{encoder=new tc;decoder=new ec}const Wr=new rc;v(We,Wr);class _r extends X{constructor(e,r,o="bad server response: server error"){super(e,r,o),Object.freeze(this)}get code(){return _e}}const _e="BadResponseServerError";class oc{convert(e){return a(e,"code","message","status"),p(e,_e),new _r(Number(e.status),null,c.decode(e.message))}}class nc extends ye{}class sc extends s{encoder=new nc;decoder=new oc}const cc=new sc;v(_e,cc);const je="ChannelClosedError";class Z extends m{constructor(e="channel closed"){super(e),Object.freeze(this)}get code(){return je}}class ac{convert(e){return a(e,"code","message"),p(e,je),new Z(c.decode(e.message))}}class dc extends R{}class ic extends s{encoder=new dc;decoder=new ac}const lc=new ic;v(je,lc);const He="FetchError";class jr extends m{cause;constructor(e,r=`fetch failed: ${String(e)}`){super(r),this.cause=e,Object.freeze(this)}get code(){return He}}class hc{convert(e){return a(e,"code","message"),p(e,He),new jr({},c.decode(e.message))}}class uc extends R{}class wc extends s{encoder=new uc;decoder=new hc}const fc=new wc;v(He,fc);const qe="IncorrectBase64PaddingError";class Hr extends m{constructor(e="incorrect padding"){super(e),Object.freeze(this)}get code(){return qe}}class gc{convert(e){return a(e,"code","message"),p(e,qe),new Hr(c.decode(e.message))}}class mc extends R{}class pc extends s{encoder=new mc;decoder=new gc}const vc=new pc;v(qe,vc);class yc{convert(e){if(!Lr(e))throw new E(typeof e,"number");return e}}class bc{convert(e){return Le(e,"number"),e}}class Sc extends s{encoder=new bc;decoder=new yc}const y=new Sc,qr=new P(new J(y),new M(y)),$r=new I(new N(y),new B(y));new I(new N(qr),new B(qr));const $e="InvalidBase64AlphabetLengthError";class Ke extends m{length;constructor(e,r=`alphabet needs to be 64 characters, received ${e}`){super(r),this.length=e,Object.freeze(this)}toJSON(){return Kr.encode(this)}get code(){return $e}}class Ec{convert(e){return a(e,"code","length","message"),p(e,$e),new Ke(y.decode(e.length),c.decode(e.message))}}class Cc{convert(e){return b(e,Ke),{...L.convert(e),length:y.encode(e.length)}}}class xc extends s{encoder=new Cc;decoder=new Ec}const Kr=new xc;v($e,Kr);const Ge="InvalidHexStringError";class Gr extends m{constructor(e="invalid hex string"){super(e),Object.freeze(this)}get code(){return Ge}}class kc{convert(e){return a(e,"code","message"),p(e,Ge),new Gr(c.decode(e.message))}}class Nc extends R{}class Bc extends s{encoder=new Nc;decoder=new kc}const Ic=new Bc;v(Ge,Ic);const Qe="InvalidHexValueError";class Qr extends m{value;constructor(e,r=`invalid hex value "${e}"`){super(r),this.value=e,Object.freeze(this)}toJSON(){return Xr.encode(this)}get code(){return Qe}}class Oc{convert(e){return a(e,"code","value","message"),p(e,Qe),new Qr(y.decode(e.value),c.decode(e.message))}}class Ac{convert(e){return{...L.convert(e),value:y.encode(e.value)}}}class Rc extends s{encoder=new Ac;decoder=new Oc}const Xr=new Rc;v(Qe,Xr);const Xe="InvalidInputError";class Y extends m{constructor(e="invalid input"){super(e),Object.freeze(this)}get code(){return Xe}}class Dc{convert(e){return a(e,"code","message"),p(e,Xe),new Y(c.decode(e.message))}}class Uc extends R{}class Lc extends s{encoder=new Uc;decoder=new Dc}const Jc=new Lc;v(Xe,Jc);const Ze="InvalidStringValueError";class Zr extends m{have;want;constructor(e,r,o=`invalid string value: have "${e}", want "${r}"`){super(o),this.have=e,this.want=r,Object.freeze(this)}toJSON(){return Yr.encode(this)}get code(){return Ze}}class Mc{convert(e){return a(e,"code","have","want","message"),p(e,Ze),new Zr(c.decode(e.have),c.decode(e.want),c.decode(e.message))}}class Pc{convert(e){return b(e,Zr),{...L.convert(e),have:c.encode(e.have),want:c.encode(e.want)}}}class Tc extends s{encoder=new Pc;decoder=new Mc}const Yr=new Tc;v(Ze,Yr);const Ye="InvalidTaggedBase64EncodingError";class eo extends m{constructor(e="invalid tagged base64 encoding"){super(e),Object.freeze(this)}toJSON(){return to.encode(this)}get code(){return Ye}}class Fc{convert(e){return a(e,"code","message"),p(e,Ye),new eo(c.decode(e.message))}}class zc extends R{}class Vc extends s{encoder=new zc;decoder=new Fc}const to=new Vc;v(Ye,to);const et="MissingElementError";class be extends m{constructor(e="missing element"){super(e),Object.freeze(this)}get code(){return et}}class Wc{convert(e){return a(e,"code","message"),p(e,et),new be(c.decode(e.message))}}class _c extends R{}class jc extends s{encoder=new _c;decoder=new Wc}const Hc=new jc;v(et,Hc);const tt="NoCompleterFoundForRequestID";class ro extends m{requestID;constructor(e,r=`no completer found for request id "${e}"`){super(r),this.requestID=e,Object.freeze(this)}toJSON(){return oo.encode(this)}get code(){return tt}}class qc{convert(e){return a(e,"code","requestID","message"),p(e,tt),new ro(me.decode(e.requestID),c.decode(e.message))}}class $c{convert(e){return b(e,ro),{...L.convert(e),requestID:me.encode(e.requestID)}}}class Kc extends s{encoder=new $c;decoder=new qc}const oo=new Kc;v(tt,oo);const rt="NotFoundError";class Gc extends m{key;constructor(e,r=`Not Found: ${e}`){super(r),this.key=e,Object.freeze(this)}get code(){return rt}}class no{codec;constructor(e){this.codec=e}convert(e){return a(e,"code","key"),p(e,rt),new Gc(this.codec.decode(e.key))}}class so{codec;constructor(e){this.codec=e}convert(e){return{...L.convert(e),key:this.codec.encode(e.key)}}}class co extends s{encoder;decoder;constructor(e,r){super(),this.encoder=e,this.decoder=r}}new co(new so(c),new no(c));const Qc=new co(new so(me),new no(me));v(rt,Qc);const ot="NoURLProvidedError";class Xc extends m{constructor(e="no url provided"){super(e),Object.freeze(this)}get code(){return ot}}class Zc{convert(e){return a(e,"code","message"),p(e,ot),new Xc(c.decode(e.message))}}class Yc extends R{}class ea extends s{encoder=new Yc;decoder=new Zc}const ta=new ea;v(ot,ta);const nt="UnimplementedError";class D extends m{constructor(e="unimplemented"){super(e),Object.freeze(this);debugger}get code(){return nt}}class ra{convert(e){return a(e,"code","message"),p(e,nt),new D(c.decode(e.message))}}class oa extends R{}class na extends s{encoder=new oa;decoder=new ra}const sa=new na;v(nt,sa);const st="QUERY_ERROR";class ca extends m{error;constructor(e,r="missing element"){super(r),this.error=e,Object.freeze(this)}get code(){return st}}class aa{convert(e){return a(e,"code","error","message"),p(e,st),new ca(ho.decode(e.error),c.decode(e.message))}}class da{convert(e){return{code:e.code,error:ho.encode(e.error),message:c.encode(e.message)}}}class ia extends s{encoder=new da;decoder=new aa}const la=new ia;class ct{}const at="NotFound";class ao extends ct{constructor(){super(),Object.freeze(this)}valueOf(){return at}toJSON(){return this.valueOf()}}const ha=new ao,dt="Missing";class io extends ct{constructor(){super(),Object.freeze(this)}valueOf(){return dt}toJSON(){return this.valueOf()}}const ua=new io;class lo extends ct{error;constructor(e){super(),this.error=e,Object.freeze(this)}toJSON(){return lt.encode(this)}}class wa{message;constructor(e){this.message=e,Object.freeze(this)}toJSON(){return it.encode(this)}}class fa{convert(e){return a(e,"message"),new wa(c.decode(e.message))}}class ga{convert(e){return{message:c.encode(e.message)}}}class ma extends s{encoder=new ga;decoder=new fa}const it=new ma;class pa{convert(e){return a(e,"Error"),new lo(it.decode(e.Error))}}class va{convert(e){return{Error:it.encode(e.error)}}}class ya extends s{encoder=new va;decoder=new pa}const lt=new ya;class ba{convert(e){return e===at?ha:e===dt?ua:lt.decode(e)}}class Sa{convert(e){if(e instanceof ao)return at;if(e instanceof io)return dt;if(e instanceof lo)return lt.encode(e);throw new D}}class Ea extends s{encoder=new Sa;decoder=new ba}const ho=new Ea;v(st,la);const uo="ResponseContentTypeIsNotApplicationJSONError";class ee extends X{haveHeaderType;constructor(e,r,o,n="response content type is not application/json"){super(r,o,n),this.haveHeaderType=e,Object.freeze(this)}static fromResponse(e,r){return new ee(e.headers.get("content-type")??"undefined",e.status,e,r)}toJSON(){return wo.encode(this)}get code(){return uo}}class Ca{convert(e){return a(e,"code","status","have","want","message"),p(e,uo),new ee(c.decode(e.code),y.decode(e.status),null,c.decode(e.message))}}class xa{convert(e){return{...Tr.convert(e),have:c.encode(e.haveHeaderType),want:c.encode("application/json")}}}class ka extends s{encoder=new xa;decoder=new Ca}const wo=new ka;v(ee.name,wo);const ht="WebWorkerErrorResponse";class Na extends m{error;constructor(e,r="error in web worker"){super(r),this.error=e,Object.freeze(this)}toJSON(){return fo.encode(this)}get code(){return ht}}class Ba{convert(e){return a(e,"code","error","message"),p(e,ht),new Na(ge.decode(e.error),c.decode(e.message))}}class Ia{convert(e){return{...L.convert(e),error:ge.encode(e.error)}}}class Oa extends s{encoder=new Ia;decoder=new Ba}const fo=new Oa;v(ht,fo);var go=(t=>(t[t.success=0]="success",t[t.full=1]="full",t[t.failed=2]="failed",t))(go||{});class Aa{getFromEmpty(){}}class Ra{getFromEmpty(){throw new be}}const mo={returnUndefined:new Aa,throwMissingElement:new Ra};class Da{maxSize;constructor(e){x(!Number.isNaN(e),"maxSize must not be NaN"),x(Number.isInteger(e),"maxSize must be an integer"),x(e>0,"maxSize must be greater than 0"),this.maxSize=e}nextIndex(e){return x(e>=0,"index must be greater than or equal to 0"),(e+1)%this.maxSize}}class Ua{preComputedSizeMinus1;constructor(e){x(!Number.isNaN(e),"maxSize must not be NaN"),x(Number.isInteger(e),"maxSize must be an integer"),x(e>0,"maxSize must be greater than 0"),x(po(e),"maxSize must be a power of two"),this.preComputedSizeMinus1=e-1}nextIndex(e){return x(e>=0,"index must be greater than or equal to 0"),e+1&this.preComputedSizeMinus1}}function po(t){return(t&t-1)===0}const ut="BufferFullError";class vo extends m{constructor(e="buffer full"){super(e),Object.freeze(this)}get code(){return ut}}class La{convert(e){return a(e,"code","message"),p(e,ut),new vo(c.decode(e.message))}}class Ja extends R{}class Ma extends s{encoder=new Ja;decoder=new La}const Pa=new Ma;v(ut,Pa);class Ta{putToFull(e,r){return e.get(),e.put(r)}}class Fa{putToFull(){throw new vo}}const yo={overwriteOldest:new Ta,throw:new Fa};function za(t){return po(t)?new Ua(t):new Da(t)}class Va{readIndex=0;writeIndex=0;buffer;nextIndex;getOnEmpty;putOnFull;constructor(e,r,o){x(!Number.isNaN(e),"maxSize must not be NaN"),this.buffer=new Array(e),this.nextIndex=za(e),this.getOnEmpty=r,this.putOnFull=o}get maxSize(){return this.buffer.length}get length(){return this.writeIndex<this.readIndex?this.writeIndex+this.maxSize-this.readIndex:this.writeIndex-this.readIndex}put(e){const r=this.nextIndex.nextIndex(this.writeIndex);return r===this.readIndex?this.putOnFull.putToFull(this,e):(this.buffer[this.writeIndex]=e,this.writeIndex=r,go.success)}get(){if(this.readIndex===this.writeIndex)return this.getOnEmpty.getFromEmpty(this);const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),e}[Symbol.iterator](){return new Wa(this)}immutableIterable(){return{[Symbol.iterator]:()=>this.immutableIterator()}}immutableIterator(){return new _a(this.readIndex,this.writeIndex,this.buffer,this.nextIndex)}}class Wa{buffer;constructor(e){this.buffer=e}next(){const e=this.buffer.get();return e==null?{value:void 0,done:!0}:{value:e,done:!1}}}class _a{readIndex;writeIndex;buffer;nextIndex;constructor(e,r,o,n){this.readIndex=e,this.writeIndex=r,this.buffer=o,this.nextIndex=n}next(){if(this.readIndex===this.writeIndex)return{value:void 0,done:!0};const e=this.buffer[this.readIndex];return this.readIndex=this.nextIndex.nextIndex(this.readIndex),{value:e,done:!1}}}function ja(t=32,e=mo.returnUndefined,r=yo.overwriteOldest){return new Va(t,e,r)}class Ha{publishQueue;pollBlocked;publishBlocked;capacity;closed=!1;constructor(e){this.publishQueue=ja(Math.max(2,e),mo.throwMissingElement,yo.throw);const r=ze();this.pollBlocked=r,this.publishBlocked=r,r.complete(),this.capacity=e-1}get isClosed(){return this.closed}close(){if(this.closed)throw new Z;this.closed=!0}async drain(){for(;this.publishQueue.length>0;)this.publishQueue.get()}async publish(e){if(this.closed)throw new Z;if(this.publishQueue.length>=this.capacity){if(this.publishBlocked.isCompleted){const r=ze();this.publishBlocked=r,await r.promise}return await this.publishBlocked.promise,this.publish(e)}this.publishQueue.put(e),this.pollBlocked.isCompleted||this.pollBlocked.complete()}async poll(){if(this.publishQueue.length<=0){if(this.isClosed)throw new Z;if(this.pollBlocked.isCompleted){const r=ze();this.pollBlocked=r}return await this.pollBlocked.promise,this.poll()}const e=this.publishQueue.get();return this.publishBlocked.isCompleted||this.publishBlocked.complete(),e}[Symbol.asyncIterator](){return new qa(this)}}class qa{channel;constructor(e){this.channel=e}async next(){try{return{done:!1,value:await this.channel.poll()}}catch(e){if(e instanceof Z)return{done:!0,value:void 0};throw e}}}function $a(t){return new Ha(t)}class z{constructor(e,r,o){this.alpha3Code=e,this.code=r,this.significantDigits=o,this.alpha3Code=e,this.code=r,this.significantDigits=o,this.significantDigitsMultiplier=BigInt(10)**BigInt(this.significantDigits)}significantDigitsMultiplier;toJSON(){return Se.encode(this)}}const bo=new z("JPY",392,0),Ka=new z("GBP",826,2),So=new z("USD",840,2),Ga=new z("EUR",978,2),Qa=new z("XXX",999,2),Eo=new z("ETH",1001,18),wt=new z("XBT",1002,8),Co=new z("ESP",10001,18),Xa=[bo,Ka,So,Ga,Qa,Eo,wt,Co],Za=new Map(Xa.map(t=>[t.alpha3Code,t]));class Ya{convert(e){if(typeof e!="string")throw new Y("CurrencyCodeDecoder: expected string");if(e==="BTC")return wt;const r=Za.get(e);if(r===void 0)throw new Y(`CurrencyCodeDecoder: unknown currency: "${e}"`);return r}}class ed{convert(e){return b(e,z),e.alpha3Code}}class td extends s{decoder=new Ya;encoder=new ed}const Se=new td;class T{constructor(e,r){this.currency=e,this.value=r,this.currency=e,this.value=r}static USD(e){return new T(So,BigInt(e))}static ETH(e){return new T(Eo,BigInt(e))}static ESP(e){return new T(Co,BigInt(e))}static JPY(e){return new T(bo,BigInt(e))}static BTC(e){return new T(wt,BigInt(e))}toString(){return Ee.encode(this)}toJSON(){return Ee.encode(this)}}function rd(t){return t==="."||t===","||t===" "}function od(t,e){let r=-1;const o=t.length;for(let n=0;n<o;n++)e(t[n])&&(r=n);return r}class nd{parseCurrencyCode(e){return Se.decode(e)}parseValue(e,r){let o=1n;r[0]==="-"&&(o=-1n,r=r.substring(1));const n=od(r,rd);if(n===-1){const i=BigInt(r.replace(/\D/g,""))*e.significantDigitsMultiplier;return o*i}const d=r.substring(0,n).replace(/\D/g,""),l=r.substring(n+1).replace(/\D/g,""),h=BigInt(d)*e.significantDigitsMultiplier,f=BigInt(l)*10n**BigInt(e.significantDigits-l.length);return o*(h+f)}convert(e){if(typeof e!="string")throw new Y("MonetaryValueDecoder: expected string");const r=e.indexOf(" ");if(r<=-1)throw new Y("MonetaryValueDecoder: missing non-breaking space");const o=e.substring(0,r),n=e.substring(r+1);if(/^-?[\d .,]+$/.test(o)){const l=this.parseCurrencyCode(n);return new T(l,this.parseValue(l,o))}const d=this.parseCurrencyCode(o);return new T(d,this.parseValue(d,n))}}class sd{convert(e){b(e,T);const r=e.value<0n?"-":"",o=e.value<0n?-e.value:e.value,n=o%e.currency.significantDigitsMultiplier,d=o/e.currency.significantDigitsMultiplier,l=String(d),h=String(n);return/^0+$/.test(h)?`${Se.encode(e.currency)} ${r}${l}`:`${Se.encode(e.currency)} ${r}${d}.${String(n).padStart(e.currency.significantDigits,"0")}`}}class cd extends s{decoder=new nd;encoder=new sd}const Ee=new cd;new I(new N(Ee),new B(Ee));class g{namespace;name;site;blockExplorer;constructor(e,r,o,n){this.namespace=e,this.name=r,this.site=o,this.blockExplorer=n}}const ad=new g(202374881,"Vienna",new URL("https://vienna.caldera.dev/"),new URL("https://vienna.calderaexplorer.xyz/")),dd=new g(202374882,"OP Stack",new URL("https://stack.optimism.io/"),new URL("https://www.blockscout.com/")),id=new g(33914988448,"Arbitrum",new URL("https://arbitrum.io/"),new URL("https://arbiscan.io/")),ld=new g(33914988449,"Eigen Layer",new URL("https://www.eigenlayer.xyz/"),new URL("https://www.blockscout.com/")),hd=new g(33914988450,"Spire",new URL("https://www.spire.dev/"),new URL("https://www.blockscout.com/")),ud=new g(33914988451,"Alt Layer",new URL("https://altlayer.io/"),new URL("https://www.blockscout.com/")),wd=new g(33914988452,"Caldera",new URL("https://www.caldera.xyz/"),new URL("https://www.blockscout.com/")),fd=new g(33914988453,"Vistara Labs",new URL("https://vistara.dev/"),new URL("https://www.blockscout.com/")),gd=new g(33914988454,"Polygon",new URL("https://polygon.technology/"),new URL("https://www.blockscout.com/")),md=new g(263,"Milan",new URL("https://milan.caldera.dev/"),new URL("https://milan-devnet.explorer.caldera.xyz/")),pd=new g(41234687,"Kyoto",new URL("https://example.com/"),new URL("https://kyoto-explorer.altlayer.io/")),vd=1918988905,yd=new g(vd,"RARI",new URL("https://rarichain.org/"),new URL("https://explorer.rarichain.org/")),bd=1380012617,Sd=new g(bd,"RARI",new URL("https://rarichain.org/"),new URL("https://mainnet.explorer.rarichain.org/")),Ed=9369,Cd=new g(Ed,"LogX",new URL("https://logx.network/"),new URL("https://kartel-testnet-explorer.alt.technology/")),xd=936369,kd=new g(xd,"LogX",new URL("https://logx.network/"),new URL("https://vzjuxmhfn70kgnlds27h-explorer.alt.technology")),Nd=466,Bd=new g(Nd,"AppChain",new URL("https://appchain.xyz/"),new URL("https://explorer.appchain.xyz/")),Id=4661,Od=new g(Id,"AppChain",new URL("https://appchain.xyz/"),new URL("https://appchaintestnet.explorer.caldera.xyz/")),Ad=360,Rd=new g(Ad,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Dd=3609,Ud=new g(Dd,"Molten",new URL("https://www.moltennetwork.com/"),new URL("https://molten.explorer.caldera.dev/")),Ld=33139,Jd=new g(Ld,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apescan.io/")),Md=3313939,Pd=new g(Md,"APECHAIN",new URL("https://apechain.com/"),new URL("https://apechain-testnet.explorer.caldera.xyz/")),Td=13107,Fd=new g(Td,"t3rn",new URL("https://t3rn.io/"),new URL("https://brn-testnet.explorer.caldera.xyz/")),zd=819,Vd=new g(zd,"t3rn",new URL("https://t3rn.io/"),new URL("https://exporer.t3rn.io/")),xo=21341,Wd=new g(xo,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus-sepolia-testnet.explorer.caldera.xyz/")),_d=new g(xo,"Rufus",new URL("https://l2beat.com/scaling/projects/rufus"),new URL("https://rufus.calderaexplorer.xyz/")),jd=2524852,Hd=new g(jd,"Huddle01",new URL("https://huddle01.com/"),new URL("https://hudlscan.com/txs")),qd=1397311310,ko=new g(qd,"Infinite Garden",new URL("https://infinitegarden.espressosys.com/"),new URL("https://explorer.main.net.espressosys.com/")),$d=10101,Kd=new g($d,"Timeboost Decaf",new URL("https://espressosys.com/"),new URL("https://explorer.decaf.testnet.espresso.network/")),Gd=[ko,Sd,kd,Rd,Bd,Jd,Vd,_d],Qd=[ko,yd,Cd,Od,Ud,Pd,Fd,Wd,Hd,Kd],Xd=new Map([ad,dd,id,gd,ld,hd,ud,wd,fd,md,pd,...Gd,...Qd].map(t=>[t.namespace,t])),ft="CorruptBase64InputError";class _ extends m{offset;constructor(e,r=`corrupt input error at ${e}`){super(r),this.offset=e,Object.freeze(this)}get code(){return ft}toJSON(){return No.encode(this)}}class Zd{convert(e){return a(e,"code","offset","message"),p(e,ft),new _(y.decode(e.offset),c.decode(e.message))}}class Yd{convert(e){return b(e,_),{...L.convert(e),offset:y.encode(e.offset),message:c.encode(e.message)}}}class ei extends s{encoder=new Yd;decoder=new Zd}const No=new ei;v(ft,No);class ti{convert(e){const r=new ArrayBuffer(e.byteLength);return new Uint8Array(r).set(e),r}}class ri{convert(e){return new Uint8Array(e)}}class oi extends s{encoder=new ti;decoder=new ri}const gt=new oi,ni=new TextEncoder;function Bo(t){return ni.encode(t)}const si=new TextDecoder;function ci(t){return si.decode(t)}function*Io(t){yield*Bo(t)}function*ai(){for(let t=0;t<256;t++)yield 255}const te=-1,di=61;class re{encodeMap;decodeMap;padChar;strict;constructor(e,r,o=di,n=!1){this.encodeMap=e,this.decodeMap=r,this.padChar=o,this.strict=n}static withAlphabet(e){const r=e.length;if(r!==64)throw new Ke(r);const o=Array.from(Io(e)),n=Array.from(ai());for(let d=0;d<r;d++)n[o[d]]=d;return new re(o,n)}withPadding(e){return new re(this.encodeMap,this.decodeMap,e,this.strict)}encode(e){if(e.byteLength===0)return new ArrayBuffer(0);let r=0,o=0;const n=Math.floor(e.byteLength/3)*3,d=Math.ceil(e.byteLength/3)*4,l=new ArrayBuffer(d),h=new DataView(e),f=new DataView(l);for(;o<n;){const O=h.getUint8(o+0)<<16|h.getUint8(o+1)<<8|h.getUint8(o+2);f.setUint8(r+0,this.encodeMap[O>>18&63]),f.setUint8(r+1,this.encodeMap[O>>12&63]),f.setUint8(r+2,this.encodeMap[O>>6&63]),f.setUint8(r+3,this.encodeMap[O&63]),o+=3,r+=4}const i=e.byteLength-o;if(i===0)return l;let C=h.getUint8(o+0)<<16;switch(i===2&&(C|=h.getUint8(o+1)<<8),f.setUint8(r+0,this.encodeMap[C>>18&63]),f.setUint8(r+1,this.encodeMap[C>>12&63]),i){case 2:return f.setUint8(r+2,this.encodeMap[C>>6&63]),this.padChar!==te?(f.setUint8(r+3,this.padChar),l.slice(0,r+4)):l.slice(0,r+3);case 1:if(this.padChar!==te)return f.setUint8(r+2,this.padChar),f.setUint8(r+3,this.padChar),l.slice(0,r+4);break}return l.slice(0,r+2)}decode(e){const r=e.byteLength;if(r===0)return new ArrayBuffer(0);const o=new DataView(e),n=new ArrayBuffer(Math.floor(r/4*3)),d=new DataView(n),l=new ArrayBuffer(4),h=new DataView(l);let f=0,i=0,C=0,O=!1;for(;i<r&&!O;){let w=3,u=4;for(let A=0;A<4;A++){if(i===r){if(A===0)return n;if(A===1||this.padChar!==te)throw new _(i-A);w=A-1,u=A,O=!0;break}const H=o.getUint8(i);i++;const he=this.decodeMap[H];if(he!==255){h.setUint8(A,he);continue}if(H===10||H===13){A--;continue}if(H===this.padChar){switch(A){case 0:case 1:throw new Hr;case 2:for(;i<r&&(o.getUint8(i)===10||o.getUint8(i)===13);)i++;if(i===r)throw new _(r);i++}for(;i<r&&(o.getUint8(i)===10||o.getUint8(i)===13);)i++;if(i<r)throw new _(i);w=3,u=A,O=!0;break}throw new _(i-1)}const Q=h.getUint8(0)<<18|h.getUint8(1)<<12|h.getUint8(2)<<6|h.getUint8(3);switch(h.setUint8(2,Q>>0&255),h.setUint8(1,Q>>8&255),h.setUint8(0,Q>>16&255),u){case 4:d.setUint8(C+2,h.getUint8(2)),h.setUint8(2,0);case 3:if(d.setUint8(C+1,h.getUint8(1)),this.strict&&h.getUint8(2)!==0)throw new _(i-1);case 2:if(d.setUint8(C+0,h.getUint8(0)),this.strict&&(h.getUint8(1)!==0||h.getUint8(2)!==0))throw new _(i-2)}C+=w,f+=u-1}return n.slice(0,f)}decodeString(e){return this.decode(gt.encode(Bo(e)))}encodeToString(e){return ci(this.encode(e))}}const Oo=re.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),ii=Oo.withPadding(te),Ao=re.withAlphabet("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),mt=Ao.withPadding(te);class F{tag;data;constructor(e,r){this.tag=e,this.data=r}static fromString(e){const r=e.indexOf("~");if(r<0)throw new eo;const o=e.substring(0,r),n=mt.decodeString(e.substring(r+1));return new F(o,n)}static inflate(e){return U.decode(e)}toString(){return`${this.tag}~${mt.encodeToString(this.data)}`}valueOf(){return this.toString()}toJSON(){return this.toString()}}class li{convert(e){if(typeof e!="string")throw new E(typeof e,"string");return F.fromString(e)}}class hi{convert(e){return b(e,F),e.toString()}}class ui extends s{encoder=new hi;decoder=new li}const U=new ui,oe=2147483648,wi=1103515245,fi=12345;class ne{state;constructor(e){this.state=e!==void 0?e:Math.floor(Math.random()*(oe-1))}nextInt(){return this.state=(wi*this.state+fi)%oe,this.state}nextFloat(){return this.nextInt()/(oe-1)}nextRange(e,r){const o=r-e,n=this.nextInt()/oe;return e+Math.floor(n*o)}nextRangeBigInt(e,r){const o=r-e,n=BigInt(this.nextInt())*1000000n/BigInt(oe);return e+n*o/1000000n}fillBytes(e){const r=new ArrayBuffer(e),o=new DataView(r);let n=0;for(;n<e-4;n+=4)o.setUint32(n,this.nextRange(0,4294967295));for(let d=n;d<e;d++)o.setUint8(d,this.nextRange(0,256));return r}}const Ce=new Date,Ro=new Date(Ce.getFullYear(),Ce.getMonth(),Ce.getDate()).valueOf(),gi=Ro;function mi(){return Ce.valueOf()}function pi(){return Ro}function pt(){return gi}function*vi(t,e){for(let r=t.next();!r.done;r=t.next())e(r.value)&&(yield r.value)}function yi(t,e){return vi(t[Symbol.iterator](),e)}function*Do(t,e){for(let r=t.next();!r.done;r=t.next())yield e(r.value)}function xe(t,e){return Do(t[Symbol.iterator](),e)}function*bi(t,e){for(let r=0;r<e;r++){const o=t.next();if(o.done)return;yield o.value}}function Si(t,e){return bi(t[Symbol.iterator](),e)}function Ei(t){let e;for(let r=t.next();!r.done;r=t.next())e=r.value;if(e===void 0)throw new be;return e}function Ci(t){return Ei(t[Symbol.iterator]())}function*xi(t,e){for(let r=t.next();!r.done;r=t.next())yield*e(r.value)}function ki(t,e){return xi(t[Symbol.iterator](),e)}function*Ni(){let t=0;for(;;)yield t++}function Bi(t){return Si(Ni(),Math.ceil(t))}function*Ii(t,e,r){for(let o=t.next(),n=e.next();!o.done&&!n.done;o=t.next(),n=e.next())yield r(o.value,n.value)}function Uo(t,e,r){return Ii(t[Symbol.iterator](),e[Symbol.iterator](),r)}const Lo=["Residential","Mobile","Enterprise","AWS","Azure","GCP"],Jo=["Espresso v1.0","Espresso v1.1","Espresso v1.2","Espresso v1.3","Espresso v1.4"],Mo=["Linux","Unix","Windows","MacOS"],Po=[["Espresso","https://espressosys.com/"],["BlockDaemon","https://www.blockdaemon.com/"],["Unit 410","https://unit410.com/"],["Nethermind","https://www.nethermind.io/"],["Sub7","https://sub7.xyz/"],["KudasaiJP","https://kudasai.co.jp/"],["Informal Systems","https://informal.systems/"],["P2P","https://p2p.org/"],["LinkPool","https://linkpool.com/"],["ZKV","https://zkvalidator.com/"],["Figment","https://figment.io/"]],Oi=[[["Mexico City",19.4333,-99.1333,"MX"],["Guadalajara",20.6767,-103.3475,"MX"],["Monterrey",25.6667,-100.3,"MX"],["Guatemala City",14.6133,-90.5353,"GT"],["Tijuana",32.525,-117.0333,"MX"],["Ecatepec",19.6097,-99.06,"MX"],["Tegucigalpa",14.1058,-87.2047,"HN"],["León de los Aldama",21.1167,-101.6833,"MX"],["San José",9.9325,-84.08,"CR"],["Panama City",8.9833,-79.5167,"PA"],["Juárez",31.745,-106.485,"MX"],["Comayagüela",14.098,-87.21,"HN"],["Mexicali",32.6633,-115.4678,"MX"],["Nezahualcóyotl",19.4081,-99.0186,"MX"],["Managua",12.1364,-86.2514,"NI"],["Morelia",19.7683,-101.1894,"MX"],["Aguascalientes",21.876,-102.296,"MX"],["Mérida",20.97,-89.62,"MX"],["Saltillo",25.4231,-100.9919,"MX"],["Culiacán",24.8069,-107.3939,"MX"]],[["Havana",23.1367,-82.3589,"CU"],["San Juan",18.3985,-66.061,"PR"],["Santiago",19.4572,-70.6889,"DO"],["Santo Domingo",18.4667,-69.95,"DO"],["Port-au-Prince",18.5333,-72.3333,"HT"],["Santo Domingo Este",18.4855,-69.8734,"DO"],["Kingston",17.9714,-76.7931,"JM"],["Carrefour",18.5344,-72.4094,"HT"],["Santiago de Cuba",20.0217,-75.8294,"CU"],["Pétion-Ville",18.5128,-72.2864,"HT"],["Holguín",20.8869,-76.2592,"CU"],["Gonaïves",19.4456,-72.6883,"HT"],["Camagüey",21.3839,-77.9075,"CU"],["Puerto Plata",19.8,-70.6833,"DO"],["Croix-des-Bouquets",18.5761,-72.2269,"HT"],["Nassau",25.0781,-77.3386,"BS"],["Fort-de-France",14.6,-61.0667,"MQ"],["Higüey",18.6167,-68.7,"DO"],["Santa Clara",22.4069,-79.9649,"CU"],["Bayamo",20.3817,-76.6428,"CU"]],[["Cairo",30.0444,31.2358,"EG"],["Lagos",6.455,3.3841,"NG"],["Kinshasa",-4.3219,15.3119,"CD"],["Luanda",-8.8383,13.2344,"AO"],["Johannesburg",-26.2044,28.0456,"ZA"],["Dar es Salaam",-6.8161,39.2803,"TZ"],["Douala",4.05,9.7,"CM"],["Giza",29.987,31.2118,"EG"],["Abidjan",5.3167,-4.0333,"CI"],["Cape Town",-33.9253,18.4239,"ZA"],["Bamako",12.6392,-8.0028,"ML"],["Abuja",9.0667,7.4833,"NG"],["Ibadan",7.3964,3.9167,"NG"],["Addis Ababa",9.03,38.74,"ET"],["Mbuji-Mayi",-6.15,23.6,"CD"],["Mogadishu",2.0392,45.3419,"SO"],["Lusaka",-15.4167,28.2833,"ZM"],["Antananarivo",-18.91,47.525,"MG"],["Awka",6.2069,7.0678,"NG"],["Bamenda",5.9614,10.1517,"CM"]],[["Tokyo",35.6897,139.6922,"JP"],["Delhi",28.61,77.23,"IN"],["Manila",14.5958,120.9772,"PH"],["Dhaka",23.7639,90.3889,"BD"],["Moscow",55.7558,37.6172,"RU"],["Ho Chi Minh City",10.7756,106.7019,"VN"],["Xi’an",34.2611,108.9422,"CN"],["Dongguan",23.021,113.752,"CN"],["Tongshan",34.204,117.284,"CN"],["Jining",35.4151,116.5871,"CN"],["Cangzhou",38.3047,116.8387,"CN"],["Shaoyang",27.2395,111.4679,"CN"],["Dalian",38.9,121.6,"CN"],["Ankara",39.93,32.85,"TR"],["Zhangzhou",24.513,117.647,"CN"],["Changsha",28.228,112.939,"CN"],["Ürümqi",43.8225,87.6125,"CN"],["Ningbo",29.8603,121.6245,"CN"],["Suihua",46.654,126.969,"CN"],["Deyang",31.127,104.398,"CN"]],[["London",51.5072,-.1275,"GB"],["Madrid",40.4169,-3.7033,"ES"],["Berlin",52.52,13.405,"DE"],["Barcelona",41.3828,2.1769,"ES"],["Athens",37.9842,23.7281,"GR"],["Budapest",47.4925,19.0514,"HU"],["Birmingham",52.48,-1.9025,"GB"],["Stuttgart",48.7775,9.18,"DE"],["Munich",48.1375,11.575,"DE"],["Hamburg",53.55,10,"DE"],["Bucharest",44.4325,26.1039,"RO"],["Vienna",48.2083,16.3725,"AT"],["Stockholm",59.3294,18.0686,"SE"],["Minsk",53.9,27.5667,"BY"],["Warsaw",52.23,21.0111,"PL"],["Valencia",39.47,-.3764,"ES"],["Amsterdam",52.3728,4.8936,"NL"],["Copenhagen",55.6761,12.5683,"DK"],["Porto",41.1621,-8.622,"PT"],["Brussels",50.8467,4.3525,"BE"]],[["New York",40.6943,-73.9249,"US"],["Los Angeles",34.1141,-118.4068,"US"],["Chicago",41.8375,-87.6866,"US"],["Miami",25.784,-80.2101,"US"],["Dallas",32.7935,-96.7667,"US"],["Philadelphia",40.0077,-75.1339,"US"],["Atlanta",33.7628,-84.422,"US"],["Boston",42.3188,-71.0852,"US"],["Phoenix",33.5722,-112.0892,"US"],["Detroit",42.3834,-83.1024,"US"],["Seattle",47.6211,-122.3244,"US"],["San Francisco",37.7558,-122.4449,"US"],["San Diego",32.8313,-117.1222,"US"],["Minneapolis",44.9635,-93.2678,"US"],["Brooklyn",40.6501,-73.9496,"US"],["Vancouver",49.25,-123.1,"CA"],["Riverside",33.9381,-117.3949,"US"],["Baltimore",39.3051,-76.6144,"US"],["Portland",45.5371,-122.65,"US"],["Sacramento",38.5677,-121.4685,"US"]],[["Melbourne",-37.8142,144.9631,"AU"],["Sydney",-33.8678,151.21,"AU"],["Brisbane",-27.4678,153.0281,"AU"],["Perth",-31.9559,115.8606,"AU"],["Auckland",-36.8406,174.74,"NZ"],["Adelaide",-34.9275,138.6,"AU"],["Port Moresby",-9.4789,147.1494,"PG"],["Gold Coast",-28.0167,153.4,"AU"],["Cranbourne",-38.0996,145.2834,"AU"],["Christchurch",-43.531,172.6365,"NZ"],["Manukau City",-37,174.885,"NZ"],["Central Coast",-33.3,151.2,"AU"],["Wollongong",-34.4331,150.8831,"AU"],["Ipswich",-27.6144,152.7608,"AU"],["Wellington",-41.2889,174.7772,"NZ"],["Northcote",-36.8019,174.7494,"NZ"],["Hobart",-42.8806,147.325,"AU"],["Lae",-6.7303,147.0008,"PG"],["Suva",-18.1416,178.4419,"FJ"],["Nouméa",-22.2758,166.458,"NC"]],[["São Paulo",-23.55,-46.6333,"BR"],["Buenos Aires",-34.6033,-58.3817,"AR"],["Rio de Janeiro",-22.9111,-43.2056,"BR"],["Lima",-12.06,-77.0375,"PE"],["Bogotá",4.7111,-74.0722,"CO"],["Santiago",-33.4372,-70.6506,"CL"],["Belo Horizonte",-19.9167,-43.9333,"BR"],["Fortaleza",-3.7275,-38.5275,"BR"],["Santa Cruz de la Sierra",-17.7892,-63.1975,"BO"],["La Paz",-16.4958,-68.1333,"BO"],["Guayaquil",-2.19,-79.8875,"EC"],["Medellín",6.2308,-75.5906,"CO"],["Salvador",-12.9747,-38.4767,"BR"],["Caracas",10.4806,-66.9036,"VE"],["Córdoba",-31.4167,-64.1833,"AR"],["Santos",-23.9369,-46.325,"BR"],["Curitiba",-25.4297,-49.2711,"BR"],["Maracaibo",10.6333,-71.6333,"VE"],["Recife",-8.05,-34.9,"BR"],["Porto Alegre",-30.0331,-51.23,"BR"]]],To=[0,0,5,26,28,26,9,6],Ai=To.reduce((t,e)=>t+e,0),Ri=To.reduce((t,e)=>{const r=t[t.length-1]??0;return t.push(r+e),t},[]),Di=Array.from(Uo(Ri,Oi,(t,e)=>[t,e]));function Ui(t){const e=t.nextRange(0,Ai),r=yi(Di,([l])=>l<=e),[,o]=Ci(r),n=t.nextRange(0,o.length);return o[n]}function Li(t){const e=t.nextRange(0,Po.length);return Po[e]}function Ji(t){const e=t.nextRange(0,Mo.length);return Mo[e]}function Mi(t){const e=t.nextRange(0,Jo.length);return Jo[e]}function Pi(t){const e=t.nextRange(0,Lo.length);return Lo[e]}function Ti(t){const[e,r]=Li(t),[,o,n,d]=Ui(t),l=Ji(t),h=Mi(t),f=Pi(t);return{pubkey:new F("PUBKEY",t.fillBytes(32)),stateVerKey:new F("STATE_VER_KEY",t.fillBytes(32)),stake:t.nextRangeBigInt(0n,1000n)*1000000000000000000n,commission:t.nextRange(0,5e3),name:`${e} Node ${d} ${t.nextRange(0,100)}`,address:t.fillBytes(32),company:{name:e,website:r},location:{coords:[o,n],country:d},operatingSystem:l,networkType:f,nodeType:h}}function*Fi(t=new ne(pt())){const e=t.nextRange(100,350);for(let r=0;r<e;r++)yield Ti(t)}const ke=Array.from(Fi());async function*zi(){}function Vi(){const t=new Uint8Array(new Array(20).map(()=>0)).buffer;return{hash:new F("BLOCK",t),height:0,time:new Date(0),genTime:0,transactions:zi(),numTransactions:0,proposer:[],size:0,fees:[]}}async function*Wi(t){let e=1,r=pt();const o=mi();for(;r<o;){const n=Math.floor(t.nextFloat()*14*1e3);yield ji(new ne(e+n),e,r,r+n),r+=n,e++}}async function*_i(t=new ne(pt())){yield Vi(),yield*Wi(t)}function ji(t,e,r,o){const n=Math.floor(t.nextRange(0,5)),d=t.nextRange(0,ke.length),l=ke[d];return{hash:new F("BLOCK",t.fillBytes(32)),height:e,genTime:o-r,time:new Date(o),numTransactions:n,transactions:qi(new ne(e+r),e,r,o,n),proposer:[l.address],size:Math.floor(t.nextFloat()*1024*n)+8,fees:[T.ESP(BigInt(t.nextRange(0,1e9)*1e3))]}}const Fo=Array.from(Xd.keys());function Hi(t){return t.nextFloat()>.98?1:Fo[t.nextRange(0,Fo.length)]}async function*qi(t,e,r,o,n){const d=(o-r)/n;for(let l=0,h=r;h<o;h+=d,l++){const f=Hi(t),i=Math.floor(1024*t.nextFloat());yield{block:e,index:l,size:i,hash:new F("COMMIT",t.fillBytes(32)),time:new Date(h),sender:new F("PUBKEY",t.fillBytes(32)),tree:{namespace:f,data:t.fillBytes(i)}}}}function vt(t){if(t.startsWith("0x"))return vt(t.substring(2));if((t.length&1)!==0)return vt("0"+t);const e=new ArrayBuffer(t.length/2);return $i(Io(t),e),e}function $i(t,e){const r=new DataView(e);let o=0;for(;o<e.byteLength;){const n=t.next(),d=t.next();if(n.done||d.done)throw new Gr;const l=zo(n.value),h=zo(d.value),f=l<<4|h;r.setUint8(o,f),o++}}function zo(t){if(t>=48&&t<=57)return t-48;if(t>=97&&t<=102)return t-97+10;if(t>=65&&t<=70)return t-65+10;throw new Qr(t)}function Ki(t){return t.toString(16).padStart(2,"0")}function*Gi(t){yield*Do(t,Ki)}function Vo(t){return Gi(t[Symbol.iterator]())}class Qi{convert(e){if(typeof e!="string")throw new E(typeof e,"string");return vt(e)}}class Xi{convert(e){return`0x${Array.from(Vo(new Uint8Array(e))).join("")}`}}class Zi extends s{encoder=new Xi;decoder=new Qi}const V=new Zi;new P(new J(V),new M(V)),new I(new N(V),new B(V));class Yi{encoding;constructor(e){this.encoding=e}convert(e){if(typeof e!="string")throw new E(typeof e,"string");return this.encoding.decodeString(e)}}class el{encoding;constructor(e){this.encoding=e}convert(e){return this.encoding.encodeToString(e)}}class Ne extends s{encoder;decoder;constructor(e){super(),this.encoder=new el(e),this.decoder=new Yi(e)}}new Ne(mt),new Ne(ii),new Ne(Ao);const k=new Ne(Oo);new P(new J(k),new M(k));class tl{convert(e){if(Is(e))return e;if(Lr(e))return BigInt(e);if(!ue(e))throw new E(typeof e,"string | bigint | number");return BigInt(e)}}class rl{convert(e){return Le(e,"bigint"),`0x${e.toString(16)}`}}class ol extends s{encoder=new rl;decoder=new tl}const S=new ol,Wo=new P(new J(S),new M(S));new I(new N(S),new B(S)),new I(new N(Wo),new B(Wo));const _o=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648];function Be(t){for(let e=0;e<24;++e){const r=t[0]^t[10]^t[20]^t[30]^t[40],o=t[1]^t[11]^t[21]^t[31]^t[41],n=t[2]^t[12]^t[22]^t[32]^t[42],d=t[3]^t[13]^t[23]^t[33]^t[43],l=t[4]^t[14]^t[24]^t[34]^t[44],h=t[5]^t[15]^t[25]^t[35]^t[45],f=t[6]^t[16]^t[26]^t[36]^t[46],i=t[7]^t[17]^t[27]^t[37]^t[47],C=t[8]^t[18]^t[28]^t[38]^t[48],O=t[9]^t[19]^t[29]^t[39]^t[49];let w=C^(n<<1|d>>>31),u=O^(d<<1|n>>>31);const Q=t[0]^w,A=t[1]^u,H=t[10]^w,he=t[11]^u,Dn=t[20]^w,Un=t[21]^u,Ln=t[30]^w,Jn=t[31]^u,Mn=t[40]^w,Pn=t[41]^u;w=r^(l<<1|h>>>31),u=o^(h<<1|l>>>31);const Tn=t[2]^w,Fn=t[3]^u,zn=t[12]^w,Vn=t[13]^u,Wn=t[22]^w,_n=t[23]^u,jn=t[32]^w,Hn=t[33]^u,qn=t[42]^w,$n=t[43]^u;w=n^(f<<1|i>>>31),u=d^(i<<1|f>>>31);const Kn=t[4]^w,Gn=t[5]^u,Qn=t[14]^w,Xn=t[15]^u,Zn=t[24]^w,Yn=t[25]^u,es=t[34]^w,ts=t[35]^u,rs=t[44]^w,os=t[45]^u;w=l^(C<<1|O>>>31),u=h^(O<<1|C>>>31);const ns=t[6]^w,ss=t[7]^u,cs=t[16]^w,as=t[17]^u,ds=t[26]^w,is=t[27]^u,ls=t[36]^w,hs=t[37]^u,us=t[46]^w,ws=t[47]^u;w=f^(r<<1|o>>>31),u=i^(o<<1|r>>>31);const fs=t[8]^w,gs=t[9]^u,ms=t[18]^w,ps=t[19]^u,vs=t[28]^w,ys=t[29]^u,bs=t[38]^w,Ss=t[39]^u,Es=t[48]^w,Cs=t[49]^u,Tt=Q,Ft=A,zt=he<<4|H>>>28,Vt=H<<4|he>>>28,Wt=Dn<<3|Un>>>29,_t=Un<<3|Dn>>>29,jt=Jn<<9|Ln>>>23,Ht=Ln<<9|Jn>>>23,qt=Mn<<18|Pn>>>14,$t=Pn<<18|Mn>>>14,Kt=Tn<<1|Fn>>>31,Gt=Fn<<1|Tn>>>31,Qt=Vn<<12|zn>>>20,Xt=zn<<12|Vn>>>20,Zt=Wn<<10|_n>>>22,Yt=_n<<10|Wn>>>22,er=Hn<<13|jn>>>19,tr=jn<<13|Hn>>>19,rr=qn<<2|$n>>>30,or=$n<<2|qn>>>30,nr=Gn<<30|Kn>>>2,sr=Kn<<30|Gn>>>2,cr=Qn<<6|Xn>>>26,ar=Xn<<6|Qn>>>26,dr=Yn<<11|Zn>>>21,ir=Zn<<11|Yn>>>21,lr=es<<15|ts>>>17,hr=ts<<15|es>>>17,ur=os<<29|rs>>>3,wr=rs<<29|os>>>3,fr=ns<<28|ss>>>4,gr=ss<<28|ns>>>4,mr=as<<23|cs>>>9,pr=cs<<23|as>>>9,vr=ds<<25|is>>>7,yr=is<<25|ds>>>7,br=ls<<21|hs>>>11,Sr=hs<<21|ls>>>11,Er=ws<<24|us>>>8,Cr=us<<24|ws>>>8,xr=fs<<27|gs>>>5,kr=gs<<27|fs>>>5,Nr=ms<<20|ps>>>12,Br=ps<<20|ms>>>12,Ir=ys<<7|vs>>>25,Or=vs<<7|ys>>>25,Ar=bs<<8|Ss>>>24,Rr=Ss<<8|bs>>>24,Dr=Es<<14|Cs>>>18,Ur=Cs<<14|Es>>>18;t[0]=Tt^~Qt&dr,t[1]=Ft^~Xt&ir,t[10]=fr^~Nr&Wt,t[11]=gr^~Br&_t,t[20]=Kt^~cr&vr,t[21]=Gt^~ar&yr,t[30]=xr^~zt&Zt,t[31]=kr^~Vt&Yt,t[40]=nr^~mr&Ir,t[41]=sr^~pr&Or,t[2]=Qt^~dr&br,t[3]=Xt^~ir&Sr,t[12]=Nr^~Wt&er,t[13]=Br^~_t&tr,t[22]=cr^~vr&Ar,t[23]=ar^~yr&Rr,t[32]=zt^~Zt&lr,t[33]=Vt^~Yt&hr,t[42]=mr^~Ir&jt,t[43]=pr^~Or&Ht,t[4]=dr^~br&Dr,t[5]=ir^~Sr&Ur,t[14]=Wt^~er&ur,t[15]=_t^~tr&wr,t[24]=vr^~Ar&qt,t[25]=yr^~Rr&$t,t[34]=Zt^~lr&Er,t[35]=Yt^~hr&Cr,t[44]=Ir^~jt&rr,t[45]=Or^~Ht&or,t[6]=br^~Dr&Tt,t[7]=Sr^~Ur&Ft,t[16]=er^~ur&fr,t[17]=tr^~wr&gr,t[26]=Ar^~qt&Kt,t[27]=Rr^~$t&Gt,t[36]=lr^~Er&xr,t[37]=hr^~Cr&kr,t[46]=jt^~rr&nr,t[47]=Ht^~or&sr,t[8]=Dr^~Tt&Qt,t[9]=Ur^~Ft&Xt,t[18]=ur^~fr&Nr,t[19]=wr^~gr&Br,t[28]=qt^~Kt&cr,t[29]=$t^~Gt&ar,t[38]=Er^~xr&zt,t[39]=Cr^~kr&Vt,t[48]=rr^~nr&mr,t[49]=or^~sr&pr,t[0]^=_o[e*2],t[1]^=_o[e*2+1]}}class nl{state=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];blockSize=0;count=0;squeezing=!1;initialize(e,r){for(let o=0;o<50;++o)this.state[o]=0;this.blockSize=e/8,this.count=0,this.squeezing=!1}absorb(e){for(let r=0;r<e.length;++r)this.state[~~(this.count/4)]^=e[r]<<8*(this.count%4),this.count+=1,this.count===this.blockSize&&(Be(this.state),this.count=0)}absorbLastFewBits(e){this.state[~~(this.count/4)]^=e<<8*(this.count%4),(e&128)!==0&&this.count===this.blockSize-1&&Be(this.state),this.state[~~((this.blockSize-1)/4)]^=128<<8*((this.blockSize-1)%4),Be(this.state),this.count=0,this.squeezing=!0}squeeze(e){this.squeezing||this.absorbLastFewBits(1);const r=new Uint8Array(e);for(let o=0;o<e;++o)r[o]=this.state[~~(this.count/4)]>>>8*(this.count%4)&255,this.count+=1,this.count===this.blockSize&&(Be(this.state),this.count=0);return r}copy(e){for(let r=0;r<50;++r)e.state[r]=this.state[r];e.blockSize=this.blockSize,e.count=this.count,e.squeezing=this.squeezing}}class j{_rate;_capacity;_delimitedSuffix;_hashBitLength;_state;_finalized;constructor(e,r,o,n){this._rate=e,this._capacity=r,this._delimitedSuffix=o,this._hashBitLength=n,this._state=new nl,this._state.initialize(e,r),this._finalized=!1}update(e){if(this._finalized)throw new Error("Digest already called");return this._state.absorb(new Uint8Array(e)),this}digest(){if(this._finalized)throw new Error("Digest already called");this._finalized=!0,this._delimitedSuffix&&this._state.absorbLastFewBits(this._delimitedSuffix);const e=this._state.squeeze(this._hashBitLength/8);return this._resetState(),gt.encode(e)}_resetState(){return this._state.initialize(this._rate,this._capacity),this}}function sl(t){switch(t.toLowerCase()){case"keccak224":return new j(1152,448,null,224);case"keccak256":return new j(1088,512,null,256);case"keccak384":return new j(832,768,null,384);case"keccak512":return new j(576,1024,null,512);case"sha3-224":return new j(1152,448,6,224);case"sha3-256":return new j(1088,512,6,256);case"sha3-384":return new j(832,768,6,384);case"sha3-512":return new j(576,1024,6,512);default:throw new Error("invalid algorithm: "+t)}}const cl=48,al=57,dl=97,il=102;class ll{convert(e){if(b(e,ArrayBuffer),e.byteLength!==20)throw new E(typeof e,"20-byte ArrayBuffer");const o=[...ki(Vo(new Uint8Array(e)),f=>f.split(""))],n=sl("keccak256"),d=new TextEncoder;n.update(gt.encode(d.encode(o.join(""))));const l=new Uint8Array(n.digest());return["0x",...xe(Uo(Bi(e.byteLength*2),o,(f,i)=>[f,i]),([f,i])=>{const C=i.charCodeAt(0);if(C>=cl&&C<=al)return i;if(C>=dl&&C<=il){const O=Math.floor(f/2),w=f&1,u=l[O];return(w===0?u>>4:u&15)>7?i.toUpperCase():i}throw new D})].join("")}}const hl=new ll;class ul{keyCodec;valueCodec;constructor(e,r){this.keyCodec=e,this.valueCodec=r}convert(e){if(typeof e!="object"||e===null)throw new Error(`invalid map value: expected an object, got ${typeof e}`);const r=new Map;for(const[o,n]of Object.entries(e)){const d=this.keyCodec.decode(o),l=this.valueCodec.decode(n);r.set(d,l)}return r}}class wl{keyCodec;valueCodec;constructor(e,r){this.keyCodec=e,this.valueCodec=r}convert(e){b(e,Map);const r={};for(const[o,n]of e.entries()){const d=this.keyCodec.encode(o),l=this.valueCodec.encode(n);r[d]=l}return r}}class yt extends s{encoder;decoder;constructor(e,r){super(),this.encoder=r,this.decoder=e}static keyStringCodec(e){return new yt(new ul(c,e),new wl(c,e))}}class fl{convert(e){if(!ue(e))throw new E(typeof e,"string");return new URL(e)}}class gl{convert(e){return e.toString()}}class ml extends s{encoder=new gl;decoder=new fl}const jo=new ml;new P(new J(jo),new M(jo));class Ho{number;hash;parent;constructor(e,r,o){this.number=e,this.hash=r,this.parent=o}toJSON(){return se.encode(this)}}class pl{convert(e){return a(e,"number","hash","parent"),new Ho(S.decode(e.number),k.decode(e.hash),k.decode(e.parent))}}class vl{convert(e){return{number:S.encode(e.number),hash:k.encode(e.hash),parent:k.encode(e.parent)}}}class yl extends s{encoder=new vl;decoder=new pl}const se=new yl,bl=1000000000n,Sl=12n;class El{async getBlockForHeight(e){const r=new ArrayBuffer(32);new DataView(r).setBigUint64(24,BigInt(e),!1);const n=new ArrayBuffer(32);return new DataView(n).setBigUint64(24,e-1n,!1),new Ho(BigInt(e),r,n)}async getLatestBlock(){const e=BigInt(Math.floor(pi()/1e3)),o=(BigInt(Math.floor(Date.now()/1e3))-e)/Sl,n=bl+o;return this.getBlockForHeight(n)}}async function Cl(t){let e;for(let r=await t.next();!r.done;r=await t.next())e=r.value;if(e===void 0)throw new be;return e}async function xl(t){return Cl(t[Symbol.asyncIterator]())}class Ie{ratio;constructor(e){this.ratio=e,Object.freeze(this)}valueOf(){return this.ratio}toString(){return this.ratio.toString()}toJSON(){return W.encode(this)}}class kl{convert(e){return y.encode(e.ratio)}}class Nl{convert(e){return new Ie(y.decode(e))}}class Bl extends s{encoder=new kl;decoder=new Nl}const W=new Bl;class qo{address;voterParticipation;leaderParticipation;constructor(e,r,o){this.address=e,this.voterParticipation=r,this.leaderParticipation=o}toJSON(){return bt.encode(this)}}class Il{convert(e){return a(e,"address","voter_participation","leader_participation"),new qo(k.decode(e.address),W.decode(e.voter_participation),W.decode(e.leader_participation))}}class Ol{convert(e){return{address:k.encode(e.address),voter_participation:W.encode(e.voterParticipation),leader_participation:W.encode(e.leaderParticipation)}}}class Al extends s{encoder=new Ol;decoder=new Il}const bt=new Al,Oe=new I(new N(bt),new B(bt));class $o{epoch;block;timestamp;constructor(e,r,o){this.epoch=e,this.block=r,this.timestamp=o}toJSON(){return ce.encode(this)}}class Rl{convert(e){return a(e,"epoch","block","timestamp"),new $o(S.decode(e.epoch),S.decode(e.block),new Date(y.decode(e.timestamp)))}}class Dl{convert(e){return{epoch:S.encode(e.epoch),block:S.encode(e.block),timestamp:y.encode(e.timestamp.getTime())}}}class Ul extends s{encoder=new Dl;decoder=new Rl}const ce=new Ul;class Ko{espressoBlock;nodes;constructor(e,r){this.espressoBlock=e,this.nodes=r}toJSON(){return St.encode(this)}}class Ll{convert(e){return a(e,"espresso_block","nodes"),new Ko(ce.decode(e.espresso_block),Oe.decode(e.nodes))}}class Jl{convert(e){return{espresso_block:ce.encode(e.espressoBlock),nodes:Oe.encode(e.nodes)}}}class Ml extends s{encoder=new Jl;decoder=new Ll}const St=new Ml;class Pl{async active(){const e=await xl(_i()),r=ke.slice().sort((n,d)=>Number(d.stake-n.stake)).slice(0,100),o=new ne(e.genTime);return new Ko(new $o(BigInt(Math.floor(e.height/100)),BigInt(e.height),new Date(e.time)),Array.from(xe(r,n=>new qo(n.address,new Ie(o.nextFloat()),new Ie(o.nextFloat())))))}async updatesSince(){throw new D}}class Go{number;hash;timestamp;constructor(e,r,o){this.number=e,this.hash=r,this.timestamp=o}toJSON(){return ae.encode(this)}}class Tl{convert(e){return a(e,"number","hash","timestamp"),new Go(S.decode(e.number),k.decode(e.hash),new Date(y.decode(e.timestamp)))}}class Fl{convert(e){return{number:S.encode(e.number),hash:k.encode(e.hash),timestamp:y.encode(e.timestamp.valueOf())}}}class zl extends s{encoder=new Fl;decoder=new Tl}const ae=new zl,Et=1e4,Qo=0,Vl="PercentageOutOfRange";class Wl extends m{value;constructor(e,r=`the commission percentage is outside of the range [${Qo}, ${Et}], have ${e}`){super(r),this.value=e,Object.freeze(this)}get code(){return Vl}}class Xo{value;constructor(e){if(e<Qo||e>Et)throw new Wl(e);this.value=e}toString(){return`${this.value/100}%`}toJSON(){return this.value}valueOf(){return this.value/Et}}class _l{convert(e){if(typeof e!="number")throw new E(typeof e,"number");return new Xo(e)}}class jl{convert(e){if(!(e instanceof Xo))throw new E(e,"CommissionPercent");return Math.floor(e.value)}}class Hl extends s{encoder=new jl;decoder=new _l}const Zo=new Hl;class Yo{stakeKey;stakeAmount;constructor(e,r){this.stakeKey=e,this.stakeAmount=r}}class ql{convert(e){return a(e,"stake_key","stake_amount"),new Yo(U.decode(e.stake_key),S.decode(e.stake_amount))}}class $l{convert(e){return b(e,Yo),{stake_key:U.encode(e.stakeKey),stake_amount:S.encode(e.stakeAmount)}}}class Kl extends s{encoder=new $l;decoder=new ql}const q=new Kl;new P(new J(q),new M(q)),new I(new N(q),new B(q));class en{stakeTableEntry;stateVerKey;constructor(e,r){this.stakeTableEntry=e,this.stateVerKey=r}}class Gl{convert(e){return a(e,"stake_table_entry","state_ver_key"),new en(q.decode(e.stake_table_entry),U.decode(e.state_ver_key))}}class Ql{convert(e){return b(e,en),{stake_table_entry:q.encode(e.stakeTableEntry),state_ver_key:U.encode(e.stateVerKey)}}}class Xl extends s{encoder=new Ql;decoder=new Gl}const Ae=new Xl;new P(new J(Ae),new M(Ae)),new I(new N(Ae),new B(Ae));class Zl{address;constructor(e){this.address=e,Object.freeze(this)}toJSON(){return $.encode(this)}toString(){return $.encode(this)}}class Yl{convert(e){return e.address.byteLength!==20?V.encode(e.address):hl.convert(e.address)}}class eh{convert(e){return new Zl(V.decode(e))}}class th extends s{encoder=new Yl;decoder=new eh}const $=new th;new P(new J($),new M($));const tn=yt.keyStringCodec(S);class rn{account;stakeTableKey;stateVerKey;stake;commission;delegators;constructor(e,r,o,n,d,l){this.account=e,this.stakeTableKey=r,this.stateVerKey=o,this.stake=n,this.commission=d,this.delegators=l}}class rh{convert(e){return a(e,"account","stake_table_key","state_ver_key","stake","commission","delegators"),new rn($.decode(e.account),U.decode(e.stake_table_key),U.decode(e.state_ver_key),S.decode(e.stake),Zo.decode(e.commission),tn.decode(e.delegators))}}class oh{convert(e){return b(e,rn),{account:$.encode(e.account),stake_table_key:U.encode(e.stakeTableKey),state_ver_key:U.encode(e.stateVerKey),stake:S.encode(e.stake),commission:Zo.encode(e.commission),delegators:tn.encode(e.delegators)}}}class nh extends s{encoder=new oh;decoder=new rh}const Re=new nh;new P(new J(Re),new M(Re)),new I(new N(Re),new B(Re));class on{address;stakingKey;stake;commission;constructor(e,r,o,n){this.address=e,this.stakingKey=r,this.stake=o,this.commission=n}toJSON(){return de.encode(this)}}class sh{convert(e){return a(e,"address","staking_key","stake","commission"),new on(k.decode(e.address),U.decode(e.staking_key),S.decode(e.stake),W.decode(e.commission))}}class ch{convert(e){return{address:k.encode(e.address),staking_key:U.encode(e.stakingKey),stake:S.encode(e.stake),commission:W.encode(e.commission)}}}class ah extends s{encoder=new ch;decoder=new sh}const de=new ah,nn=new I(new N(de),new B(de));class sn{l1Block;nodes;constructor(e,r=[]){this.l1Block=e,this.nodes=r}toJSON(){return Ct.encode(this)}}class dh{convert(e){return a(e,"l1_block","nodes"),new sn(ae.decode(e.l1_block),nn.decode(e.nodes))}}class ih{convert(e){return{l1_block:ae.encode(e.l1Block),nodes:nn.encode(e.nodes)}}}class lh extends s{encoder=new ih;decoder=new dh}const Ct=new lh;class hh{async snapshot(){return new sn(new Go(BigInt(1),new ArrayBuffer(32),new Date),Array.from(xe(ke,e=>new on(e.address,e.stateVerKey,e.stake,new Ie(e.commission/1e4)))))}async updatesSince(){throw new D}}class uh{l1Block=new El;validatorsAll=new hh;validatorsActive=new Pl;async setURL(){throw new D}}function K(t,e){return async r=>(await wh(r,e),xt(r),t.convert(await r.json()))}async function wh(t,e){if(!t.ok){if(t.status>=500&&t.status<600){try{xt(t)}catch(r){if(r instanceof m)throw r;console.error("encountered an error attempting to decode a server error from the server",r)}throw new _r(t.status,t)}if(t.status>=400&&t.status<500){try{xt(t)}catch(r){if(r instanceof m)throw r;console.error("encountered an error attempting to decode a client error from the server",r)}throw new Fr(t.status,t)}throw new Vr(t.status,t)}}function xt(t){const e=t.headers.get("content-type");if(!e||!e.startsWith("application/json"))throw ee.fromResponse(t,e||"undefined")}class fh{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async getBlockForHeight(e){const r=new URL(`./${e}`,this.baseURL);return this.fetcher(r).then(K(se.decoder))}async getLatestBlock(){const e=new URL("latest",this.baseURL);return this.fetcher(e).then(K(se.decoder))}}class cn{width;index;constructor(e,r){this.width=e,this.index=r}toJSON(){return kt.encode(this)}}class gh{convert(e){return a(e,"width","index"),new cn(y.decode(e.width),y.decode(e.index))}}class mh{convert(e){return b(e,cn),{width:y.encode(e.width),index:y.encode(e.index)}}}class ph extends s{encoder=new mh;decoder=new gh}const kt=new ph;class ie{static get lsb0(){return yh}static get msb0(){return Sh}valueOf(){return this.toString()}toJSON(){return this.toString()}}const an="bitvec::order::Lsb0",dn="bitvec::order::Msb0";class vh extends ie{toString(){return an}}const yh=new vh;class bh extends ie{toString(){return dn}}const Sh=new bh;class Eh{convert(e){if(typeof e!="string")throw new E(typeof e,"string");switch(e){case an:return ie.lsb0;case dn:return ie.msb0;default:throw new E(e,"CappuccinoAPIBitVecOrder")}}}class Ch{convert(e){return e.toString()}}class xh extends s{encoder=new Ch;decoder=new Eh}const ln=new xh;class hn{order;head;bits;data;constructor(e,r,o,n){this.order=e,this.head=r,this.bits=o,this.data=n}getBitVecIndexIterable(){return this.order===ie.lsb0?new Ah(this.head.width,this.bits):new Dh(this.head.width,this.bits)}[Symbol.iterator](){const e=this.getBitVecIndexIterable();return xe(e,r=>Ih(this.data,r))[Symbol.iterator]()}toJSON(){return le.encode(this)}}class kh{convert(e){return a(e,"order","head","bits","data"),new hn(ln.decode(e.order),kt.decode(e.head),y.decode(e.bits),$r.decode(e.data))}}class Nh{convert(e){return b(e,hn),{order:ln.encode(e.order),head:kt.encode(e.head),bits:y.encode(e.bits),data:$r.encode(e.data)}}}class Bh extends s{encoder=new Nh;decoder=new kh}const le=new Bh;new I(new N(le),new B(le));function Ih(t,e){return(t[e.bucket]>>e.bitOffset&1)===1}class un{bucket;bitOffset;constructor(e,r){this.bucket=e,this.bitOffset=r}}function wn(t){switch(x(t===8||t===16||t===32,"bit width should be a power of two that is supported"),t){case 8:return 3;case 16:return 4;case 32:return 5;default:throw new D}}class Oh{totalBits;bitWidthMask;bitWidthShift;offset=0;constructor(e,r){this.totalBits=r;const o=wn(e);this.bitWidthMask=e-1,this.bitWidthShift=o}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,r=this.offset&this.bitWidthMask;return this.offset+=1,{done:!1,value:new un(e,r)}}}class Ah{bitWidth;totalBits;constructor(e,r){this.bitWidth=e,this.totalBits=r}[Symbol.iterator](){return new Oh(this.bitWidth,this.totalBits)}}class Rh{bitWidth;totalBits;bitWidthMask;bitWidthShift;offset=0;constructor(e,r){this.bitWidth=e,this.totalBits=r;const o=wn(e);this.bitWidthMask=e-1,this.bitWidthShift=o}next(){if(this.offset>=this.totalBits)return{done:!0,value:void 0};const e=this.offset>>this.bitWidthShift,r=this.bitWidth-1-(this.offset&this.bitWidthMask);return this.offset+=1,{done:!1,value:new un(e,r)}}}class Dh{bitWidth;totalBits;constructor(e,r){this.bitWidth=e,this.totalBits=r}[Symbol.iterator](){return new Rh(this.bitWidth,this.totalBits)}}class Uh{address;ratio;constructor(e,r){this.address=e,this.ratio=r}toJSON(){return Nt.encode(this)}}class Lh{convert(e){return a(e,"address","percentage"),new Uh(k.decode(e.address),W.decode(e.percentage))}}class Jh{convert(e){return{address:k.encode(e.address),percentage:W.encode(e.ratio)}}}class Mh extends s{encoder=new Jh;decoder=new Lh}const Nt=new Mh,fn=new I(new N(Nt),new B(Nt));class gn{}class mn extends gn{leaders;voters;constructor(e,r){super(),this.leaders=e,this.voters=r}toJSON(){return Bt.encode(this)}}class Ph{convert(e){return a(e,"leaders","voters"),new mn(fn.decode(e.leaders),le.decode(e.voters))}}class Th{convert(e){return{leaders:fn.encode(e.leaders),voters:le.encode(e.voters)}}}class Fh extends s{encoder=new Th;decoder=new Ph}const De="NewBlock",Bt=new Fh;class pn extends gn{entries;constructor(e){super(),this.entries=e}toJSON(){return It.encode(this)}}class zh{convert(e){return new pn(Oe.decode(e))}}class Vh{convert(e){return Oe.encode(e.entries)}}class Wh extends s{encoder=new Vh;decoder=new zh}const Ue="NewEpoch",It=new Wh;class _h{convert(e){if(a(e),we(e,Ue))return It.decode(e[Ue]);if(we(e,De))return Bt.decode(e[De]);const r=Object.keys(e);if(r.length<=0)throw new E("Empty EspressoMessage object","object");const[o]=r;throw new E(o,`${Ue} | ${De}`)}}class jh{convert(e){if(e instanceof pn)return{[Ue]:It.encode(e)};if(e instanceof mn)return{[De]:Bt.encode(e)};throw new E("Unrecognized EspressoMessage type","Valid EspressoMessage Type")}}class Hh extends s{encoder=new jh;decoder=new _h}const vn=new Hh,yn=new I(new N(vn),new B(vn));class qh{espressoBlock;diff;constructor(e,r){this.espressoBlock=e,this.diff=r}toJSON(){return Ot.encode(this)}}class $h{convert(e){return a(e,"espresso_block","diff"),new qh(ce.decode(e.espresso_block),yn.decode(e.diff))}}class Kh{convert(e){return{espresso_block:ce.encode(e.espressoBlock),diff:yn.encode(e.diff)}}}class Gh extends s{encoder=new Kh;decoder=new $h}const Ot=new Gh;class Qh{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async active(){return this.fetcher(this.baseURL).then(K(St.decoder))}async updatesSince(e){const r=new URL(`active/updates/${e}`,this.baseURL);return this.fetcher(r).then(K(Ot.decoder))}}class Xh{address;exitTime;constructor(e,r){this.address=e,this.exitTime=r}toJSON(){return At.encode(this)}}class Zh{convert(e){return a(e,"address","exit_time"),new Xh(k.decode(e.address),new Date(e.exit_time))}}class Yh{convert(e){return{address:k.encode(e.address),exit_time:e.exitTime.toISOString()}}}class eu extends s{encoder=new Yh;decoder=new Zh}const At=new eu;class bn{}class Sn extends bn{validatorExit;constructor(e){super(),this.validatorExit=e}toJSON(){return Dt.encode(this)}}class tu{convert(e){return a(e,"validator_exit"),new Sn(At.decode(e.validator_exit))}}class ru{convert(e){return{validator_exit:At.encode(e.validatorExit)}}}class ou extends s{encoder=new ru;decoder=new tu}const Rt="NodeExit",Dt=new ou;class En extends bn{validatorInformation;constructor(e){super(),this.validatorInformation=e}toJSON(){return Lt.encode(this)}}class nu{convert(e){return new En(de.decode(e))}}class su{convert(e){return de.encode(e.validatorInformation)}}class cu extends s{encoder=new su;decoder=new nu}const Ut="NodeUpdate",Lt=new cu;class au{convert(e){if(a(e),we(e,Ut))return Lt.decode(e[Ut]);if(we(e,Rt))return Dt.decode(e[Rt]);throw Object.keys(e).length<=0?new E("Empty L1Message object","object"):new E("Unrecognized L1Message type","Valid L1 Type")}}class du{convert(e){if(e instanceof En)return{[Ut]:Lt.encode(e)};if(e instanceof Sn)return{[Rt]:Dt.encode(e)};throw new E("Unrecognized L1Message type","Valid L1 Type")}}class iu extends s{encoder=new du;decoder=new au}const Cn=new iu,xn=new I(new N(Cn),new B(Cn));class lu{l1Block;diff;constructor(e,r=[]){this.l1Block=e,this.diff=r}toJSON(){return Jt.encode(this)}}class hu{convert(e){return a(e,"l1_block","diff"),new lu(ae.decode(e.l1_block),xn.decode(e.diff))}}class uu{convert(e){return{l1_block:ae.encode(e.l1Block),diff:xn.encode(e.diff)}}}class wu extends s{encoder=new uu;decoder=new hu}const Jt=new wu;class fu{fetcher;baseURL;constructor(e,r){this.fetcher=e,this.baseURL=r}async snapshot(e){const r=V.encode(e),o=new URL(`./${r}`,this.baseURL);return this.fetcher(o).then(K(Ct.decoder))}async updatesSince(e){const r=new URL(`updates/${V.encode(e)}`,this.baseURL);return this.fetcher(r).then(K(Jt.decoder))}}class kn{l1Block;validatorsAll;validatorsActive;constructor(e,r){this.l1Block=new fh(e,new URL("l1/block/",r)),this.validatorsAll=new fu(e,new URL("nodes/all/",r)),this.validatorsActive=new Qh(e,new URL("nodes/active",r))}async setURL(){throw new D}}class gu{service;constructor(e){this.service=e}async getBlockForHeight(e){return this.service.getBlockForHeight(e)}async getLatestBlock(){return this.service.getLatestBlock()}async handleRequest(e){switch(e.method){case"getBlockForHeight":return se.encode(await this.getBlockForHeight(S.decode(e.param[0])));case"getLatestBlock":return se.encode(await this.getLatestBlock());default:throw new D}}}class mu{service;constructor(e){this.service=e}async active(){return this.service.active()}async updatesSince(e){return this.service.updatesSince(e)}async handleRequest(e){switch(e.method){case"active":return St.encode(await this.active());case"updatesSince":return Ot.encode(await this.updatesSince(S.decode(e.param[0])))}}}class pu{service;constructor(e){this.service=e}async snapshot(e){return this.service.snapshot(e)}async updatesSince(e){return this.service.updatesSince(e)}async handleRequest(e){switch(e.method){case"snapshot":{const r=V.decode(e.param[0]);return Ct.encode(await this.snapshot(r))}case"updatesSince":return Jt.encode(await this.updatesSince(k.decode(e.param[0])))}}}class Nn{l1Block;validatorsActive;validatorsAll;constructor(e){this.l1Block=new gu(e.l1Block),this.validatorsActive=new mu(e.validatorsActive),this.validatorsAll=new pu(e.validatorsAll)}async handleRequest(e){switch(e.api){case"l1Block":return this.l1Block.handleRequest(e);case"validatorsActive":return this.validatorsActive.handleRequest(e);case"validatorsAll":return this.validatorsAll.handleRequest(e);default:throw new D}}}const G=y;class Bn{requestID;api;method;param;constructor(e,r,o,n){this.requestID=e,this.api=r,this.method=o,this.param=n}toJSON(){return{requestID:this.requestID,api:this.api,method:this.method,param:this.param}}}class vu{convert(e){return a(e,"requestID","api","method","param"),new Bn(G.decode(e.requestID),c.decode(e.api),c.decode(e.method),e.param)}}class yu{convert(e){return b(e,Bn),{requestID:G.encode(e.requestID),api:c.encode(e.api),method:c.encode(e.method),param:e.param}}}class bu extends s{encoder=new yu;decoder=new vu}const Su=new bu;class In{requestID;constructor(e){this.requestID=e}}class Mt extends In{response;constructor(e,r){super(e),this.response=r}toJSON(){return On.encode(this)}}class Eu{convert(e){return a(e,"requestID","response"),new Mt(G.decode(e.requestID),e.response)}}class Cu{convert(e){return b(e,Mt),{requestID:G.encode(e.requestID),response:e.response}}}class xu extends s{encoder=new Cu;decoder=new Eu}const On=new xu;class Pt extends In{error;constructor(e,r){super(e),this.error=r}toJSON(){return An.encode(this)}}class ku{convert(e){return a(e,"requestID","error"),new Pt(G.decode(e.requestID),ge.decode(e.error))}}class Nu{convert(e){return b(e,Pt),{requestID:G.encode(e.requestID),error:ge.encode(e.error)}}}class Bu extends s{encoder=new Nu;decoder=new ku}const An=new Bu,Rn=async(t,e)=>{try{return await fetch(t,e)}catch(r){throw new jr(r)}};async function Iu(){try{const e=await(await fetch("/config.json")).json();if(e.l1_validators_service_url){const r=new URL(e.l1_validators_service_url);return new kn(Rn,r)}}catch{}return new uh}async function Ou(){return new Nn(await Iu())}class Au{service;postMessage;requestChannel;constructor(e){this.postMessage=e,this.service=Ou(),this.requestChannel=$a(10),this.processRequests()}async handleProxyRequest(e){if(e.method==="set-url"){const r=e.param[0];if(!r||typeof r!="string")throw new D("Invalid URL provided");return this.service=Promise.resolve(new Nn(new kn(Rn,new URL(r)))),!0}else throw new D(`Unknown proxy method: ${e.method}`)}async processRequests(){for await(const e of this.requestChannel)try{const r=await this.service;let o;e.api==="proxy"?o=await this.handleProxyRequest(e):o=await r.handleRequest(e),this.postMessage(On.encode(new Mt(e.requestID,o)))}catch(r){this.postMessage(An.encode(new Pt(e.requestID,r)))}}async handleEvent(e){const r=Su.decode(e.data);await this.requestChannel.publish(r)}}self.addEventListener("message",new Au(self.postMessage.bind(self)))})();
